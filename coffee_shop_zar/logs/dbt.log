

============================== 2022-08-06 18:22:21.515117 | 5500d099-68cd-46b3-b79a-e8d4be6fc7cf ==============================
[0m18:22:21.515129 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:22:21.515563 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m18:22:21.515833 [debug] [MainThread]: Tracking: tracking
[0m18:22:21.519877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69c48f9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69c48817c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69c4881400>]}
[0m18:22:21.828556 [debug] [MainThread]: Executing "git --help"
[0m18:22:21.833743 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:22:21.834268 [debug] [MainThread]: STDERR: "b''"
[0m18:22:21.838421 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m18:22:21.839279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:22.409783 [debug] [MainThread]: On debug: select 1 as id
[0m18:22:23.315453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69c4881970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69c2cc8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69c2cc8310>]}
[0m18:22:23.823137 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-06 18:24:30.024203 | 6178e7a8-7a6b-4333-a3f1-3f448f3ff4a5 ==============================
[0m18:24:30.024234 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:24:30.025119 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:24:30.025702 [debug] [MainThread]: Tracking: tracking
[0m18:24:30.031190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad27a06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad27a0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad27a0970>]}
[0m18:24:30.050016 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m18:24:30.050647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6178e7a8-7a6b-4333-a3f1-3f448f3ff4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad2771ac0>]}
[0m18:24:30.079109 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:24:30.083337 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:24:30.107439 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:24:30.113139 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:24:30.115817 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:24:30.116383 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:24:30.116845 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:24:30.117440 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:24:30.118137 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:24:30.118807 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:24:30.119530 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:24:30.119966 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:24:30.121508 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:24:30.123441 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:24:30.124089 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:24:30.125415 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:24:30.126013 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:24:30.126645 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:24:30.129152 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:24:30.130855 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:24:30.136128 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:24:30.139065 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:24:30.154762 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:24:30.157585 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:24:30.158567 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:24:30.159346 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:24:30.160227 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:24:30.161626 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:24:30.164310 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:24:30.177750 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:24:30.184664 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:24:30.198826 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:24:30.203256 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:24:30.212785 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:24:30.215751 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:24:30.217951 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:24:30.219012 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:24:30.220130 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:24:30.221144 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:24:30.222443 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:24:30.228030 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:24:30.228934 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:24:30.230206 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:24:30.231552 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:24:30.232667 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:24:30.233837 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:24:30.235015 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:24:30.235906 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:24:30.237982 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:24:30.239848 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:24:30.242293 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:24:30.243469 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:24:30.244455 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:24:30.245781 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:24:30.246821 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:24:30.247958 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:24:30.249076 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:24:30.257673 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:24:30.263019 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:24:30.265351 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:24:30.269148 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:24:30.274656 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:24:30.277526 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:24:30.293226 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:24:30.297662 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:24:30.312640 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:24:30.314216 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:24:30.324279 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:24:30.325682 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:24:30.331094 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:24:30.334534 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:24:30.336866 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:24:30.341332 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:24:30.343200 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:24:30.345007 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:24:30.362489 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:24:30.369470 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:24:30.381639 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:24:30.383404 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:24:30.394647 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:24:30.411130 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:24:30.412770 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:24:30.414417 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:24:30.416888 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:24:30.728473 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m18:24:30.749143 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m18:24:30.780994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_zar.example

[0m18:24:30.787003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6178e7a8-7a6b-4333-a3f1-3f448f3ff4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad21b40d0>]}
[0m18:24:30.792640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6178e7a8-7a6b-4333-a3f1-3f448f3ff4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad27a06d0>]}
[0m18:24:30.792971 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:24:30.793299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6178e7a8-7a6b-4333-a3f1-3f448f3ff4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad2204a00>]}
[0m18:24:30.794729 [info ] [MainThread]: 
[0m18:24:30.795798 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:24:30.797649 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:24:30.798129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:32.017882 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:24:32.018483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:32.286718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6178e7a8-7a6b-4333-a3f1-3f448f3ff4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad21b4f70>]}
[0m18:24:32.287425 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:24:32.287831 [info ] [MainThread]: 
[0m18:24:32.292980 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m18:24:32.293363 [info ] [Thread-1  ]: 1 of 2 START table model dbt_lauren.customers .................................. [RUN]
[0m18:24:32.294077 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m18:24:32.294386 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m18:24:32.294623 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m18:24:32.298535 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m18:24:32.299050 [debug] [Thread-1  ]: finished collecting timing info
[0m18:24:32.299285 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m18:24:32.315075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:24:32.595287 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customers"
[0m18:24:32.595903 [debug] [Thread-1  ]: On model.coffee_shop_zar.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customers"} */


  create or replace table `aec-students`.`dbt_lauren`.`customers`
  
  
  OPTIONS()
  as (
    


/*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club.coffee_shop.customers`
    ),

    orders as (
      select * from `analytics-engineers-club.coffee_shop.orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            ifnull(aggregate_orders.orders,0) as orders,
            aggregate_orders.first_order_at
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at
  );
  
[0m18:24:37.846964 [debug] [Thread-1  ]: finished collecting timing info
[0m18:24:37.847840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6178e7a8-7a6b-4333-a3f1-3f448f3ff4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad214ab20>]}
[0m18:24:37.848518 [info ] [Thread-1  ]: 1 of 2 OK created table model dbt_lauren.customers ............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 5.55s]
[0m18:24:37.849330 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m18:24:37.850558 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.monthly_users
[0m18:24:37.850987 [info ] [Thread-3  ]: 2 of 2 START view model dbt_lauren.monthly_users ............................... [RUN]
[0m18:24:37.852222 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.monthly_users"
[0m18:24:37.852537 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.monthly_users
[0m18:24:37.852827 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.monthly_users
[0m18:24:37.857371 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.monthly_users"
[0m18:24:37.857838 [debug] [Thread-3  ]: finished collecting timing info
[0m18:24:37.858126 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.monthly_users
[0m18:24:37.883875 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.monthly_users"
[0m18:24:37.884387 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:24:37.884642 [debug] [Thread-3  ]: On model.coffee_shop_zar.monthly_users: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.monthly_users"} */


  create or replace view `aec-students`.`dbt_lauren`.`monthly_users`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
from `aec-students`.`dbt_lauren`.`customers`
group by 
    signup_month;


[0m18:24:38.585508 [debug] [Thread-3  ]: finished collecting timing info
[0m18:24:38.586048 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6178e7a8-7a6b-4333-a3f1-3f448f3ff4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad0125ee0>]}
[0m18:24:38.586488 [info ] [Thread-3  ]: 2 of 2 OK created view model dbt_lauren.monthly_users .......................... [[32mOK[0m in 0.73s]
[0m18:24:38.587023 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.monthly_users
[0m18:24:38.588661 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:24:38.589659 [info ] [MainThread]: 
[0m18:24:38.590072 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m18:24:38.590533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:38.590828 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customers' was properly closed.
[0m18:24:38.591011 [debug] [MainThread]: Connection 'model.coffee_shop_zar.monthly_users' was properly closed.
[0m18:24:38.638734 [info ] [MainThread]: 
[0m18:24:38.639105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:38.639642 [info ] [MainThread]: 
[0m18:24:38.640058 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:24:38.640768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad264ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad5a3f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad5a30a30>]}


============================== 2022-08-07 02:25:04.284316 | ebc113e0-4329-46cf-87c3-643425b2b8d9 ==============================
[0m02:25:04.284349 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:25:04.289413 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:25:04.289880 [debug] [MainThread]: Tracking: tracking
[0m02:25:04.295395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616f620790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616f6206d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616f620a30>]}
[0m02:25:04.400472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:25:04.401014 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/sources.yml
[0m02:25:04.452761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616f4ecb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616f4e6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f616f4e6220>]}


============================== 2022-08-07 02:31:25.203002 | 523136b9-adba-4577-bf8b-0e6b76190a94 ==============================
[0m02:31:25.203033 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:31:25.203897 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:31:25.204210 [debug] [MainThread]: Tracking: tracking
[0m02:31:25.209277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1437f60790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1437f606d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1437f60a30>]}
[0m02:31:25.269387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:31:25.269930 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/sources.yml
[0m02:31:25.321076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1437e2cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1437de58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1437de5340>]}


============================== 2022-08-07 02:32:06.791114 | 6f2323a5-f934-441c-ba34-3bd68816138d ==============================
[0m02:32:06.791149 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:32:06.792012 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:32:06.792325 [debug] [MainThread]: Tracking: tracking
[0m02:32:06.797504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54920790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d549206d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54920a30>]}
[0m02:32:06.854361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:32:06.854855 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/sources.yml
[0m02:32:06.904098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54772fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d547aeeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d547ae670>]}


============================== 2022-08-07 02:33:05.525417 | 88cfba73-853f-4436-b765-ad024456ecca ==============================
[0m02:33:05.525448 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:33:05.526381 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:33:05.526724 [debug] [MainThread]: Tracking: tracking
[0m02:33:05.545384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e4be0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e4be06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e4be0a30>]}
[0m02:33:05.629299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:33:05.629892 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/sources.yml
[0m02:33:05.746743 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_zar.example

[0m02:33:05.763100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88cfba73-853f-4436-b765-ad024456ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e49e60d0>]}
[0m02:33:05.775684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88cfba73-853f-4436-b765-ad024456ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e4a85f10>]}
[0m02:33:05.776211 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m02:33:05.777915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88cfba73-853f-4436-b765-ad024456ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e4a85f70>]}
[0m02:33:05.780279 [info ] [MainThread]: 
[0m02:33:05.781170 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:33:05.786172 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m02:33:05.786600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:33:08.610169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88cfba73-853f-4436-b765-ad024456ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e4b0a400>]}
[0m02:33:08.611035 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m02:33:08.611445 [info ] [MainThread]: 
[0m02:33:08.617334 [debug] [Thread-1  ]: Began running node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m02:33:08.617530 [debug] [Thread-2  ]: Began running node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m02:33:08.618541 [info ] [Thread-2  ]: 2 of 4 START test source_not_null_coffee_shop_zar_customers_email .............. [RUN]
[0m02:33:08.619214 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2"
[0m02:33:08.618260 [info ] [Thread-1  ]: 1 of 4 START test source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming  [RUN]
[0m02:33:08.617769 [debug] [Thread-3  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m02:33:08.619965 [info ] [Thread-3  ]: 3 of 4 START test source_unique_coffee_shop_zar_customers_id ................... [RUN]
[0m02:33:08.619482 [debug] [Thread-2  ]: Began compiling node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m02:33:08.617980 [debug] [Thread-4  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m02:33:08.622823 [info ] [Thread-4  ]: 4 of 4 START test source_unique_coffee_shop_zar_orders_id ...................... [RUN]
[0m02:33:08.622355 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915"
[0m02:33:08.624232 [debug] [Thread-3  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m02:33:08.623354 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1"
[0m02:33:08.624680 [debug] [Thread-4  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m02:33:08.624472 [debug] [Thread-3  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m02:33:08.622592 [debug] [Thread-2  ]: Compiling test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m02:33:08.624860 [debug] [Thread-4  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m02:33:08.621370 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723"
[0m02:33:08.633763 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915"
[0m02:33:08.643223 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2"
[0m02:33:08.647239 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1"
[0m02:33:08.647515 [debug] [Thread-1  ]: Began compiling node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m02:33:08.648219 [debug] [Thread-1  ]: Compiling test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m02:33:08.658314 [debug] [Thread-4  ]: finished collecting timing info
[0m02:33:08.669516 [debug] [Thread-2  ]: finished collecting timing info
[0m02:33:08.677259 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723"
[0m02:33:08.677607 [debug] [Thread-4  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m02:33:08.677802 [debug] [Thread-3  ]: finished collecting timing info
[0m02:33:08.695119 [debug] [Thread-3  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m02:33:08.678050 [debug] [Thread-2  ]: Began executing node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m02:33:08.695465 [debug] [Thread-1  ]: finished collecting timing info
[0m02:33:08.701333 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915"
[0m02:33:08.702732 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1"
[0m02:33:08.704644 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2"
[0m02:33:08.704929 [debug] [Thread-1  ]: Began executing node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m02:33:08.708217 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723"
[0m02:33:08.706108 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:33:08.705780 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:33:08.708533 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:33:08.709790 [debug] [Thread-2  ]: On test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `analytics-engineers-club`.`coffee_shop`.`customers`
where email is null



      
    ) dbt_internal_test
[0m02:33:08.709046 [debug] [Thread-3  ]: On test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m02:33:08.709573 [debug] [Thread-4  ]: On test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`orders`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m02:33:08.709377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:33:08.715151 [debug] [Thread-1  ]: On test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by state

)

select *
from all_values
where value_field not in (
    'Alabama','Alaska','Arizona','Arkansas','California','Colorado','Connecticut','Delaware','Florida','Georgia','Hawaii','Idaho','Illinois','Indiana','Iowa','Kansas','Kentucky','Louisiana','Maine','Maryland','Massachusetts','Michigan','Minnesota','Mississippi','Missouri','Montana','Nebraska','Nevada','New Hampshire','New Jersey','New Mexico','New York','North Carolina','North Dakota','Ohio','Oklahoma','Oregon','Pennsylvania','Rhode Island','South Carolina','South Dakota','Tennessee','Texas','Utah','Vermont','Virginia','Washington','West Virginia','Wisconsin','Wyoming'
)



      
    ) dbt_internal_test
[0m02:33:10.263282 [debug] [Thread-2  ]: finished collecting timing info
[0m02:33:10.264255 [info ] [Thread-2  ]: 2 of 4 PASS source_not_null_coffee_shop_zar_customers_email .................... [[32mPASS[0m in 1.65s]
[0m02:33:10.265208 [debug] [Thread-2  ]: Finished running node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m02:33:10.380550 [debug] [Thread-1  ]: finished collecting timing info
[0m02:33:10.381094 [info ] [Thread-1  ]: 1 of 4 PASS source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming  [[32mPASS[0m in 1.76s]
[0m02:33:10.381666 [debug] [Thread-1  ]: Finished running node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m02:33:10.656658 [debug] [Thread-4  ]: finished collecting timing info
[0m02:33:10.657265 [info ] [Thread-4  ]: 4 of 4 PASS source_unique_coffee_shop_zar_orders_id ............................ [[32mPASS[0m in 2.03s]
[0m02:33:10.657849 [debug] [Thread-4  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m02:33:10.772807 [debug] [Thread-3  ]: finished collecting timing info
[0m02:33:10.773380 [info ] [Thread-3  ]: 3 of 4 PASS source_unique_coffee_shop_zar_customers_id ......................... [[32mPASS[0m in 2.15s]
[0m02:33:10.774282 [debug] [Thread-3  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m02:33:10.776568 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:33:10.777010 [info ] [MainThread]: 
[0m02:33:10.777368 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m02:33:10.777966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:33:10.778338 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723' was properly closed.
[0m02:33:10.778646 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2' was properly closed.
[0m02:33:10.779262 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915' was properly closed.
[0m02:33:10.779515 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1' was properly closed.
[0m02:33:10.786305 [info ] [MainThread]: 
[0m02:33:10.786667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:33:10.787169 [info ] [MainThread]: 
[0m02:33:10.787589 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:33:10.788165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e40b4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e4bb12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e4931f40>]}


============================== 2022-08-07 03:06:56.027069 | 7c7103fc-0908-4a81-b742-a5abe87dc5d4 ==============================
[0m03:06:56.027099 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:06:56.036128 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m03:06:56.036499 [debug] [MainThread]: Tracking: tracking
[0m03:06:56.042079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936b909880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936b909310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936b909850>]}
[0m03:06:56.172087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:06:56.172718 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop_zar.customers
[0m03:06:56.172959 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop_zar.orders
[0m03:06:56.173182 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop_zar://models/sources.yml
[0m03:06:56.254660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936b7018b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936b7019d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f936b701c10>]}


============================== 2022-08-07 03:07:31.678120 | 3a5dc787-30ff-46ad-a38e-05182d0bee8d ==============================
[0m03:07:31.678151 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:07:31.678994 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m03:07:31.679292 [debug] [MainThread]: Tracking: tracking
[0m03:07:31.684288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba081dbb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba081dba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba081dbb20>]}
[0m03:07:31.718942 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:07:31.719672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a5dc787-30ff-46ad-a38e-05182d0bee8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba081b43d0>]}
[0m03:07:31.744310 [debug] [MainThread]: Parsing macros/etc.sql
[0m03:07:31.747231 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:07:31.771753 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:07:31.781961 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:07:31.786744 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:07:31.787643 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:07:31.788420 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:07:31.789445 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:07:31.790645 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:07:31.791700 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:07:31.792867 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:07:31.793610 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:07:31.795715 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:07:31.797312 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:07:31.798231 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:07:31.800203 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:07:31.801084 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:07:31.801964 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m03:07:31.806260 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m03:07:31.809207 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m03:07:31.816809 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m03:07:31.821116 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m03:07:31.846189 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m03:07:31.851273 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:07:31.852919 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:07:31.854268 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:07:31.855571 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:07:31.857967 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:07:31.862886 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:07:31.886533 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:07:31.903866 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:07:31.929578 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:07:31.939585 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:07:31.957670 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:07:31.962707 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:07:31.965970 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:07:31.967356 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:07:31.968528 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:07:31.969617 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:07:31.970965 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:07:31.976659 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:07:31.977589 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:07:31.978892 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:07:31.980245 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:07:31.981395 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:07:31.982512 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:07:31.983713 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:07:31.984642 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:07:31.986854 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:07:31.988756 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:07:31.991254 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:07:31.992473 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:07:31.993489 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:07:31.994804 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:07:31.995837 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:07:31.997055 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:07:31.998207 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:07:32.006707 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:07:32.011678 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:07:32.014092 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:07:32.017975 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:07:32.023667 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:07:32.026815 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:07:32.042734 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:07:32.047424 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:07:32.062577 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:07:32.064163 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:07:32.073605 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:07:32.075028 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:07:32.080462 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:07:32.084308 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:07:32.086822 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:07:32.091352 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:07:32.093214 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:07:32.095069 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:07:32.112717 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:07:32.119671 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:07:32.132036 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:07:32.133879 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:07:32.145366 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:07:32.162175 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:07:32.163786 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:07:32.165430 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:07:32.168102 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:07:32.434729 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m03:07:32.447176 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m03:07:32.528688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba07c28700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba07c28c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba07c28f10>]}


============================== 2022-08-07 03:09:01.503030 | 6121046f-4837-4475-991d-b8e530d2b826 ==============================
[0m03:09:01.503059 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:09:01.503911 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m03:09:01.504213 [debug] [MainThread]: Tracking: tracking
[0m03:09:01.509589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4e39b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4e39b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4e39b0d0>]}
[0m03:09:01.568351 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:09:01.569360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6121046f-4837-4475-991d-b8e530d2b826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4ff02af0>]}
[0m03:09:01.593653 [debug] [MainThread]: Parsing macros/etc.sql
[0m03:09:01.597181 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:09:01.623562 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:09:01.630441 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:09:01.634501 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:09:01.635289 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:09:01.635970 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:09:01.636934 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:01.638086 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:09:01.639069 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:09:01.640286 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:09:01.641027 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:01.644080 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:01.645748 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:09:01.646690 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:01.648685 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:09:01.649604 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:09:01.650539 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m03:09:01.654167 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m03:09:01.655903 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m03:09:01.660574 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m03:09:01.663423 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m03:09:01.679385 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m03:09:01.683073 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:09:01.684105 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:09:01.684916 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:09:01.685818 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:09:01.687254 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:09:01.689985 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:09:01.705883 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:09:01.714077 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:09:01.728278 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:09:01.732786 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:09:01.742456 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:09:01.745409 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:09:01.747585 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:09:01.748657 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:09:01.749798 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:01.750806 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:09:01.752118 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:09:01.757769 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:09:01.758694 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:09:01.759983 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:01.761370 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:09:01.762507 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:09:01.763654 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:09:01.764861 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:09:01.765759 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:01.767841 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:01.769702 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:01.772246 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:09:01.773459 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:09:01.774485 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:01.775861 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:09:01.776946 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:09:01.778098 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:09:01.779263 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:09:01.787677 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:09:01.792085 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:09:01.794447 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:09:01.798312 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:09:01.803923 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:09:01.806828 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:09:01.823280 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:09:01.827784 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:09:01.842872 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:09:01.844467 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:09:01.853775 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:09:01.855191 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:09:01.860683 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:09:01.864045 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:09:01.866427 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:09:01.870924 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:09:01.872784 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:09:01.874635 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:09:01.893331 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:09:01.900586 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:09:01.912987 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:09:01.914700 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:09:01.930104 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:09:01.946810 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:09:01.948352 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:09:01.949976 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:09:01.952451 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:09:02.266260 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m03:09:02.285613 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m03:09:02.430638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4de0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4de0b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4de0b820>]}


============================== 2022-08-07 03:09:22.550044 | 39a93576-c4e7-4eec-b114-d71e385ec9b8 ==============================
[0m03:09:22.550077 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:09:22.551015 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m03:09:22.551342 [debug] [MainThread]: Tracking: tracking
[0m03:09:22.556571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4fa0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4fa05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4fa0910>]}
[0m03:09:22.624085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m03:09:22.624967 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/docs/customers.md
[0m03:09:22.625742 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop_zar.customers
[0m03:09:22.626070 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop_zar.orders
[0m03:09:22.626459 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop_zar://models/sources.yml
[0m03:09:22.764637 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_zar.example

[0m03:09:22.771905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39a93576-c4e7-4eec-b114-d71e385ec9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4da60d0>]}
[0m03:09:22.779071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39a93576-c4e7-4eec-b114-d71e385ec9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4f77430>]}
[0m03:09:22.779485 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m03:09:22.779846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a93576-c4e7-4eec-b114-d71e385ec9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4f777f0>]}
[0m03:09:22.782093 [info ] [MainThread]: 
[0m03:09:22.783127 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:09:22.784037 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m03:09:22.785114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:25.622348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a93576-c4e7-4eec-b114-d71e385ec9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4f82670>]}
[0m03:09:25.623233 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:09:25.623668 [info ] [MainThread]: 
[0m03:09:25.636130 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m03:09:25.636438 [debug] [Thread-2  ]: Began running node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:09:25.636663 [debug] [Thread-3  ]: Began running node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:09:25.638669 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2"
[0m03:09:25.637515 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m03:09:25.637739 [debug] [Thread-5  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:09:25.638247 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723"
[0m03:09:25.638881 [debug] [Thread-3  ]: Began compiling node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:09:25.639998 [debug] [Thread-3  ]: Compiling test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:09:25.639127 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m03:09:25.639514 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1"
[0m03:09:25.639739 [debug] [Thread-2  ]: Began compiling node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:09:25.652597 [debug] [Thread-2  ]: Compiling test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:09:25.651716 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2"
[0m03:09:25.652051 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m03:09:25.652335 [debug] [Thread-5  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:09:25.637025 [debug] [Thread-4  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:09:25.683463 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915"
[0m03:09:25.682000 [debug] [Thread-5  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:09:25.680311 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m03:09:25.686238 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723"
[0m03:09:25.686480 [debug] [Thread-4  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:09:25.695946 [debug] [Thread-4  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:09:25.695259 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1"
[0m03:09:25.686676 [debug] [Thread-3  ]: finished collecting timing info
[0m03:09:25.701414 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915"
[0m03:09:25.701608 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:25.703033 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m03:09:25.703285 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:25.703913 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m03:09:25.702351 [debug] [Thread-3  ]: Began executing node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:09:25.701977 [debug] [Thread-2  ]: finished collecting timing info
[0m03:09:25.705160 [debug] [Thread-2  ]: Began executing node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:09:25.704192 [debug] [Thread-4  ]: finished collecting timing info
[0m03:09:25.704725 [debug] [Thread-7  ]: Began running node model.coffee_shop_zar.monthly_users
[0m03:09:25.704952 [debug] [Thread-3  ]: finished collecting timing info
[0m03:09:25.705358 [debug] [Thread-2  ]: finished collecting timing info
[0m03:09:25.706972 [debug] [Thread-2  ]: Finished running node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:09:25.702693 [debug] [Thread-5  ]: finished collecting timing info
[0m03:09:25.705987 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.coffee_shop_zar.monthly_users"
[0m03:09:25.707601 [debug] [Thread-7  ]: Began compiling node model.coffee_shop_zar.monthly_users
[0m03:09:25.707777 [debug] [Thread-7  ]: Compiling model.coffee_shop_zar.monthly_users
[0m03:09:25.707370 [debug] [Thread-5  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:09:25.710763 [debug] [Thread-7  ]: Writing injected SQL for node "model.coffee_shop_zar.monthly_users"
[0m03:09:25.705586 [debug] [Thread-4  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:09:25.706501 [debug] [Thread-3  ]: Finished running node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:09:25.711044 [debug] [Thread-5  ]: finished collecting timing info
[0m03:09:25.711464 [debug] [Thread-4  ]: finished collecting timing info
[0m03:09:25.711938 [debug] [Thread-7  ]: finished collecting timing info
[0m03:09:25.713148 [debug] [Thread-7  ]: Began executing node model.coffee_shop_zar.monthly_users
[0m03:09:25.712918 [debug] [Thread-4  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:09:25.713341 [debug] [Thread-7  ]: finished collecting timing info
[0m03:09:25.712433 [debug] [Thread-5  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:09:25.713987 [debug] [Thread-7  ]: Finished running node model.coffee_shop_zar.monthly_users
[0m03:09:25.715508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:25.715710 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customers' was properly closed.
[0m03:09:25.715869 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723' was properly closed.
[0m03:09:25.716024 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2' was properly closed.
[0m03:09:25.716177 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1' was properly closed.
[0m03:09:25.716316 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915' was properly closed.
[0m03:09:25.716514 [debug] [MainThread]: Connection 'model.coffee_shop_zar.monthly_users' was properly closed.
[0m03:09:25.723585 [info ] [MainThread]: Done.
[0m03:09:25.752976 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m03:09:25.753305 [info ] [MainThread]: Building catalog
[0m03:09:25.754345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:26.187471 [debug] [ThreadPool]: Acquiring new bigquery connection "aec-students.information_schema"
[0m03:09:26.198865 [debug] [ThreadPool]: Acquiring new bigquery connection "analytics-engineers-club.information_schema"
[0m03:09:26.227132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:26.230832 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_lauren`.__TABLES__
        where (upper(dataset_id) = upper('dbt_lauren'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_lauren`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_lauren`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m03:09:26.230312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:26.234124 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m03:09:29.035136 [info ] [MainThread]: Catalog written to /workspaces/ae-club-lauren/coffee_shop_zar/target/catalog.json
[0m03:09:29.035803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe8cd5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4dc35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe4d14190>]}
[0m03:09:29.484880 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m03:09:29.485463 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m03:09:29.485682 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.


============================== 2022-08-07 03:12:17.342858 | 1b67d631-27ea-4050-b02e-1d77a1e481c0 ==============================
[0m03:12:17.342888 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:12:17.343751 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m03:12:17.344047 [debug] [MainThread]: Tracking: tracking
[0m03:12:17.348926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6810360760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6810360640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6810360a00>]}
[0m03:12:17.354120 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m03:12:17.355470 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m03:12:17.357506 [info ] [MainThread]: 
[0m03:12:17.359284 [info ] [MainThread]: 
[0m03:12:17.361274 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-08-07 03:24:35.849183 | 303b6cc1-30d4-4720-9f44-e1b267def8a6 ==============================
[0m03:24:35.849244 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:24:35.859487 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m03:24:35.862123 [debug] [MainThread]: Tracking: tracking
[0m03:24:35.896195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc9709d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc9709df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc9709ddc0>]}
[0m03:24:35.970326 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:24:35.972650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '303b6cc1-30d4-4720-9f44-e1b267def8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc98c028e0>]}
[0m03:24:36.195018 [debug] [MainThread]: Parsing macros/etc.sql
[0m03:24:36.200087 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:24:36.282833 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:24:36.315617 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:24:36.330655 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:24:36.331799 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:24:36.332650 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:24:36.333652 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:24:36.334831 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:24:36.335890 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:24:36.340423 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:24:36.342241 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:24:36.349476 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:24:36.356762 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:24:36.358006 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:24:36.362992 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:24:36.369523 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:24:36.370530 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m03:24:36.379278 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m03:24:36.388210 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m03:24:36.402355 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m03:24:36.448017 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m03:24:36.534408 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m03:24:36.540271 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:24:36.543193 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:24:36.544466 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:24:36.545936 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:24:36.548720 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:24:36.554987 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:24:36.581104 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:24:36.595404 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:24:36.640699 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:24:36.653612 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:24:36.681221 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:24:36.686381 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:24:36.689954 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:24:36.691602 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:24:36.693354 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:24:36.694821 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:24:36.703330 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:24:36.717107 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:24:36.719813 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:24:36.723142 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:24:36.726620 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:24:36.729359 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:24:36.732386 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:24:36.735356 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:24:36.737463 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:24:36.745673 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:24:36.751668 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:24:36.759478 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:24:36.763553 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:24:36.765758 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:24:36.767743 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:24:36.769194 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:24:36.770906 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:24:36.772617 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:24:36.785688 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:24:36.793202 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:24:36.797694 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:24:36.815892 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:24:36.839651 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:24:36.844669 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:24:36.879767 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:24:36.892955 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:24:36.923532 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:24:36.926320 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:24:36.945429 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:24:36.948038 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:24:36.959550 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:24:36.966490 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:24:36.971429 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:24:36.980460 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:24:36.983921 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:24:36.987503 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:24:37.019918 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:24:37.035212 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:24:37.060779 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:24:37.064101 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:24:37.087634 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:24:37.120386 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:24:37.123507 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:24:37.126687 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:24:37.131480 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:24:37.714055 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m03:24:37.736402 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m03:24:38.225309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '303b6cc1-30d4-4720-9f44-e1b267def8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc96ff3040>]}
[0m03:24:38.237424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '303b6cc1-30d4-4720-9f44-e1b267def8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc96ff34c0>]}
[0m03:24:38.249166 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m03:24:38.249608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303b6cc1-30d4-4720-9f44-e1b267def8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc97066700>]}
[0m03:24:38.251361 [info ] [MainThread]: 
[0m03:24:38.252718 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:24:38.254566 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m03:24:38.255042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:43.581939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303b6cc1-30d4-4720-9f44-e1b267def8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc96f42b50>]}
[0m03:24:43.582746 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:24:43.583154 [info ] [MainThread]: 
[0m03:24:43.598103 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m03:24:43.598331 [debug] [Thread-2  ]: Began running node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:24:43.598528 [debug] [Thread-3  ]: Began running node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:24:43.598716 [debug] [Thread-4  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:24:43.600735 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915"
[0m03:24:43.599308 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m03:24:43.599810 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723"
[0m03:24:43.600314 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2"
[0m03:24:43.600941 [debug] [Thread-4  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:24:43.601832 [debug] [Thread-4  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:24:43.601152 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m03:24:43.601399 [debug] [Thread-2  ]: Began compiling node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:24:43.601590 [debug] [Thread-3  ]: Began compiling node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:24:43.611300 [debug] [Thread-3  ]: Compiling test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:24:43.610550 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915"
[0m03:24:43.610829 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m03:24:43.611076 [debug] [Thread-2  ]: Compiling test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:24:43.598863 [debug] [Thread-5  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:24:43.620961 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2"
[0m03:24:43.624001 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m03:24:43.634709 [debug] [Thread-4  ]: finished collecting timing info
[0m03:24:43.648079 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723"
[0m03:24:43.648531 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1"
[0m03:24:43.650089 [debug] [Thread-5  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:24:43.649537 [debug] [Thread-3  ]: finished collecting timing info
[0m03:24:43.651910 [debug] [Thread-3  ]: Began executing node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:24:43.652205 [debug] [Thread-3  ]: finished collecting timing info
[0m03:24:43.650431 [debug] [Thread-5  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:24:43.649693 [debug] [Thread-1  ]: finished collecting timing info
[0m03:24:43.657720 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m03:24:43.652476 [debug] [Thread-2  ]: finished collecting timing info
[0m03:24:43.652984 [debug] [Thread-3  ]: Finished running node test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2
[0m03:24:43.657432 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1"
[0m03:24:43.657929 [debug] [Thread-1  ]: finished collecting timing info
[0m03:24:43.649173 [debug] [Thread-4  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:24:43.658171 [debug] [Thread-2  ]: Began executing node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:24:43.659150 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m03:24:43.659446 [debug] [Thread-5  ]: finished collecting timing info
[0m03:24:43.659629 [debug] [Thread-4  ]: finished collecting timing info
[0m03:24:43.659867 [debug] [Thread-2  ]: finished collecting timing info
[0m03:24:43.660373 [debug] [Thread-7  ]: Began running node model.coffee_shop_zar.monthly_users
[0m03:24:43.661645 [debug] [Thread-5  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:24:43.662163 [debug] [Thread-4  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915
[0m03:24:43.662678 [debug] [Thread-2  ]: Finished running node test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723
[0m03:24:43.663087 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.coffee_shop_zar.monthly_users"
[0m03:24:43.663879 [debug] [Thread-7  ]: Began compiling node model.coffee_shop_zar.monthly_users
[0m03:24:43.664056 [debug] [Thread-7  ]: Compiling model.coffee_shop_zar.monthly_users
[0m03:24:43.663347 [debug] [Thread-5  ]: finished collecting timing info
[0m03:24:43.667550 [debug] [Thread-7  ]: Writing injected SQL for node "model.coffee_shop_zar.monthly_users"
[0m03:24:43.668094 [debug] [Thread-5  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1
[0m03:24:43.668696 [debug] [Thread-7  ]: finished collecting timing info
[0m03:24:43.668897 [debug] [Thread-7  ]: Began executing node model.coffee_shop_zar.monthly_users
[0m03:24:43.669077 [debug] [Thread-7  ]: finished collecting timing info
[0m03:24:43.670290 [debug] [Thread-7  ]: Finished running node model.coffee_shop_zar.monthly_users
[0m03:24:43.671690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:24:43.671885 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customers' was properly closed.
[0m03:24:43.672040 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_accepted_values_coffee_shop_zar_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.64e58e0723' was properly closed.
[0m03:24:43.672191 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_not_null_coffee_shop_zar_customers_email.877ce4a1c2' was properly closed.
[0m03:24:43.672328 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_zar_customers_id.ad4c926915' was properly closed.
[0m03:24:43.672505 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_zar_orders_id.a70f58bfd1' was properly closed.
[0m03:24:43.672643 [debug] [MainThread]: Connection 'model.coffee_shop_zar.monthly_users' was properly closed.
[0m03:24:43.679524 [info ] [MainThread]: Done.
[0m03:24:43.702952 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m03:24:43.703373 [info ] [MainThread]: Building catalog
[0m03:24:43.704563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:24:44.150529 [debug] [ThreadPool]: Acquiring new bigquery connection "aec-students.information_schema"
[0m03:24:44.165842 [debug] [ThreadPool]: Acquiring new bigquery connection "analytics-engineers-club.information_schema"
[0m03:24:44.175156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:44.178621 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_lauren`.__TABLES__
        where (upper(dataset_id) = upper('dbt_lauren'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_lauren`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_lauren`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m03:24:44.178151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:44.181735 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m03:24:46.967270 [info ] [MainThread]: Catalog written to /workspaces/ae-club-lauren/coffee_shop_zar/target/catalog.json
[0m03:24:46.967951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc96fda970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc96fcb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc96fcb400>]}
[0m03:24:47.454158 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m03:24:47.454684 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m03:24:47.454899 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.


============================== 2022-08-07 03:24:54.349176 | dc66c67d-d5dd-4c86-b7e7-bbb1d97592d0 ==============================
[0m03:24:54.349207 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:24:54.350181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m03:24:54.350512 [debug] [MainThread]: Tracking: tracking
[0m03:24:54.356476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e5b9d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e5b9df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e5b9d670>]}
[0m03:24:54.360962 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m03:24:54.362071 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m03:24:54.362959 [info ] [MainThread]: 
[0m03:24:54.364677 [info ] [MainThread]: 
[0m03:24:54.366889 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-08-07 03:30:12.898146 | a98a0b12-8c54-4f7e-906c-aca11425cd04 ==============================
[0m03:30:12.898184 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:30:12.899113 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:30:12.899749 [debug] [MainThread]: Tracking: tracking
[0m03:30:12.906298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e99f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e99f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e99fa30>]}
[0m03:30:12.966012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:30:12.966637 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/docs/overview.md
[0m03:30:12.966999 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/customers.sql
[0m03:30:12.980489 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m03:30:12.993785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e802ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e3b33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e3b35e0>]}


============================== 2022-08-07 03:31:13.727609 | 919a2af4-95bb-4dfc-9390-8ff4893cb333 ==============================
[0m03:31:13.727641 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:31:13.728600 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:31:13.728931 [debug] [MainThread]: Tracking: tracking
[0m03:31:13.734246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff09c371e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff09c371640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff09c3716d0>]}
[0m03:31:13.798752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:31:13.799630 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/customers.sql
[0m03:31:13.800238 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/docs/overview.md
[0m03:31:13.813819 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m03:31:13.827029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff09c203040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff09bdb4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff09bdb4cd0>]}


============================== 2022-08-07 03:32:54.112705 | ee43260a-75ed-4b26-9fd2-459df32bfdcf ==============================
[0m03:32:54.112740 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:32:54.115181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:32:54.115648 [debug] [MainThread]: Tracking: tracking
[0m03:32:54.123476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e552e45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e552e4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e552e4c40>]}
[0m03:32:54.181863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:32:54.182550 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop_zar.customers
[0m03:32:54.182822 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop_zar.orders
[0m03:32:54.183071 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop_zar://models/sources.yml
[0m03:32:54.183434 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/docs/overview.md
[0m03:32:54.183742 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/customers.sql
[0m03:32:54.197091 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m03:32:54.291270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee43260a-75ed-4b26-9fd2-459df32bfdcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e51b1d0d0>]}
[0m03:32:54.298272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee43260a-75ed-4b26-9fd2-459df32bfdcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e52005d90>]}
[0m03:32:54.298696 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m03:32:54.299075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee43260a-75ed-4b26-9fd2-459df32bfdcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e52005fa0>]}
[0m03:32:54.301317 [info ] [MainThread]: 
[0m03:32:54.302298 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:32:54.303335 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m03:32:54.303900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:32:55.533851 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m03:32:55.534385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:55.775529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee43260a-75ed-4b26-9fd2-459df32bfdcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e51fc2c70>]}
[0m03:32:55.776312 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:32:55.776759 [info ] [MainThread]: 
[0m03:32:55.782987 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m03:32:55.783395 [info ] [Thread-1  ]: 1 of 2 START table model dbt_lauren.customers .................................. [RUN]
[0m03:32:55.784303 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m03:32:55.784573 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m03:32:55.784832 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m03:32:55.789979 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m03:32:55.790585 [debug] [Thread-1  ]: finished collecting timing info
[0m03:32:55.790838 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m03:32:55.813342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:32:56.091990 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customers"
[0m03:32:56.096396 [debug] [Thread-1  ]: On model.coffee_shop_zar.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customers"} */


  create or replace table `aec-students`.`dbt_lauren`.`customers`
  
  
  OPTIONS()
  as (
    


/*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club`.`coffee_shop`.`customers`
    ),

    orders as (
      select * from `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            ifnull(aggregate_orders.orders,0) as orders,
            aggregate_orders.first_order_at
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at
  );
  
[0m03:33:13.076140 [debug] [Thread-1  ]: finished collecting timing info
[0m03:33:13.076815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee43260a-75ed-4b26-9fd2-459df32bfdcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e51ac75e0>]}
[0m03:33:13.077283 [info ] [Thread-1  ]: 1 of 2 OK created table model dbt_lauren.customers ............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 17.29s]
[0m03:33:13.077853 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m03:33:13.078810 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.monthly_users
[0m03:33:13.079169 [info ] [Thread-3  ]: 2 of 2 START view model dbt_lauren.monthly_users ............................... [RUN]
[0m03:33:13.079772 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.monthly_users"
[0m03:33:13.079966 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.monthly_users
[0m03:33:13.080159 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.monthly_users
[0m03:33:13.082816 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.monthly_users"
[0m03:33:13.083458 [debug] [Thread-3  ]: finished collecting timing info
[0m03:33:13.084611 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.monthly_users
[0m03:33:13.107172 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.monthly_users"
[0m03:33:13.107864 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:33:13.108177 [debug] [Thread-3  ]: On model.coffee_shop_zar.monthly_users: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.monthly_users"} */


  create or replace view `aec-students`.`dbt_lauren`.`monthly_users`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
from `aec-students`.`dbt_lauren`.`customers`
group by 
    signup_month;


[0m03:33:13.813919 [debug] [Thread-3  ]: finished collecting timing info
[0m03:33:13.814561 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee43260a-75ed-4b26-9fd2-459df32bfdcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e51aa3e80>]}
[0m03:33:13.815032 [info ] [Thread-3  ]: 2 of 2 OK created view model dbt_lauren.monthly_users .......................... [[32mOK[0m in 0.73s]
[0m03:33:13.815588 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.monthly_users
[0m03:33:13.817235 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:33:13.817747 [info ] [MainThread]: 
[0m03:33:13.818081 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 19.52 seconds (19.52s).
[0m03:33:13.818543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:33:13.818805 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customers' was properly closed.
[0m03:33:13.819442 [debug] [MainThread]: Connection 'model.coffee_shop_zar.monthly_users' was properly closed.
[0m03:33:13.828191 [info ] [MainThread]: 
[0m03:33:13.828607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:33:13.829192 [info ] [MainThread]: 
[0m03:33:13.829694 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:33:13.830377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e51b750d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e520273d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e552e4b80>]}


============================== 2022-08-07 03:37:26.015888 | 0ae60d5f-3b47-4fd5-881c-b6784fa03eae ==============================
[0m03:37:26.015921 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:37:26.016870 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['customers'], 'which': 'test', 'rpc_method': 'test'}
[0m03:37:26.017204 [debug] [MainThread]: Tracking: tracking
[0m03:37:26.022651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86d33b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86d33190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86d33f10>]}
[0m03:37:26.082883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:37:26.083216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:37:26.090014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ae60d5f-3b47-4fd5-881c-b6784fa03eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86bd80d0>]}
[0m03:37:26.096960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ae60d5f-3b47-4fd5-881c-b6784fa03eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86c2efa0>]}
[0m03:37:26.097341 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m03:37:26.097707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ae60d5f-3b47-4fd5-881c-b6784fa03eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86cac070>]}
[0m03:37:26.099138 [info ] [MainThread]: 
[0m03:37:26.099840 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m03:37:26.106973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86c2ea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86c2ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d86c2e880>]}


============================== 2022-08-07 04:38:11.526289 | 39a1cbf1-9afb-43a1-a7de-45d072592300 ==============================
[0m04:38:11.526320 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:38:11.529611 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['product_prices'], 'which': 'test', 'rpc_method': 'test'}
[0m04:38:11.530285 [debug] [MainThread]: Tracking: tracking
[0m04:38:11.536369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adda1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adda16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adda1a30>]}
[0m04:38:11.651063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m04:38:11.651502 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://tests/assert_amount_positive.sql
[0m04:38:11.652062 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop.customers
[0m04:38:11.652274 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop.orders
[0m04:38:11.652513 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop_zar://models/sources.yml
[0m04:38:11.665875 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m04:38:11.679350 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m04:38:11.863103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39a1cbf1-9afb-43a1-a7de-45d072592300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ad7c1a30>]}
[0m04:38:11.876356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39a1cbf1-9afb-43a1-a7de-45d072592300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84add78c70>]}
[0m04:38:11.876859 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m04:38:11.877376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a1cbf1-9afb-43a1-a7de-45d072592300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adc05a90>]}
[0m04:38:11.878421 [warn ] [MainThread]: The selection criterion 'product_prices' does not match any nodes
[0m04:38:11.881077 [info ] [MainThread]: 
[0m04:38:11.882422 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:38:11.892287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adc70d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adc70d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adc70e80>]}


============================== 2022-08-07 04:38:59.132417 | 95d615d7-31f8-41d9-bfc0-45c6c154a4f4 ==============================
[0m04:38:59.132445 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:38:59.133321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['source:*'], 'which': 'test', 'rpc_method': 'test'}
[0m04:38:59.133628 [debug] [MainThread]: Tracking: tracking
[0m04:38:59.139911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ba0255b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ba025fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ba025c40>]}
[0m04:38:59.198948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:38:59.199212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:38:59.205557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95d615d7-31f8-41d9-bfc0-45c6c154a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63b6ce30d0>]}
[0m04:38:59.212702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95d615d7-31f8-41d9-bfc0-45c6c154a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63b6d9fa90>]}
[0m04:38:59.213055 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m04:38:59.213409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d615d7-31f8-41d9-bfc0-45c6c154a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63b6d9f9d0>]}
[0m04:38:59.215608 [info ] [MainThread]: 
[0m04:38:59.216373 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:38:59.217373 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m04:38:59.218298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:39:02.012414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d615d7-31f8-41d9-bfc0-45c6c154a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63b6d30850>]}
[0m04:39:02.013259 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m04:39:02.013669 [info ] [MainThread]: 
[0m04:39:02.018970 [debug] [Thread-1  ]: Began running node test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:39:02.019175 [debug] [Thread-2  ]: Began running node test.coffee_shop_zar.source_assert_amount_positive_coffee_shop_product_prices_price.34d9768822
[0m04:39:02.020659 [info ] [Thread-2  ]: 2 of 7 START test source_assert_amount_positive_coffee_shop_product_prices_price  [RUN]
[0m04:39:02.021311 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_assert_amount_positive_coffee_shop_product_prices_price.34d9768822"
[0m04:39:02.021549 [debug] [Thread-2  ]: Began compiling node test.coffee_shop_zar.source_assert_amount_positive_coffee_shop_product_prices_price.34d9768822
[0m04:39:02.021770 [debug] [Thread-2  ]: Compiling test.coffee_shop_zar.source_assert_amount_positive_coffee_shop_product_prices_price.34d9768822
[0m04:39:02.019642 [debug] [Thread-5  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:39:02.031755 [info ] [Thread-5  ]: 5 of 7 START test source_unique_coffee_shop_customers_id ....................... [RUN]
[0m04:39:02.019502 [debug] [Thread-4  ]: Began running node test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:39:02.019354 [debug] [Thread-3  ]: Began running node test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:39:02.019778 [debug] [Thread-6  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:39:02.020013 [debug] [Thread-7  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:39:02.033010 [info ] [Thread-4  ]: 4 of 7 START test source_not_null_coffee_shop_product_prices_price ............. [RUN]
[0m04:39:02.035817 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f"
[0m04:39:02.020397 [info ] [Thread-1  ]: 1 of 7 START test source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming  [RUN]
[0m04:39:02.033841 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5"
[0m04:39:02.034131 [info ] [Thread-3  ]: 3 of 7 START test source_not_null_coffee_shop_customers_email .................. [RUN]
[0m04:39:02.034373 [info ] [Thread-6  ]: 6 of 7 START test source_unique_coffee_shop_orders_id .......................... [RUN]
[0m04:39:02.035064 [info ] [Thread-7  ]: 7 of 7 START test source_unique_coffee_shop_product_prices_id .................. [RUN]
[0m04:39:02.036039 [debug] [Thread-4  ]: Began compiling node test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:39:02.038709 [debug] [Thread-4  ]: Compiling test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:39:02.036498 [debug] [Thread-5  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:39:02.032695 [debug] [Thread-2  ]: finished collecting timing info
[0m04:39:02.050781 [debug] [Thread-2  ]: Compilation Error in test source_assert_amount_positive_coffee_shop_product_prices_price (models/sources.yml)
  'test_assert_amount_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:39:02.051606 [error] [Thread-2  ]: 2 of 7 ERROR source_assert_amount_positive_coffee_shop_product_prices_price .... [[31mERROR[0m in 0.03s]
[0m04:39:02.050302 [debug] [Thread-5  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:39:02.049617 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f"
[0m04:39:02.051272 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e"
[0m04:39:02.052067 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m04:39:02.061836 [debug] [Thread-6  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:39:02.062037 [debug] [Thread-6  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:39:02.053435 [debug] [Thread-2  ]: Finished running node test.coffee_shop_zar.source_assert_amount_positive_coffee_shop_product_prices_price.34d9768822
[0m04:39:02.061106 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5"
[0m04:39:02.061559 [debug] [Thread-3  ]: Began compiling node test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:39:02.052379 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m04:39:02.050114 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af"
[0m04:39:02.067618 [debug] [Thread-1  ]: Began compiling node test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:39:02.067803 [debug] [Thread-1  ]: Compiling test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:39:02.066900 [debug] [Thread-3  ]: Compiling test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:39:02.067237 [debug] [Thread-5  ]: finished collecting timing info
[0m04:39:02.067417 [debug] [Thread-7  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:39:02.103913 [debug] [Thread-7  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:39:02.107721 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m04:39:02.087752 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e"
[0m04:39:02.093241 [debug] [Thread-5  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:39:02.103661 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af"
[0m04:39:02.065892 [debug] [Thread-6  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m04:39:02.066459 [debug] [Thread-4  ]: finished collecting timing info
[0m04:39:02.124715 [debug] [Thread-4  ]: Began executing node test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:39:02.123768 [debug] [Thread-3  ]: finished collecting timing info
[0m04:39:02.113403 [debug] [Thread-7  ]: finished collecting timing info
[0m04:39:02.125410 [debug] [Thread-1  ]: finished collecting timing info
[0m04:39:02.131231 [debug] [Thread-3  ]: Began executing node test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:39:02.135452 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e"
[0m04:39:02.135864 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:39:02.132986 [debug] [Thread-6  ]: finished collecting timing info
[0m04:39:02.133217 [debug] [Thread-7  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:39:02.133445 [debug] [Thread-1  ]: Began executing node test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:39:02.136122 [debug] [Thread-3  ]: On test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `analytics-engineers-club`.`coffee_shop`.`customers`
where email is null



      
    ) dbt_internal_test
[0m04:39:02.131544 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f"
[0m04:39:02.132801 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5"
[0m04:39:02.137183 [debug] [Thread-6  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:39:02.145817 [debug] [Thread-6  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m04:39:02.141231 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af"
[0m04:39:02.143530 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:39:02.139229 [debug] [Thread-7  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m04:39:02.146521 [debug] [Thread-4  ]: On test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from `analytics-engineers-club`.`coffee_shop`.`product_prices`
where price is null



      
    ) dbt_internal_test
[0m04:39:02.146829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:39:02.147009 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m04:39:02.147323 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m04:39:02.155264 [debug] [Thread-5  ]: On test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:39:02.149342 [debug] [Thread-1  ]: On test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by state

)

select *
from all_values
where value_field not in (
    'Alabama','Alaska','Arizona','Arkansas','California','Colorado','Connecticut','Delaware','Florida','Georgia','Hawaii','Idaho','Illinois','Indiana','Iowa','Kansas','Kentucky','Louisiana','Maine','Maryland','Massachusetts','Michigan','Minnesota','Mississippi','Missouri','Montana','Nebraska','Nevada','New Hampshire','New Jersey','New Mexico','New York','North Carolina','North Dakota','Ohio','Oklahoma','Oregon','Pennsylvania','Rhode Island','South Carolina','South Dakota','Tennessee','Texas','Utah','Vermont','Virginia','Washington','West Virginia','Wisconsin','Wyoming'
)



      
    ) dbt_internal_test
[0m04:39:02.154993 [debug] [Thread-6  ]: On test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`orders`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:39:02.147682 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m04:39:02.160731 [debug] [Thread-7  ]: On test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`product_prices`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:39:03.866758 [debug] [Thread-3  ]: finished collecting timing info
[0m04:39:03.867326 [info ] [Thread-3  ]: 3 of 7 PASS source_not_null_coffee_shop_customers_email ........................ [[32mPASS[0m in 1.82s]
[0m04:39:03.867922 [debug] [Thread-3  ]: Finished running node test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:39:03.914546 [debug] [Thread-4  ]: finished collecting timing info
[0m04:39:03.915029 [info ] [Thread-4  ]: 4 of 7 PASS source_not_null_coffee_shop_product_prices_price ................... [[32mPASS[0m in 1.88s]
[0m04:39:03.915574 [debug] [Thread-4  ]: Finished running node test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:39:04.113207 [debug] [Thread-7  ]: finished collecting timing info
[0m04:39:04.113723 [info ] [Thread-7  ]: 7 of 7 PASS source_unique_coffee_shop_product_prices_id ........................ [[32mPASS[0m in 2.06s]
[0m04:39:04.114292 [debug] [Thread-7  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:39:04.227728 [debug] [Thread-1  ]: finished collecting timing info
[0m04:39:04.228210 [info ] [Thread-1  ]: 1 of 7 PASS source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming  [[32mPASS[0m in 2.18s]
[0m04:39:04.228753 [debug] [Thread-1  ]: Finished running node test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:39:04.247448 [debug] [Thread-6  ]: finished collecting timing info
[0m04:39:04.247913 [info ] [Thread-6  ]: 6 of 7 PASS source_unique_coffee_shop_orders_id ................................ [[32mPASS[0m in 2.20s]
[0m04:39:04.248452 [debug] [Thread-6  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:39:04.281657 [debug] [Thread-5  ]: finished collecting timing info
[0m04:39:04.282113 [info ] [Thread-5  ]: 5 of 7 PASS source_unique_coffee_shop_customers_id ............................. [[32mPASS[0m in 2.25s]
[0m04:39:04.282643 [debug] [Thread-5  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:39:04.284332 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:39:04.284759 [info ] [MainThread]: 
[0m04:39:04.285112 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m04:39:04.285527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:39:04.285807 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af' was properly closed.
[0m04:39:04.285996 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_assert_amount_positive_coffee_shop_product_prices_price.34d9768822' was properly closed.
[0m04:39:04.286229 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
[0m04:39:04.286409 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f' was properly closed.
[0m04:39:04.286589 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e' was properly closed.
[0m04:39:04.286757 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7' was properly closed.
[0m04:39:04.286934 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc' was properly closed.
[0m04:39:04.295572 [info ] [MainThread]: 
[0m04:39:04.295938 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:39:04.296520 [info ] [MainThread]: 
[0m04:39:04.297348 [error] [MainThread]: [33mCompilation Error in test source_assert_amount_positive_coffee_shop_product_prices_price (models/sources.yml)[0m
[0m04:39:04.297999 [error] [MainThread]:   'test_assert_amount_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:39:04.298529 [info ] [MainThread]: 
[0m04:39:04.299382 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m04:39:04.300279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63b6d30970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ba025ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63b6e38e50>]}


============================== 2022-08-07 04:44:57.151898 | 3b2a292f-38d0-4341-9dca-f2263ea12ca8 ==============================
[0m04:44:57.151909 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:44:57.152370 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m04:44:57.152647 [debug] [MainThread]: Tracking: tracking
[0m04:44:57.157543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48bcdd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48bcddc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48bcdd940>]}
[0m04:44:57.158648 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kr8kue_s'
[0m04:44:57.159194 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:44:57.409196 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:44:57.409834 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:44:57.552008 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:44:57.596676 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:44:58.162134 [info ] [MainThread]:   Installed from version 0.8.6
[0m04:44:58.162658 [info ] [MainThread]:   Up to date!
[0m04:44:58.163204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b2a292f-38d0-4341-9dca-f2263ea12ca8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48bc42820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48bc42640>]}
[0m04:44:58.163982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48bc42850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48bc42340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48bc42820>]}


============================== 2022-08-07 04:45:28.368005 | e5bfaec6-f717-4cfe-879f-8d21b18d1ec6 ==============================
[0m04:45:28.368037 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:45:28.368865 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['product_prices'], 'which': 'test', 'rpc_method': 'test'}
[0m04:45:28.369178 [debug] [MainThread]: Tracking: tracking
[0m04:45:28.374591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06428b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06428bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06428bac0>]}
[0m04:45:28.420346 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m04:45:28.421385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5bfaec6-f717-4cfe-879f-8d21b18d1ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06425c970>]}
[0m04:45:28.450379 [debug] [MainThread]: Parsing macros/etc.sql
[0m04:45:28.452971 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:45:28.476633 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:45:28.482282 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:45:28.484928 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:45:28.485498 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:45:28.485959 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:45:28.486576 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:45:28.487275 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:45:28.487918 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:45:28.488641 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:45:28.489096 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:45:28.490497 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:45:28.491575 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:45:28.492200 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:45:28.493502 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:45:28.494125 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:45:28.494736 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m04:45:28.497382 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m04:45:28.499077 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m04:45:28.503756 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m04:45:28.506609 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m04:45:28.522764 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m04:45:28.525598 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:45:28.526581 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:45:28.527361 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:45:28.528254 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:45:28.529676 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:45:28.532381 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:45:28.546383 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:45:28.553915 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:45:28.573249 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:45:28.577743 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:45:28.587311 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:45:28.590247 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:45:28.592527 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:45:28.593604 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:45:28.594828 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:45:28.595852 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:45:28.597178 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:45:28.602925 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:45:28.603873 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:45:28.605171 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:45:28.606506 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:45:28.607642 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:45:28.608752 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:45:28.609935 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:45:28.610841 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:45:28.612956 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:45:28.614822 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:45:28.617415 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:45:28.618627 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:45:28.619633 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:45:28.620968 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:45:28.621989 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:45:28.623174 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:45:28.624305 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:45:28.632646 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:45:28.637179 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:45:28.639581 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:45:28.643434 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:45:28.649067 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:45:28.651953 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:45:28.668012 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:45:28.672492 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:45:28.687562 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:45:28.689156 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:45:28.698498 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:45:28.699894 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:45:28.705302 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:45:28.708688 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:45:28.711044 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:45:28.715510 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:45:28.717543 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:45:28.719435 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:45:28.737162 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:45:28.744878 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:45:28.757765 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:45:28.759510 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:45:28.771000 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:45:28.787680 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:45:28.789238 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:45:28.790895 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:45:28.793402 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:45:28.796417 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m04:45:28.799303 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m04:45:28.800639 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m04:45:28.802172 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m04:45:28.804449 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m04:45:28.806538 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m04:45:28.809449 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m04:45:28.811755 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m04:45:28.813138 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m04:45:28.815063 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m04:45:28.817772 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m04:45:28.826704 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m04:45:28.828612 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m04:45:28.832227 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m04:45:28.834511 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m04:45:28.835995 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m04:45:28.837687 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m04:45:28.839373 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m04:45:28.841274 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:45:28.842370 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m04:45:28.844085 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m04:45:28.846242 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:45:28.852201 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m04:45:28.853564 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:45:28.854775 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:45:28.856127 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:45:28.857289 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:45:28.859191 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:45:28.862162 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:45:28.863633 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m04:45:28.865523 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:45:28.867791 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:45:28.872977 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:45:28.874121 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:45:28.880424 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:45:28.884005 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m04:45:28.886669 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m04:45:28.895386 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:45:28.897369 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:45:28.900818 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:45:28.902459 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:45:28.903467 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:45:28.913240 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m04:45:28.916214 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:45:28.917897 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:45:28.919230 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:45:28.920675 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:45:28.922183 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:45:28.924259 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:45:28.925882 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:45:28.928479 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:45:28.929793 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:45:28.931076 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:45:28.932250 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:45:28.933508 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:45:28.958648 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:45:28.962117 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:45:28.966402 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m04:45:28.969245 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:45:28.973473 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:45:28.975864 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:45:28.981912 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m04:45:28.983562 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:45:28.984992 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:45:28.996395 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m04:45:29.003416 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:45:29.007290 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:45:29.011458 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:45:29.013124 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:45:29.015024 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:45:29.022941 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:45:29.028554 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:45:29.031998 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:45:29.033825 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:45:29.037304 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:45:29.039045 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:45:29.553130 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m04:45:29.568324 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m04:45:29.684653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe063c30670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe063c307c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe063c30a00>]}


============================== 2022-08-07 04:46:14.445563 | 77e3cfe1-143b-4542-8f55-80df283809d1 ==============================
[0m04:46:14.445591 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:46:14.446526 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['product_prices'], 'which': 'test', 'rpc_method': 'test'}
[0m04:46:14.446863 [debug] [MainThread]: Tracking: tracking
[0m04:46:14.454709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9751138250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9751138a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9751138070>]}
[0m04:46:14.500466 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m04:46:14.501387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77e3cfe1-143b-4542-8f55-80df283809d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9752d02a00>]}
[0m04:46:14.528407 [debug] [MainThread]: Parsing macros/etc.sql
[0m04:46:14.531156 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:46:14.556651 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:46:14.562231 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:46:14.564895 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:46:14.565452 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:46:14.565913 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:46:14.566536 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:46:14.567260 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:46:14.567902 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:46:14.568613 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:46:14.569075 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:46:14.570486 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:46:14.571578 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:46:14.572215 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:46:14.573508 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:46:14.574137 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:46:14.574774 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m04:46:14.577390 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m04:46:14.579080 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m04:46:14.583659 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m04:46:14.586492 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m04:46:14.602476 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m04:46:14.605288 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:46:14.606302 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:46:14.607082 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:46:14.607979 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:46:14.609430 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:46:14.612138 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:46:14.625393 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:46:14.632426 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:46:14.646658 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:46:14.651363 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:46:14.660787 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:46:14.663712 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:46:14.665910 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:46:14.666972 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:46:14.668115 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:46:14.669123 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:46:14.670444 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:46:14.675952 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:46:14.676870 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:46:14.678170 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:46:14.679502 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:46:14.680617 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:46:14.681711 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:46:14.682890 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:46:14.683779 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:46:14.685860 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:46:14.687788 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:46:14.690287 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:46:14.691776 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:46:14.693489 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:46:14.695833 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:46:14.697697 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:46:14.699820 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:46:14.701918 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:46:14.717948 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:46:14.726013 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:46:14.729630 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:46:14.736720 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:46:14.748343 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:46:14.759346 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:46:14.789790 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:46:14.797786 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:46:14.827132 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:46:14.829816 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:46:14.845445 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:46:14.847921 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:46:14.857146 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:46:14.862984 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:46:14.866912 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:46:14.874633 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:46:14.877664 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:46:14.880721 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:46:14.911991 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:46:14.924491 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:46:14.947009 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:46:14.960907 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:46:14.981852 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:46:14.998384 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:46:14.999945 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:46:15.001557 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:46:15.004036 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:46:15.007084 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m04:46:15.009950 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m04:46:15.011285 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m04:46:15.012774 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m04:46:15.015072 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m04:46:15.017136 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m04:46:15.020139 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m04:46:15.022527 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m04:46:15.023839 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m04:46:15.025660 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m04:46:15.028151 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m04:46:15.036800 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m04:46:15.038721 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m04:46:15.042430 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m04:46:15.044683 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m04:46:15.046190 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m04:46:15.047867 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m04:46:15.049842 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m04:46:15.051761 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:46:15.052834 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m04:46:15.054601 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m04:46:15.056693 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:46:15.062527 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m04:46:15.063889 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:46:15.065096 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:46:15.066633 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:46:15.067771 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:46:15.069656 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:46:15.072605 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:46:15.074089 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m04:46:15.075956 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:46:15.078214 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:46:15.083361 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:46:15.084483 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:46:15.090335 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:46:15.093841 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m04:46:15.096491 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m04:46:15.105110 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:46:15.107082 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:46:15.110417 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:46:15.111981 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:46:15.112998 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:46:15.122664 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m04:46:15.125420 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:46:15.127119 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:46:15.128501 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:46:15.129991 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:46:15.131492 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:46:15.133576 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:46:15.135245 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:46:15.137855 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:46:15.139302 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:46:15.140786 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:46:15.141952 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:46:15.143225 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:46:15.167848 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:46:15.171334 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:46:15.175845 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m04:46:15.178715 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:46:15.182861 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:46:15.185212 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:46:15.191220 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m04:46:15.192842 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:46:15.194305 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:46:15.205497 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m04:46:15.212389 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:46:15.216255 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:46:15.220421 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:46:15.222103 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:46:15.223820 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:46:15.231668 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:46:15.237271 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:46:15.240751 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:46:15.242500 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:46:15.245960 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:46:15.247912 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:46:15.726147 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m04:46:15.738461 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m04:46:15.903789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77e3cfe1-143b-4542-8f55-80df283809d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9750a200d0>]}
[0m04:46:15.913965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77e3cfe1-143b-4542-8f55-80df283809d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97543b17f0>]}
[0m04:46:15.914356 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 522 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m04:46:15.914710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77e3cfe1-143b-4542-8f55-80df283809d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975111a310>]}
[0m04:46:15.915388 [warn ] [MainThread]: The selection criterion 'product_prices' does not match any nodes
[0m04:46:15.916861 [info ] [MainThread]: 
[0m04:46:15.917458 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:46:15.927457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9750a4cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9750b672b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9750a201f0>]}


============================== 2022-08-07 04:49:23.509431 | 7bd1ddb3-0d1f-4d99-88c4-ee914a125c7a ==============================
[0m04:49:23.509462 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:49:23.510403 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['source:*'], 'which': 'test', 'rpc_method': 'test'}
[0m04:49:23.510759 [debug] [MainThread]: Tracking: tracking
[0m04:49:23.519349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8c03f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8c03ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8c03f970>]}
[0m04:49:23.602786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:23.603175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:23.610073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bd1ddb3-0d1f-4d99-88c4-ee914a125c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa88bbc0d0>]}
[0m04:49:23.622620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bd1ddb3-0d1f-4d99-88c4-ee914a125c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa88d0dd00>]}
[0m04:49:23.622970 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 522 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m04:49:23.623324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd1ddb3-0d1f-4d99-88c4-ee914a125c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa88d0da90>]}
[0m04:49:23.625179 [info ] [MainThread]: 
[0m04:49:23.626036 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:49:23.627085 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m04:49:23.627958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:24.851314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd1ddb3-0d1f-4d99-88c4-ee914a125c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa88e148e0>]}
[0m04:49:24.852472 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m04:49:24.853507 [info ] [MainThread]: 
[0m04:49:24.860910 [debug] [Thread-1  ]: Began running node test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b
[0m04:49:24.862783 [info ] [Thread-1  ]: 1 of 7 START test dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0  [RUN]
[0m04:49:24.861528 [debug] [Thread-3  ]: Began running node test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:49:24.863826 [info ] [Thread-3  ]: 3 of 7 START test source_not_null_coffee_shop_customers_email .................. [RUN]
[0m04:49:24.861977 [debug] [Thread-5  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:49:24.864459 [info ] [Thread-5  ]: 5 of 7 START test source_unique_coffee_shop_customers_id ....................... [RUN]
[0m04:49:24.862533 [debug] [Thread-7  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:49:24.866144 [info ] [Thread-7  ]: 7 of 7 START test source_unique_coffee_shop_product_prices_id .................. [RUN]
[0m04:49:24.861747 [debug] [Thread-4  ]: Began running node test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:49:24.866815 [info ] [Thread-4  ]: 4 of 7 START test source_not_null_coffee_shop_product_prices_price ............. [RUN]
[0m04:49:24.861263 [debug] [Thread-2  ]: Began running node test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:49:24.867460 [info ] [Thread-2  ]: 2 of 7 START test source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming  [RUN]
[0m04:49:24.862230 [debug] [Thread-6  ]: Began running node test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:49:24.868724 [info ] [Thread-6  ]: 6 of 7 START test source_unique_coffee_shop_orders_id .......................... [RUN]
[0m04:49:24.869881 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b"
[0m04:49:24.870793 [debug] [Thread-1  ]: Began compiling node test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b
[0m04:49:24.871219 [debug] [Thread-1  ]: Compiling test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b
[0m04:49:24.882439 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e"
[0m04:49:24.882856 [debug] [Thread-3  ]: Began compiling node test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:49:24.883169 [debug] [Thread-3  ]: Compiling test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:49:24.895851 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5"
[0m04:49:24.896168 [debug] [Thread-5  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:49:24.896435 [debug] [Thread-5  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:49:24.920648 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m04:49:24.925075 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5"
[0m04:49:24.928539 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b"
[0m04:49:24.928897 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f"
[0m04:49:24.929068 [debug] [Thread-7  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:49:24.936109 [debug] [Thread-7  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:49:24.933903 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af"
[0m04:49:24.938771 [debug] [Thread-2  ]: Began compiling node test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:49:24.939055 [debug] [Thread-2  ]: Compiling test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:49:24.935798 [debug] [Thread-4  ]: Began compiling node test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:49:24.933365 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e"
[0m04:49:24.938490 [debug] [Thread-5  ]: finished collecting timing info
[0m04:49:24.934595 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m04:49:24.935611 [debug] [Thread-1  ]: finished collecting timing info
[0m04:49:24.945978 [debug] [Thread-4  ]: Compiling test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:49:24.949778 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m04:49:24.983452 [debug] [Thread-7  ]: finished collecting timing info
[0m04:49:24.977915 [debug] [Thread-5  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:49:24.978217 [debug] [Thread-3  ]: finished collecting timing info
[0m04:49:24.978394 [debug] [Thread-6  ]: Began compiling node test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:49:24.978597 [debug] [Thread-1  ]: Began executing node test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b
[0m04:49:24.983034 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f"
[0m04:49:24.983658 [debug] [Thread-7  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:49:24.977536 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af"
[0m04:49:25.002595 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5"
[0m04:49:25.002804 [debug] [Thread-3  ]: Began executing node test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:49:25.003047 [debug] [Thread-6  ]: Compiling test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:49:25.005455 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b"
[0m04:49:25.017553 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:49:25.008512 [debug] [Thread-4  ]: finished collecting timing info
[0m04:49:25.012010 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e"
[0m04:49:25.012233 [debug] [Thread-2  ]: finished collecting timing info
[0m04:49:25.012674 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m04:49:25.017122 [debug] [Thread-6  ]: Writing injected SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m04:49:25.017814 [debug] [Thread-1  ]: On test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from (select * from `analytics-engineers-club`.`coffee_shop`.`product_prices` where price > 0) dbt_subquery
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price > 0
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:49:25.008082 [debug] [Thread-7  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m04:49:25.018048 [debug] [Thread-4  ]: Began executing node test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:49:25.024290 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f"
[0m04:49:25.024918 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:49:25.019050 [debug] [Thread-5  ]: On test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:49:25.021085 [debug] [Thread-6  ]: finished collecting timing info
[0m04:49:25.018557 [debug] [Thread-2  ]: Began executing node test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:49:25.018856 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:49:25.025279 [debug] [Thread-4  ]: On test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from `analytics-engineers-club`.`coffee_shop`.`product_prices`
where price is null



      
    ) dbt_internal_test
[0m04:49:25.025455 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m04:49:25.029968 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af"
[0m04:49:25.032949 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m04:49:25.033280 [debug] [Thread-2  ]: On test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by state

)

select *
from all_values
where value_field not in (
    'Alabama','Alaska','Arizona','Arkansas','California','Colorado','Connecticut','Delaware','Florida','Georgia','Hawaii','Idaho','Illinois','Indiana','Iowa','Kansas','Kentucky','Louisiana','Maine','Maryland','Massachusetts','Michigan','Minnesota','Mississippi','Missouri','Montana','Nebraska','Nevada','New Hampshire','New Jersey','New Mexico','New York','North Carolina','North Dakota','Ohio','Oklahoma','Oregon','Pennsylvania','Rhode Island','South Carolina','South Dakota','Tennessee','Texas','Utah','Vermont','Virginia','Washington','West Virginia','Wisconsin','Wyoming'
)



      
    ) dbt_internal_test
[0m04:49:25.032490 [debug] [Thread-7  ]: On test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`product_prices`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:49:25.030372 [debug] [Thread-3  ]: On test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `analytics-engineers-club`.`coffee_shop`.`customers`
where email is null



      
    ) dbt_internal_test
[0m04:49:25.027307 [debug] [Thread-6  ]: Began executing node test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:49:25.043383 [debug] [Thread-6  ]: Writing runtime SQL for node "test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m04:49:25.048564 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m04:49:25.048941 [debug] [Thread-6  ]: On test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`orders`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:49:26.616326 [debug] [Thread-6  ]: finished collecting timing info
[0m04:49:26.616889 [info ] [Thread-6  ]: 6 of 7 PASS source_unique_coffee_shop_orders_id ................................ [[32mPASS[0m in 1.68s]
[0m04:49:26.617469 [debug] [Thread-6  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7
[0m04:49:26.702109 [debug] [Thread-3  ]: finished collecting timing info
[0m04:49:26.702582 [info ] [Thread-3  ]: 3 of 7 PASS source_not_null_coffee_shop_customers_email ........................ [[32mPASS[0m in 1.82s]
[0m04:49:26.703266 [debug] [Thread-3  ]: Finished running node test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e
[0m04:49:26.717914 [debug] [Thread-7  ]: finished collecting timing info
[0m04:49:26.718946 [info ] [Thread-7  ]: 7 of 7 PASS source_unique_coffee_shop_product_prices_id ........................ [[32mPASS[0m in 1.80s]
[0m04:49:26.719703 [debug] [Thread-7  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc
[0m04:49:26.727363 [debug] [Thread-2  ]: finished collecting timing info
[0m04:49:26.728233 [info ] [Thread-2  ]: 2 of 7 PASS source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming  [[32mPASS[0m in 1.79s]
[0m04:49:26.729635 [debug] [Thread-5  ]: finished collecting timing info
[0m04:49:26.730957 [info ] [Thread-5  ]: 5 of 7 PASS source_unique_coffee_shop_customers_id ............................. [[32mPASS[0m in 1.84s]
[0m04:49:26.731608 [debug] [Thread-5  ]: Finished running node test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5
[0m04:49:26.730382 [debug] [Thread-2  ]: Finished running node test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af
[0m04:49:26.785770 [debug] [Thread-4  ]: finished collecting timing info
[0m04:49:26.786286 [info ] [Thread-4  ]: 4 of 7 PASS source_not_null_coffee_shop_product_prices_price ................... [[32mPASS[0m in 1.86s]
[0m04:49:26.786800 [debug] [Thread-4  ]: Finished running node test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f
[0m04:49:26.790004 [debug] [Thread-1  ]: finished collecting timing info
[0m04:49:26.790816 [info ] [Thread-1  ]: 1 of 7 PASS dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0  [[32mPASS[0m in 1.92s]
[0m04:49:26.791307 [debug] [Thread-1  ]: Finished running node test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b
[0m04:49:26.792925 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:49:26.793346 [info ] [MainThread]: 
[0m04:49:26.793767 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m04:49:26.794897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:26.795394 [debug] [MainThread]: Connection 'test.coffee_shop_zar.dbt_utils_source_accepted_range_coffee_shop_product_prices_price__False__0.7adeb92f6b' was properly closed.
[0m04:49:26.795832 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_not_null_coffee_shop_customers_email.231a9c660e' was properly closed.
[0m04:49:26.796046 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
[0m04:49:26.796224 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_product_prices_id.223d586afc' was properly closed.
[0m04:49:26.796854 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_not_null_coffee_shop_product_prices_price.f9d290558f' was properly closed.
[0m04:49:26.797185 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_accepted_values_coffee_shop_orders_state__Alabama__Alaska__Arizona__Arkansas__California__Colorado__Connecticut__Delaware__Florida__Georgia__Hawaii__Idaho__Illinois__Indiana__Iowa__Kansas__Kentucky__Louisiana__Maine__Maryland__Massachusetts__Michigan__Minnesota__Mississippi__Missouri__Montana__Nebraska__Nevada__New_Hampshire__New_Jersey__New_Mexico__New_York__North_Carolina__North_Dakota__Ohio__Oklahoma__Oregon__Pennsylvania__Rhode_Island__South_Carolina__South_Dakota__Tennessee__Texas__Utah__Vermont__Virginia__Washington__West_Virginia__Wisconsin__Wyoming.e8227dc2af' was properly closed.
[0m04:49:26.797425 [debug] [MainThread]: Connection 'test.coffee_shop_zar.source_unique_coffee_shop_orders_id.76bb24edf7' was properly closed.
[0m04:49:26.820038 [info ] [MainThread]: 
[0m04:49:26.820897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:49:26.821903 [info ] [MainThread]: 
[0m04:49:26.824060 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m04:49:26.825401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8c03f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa88c1fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa88e35730>]}


============================== 2022-08-07 17:48:57.489667 | 4f8ff01c-ee8a-4ad4-b258-fadb97f7586b ==============================
[0m17:48:57.489702 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:48:57.503465 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customers'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:48:57.504072 [debug] [MainThread]: Tracking: tracking
[0m17:48:57.511222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe2f89a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe2f80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe2f8100>]}
[0m17:48:57.734286 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m17:48:57.734827 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/stg_customers.sql
[0m17:48:57.735121 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/customers.sql
[0m17:48:57.735960 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/customers.sql
[0m17:48:57.751196 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m17:48:57.765277 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers.sql
[0m17:48:57.768297 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m17:48:57.779565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_zar.customers

[0m17:48:57.787916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f8ff01c-ee8a-4ad4-b258-fadb97f7586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe0cefa0>]}
[0m17:48:57.799629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f8ff01c-ee8a-4ad4-b258-fadb97f7586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ffec29d0>]}
[0m17:48:57.800069 [info ] [MainThread]: Found 3 models, 8 tests, 0 snapshots, 0 analyses, 522 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:48:57.800421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8ff01c-ee8a-4ad4-b258-fadb97f7586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe118fd0>]}
[0m17:48:57.802187 [info ] [MainThread]: 
[0m17:48:57.803326 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:48:57.804447 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:48:57.804855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:00.703963 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:49:00.704456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:00.935085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8ff01c-ee8a-4ad4-b258-fadb97f7586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe1b92e0>]}
[0m17:49:00.935898 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:49:00.936316 [info ] [MainThread]: 
[0m17:49:00.942385 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m17:49:00.942820 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.customers .................................. [RUN]
[0m17:49:00.943526 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m17:49:00.943881 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m17:49:00.944222 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m17:49:00.950622 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m17:49:00.955813 [debug] [Thread-1  ]: finished collecting timing info
[0m17:49:00.956297 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m17:49:00.975159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:01.232497 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customers"
[0m17:49:01.233190 [debug] [Thread-1  ]: On model.coffee_shop_zar.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customers"} */


  create or replace table `aec-students`.`dbt_lauren`.`customers`
  
  
  OPTIONS()
  as (
    


/*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club`.`coffee_shop`.`customers`
    ),

    orders as (
      select * from `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as total_orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            ifnull(aggregate_orders.total_orders,0) as total_orders,
            aggregate_orders.first_order_at
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at
  );
  
[0m17:49:07.208547 [debug] [Thread-1  ]: finished collecting timing info
[0m17:49:07.209526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8ff01c-ee8a-4ad4-b258-fadb97f7586b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fdc1e6a0>]}
[0m17:49:07.210331 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_lauren.customers ............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 6.27s]
[0m17:49:07.211188 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m17:49:07.213208 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:49:07.213742 [info ] [MainThread]: 
[0m17:49:07.214602 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m17:49:07.215965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:07.216288 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customers' was properly closed.
[0m17:49:07.245692 [info ] [MainThread]: 
[0m17:49:07.246178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:07.246781 [info ] [MainThread]: 
[0m17:49:07.247297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:49:07.249491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe11d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe0cef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fe0ceaf0>]}


============================== 2022-08-07 17:51:14.153439 | 62df1b5d-8c41-40c0-92d8-4315f31a0c61 ==============================
[0m17:51:14.153454 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:51:14.153938 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m17:51:14.154219 [debug] [MainThread]: Tracking: tracking
[0m17:51:14.158882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c6ddfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c6ddca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c6dd8e0>]}
[0m17:51:14.160037 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-owwk7ls9'
[0m17:51:14.160660 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:51:14.435902 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:51:14.436822 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:51:14.548325 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:51:14.552330 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:51:14.673311 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:51:14.739455 [info ] [MainThread]: Installing dbt-labs/codegen
[0m17:51:15.211097 [info ] [MainThread]:   Installed from version 0.7.0
[0m17:51:15.211565 [info ] [MainThread]:   Up to date!
[0m17:51:15.212128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '62df1b5d-8c41-40c0-92d8-4315f31a0c61', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c6ddaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c6dd070>]}
[0m17:51:15.212590 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:51:15.859953 [info ] [MainThread]:   Installed from version 0.8.6
[0m17:51:15.860891 [info ] [MainThread]:   Up to date!
[0m17:51:15.861425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '62df1b5d-8c41-40c0-92d8-4315f31a0c61', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c6dd520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c6ddcd0>]}
[0m17:51:15.862498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c681cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c681df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068c6ddcd0>]}


============================== 2022-08-07 17:52:56.398430 | ca55180b-3b2d-4e0a-8ff7-065e707eafac ==============================
[0m17:52:56.398462 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:52:56.399343 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_source', 'args': '{"schema_name": "coffee_shop", "database_name": "analytics-engineers-club", "table_names":["order_items", "products"]}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m17:52:56.399690 [debug] [MainThread]: Tracking: tracking
[0m17:52:56.405429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e5cf70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e5cf70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e78820a0>]}
[0m17:52:56.471426 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:52:56.471933 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:52:56.472411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca55180b-3b2d-4e0a-8ff7-065e707eafac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e7882970>]}
[0m17:52:56.520621 [debug] [MainThread]: Parsing macros/etc.sql
[0m17:52:56.525941 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:52:56.569897 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:52:56.583222 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:52:56.586435 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:52:56.587129 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:52:56.587638 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:52:56.588249 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:52:56.588997 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:52:56.589670 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:52:56.590422 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:52:56.590888 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:52:56.592291 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:52:56.593454 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:52:56.594258 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:52:56.595612 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:52:56.596241 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:52:56.597022 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m17:52:56.600352 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m17:52:56.603531 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m17:52:56.609048 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m17:52:56.614252 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m17:52:56.644698 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m17:52:56.648239 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:52:56.649476 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:52:56.650321 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:52:56.651460 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:52:56.653177 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:52:56.655888 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:52:56.669515 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:52:56.676880 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:52:56.691114 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:52:56.696063 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:52:56.705829 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:52:56.708950 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:52:56.711246 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:52:56.712355 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:52:56.713842 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:52:56.715023 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:52:56.716320 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:52:56.721894 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:52:56.722834 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:52:56.724187 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:52:56.725543 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:52:56.726676 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:52:56.727831 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:52:56.729188 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:52:56.730118 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:52:56.732192 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:52:56.734088 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:52:56.736542 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:52:56.737766 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:52:56.738775 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:52:56.740103 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:52:56.741154 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:52:56.742302 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:52:56.743443 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:52:56.752443 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:52:56.757042 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:52:56.759559 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:52:56.763578 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:52:56.769262 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:52:56.772294 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:52:56.788726 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:52:56.793631 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:52:56.809090 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:52:56.810881 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:52:56.820591 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:52:56.822296 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:52:56.827779 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:52:56.831279 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:52:56.833662 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:52:56.838403 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:52:56.840281 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:52:56.842270 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:52:56.860713 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:52:56.867867 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:52:56.880286 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:52:56.882125 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:52:56.893712 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:52:56.910983 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:52:56.912718 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:52:56.914602 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:52:56.917239 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:52:56.920250 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m17:52:56.923146 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m17:52:56.924534 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m17:52:56.926071 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m17:52:56.928389 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m17:52:56.930537 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m17:52:56.933458 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m17:52:56.935710 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m17:52:56.937054 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m17:52:56.938866 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m17:52:56.941389 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:52:56.950450 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m17:52:56.952388 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m17:52:56.955989 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m17:52:56.958275 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m17:52:56.959773 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m17:52:56.961482 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m17:52:56.963169 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m17:52:56.965085 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m17:52:56.966138 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m17:52:56.967910 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m17:52:56.970018 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m17:52:56.975972 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m17:52:56.977377 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m17:52:56.978675 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m17:52:56.980023 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m17:52:56.981182 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m17:52:56.983092 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m17:52:56.986611 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m17:52:56.988143 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m17:52:56.990166 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m17:52:56.992401 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m17:52:56.997724 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m17:52:56.998884 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m17:52:57.004754 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m17:52:57.008276 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m17:52:57.010996 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m17:52:57.019947 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m17:52:57.022105 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m17:52:57.025566 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m17:52:57.027238 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m17:52:57.028315 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m17:52:57.038163 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m17:52:57.041219 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m17:52:57.043017 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m17:52:57.044399 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m17:52:57.045870 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m17:52:57.047520 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m17:52:57.049720 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m17:52:57.051883 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m17:52:57.054535 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m17:52:57.055830 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m17:52:57.057076 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m17:52:57.058262 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m17:52:57.059517 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m17:52:57.083622 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m17:52:57.087318 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m17:52:57.091648 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m17:52:57.094611 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m17:52:57.098773 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m17:52:57.101209 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m17:52:57.107232 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m17:52:57.108912 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m17:52:57.110352 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m17:52:57.121527 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m17:52:57.128609 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m17:52:57.132540 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m17:52:57.136840 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m17:52:57.138591 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m17:52:57.140301 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m17:52:57.148492 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m17:52:57.154690 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m17:52:57.158238 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m17:52:57.160026 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m17:52:57.163597 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m17:52:57.165501 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m17:52:57.171891 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m17:52:57.181026 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m17:52:57.187769 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m17:52:57.194906 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m17:52:57.770548 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m17:52:57.785247 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_daily_revenue_by_product_category.sql
[0m17:52:57.788170 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers.sql
[0m17:52:57.955759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m17:52:57.962890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca55180b-3b2d-4e0a-8ff7-065e707eafac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e559b0d0>]}
[0m17:52:57.974525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca55180b-3b2d-4e0a-8ff7-065e707eafac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e5ccf0a0>]}
[0m17:52:57.975372 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_source"
[0m17:52:57.993703 [info ] [MainThread]: version: 2

sources:
  - name: coffee_shop
    database: analytics-engineers-club
    tables:
      - name: order_items
      - name: products
[0m17:52:57.994804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e55d1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e55d1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e55d19a0>]}
[0m17:52:58.525134 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.


============================== 2022-08-07 18:07:00.701414 | ab4d0a3c-08db-4f1e-9e77-15fee4b66a6c ==============================
[0m18:07:00.701446 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:07:00.702436 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_product_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:07:00.702758 [debug] [MainThread]: Tracking: tracking
[0m18:07:00.708202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcedaf61df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcedaf61550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcedaf61130>]}
[0m18:07:00.806216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:07:00.806743 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/stg_product_details.sql
[0m18:07:00.807350 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop.customers
[0m18:07:00.807538 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop.orders
[0m18:07:00.807710 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop_zar.coffee_shop.product_prices
[0m18:07:00.807910 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop_zar://models/sources.yml
[0m18:07:00.823021 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product_details.sql
[0m18:07:00.837109 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m18:07:00.840055 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers.sql
[0m18:07:00.956599 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m18:07:00.963883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab4d0a3c-08db-4f1e-9e77-15fee4b66a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceda79afd0>]}
[0m18:07:00.982003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab4d0a3c-08db-4f1e-9e77-15fee4b66a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcedad0ce20>]}
[0m18:07:00.982431 [info ] [MainThread]: Found 4 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m18:07:00.982781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4d0a3c-08db-4f1e-9e77-15fee4b66a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcedad0ce80>]}
[0m18:07:00.984591 [info ] [MainThread]: 
[0m18:07:00.985678 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:07:00.987176 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:07:00.987647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:02.326846 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:07:02.327511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:02.610342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4d0a3c-08db-4f1e-9e77-15fee4b66a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcedcb01b80>]}
[0m18:07:02.611159 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:07:02.611595 [info ] [MainThread]: 
[0m18:07:02.617400 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.stg_product_details
[0m18:07:02.617961 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.stg_product_details ......................... [RUN]
[0m18:07:02.618754 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_product_details"
[0m18:07:02.619004 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.stg_product_details
[0m18:07:02.619242 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.stg_product_details
[0m18:07:02.629402 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_product_details"
[0m18:07:02.629950 [debug] [Thread-1  ]: finished collecting timing info
[0m18:07:02.630207 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.stg_product_details
[0m18:07:02.663947 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_product_details"
[0m18:07:02.664555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:02.664935 [debug] [Thread-1  ]: On model.coffee_shop_zar.stg_product_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_product_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_product_details`
  OPTIONS()
  as with 


    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),


    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    product_details as (
        select 
            products.id,
            products.name,
            products.category,
            products.created_at as product_available_at,
            product_prices.price,
            product_prices.created_at as price_started_at,
            product_prices.ended_at as price_ended_at,
            case
                when row_number() over (partition by products.id order by product_prices.created_at desc) = 1
                then true
                else false
            end as is_row_active

        from products
        left join product_prices on 
            products.id = product_prices.product_id
    )

    select *
    from product_details;


[0m18:07:03.399455 [debug] [Thread-1  ]: finished collecting timing info
[0m18:07:03.400095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d0a3c-08db-4f1e-9e77-15fee4b66a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceda7d8a60>]}
[0m18:07:03.400583 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.stg_product_details .................... [[32mOK[0m in 0.78s]
[0m18:07:03.401184 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.stg_product_details
[0m18:07:03.402973 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:07:03.403571 [info ] [MainThread]: 
[0m18:07:03.404071 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m18:07:03.404596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:03.404898 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_product_details' was properly closed.
[0m18:07:03.472294 [info ] [MainThread]: 
[0m18:07:03.472736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:03.473272 [info ] [MainThread]: 
[0m18:07:03.473746 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:07:03.474332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcede23f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcede23f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcede2315e0>]}


============================== 2022-08-07 18:16:18.626084 | 3332f124-7be7-423a-96c4-c30a9bfac24c ==============================
[0m18:16:18.626114 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:16:18.628255 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['marts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:16:18.628692 [debug] [MainThread]: Tracking: tracking
[0m18:16:18.636268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1537f4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1537f4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1537f44f0>]}
[0m18:16:18.936835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m18:16:18.937637 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/order_details.sql
[0m18:16:18.938145 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/product_details.sql
[0m18:16:18.956100 [debug] [MainThread]: 1699: static parser successfully parsed marts/order_details.sql
[0m18:16:18.969997 [debug] [MainThread]: 1699: static parser successfully parsed marts/product_details.sql
[0m18:16:18.981894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m18:16:18.989840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3332f124-7be7-423a-96c4-c30a9bfac24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1531520d0>]}
[0m18:16:19.003817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3332f124-7be7-423a-96c4-c30a9bfac24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1535dadf0>]}
[0m18:16:19.004309 [info ] [MainThread]: Found 6 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m18:16:19.004695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3332f124-7be7-423a-96c4-c30a9bfac24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1535dae50>]}
[0m18:16:19.006868 [info ] [MainThread]: 
[0m18:16:19.008349 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:16:19.009698 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:16:19.010894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:22.160706 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:16:22.161415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:22.418220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3332f124-7be7-423a-96c4-c30a9bfac24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff153687040>]}
[0m18:16:22.420355 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:16:22.421036 [info ] [MainThread]: 
[0m18:16:22.429717 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m18:16:22.429972 [debug] [Thread-2  ]: Began running node model.coffee_shop_zar.order_details
[0m18:16:22.430195 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.product_details
[0m18:16:22.431515 [info ] [Thread-3  ]: 3 of 3 START view model dbt_lauren.product_details ............................. [RUN]
[0m18:16:22.431145 [info ] [Thread-2  ]: 2 of 3 START view model dbt_lauren.order_details ............................... [RUN]
[0m18:16:22.430660 [info ] [Thread-1  ]: 1 of 3 START table model dbt_lauren.customers .................................. [RUN]
[0m18:16:22.432778 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.product_details"
[0m18:16:22.434360 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.product_details
[0m18:16:22.434992 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.product_details
[0m18:16:22.433904 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m18:16:22.440659 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m18:16:22.442414 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m18:16:22.442173 [debug] [Thread-2  ]: Began compiling node model.coffee_shop_zar.order_details
[0m18:16:22.442616 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m18:16:22.441813 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.product_details"
[0m18:16:22.442816 [debug] [Thread-2  ]: Compiling model.coffee_shop_zar.order_details
[0m18:16:22.447116 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m18:16:22.451544 [debug] [Thread-3  ]: finished collecting timing info
[0m18:16:22.455318 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m18:16:22.455854 [debug] [Thread-1  ]: finished collecting timing info
[0m18:16:22.457000 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m18:16:22.456533 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.product_details
[0m18:16:22.457358 [debug] [Thread-2  ]: finished collecting timing info
[0m18:16:22.502587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:22.515692 [debug] [Thread-2  ]: Began executing node model.coffee_shop_zar.order_details
[0m18:16:22.516071 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.product_details"
[0m18:16:22.521945 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m18:16:22.522743 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:16:22.522977 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:16:22.523266 [debug] [Thread-2  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),


    order_items as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`order_items`
    ),

    order_details as (
        select 
            orders.id,
            orders.created_at,
            orders.customer_id,
            orders.total,
            orders.state,
            orders.address,
            orders.zip,
            order_items.product_id

        from orders
        left join order_items on 
            orders.id = order_items.order_id

    )

    select *
    from order_details;


[0m18:16:22.523566 [debug] [Thread-3  ]: On model.coffee_shop_zar.product_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.product_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`product_details`
  OPTIONS()
  as with 


    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),


    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    product_details as (
        select 
            products.id,
            products.name,
            products.category,
            products.created_at as product_available_at,
            product_prices.price,
            product_prices.created_at as price_started_at,
            product_prices.ended_at as price_ended_at,
            case
                when row_number() over (partition by products.id order by product_prices.created_at desc) = 1
                then true
                else false
            end as is_row_active

        from products
        left join product_prices on 
            products.id = product_prices.product_id
    )

    select *
    from product_details;


[0m18:16:22.903586 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customers"
[0m18:16:22.904341 [debug] [Thread-1  ]: On model.coffee_shop_zar.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customers"} */


  create or replace table `aec-students`.`dbt_lauren`.`customers`
  
  
  OPTIONS()
  as (
    


/*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club`.`coffee_shop`.`customers`
    ),

    orders as (
      select * from `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as total_orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            ifnull(aggregate_orders.total_orders,0) as total_orders,
            aggregate_orders.first_order_at
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at
  );
  
[0m18:16:23.415389 [debug] [Thread-3  ]: finished collecting timing info
[0m18:16:23.416150 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3332f124-7be7-423a-96c4-c30a9bfac24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff152fda940>]}
[0m18:16:23.416698 [info ] [Thread-3  ]: 3 of 3 OK created view model dbt_lauren.product_details ........................ [[32mOK[0m in 0.98s]
[0m18:16:23.418032 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.product_details
[0m18:16:23.445647 [debug] [Thread-2  ]: finished collecting timing info
[0m18:16:23.446255 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3332f124-7be7-423a-96c4-c30a9bfac24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff153110a30>]}
[0m18:16:23.446696 [info ] [Thread-2  ]: 2 of 3 OK created view model dbt_lauren.order_details .......................... [[32mOK[0m in 1.01s]
[0m18:16:23.447252 [debug] [Thread-2  ]: Finished running node model.coffee_shop_zar.order_details
[0m18:16:28.737368 [debug] [Thread-1  ]: finished collecting timing info
[0m18:16:28.738222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3332f124-7be7-423a-96c4-c30a9bfac24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1531109d0>]}
[0m18:16:28.738802 [info ] [Thread-1  ]: 1 of 3 OK created table model dbt_lauren.customers ............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 6.30s]
[0m18:16:28.739474 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m18:16:28.741751 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:16:28.742511 [info ] [MainThread]: 
[0m18:16:28.743044 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m18:16:28.743609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:28.743981 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customers' was properly closed.
[0m18:16:28.744315 [debug] [MainThread]: Connection 'model.coffee_shop_zar.product_details' was properly closed.
[0m18:16:28.744638 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m18:16:28.765400 [info ] [MainThread]: 
[0m18:16:28.765782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:28.766385 [info ] [MainThread]: 
[0m18:16:28.766917 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:16:28.767690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1535d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff153687820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15309dca0>]}


============================== 2022-08-07 18:41:17.529524 | c4dade0d-d2f8-4b90-aebd-423847e614b5 ==============================
[0m18:41:17.529555 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:41:17.530551 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['staging'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:41:17.530922 [debug] [MainThread]: Tracking: tracking
[0m18:41:17.536603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86df5248b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86df524670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86df5246d0>]}
[0m18:41:17.780738 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 4 files added, 0 files changed.
[0m18:41:17.781661 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/daily_revenue_by_product.sql
[0m18:41:17.781982 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/stg_orders.sql
[0m18:41:17.782236 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/stg_product_prices.sql
[0m18:41:17.782469 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/stg_products.sql
[0m18:41:17.782642 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/staging/stg_product_details.sql
[0m18:41:17.782799 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/staging/stg_daily_revenue_by_product_category.sql
[0m18:41:17.798679 [debug] [MainThread]: 1699: static parser successfully parsed marts/daily_revenue_by_product.sql
[0m18:41:17.813417 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
[0m18:41:17.818005 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product_prices.sql
[0m18:41:17.822697 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_products.sql
[0m18:41:17.837504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m18:41:17.844689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4dade0d-d2f8-4b90-aebd-423847e614b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86dee4f0d0>]}
[0m18:41:17.856856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4dade0d-d2f8-4b90-aebd-423847e614b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86dee32700>]}
[0m18:41:17.857257 [info ] [MainThread]: Found 8 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m18:41:17.857619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4dade0d-d2f8-4b90-aebd-423847e614b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86df2b33a0>]}
[0m18:41:17.859586 [info ] [MainThread]: 
[0m18:41:17.860852 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:41:17.861942 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:41:17.862840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:20.680833 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:41:20.681303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:20.926040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4dade0d-d2f8-4b90-aebd-423847e614b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86df4f29d0>]}
[0m18:41:20.926808 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:41:20.927261 [info ] [MainThread]: 
[0m18:41:20.935261 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.stg_orders
[0m18:41:20.935580 [debug] [Thread-2  ]: Began running node model.coffee_shop_zar.stg_product_prices
[0m18:41:20.936798 [info ] [Thread-2  ]: 2 of 3 START view model dbt_lauren.stg_product_prices .......................... [RUN]
[0m18:41:20.936290 [info ] [Thread-1  ]: 1 of 3 START view model dbt_lauren.stg_orders .................................. [RUN]
[0m18:41:20.935800 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.stg_products
[0m18:41:20.938580 [info ] [Thread-3  ]: 3 of 3 START view model dbt_lauren.stg_products ................................ [RUN]
[0m18:41:20.938223 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_orders"
[0m18:41:20.940634 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_products"
[0m18:41:20.941215 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.stg_products
[0m18:41:20.940969 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.stg_orders
[0m18:41:20.941440 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.stg_products
[0m18:41:20.937561 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_product_prices"
[0m18:41:20.946795 [debug] [Thread-2  ]: Began compiling node model.coffee_shop_zar.stg_product_prices
[0m18:41:20.946534 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_products"
[0m18:41:20.946977 [debug] [Thread-2  ]: Compiling model.coffee_shop_zar.stg_product_prices
[0m18:41:20.941673 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.stg_orders
[0m18:41:20.954597 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_orders"
[0m18:41:20.955220 [debug] [Thread-1  ]: finished collecting timing info
[0m18:41:20.956474 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_product_prices"
[0m18:41:20.956759 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.stg_orders
[0m18:41:20.956935 [debug] [Thread-3  ]: finished collecting timing info
[0m18:41:20.973320 [debug] [Thread-2  ]: finished collecting timing info
[0m18:41:20.983494 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.stg_products
[0m18:41:20.992998 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_orders"
[0m18:41:20.993298 [debug] [Thread-2  ]: Began executing node model.coffee_shop_zar.stg_product_prices
[0m18:41:20.996702 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_products"
[0m18:41:21.001004 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:41:21.000533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:21.001278 [debug] [Thread-3  ]: On model.coffee_shop_zar.stg_products: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_products"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_products`
  OPTIONS()
  as with 
    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),

    renamed as (
        select 
            id,
            name,
            category,
            created_at as product_available_on
        from products

    )

    select *
    from renamed;


[0m18:41:21.000314 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_product_prices"
[0m18:41:21.001516 [debug] [Thread-1  ]: On model.coffee_shop_zar.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_orders`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    renamed as (

        select 
            id,
            created_at as created_at,
            date(created_at) as created_on,
            customer_id,
            total as total_amount_usd,
            state,
            address,
            zip
        from orders

    )

    select *
    from renamed;


[0m18:41:21.005235 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:41:21.005480 [debug] [Thread-2  ]: On model.coffee_shop_zar.stg_product_prices: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_product_prices"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_product_prices`
  OPTIONS()
  as with 

    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    renamed as (
        select 
            id,
            product_id,
            price as price_usd,
            created_at as price_started_at,
            ended_at as price_ended_at,
            case
                when row_number() over (partition by product_id order by created_at desc) = 1
                then true
                else false
            end as is_row_active

        from product_prices
    )

    select *
    from renamed;


[0m18:41:21.882274 [debug] [Thread-1  ]: finished collecting timing info
[0m18:41:21.882884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dade0d-d2f8-4b90-aebd-423847e614b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86dede4cd0>]}
[0m18:41:21.883327 [info ] [Thread-1  ]: 1 of 3 OK created view model dbt_lauren.stg_orders ............................. [[32mOK[0m in 0.94s]
[0m18:41:21.883879 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.stg_orders
[0m18:41:22.093711 [debug] [Thread-3  ]: finished collecting timing info
[0m18:41:22.094629 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dade0d-d2f8-4b90-aebd-423847e614b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ded45a30>]}
[0m18:41:22.095250 [info ] [Thread-3  ]: 3 of 3 OK created view model dbt_lauren.stg_products ........................... [[32mOK[0m in 1.15s]
[0m18:41:22.095789 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.stg_products
[0m18:41:22.131808 [debug] [Thread-2  ]: finished collecting timing info
[0m18:41:22.132414 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dade0d-d2f8-4b90-aebd-423847e614b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86dedd2820>]}
[0m18:41:22.132859 [info ] [Thread-2  ]: 2 of 3 OK created view model dbt_lauren.stg_product_prices ..................... [[32mOK[0m in 1.20s]
[0m18:41:22.133407 [debug] [Thread-2  ]: Finished running node model.coffee_shop_zar.stg_product_prices
[0m18:41:22.135161 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:41:22.135621 [info ] [MainThread]: 
[0m18:41:22.135937 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m18:41:22.136396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:22.136653 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_orders' was properly closed.
[0m18:41:22.137778 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_product_prices' was properly closed.
[0m18:41:22.138073 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_products' was properly closed.
[0m18:41:22.154006 [info ] [MainThread]: 
[0m18:41:22.154384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:22.154940 [info ] [MainThread]: 
[0m18:41:22.155450 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:41:22.156090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86decb7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86df2d7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86deda2e50>]}


============================== 2022-08-07 20:01:51.807463 | 63ada525-196a-48f1-a437-eba63ab0deba ==============================
[0m20:01:51.807499 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:01:51.808420 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_model_yaml', 'args': '{"model_name": ["stg_coffee_shop__products","stg_coffee_shop__orders"]}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m20:01:51.808718 [debug] [MainThread]: Tracking: tracking
[0m20:01:51.814271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d32a0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d32a01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d32a02b0>]}
[0m20:01:52.080453 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 5 files added, 0 files changed.
[0m20:01:52.081023 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m20:01:52.081340 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop.yml
[0m20:01:52.081622 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__products.sql
[0m20:01:52.081857 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m20:01:52.082113 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/coffee_shop/src_coffee_shop.yml
[0m20:01:52.082309 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/staging/stg_orders.sql
[0m20:01:52.082639 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/staging/stg_product_prices.sql
[0m20:01:52.082826 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/staging/stg_products.sql
[0m20:01:52.097988 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m20:01:52.111389 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m20:01:52.113950 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m20:01:52.129847 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:01:52.140061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63ada525-196a-48f1-a437-eba63ab0deba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2b70fa0>]}
[0m20:01:52.151385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ada525-196a-48f1-a437-eba63ab0deba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d325c8e0>]}
[0m20:01:52.152058 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_model_yaml"
[0m20:01:52.161403 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
macro generate_model_yaml
[0m20:01:52.161624 [debug] [MainThread]: BigQuery adapter: Compilation Error
  The name argument to ref() must be a string, got <class 'list'>
  
  > in macro generate_model_yaml (macros/generate_model_yaml.sql)
  > called by <Unknown>
[0m20:01:52.162016 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  The name argument to ref() must be a string, got <class 'list'>
  
  > in macro generate_model_yaml (macros/generate_model_yaml.sql)
  > called by <Unknown>
[0m20:01:52.162403 [debug] [MainThread]: 
[0m20:01:52.163082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2be78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2be7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2be77f0>]}
[0m20:01:52.654802 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.


============================== 2022-08-07 20:02:09.686017 | b82acce3-523c-4650-9b19-0543bdf53bba ==============================
[0m20:02:09.686048 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:02:09.686929 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_model_yaml', 'args': '{"model_name": "stg_coffee_shop__products"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m20:02:09.687294 [debug] [MainThread]: Tracking: tracking
[0m20:02:09.703689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa9608b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa960130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa960160>]}
[0m20:02:09.795291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:09.795588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:09.796289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:02:09.805010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b82acce3-523c-4650-9b19-0543bdf53bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa6df0d0>]}
[0m20:02:09.815816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b82acce3-523c-4650-9b19-0543bdf53bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa7d3190>]}
[0m20:02:09.816437 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_model_yaml"
[0m20:02:09.825904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:12.638857 [debug] [MainThread]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/aec-students/datasets/dbt_lauren/tables/stg_coffee_shop__products?prettyPrint=false: Not found: Table aec-students:dbt_lauren.stg_coffee_shop__products
[0m20:02:12.639505 [info ] [MainThread]: version: 2

models:
  - name: stg_coffee_shop__products
    description: ""
    columns:
[0m20:02:12.641160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa9608b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa6ef0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa80a670>]}
[0m20:02:13.035650 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.


============================== 2022-08-07 20:02:33.444843 | 1008b316-3a50-4a1b-8eb9-5e78b66deb38 ==============================
[0m20:02:33.444877 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:02:33.445749 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['staging.coffee_shop'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:02:33.446105 [debug] [MainThread]: Tracking: tracking
[0m20:02:33.451493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dffb783a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dffb78dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dffb78670>]}
[0m20:02:33.548674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:33.548968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:33.549680 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:02:33.558199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1008b316-3a50-4a1b-8eb9-5e78b66deb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dff91e0d0>]}
[0m20:02:33.570810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1008b316-3a50-4a1b-8eb9-5e78b66deb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dffa1f550>]}
[0m20:02:33.571207 [info ] [MainThread]: Found 8 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m20:02:33.571553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1008b316-3a50-4a1b-8eb9-5e78b66deb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e01702af0>]}
[0m20:02:33.573657 [info ] [MainThread]: 
[0m20:02:33.574737 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:02:33.575834 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m20:02:33.576679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:34.972636 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m20:02:34.973095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:35.203804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1008b316-3a50-4a1b-8eb9-5e78b66deb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dffb5da60>]}
[0m20:02:35.204597 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m20:02:35.205118 [info ] [MainThread]: 
[0m20:02:35.215525 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:02:35.216351 [info ] [Thread-1  ]: 1 of 3 START view model dbt_lauren.stg_coffee_shop__orders ..................... [RUN]
[0m20:02:35.215986 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__products
[0m20:02:35.215722 [debug] [Thread-2  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:02:35.217453 [info ] [Thread-2  ]: 2 of 3 START view model dbt_lauren.stg_coffee_shop__product_prices ............. [RUN]
[0m20:02:35.216947 [info ] [Thread-3  ]: 3 of 3 START view model dbt_lauren.stg_coffee_shop__products ................... [RUN]
[0m20:02:35.218582 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m20:02:35.219486 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m20:02:35.220413 [debug] [Thread-2  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:02:35.220182 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__products"
[0m20:02:35.220647 [debug] [Thread-2  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:02:35.219762 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:02:35.226066 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:02:35.225778 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m20:02:35.220859 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__products
[0m20:02:35.230117 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__products
[0m20:02:35.229589 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m20:02:35.237525 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__products"
[0m20:02:35.237968 [debug] [Thread-1  ]: finished collecting timing info
[0m20:02:35.238637 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:02:35.238220 [debug] [Thread-2  ]: finished collecting timing info
[0m20:02:35.238874 [debug] [Thread-3  ]: finished collecting timing info
[0m20:02:35.272674 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__products
[0m20:02:35.272338 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m20:02:35.276115 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__products"
[0m20:02:35.264730 [debug] [Thread-2  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:02:35.280049 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m20:02:35.276708 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:35.280549 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:02:35.280925 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:02:35.281218 [debug] [Thread-1  ]: On model.coffee_shop_zar.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    renamed as (

        select 
            id,
            created_at as created_at,
            date(created_at) as created_on,
            customer_id,
            total as total_amount_usd,
            state,
            address,
            zip
        from orders

    )

    select *
    from renamed;


[0m20:02:35.281499 [debug] [Thread-2  ]: On model.coffee_shop_zar.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__product_prices"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
  OPTIONS()
  as with 

    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    renamed as (
        select 
            id,
            product_id,
            price as price_usd,
            created_at as price_started_at,
            ended_at as price_ended_at,
            case
                when row_number() over (partition by product_id order by created_at desc) = 1
                then true
                else false
            end as is_row_active

        from product_prices
    )

    select *
    from renamed;


[0m20:02:35.281765 [debug] [Thread-3  ]: On model.coffee_shop_zar.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__products"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
  OPTIONS()
  as with 
    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),

    renamed as (
        select 
            id,
            name,
            category,
            created_at as product_available_on
        from products

    )

    select *
    from renamed;


[0m20:02:36.131288 [debug] [Thread-1  ]: finished collecting timing info
[0m20:02:36.132410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1008b316-3a50-4a1b-8eb9-5e78b66deb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dff875b50>]}
[0m20:02:36.133386 [info ] [Thread-1  ]: 1 of 3 OK created view model dbt_lauren.stg_coffee_shop__orders ................ [[32mOK[0m in 0.91s]
[0m20:02:36.135666 [debug] [Thread-2  ]: finished collecting timing info
[0m20:02:36.136503 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1008b316-3a50-4a1b-8eb9-5e78b66deb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dff845550>]}
[0m20:02:36.136880 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:02:36.137300 [info ] [Thread-2  ]: 2 of 3 OK created view model dbt_lauren.stg_coffee_shop__product_prices ........ [[32mOK[0m in 0.92s]
[0m20:02:36.138820 [debug] [Thread-2  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:02:36.155847 [debug] [Thread-3  ]: finished collecting timing info
[0m20:02:36.156349 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1008b316-3a50-4a1b-8eb9-5e78b66deb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dff854eb0>]}
[0m20:02:36.156751 [info ] [Thread-3  ]: 3 of 3 OK created view model dbt_lauren.stg_coffee_shop__products .............. [[32mOK[0m in 0.94s]
[0m20:02:36.157266 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__products
[0m20:02:36.158864 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:02:36.159273 [info ] [MainThread]: 
[0m20:02:36.159612 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m20:02:36.159936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:36.160082 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__orders' was properly closed.
[0m20:02:36.160237 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__product_prices' was properly closed.
[0m20:02:36.160395 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__products' was properly closed.
[0m20:02:36.177598 [info ] [MainThread]: 
[0m20:02:36.177974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:36.178492 [info ] [MainThread]: 
[0m20:02:36.178920 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:02:36.179609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e038fe0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dff7e4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dff88c4c0>]}


============================== 2022-08-07 20:02:42.430812 | eb239315-64c5-4e0e-897d-b16fb1c2181d ==============================
[0m20:02:42.430842 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:02:42.432209 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_model_yaml', 'args': '{"model_name": "stg_coffee_shop__products"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m20:02:42.432563 [debug] [MainThread]: Tracking: tracking
[0m20:02:42.438633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e94737040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e94737160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e962c20a0>]}
[0m20:02:42.531897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:42.532431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:42.533554 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:02:42.542655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb239315-64c5-4e0e-897d-b16fb1c2181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e944de0d0>]}
[0m20:02:42.553602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb239315-64c5-4e0e-897d-b16fb1c2181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e962c2970>]}
[0m20:02:42.554259 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_model_yaml"
[0m20:02:42.563817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:43.820343 [info ] [MainThread]: version: 2

models:
  - name: stg_coffee_shop__products
    description: ""
    columns:
      - name: id
        description: ""

      - name: name
        description: ""

      - name: category
        description: ""

      - name: product_available_on
        description: ""

[0m20:02:43.821649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9439e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e943a1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e943a13a0>]}
[0m20:02:44.217404 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.


============================== 2022-08-07 20:03:15.452995 | d532f962-94a1-4aad-b201-af1611df6313 ==============================
[0m20:03:15.453028 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:03:15.453990 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_model_yaml', 'args': '{"model_name": "stg_coffee_shop__product_prices"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m20:03:15.454364 [debug] [MainThread]: Tracking: tracking
[0m20:03:15.460470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852c5c2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852c5c2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852c5c2a90>]}
[0m20:03:15.553846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:15.554195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:15.554880 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:03:15.567052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd532f962-94a1-4aad-b201-af1611df6313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852a7dd0d0>]}
[0m20:03:15.578917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd532f962-94a1-4aad-b201-af1611df6313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852a8de070>]}
[0m20:03:15.579609 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_model_yaml"
[0m20:03:15.589129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:03:16.655350 [info ] [MainThread]: version: 2

models:
  - name: stg_coffee_shop__product_prices
    description: ""
    columns:
      - name: id
        description: ""

      - name: product_id
        description: ""

      - name: price_usd
        description: ""

      - name: price_started_at
        description: ""

      - name: price_ended_at
        description: ""

      - name: is_row_active
        description: ""

[0m20:03:16.657319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852a6a0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852a6a0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852a6a0bb0>]}
[0m20:03:17.178510 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.


============================== 2022-08-07 20:04:00.064689 | c1e55a2f-e4c2-4ef0-bad3-924865848df0 ==============================
[0m20:04:00.064719 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:04:00.066187 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_model_yaml', 'args': '{"model_name": "stg_coffee_shop__orders"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m20:04:00.066885 [debug] [MainThread]: Tracking: tracking
[0m20:04:00.074451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7ada00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7ada0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7ada08b0>]}
[0m20:04:00.214105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:00.214567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:00.215626 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:04:00.229172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1e55a2f-e4c2-4ef0-bad3-924865848df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7ab1d0d0>]}
[0m20:04:00.240981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e55a2f-e4c2-4ef0-bad3-924865848df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7ac151f0>]}
[0m20:04:00.241658 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_model_yaml"
[0m20:04:00.251165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:01.318962 [info ] [MainThread]: version: 2

models:
  - name: stg_coffee_shop__orders
    description: ""
    columns:
      - name: id
        description: ""

      - name: created_at
        description: ""

      - name: created_on
        description: ""

      - name: customer_id
        description: ""

      - name: total_amount_usd
        description: ""

      - name: state
        description: ""

      - name: address
        description: ""

      - name: zip
        description: ""

[0m20:04:01.320281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a9df3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a9df250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a9df2b0>]}
[0m20:04:01.726238 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.


============================== 2022-08-07 20:10:59.443249 | 1c24a54d-4548-4fc5-b82e-053376dd25b2 ==============================
[0m20:10:59.443281 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:10:59.445023 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_base_model', 'args': '{"source_name": "coffe_shop", "table_name": "order_items"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m20:10:59.445477 [debug] [MainThread]: Tracking: tracking
[0m20:10:59.452171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16009d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16009130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16009f10>]}
[0m20:10:59.546616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:10:59.547539 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m20:10:59.548157 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop.yml
[0m20:10:59.563914 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m20:10:59.603571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:10:59.610887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c24a54d-4548-4fc5-b82e-053376dd25b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1596c0d0>]}
[0m20:10:59.626023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c24a54d-4548-4fc5-b82e-053376dd25b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb191dfc40>]}
[0m20:10:59.627010 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_base_model"
[0m20:10:59.640720 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
macro generate_base_model
[0m20:10:59.641136 [debug] [MainThread]: BigQuery adapter: Compilation Error in macro generate_base_model (macros/generate_base_model.sql)
  Macro 'macro.codegen.generate_base_model' (macros/generate_base_model.sql) depends on a source named 'coffe_shop.order_items' which was not found or is disabled
  
  > in macro generate_base_model (macros/generate_base_model.sql)
  > called by macro generate_base_model (macros/generate_base_model.sql)
[0m20:10:59.641833 [error] [MainThread]: Encountered an error while running operation: Compilation Error in macro generate_base_model (macros/generate_base_model.sql)
  Macro 'macro.codegen.generate_base_model' (macros/generate_base_model.sql) depends on a source named 'coffe_shop.order_items' which was not found or is disabled
  
  > in macro generate_base_model (macros/generate_base_model.sql)
  > called by macro generate_base_model (macros/generate_base_model.sql)
[0m20:10:59.642451 [debug] [MainThread]: 
[0m20:10:59.643043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb15dedca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb15ded8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb15ded9a0>]}
[0m20:11:00.226209 [debug] [MainThread]: Connection 'macro_generate_base_model' was properly closed.


============================== 2022-08-07 20:11:15.207038 | 7312e29c-261d-48a7-ab84-bf46f495c722 ==============================
[0m20:11:15.207069 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:11:15.207990 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_base_model', 'args': '{"source_name": "coffee_shop", "table_name": "order_items"}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m20:11:15.208331 [debug] [MainThread]: Tracking: tracking
[0m20:11:15.224120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a7f77160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a7f77040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a9b020a0>]}
[0m20:11:15.316053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:11:15.316395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:11:15.317106 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:11:15.325415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7312e29c-261d-48a7-ab84-bf46f495c722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a7d2ff40>]}
[0m20:11:15.336440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7312e29c-261d-48a7-ab84-bf46f495c722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a7df1070>]}
[0m20:11:15.337107 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_base_model"
[0m20:11:15.346695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:16.607120 [info ] [MainThread]: 
with source as (

    select * from {{ source('coffee_shop', 'order_items') }}

),

renamed as (

    select
        id,
        order_id,
        product_id

    from source

)

select * from renamed

[0m20:11:16.608694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a7e10040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a7e10070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a7e10820>]}
[0m20:11:17.021412 [debug] [MainThread]: Connection 'macro_generate_base_model' was properly closed.


============================== 2022-08-07 20:21:24.365001 | 11552737-65d9-490f-989b-189a913b8b25 ==============================
[0m20:21:24.365029 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:21:24.365969 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['staging.coffee_shop'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:21:24.366288 [debug] [MainThread]: Tracking: tracking
[0m20:21:24.371205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0202ebf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0202ebf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0202ebf970>]}
[0m20:21:24.472246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:21:24.472863 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m20:21:24.473209 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m20:21:24.487798 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m20:21:24.500772 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m20:21:24.524333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop.customers

[0m20:21:24.531202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11552737-65d9-490f-989b-189a913b8b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02027ce0d0>]}
[0m20:21:24.543455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11552737-65d9-490f-989b-189a913b8b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0202e93dc0>]}
[0m20:21:24.543828 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m20:21:24.544177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11552737-65d9-490f-989b-189a913b8b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0202e93c70>]}
[0m20:21:24.546285 [info ] [MainThread]: 
[0m20:21:24.547071 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:21:24.548107 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m20:21:24.548549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:25.819200 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m20:21:25.819690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:26.079462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11552737-65d9-490f-989b-189a913b8b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0202ca6910>]}
[0m20:21:26.080653 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m20:21:26.081080 [info ] [MainThread]: 
[0m20:21:26.086577 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m20:21:26.086964 [info ] [Thread-1  ]: 1 of 4 START view model dbt_lauren.stg_coffee_shop__order_items ................ [RUN]
[0m20:21:26.087187 [debug] [Thread-2  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:21:26.087461 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:21:26.087817 [debug] [Thread-4  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__products
[0m20:21:26.089288 [info ] [Thread-4  ]: 4 of 4 START view model dbt_lauren.stg_coffee_shop__products ................... [RUN]
[0m20:21:26.090314 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__products"
[0m20:21:26.088967 [info ] [Thread-3  ]: 3 of 4 START view model dbt_lauren.stg_coffee_shop__product_prices ............. [RUN]
[0m20:21:26.088256 [info ] [Thread-2  ]: 2 of 4 START view model dbt_lauren.stg_coffee_shop__orders ..................... [RUN]
[0m20:21:26.091852 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m20:21:26.092193 [debug] [Thread-2  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:21:26.091129 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m20:21:26.088665 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m20:21:26.093203 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m20:21:26.093562 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__order_items
[0m20:21:26.092937 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:21:26.092639 [debug] [Thread-2  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:21:26.090610 [debug] [Thread-4  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__products
[0m20:21:26.098008 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m20:21:26.098265 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:21:26.101695 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m20:21:26.101952 [debug] [Thread-4  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__products
[0m20:21:26.105195 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m20:21:26.109947 [debug] [Thread-2  ]: finished collecting timing info
[0m20:21:26.110427 [debug] [Thread-1  ]: finished collecting timing info
[0m20:21:26.110648 [debug] [Thread-3  ]: finished collecting timing info
[0m20:21:26.110870 [debug] [Thread-2  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:21:26.112820 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__products"
[0m20:21:26.113022 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m20:21:26.113283 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:21:26.158375 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m20:21:26.159386 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m20:21:26.162989 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m20:21:26.163388 [debug] [Thread-4  ]: finished collecting timing info
[0m20:21:26.164466 [debug] [Thread-4  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__products
[0m20:21:26.163855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:21:26.168453 [debug] [Thread-1  ]: On model.coffee_shop_zar.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__order_items"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
  OPTIONS()
  as with source as (

    select * from `analytics-engineers-club`.`coffee_shop`.`order_items`

),

renamed as (

    select
        id,
        order_id,
        product_id
    from source

)

select * from renamed;


[0m20:21:26.164736 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:21:26.168141 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__products"
[0m20:21:26.170757 [debug] [Thread-3  ]: On model.coffee_shop_zar.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__product_prices"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
  OPTIONS()
  as with 

    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    renamed as (
        select 
            id,
            product_id,
            price as price_usd,
            created_at as price_started_at,
            ended_at as price_ended_at,
            case
                when row_number() over (partition by product_id order by created_at desc) = 1
                then true
                else false
            end as is_row_active

        from product_prices
    )

    select *
    from renamed;


[0m20:21:26.164907 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:21:26.173266 [debug] [Thread-2  ]: On model.coffee_shop_zar.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    renamed as (

        select 
            id,
            created_at as created_at,
            date(created_at) as created_on,
            extract(year from date(created_at)) as year_of,
            date_trunc(date(created_at), month) as month_of,
            date_trunc(date(created_at), week(MONDAY)) as week_of,
            case extract(dayofweek from date(created_at)) 
                when 1 then "Sunday"
                when 2 then "Monday"
                when 3 then "Tuesday"
                when 4 then "Wednesday"
                when 5 then "Thursday"
                when 6 then "Friday"
                when 7 then "Saturday"
            end as day_of_week_name,
            customer_id,
            total as total_amount_usd,
            state,
            address,
            zip
        from orders

    )

    select *
    from renamed;


[0m20:21:26.173620 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:21:26.175247 [debug] [Thread-4  ]: On model.coffee_shop_zar.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__products"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
  OPTIONS()
  as with 
    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),

    renamed as (
        select 
            id,
            name,
            category,
            created_at as product_available_on
        from products

    )

    select *
    from renamed;


[0m20:21:27.232470 [debug] [Thread-3  ]: finished collecting timing info
[0m20:21:27.234871 [debug] [Thread-1  ]: finished collecting timing info
[0m20:21:27.235331 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11552737-65d9-490f-989b-189a913b8b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02027acee0>]}
[0m20:21:27.235825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11552737-65d9-490f-989b-189a913b8b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02027acaf0>]}
[0m20:21:27.236255 [info ] [Thread-3  ]: 3 of 4 OK created view model dbt_lauren.stg_coffee_shop__product_prices ........ [[32mOK[0m in 1.14s]
[0m20:21:27.236684 [info ] [Thread-1  ]: 1 of 4 OK created view model dbt_lauren.stg_coffee_shop__order_items ........... [[32mOK[0m in 1.15s]
[0m20:21:27.237886 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m20:21:27.238586 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m20:21:27.399631 [debug] [Thread-2  ]: finished collecting timing info
[0m20:21:27.400221 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11552737-65d9-490f-989b-189a913b8b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02027acd00>]}
[0m20:21:27.400648 [info ] [Thread-2  ]: 2 of 4 OK created view model dbt_lauren.stg_coffee_shop__orders ................ [[32mOK[0m in 1.31s]
[0m20:21:27.401214 [debug] [Thread-2  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m20:21:27.425856 [debug] [Thread-4  ]: finished collecting timing info
[0m20:21:27.426383 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11552737-65d9-490f-989b-189a913b8b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0202728fd0>]}
[0m20:21:27.427694 [info ] [Thread-4  ]: 4 of 4 OK created view model dbt_lauren.stg_coffee_shop__products .............. [[32mOK[0m in 1.34s]
[0m20:21:27.428523 [debug] [Thread-4  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__products
[0m20:21:27.430895 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:21:27.431392 [info ] [MainThread]: 
[0m20:21:27.432033 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m20:21:27.432521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:27.432773 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__order_items' was properly closed.
[0m20:21:27.432949 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__products' was properly closed.
[0m20:21:27.433101 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__product_prices' was properly closed.
[0m20:21:27.433288 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__orders' was properly closed.
[0m20:21:27.445606 [info ] [MainThread]: 
[0m20:21:27.445974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:21:27.446521 [info ] [MainThread]: 
[0m20:21:27.446927 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:21:27.447650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02027cef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0202ca6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f020275cc10>]}


============================== 2022-08-08 04:30:48.153911 | 92861135-ce8e-4996-a2f5-cd721cff6d5f ==============================
[0m04:30:48.153925 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:30:48.154488 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m04:30:48.155066 [debug] [MainThread]: Tracking: tracking
[0m04:30:48.159298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6918950a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6918950b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6918950af0>]}
[0m04:30:48.160503 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d9ip6duv'
[0m04:30:48.161126 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:30:48.339373 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:30:48.340125 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m04:30:48.428082 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m04:30:48.435865 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:30:48.524459 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:30:48.607687 [info ] [MainThread]: Installing dbt-labs/codegen
[0m04:30:48.942548 [info ] [MainThread]:   Installed from version 0.7.0
[0m04:30:48.943102 [info ] [MainThread]:   Up to date!
[0m04:30:48.943660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92861135-ce8e-4996-a2f5-cd721cff6d5f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6918950fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6918950e20>]}
[0m04:30:48.944085 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:30:49.531376 [info ] [MainThread]:   Installed from version 0.8.6
[0m04:30:49.531863 [info ] [MainThread]:   Up to date!
[0m04:30:49.532637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92861135-ce8e-4996-a2f5-cd721cff6d5f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69189cfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69189cf340>]}
[0m04:30:49.534622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6918a0e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f691be2b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6918a31d00>]}


============================== 2022-08-08 04:35:24.379016 | c1f59217-9673-4bf7-89b3-50b0720a30ff ==============================
[0m04:35:24.379027 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:35:24.379564 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:35:24.379912 [debug] [MainThread]: Tracking: tracking
[0m04:35:24.383919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bded033d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bded03310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bded03400>]}
[0m04:35:24.408796 [debug] [MainThread]: Executing "git --help"
[0m04:35:24.412754 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:35:24.413247 [debug] [MainThread]: STDERR: "b''"
[0m04:35:24.413803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bded03070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bdec6b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bdec6ba60>]}


============================== 2022-08-08 04:40:30.946677 | 77a3a64c-d7d6-4aa8-9256-dafb5f7e3498 ==============================
[0m04:40:30.946689 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:40:30.947212 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:40:30.947490 [debug] [MainThread]: Tracking: tracking
[0m04:40:30.952030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b1313a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b131760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b131520>]}
[0m04:40:30.978261 [debug] [MainThread]: Executing "git --help"
[0m04:40:30.982437 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:40:30.982865 [debug] [MainThread]: STDERR: "b''"
[0m04:40:30.983648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b121970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b0a1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff99b0a1ac0>]}


============================== 2022-08-08 04:41:00.448333 | 0c12796a-41ce-4522-9244-48507a9fb19e ==============================
[0m04:41:00.448344 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:41:00.448902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:41:00.449371 [debug] [MainThread]: Tracking: tracking
[0m04:41:00.453789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d91c4cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d91c55340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d91c55790>]}
[0m04:41:00.779952 [debug] [MainThread]: Executing "git --help"
[0m04:41:00.785200 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:41:00.785723 [debug] [MainThread]: STDERR: "b''"
[0m04:41:00.796614 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m04:41:00.797440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:41:09.807220 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m04:41:09.808125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d90065760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d900678e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d90067130>]}
[0m04:41:10.129733 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-08 04:46:51.089713 | bdafd583-cee8-400a-b259-1ac3a1f5483f ==============================
[0m04:46:51.089748 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:46:51.090493 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:46:51.090776 [debug] [MainThread]: Tracking: tracking
[0m04:46:51.099914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaae9e68b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaae9e6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaae9e66d0>]}
[0m04:46:51.180117 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:46:51.180523 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:46:51.180788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdafd583-cee8-400a-b259-1ac3a1f5483f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaaea39ac0>]}
[0m04:46:51.236387 [debug] [MainThread]: Parsing macros/etc.sql
[0m04:46:51.241320 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:46:51.275139 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:46:51.286076 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:46:51.293965 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:46:51.294845 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:46:51.295539 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:46:51.296445 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:46:51.297500 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:46:51.298515 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:46:51.299753 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:46:51.300520 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:46:51.302926 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:46:51.304727 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:46:51.305792 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:46:51.308127 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:46:51.309162 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:46:51.310190 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m04:46:51.313313 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m04:46:51.315226 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m04:46:51.319838 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m04:46:51.322793 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m04:46:51.338611 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m04:46:51.341446 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:46:51.342447 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:46:51.343207 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:46:51.344076 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:46:51.345476 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:46:51.348277 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:46:51.361907 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:46:51.369368 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:46:51.383625 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:46:51.388136 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:46:51.397668 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:46:51.400636 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:46:51.402830 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:46:51.403878 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:46:51.405018 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:46:51.406026 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:46:51.407325 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:46:51.413478 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:46:51.414490 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:46:51.415797 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:46:51.417091 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:46:51.418226 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:46:51.419574 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:46:51.420956 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:46:51.421850 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:46:51.424079 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:46:51.425959 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:46:51.428443 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:46:51.429595 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:46:51.430667 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:46:51.431969 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:46:51.432969 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:46:51.434093 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:46:51.435215 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:46:51.443582 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:46:51.448063 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:46:51.450707 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:46:51.454939 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:46:51.460628 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:46:51.463545 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:46:51.479381 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:46:51.483842 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:46:51.498789 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:46:51.500369 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:46:51.509716 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:46:51.511115 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:46:51.516530 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:46:51.519909 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:46:51.522247 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:46:51.527732 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:46:51.529558 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:46:51.531444 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:46:51.548937 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:46:51.556081 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:46:51.568397 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:46:51.570092 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:46:51.581835 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:46:51.598409 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:46:51.599970 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:46:51.601562 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:46:51.604067 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:46:51.607037 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m04:46:51.609854 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m04:46:51.611194 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m04:46:51.613156 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m04:46:51.615469 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m04:46:51.617515 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m04:46:51.620933 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m04:46:51.623226 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m04:46:51.624514 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m04:46:51.626351 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m04:46:51.628835 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m04:46:51.637542 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m04:46:51.639435 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m04:46:51.643000 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m04:46:51.645245 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m04:46:51.646735 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m04:46:51.648527 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m04:46:51.650196 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m04:46:51.652095 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:46:51.653146 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m04:46:51.654865 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m04:46:51.656932 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:46:51.662818 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m04:46:51.664143 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:46:51.665318 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:46:51.666651 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:46:51.667740 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:46:51.669579 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:46:51.672549 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:46:51.674006 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m04:46:51.675910 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:46:51.678206 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:46:51.683518 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:46:51.684639 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:46:51.690509 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:46:51.693977 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m04:46:51.696569 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m04:46:51.705417 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:46:51.707483 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:46:51.710837 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:46:51.712410 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:46:51.713457 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:46:51.723206 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m04:46:51.726010 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:46:51.727776 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:46:51.729104 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:46:51.730585 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:46:51.732095 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:46:51.734270 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:46:51.735949 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:46:51.738564 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:46:51.739847 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:46:51.741005 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:46:51.742190 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:46:51.743462 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:46:51.767953 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:46:51.771405 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:46:51.775672 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m04:46:51.778560 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:46:51.782827 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:46:51.785176 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:46:51.791160 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m04:46:51.792846 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:46:51.794256 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:46:51.805456 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m04:46:51.812661 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:46:51.816790 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:46:51.821449 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:46:51.823202 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:46:51.824892 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:46:51.832821 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:46:51.838489 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:46:51.841871 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:46:51.843641 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:46:51.851639 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:46:51.855327 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:46:51.861815 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m04:46:51.870681 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m04:46:51.876755 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m04:46:51.881018 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m04:46:52.376011 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m04:46:52.388223 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m04:46:52.390717 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m04:46:52.393102 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m04:46:52.395694 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m04:46:52.398124 [debug] [MainThread]: 1699: static parser successfully parsed marts/product_details.sql
[0m04:46:52.400639 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers.sql
[0m04:46:52.403238 [debug] [MainThread]: 1699: static parser successfully parsed marts/order_details.sql
[0m04:46:52.405989 [debug] [MainThread]: 1699: static parser successfully parsed marts/daily_revenue_by_product.sql
[0m04:46:52.498530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaae961dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaae31ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaae31ba90>]}


============================== 2022-08-08 04:47:21.948869 | d647ff61-22ba-4d7c-8f1e-03ed0d1c2d77 ==============================
[0m04:47:21.948883 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:47:21.949370 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:47:21.949660 [debug] [MainThread]: Tracking: tracking
[0m04:47:21.954058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f9eb1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f9eb93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f9eb97c0>]}
[0m04:47:22.272864 [debug] [MainThread]: Executing "git --help"
[0m04:47:22.278517 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:47:22.279118 [debug] [MainThread]: STDERR: "b''"
[0m04:47:22.284004 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m04:47:22.284999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:47:31.298630 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m04:47:31.299602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f82c9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f82dd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f82ddd00>]}
[0m04:47:31.637665 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-08 04:48:27.701851 | 0bfd8198-71ce-475a-8e22-b85b11acea42 ==============================
[0m04:48:27.701863 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:48:27.702373 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:48:27.702661 [debug] [MainThread]: Tracking: tracking
[0m04:48:27.707055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043a2dfb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043a2e8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043a2e8790>]}
[0m04:48:28.018087 [debug] [MainThread]: Executing "git --help"
[0m04:48:28.024288 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:48:28.024840 [debug] [MainThread]: STDERR: "b''"
[0m04:48:28.029368 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m04:48:28.030153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:48:28.813150 [debug] [MainThread]: On debug: select 1 as id
[0m04:48:29.658715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043874a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043a2e8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043c1b00d0>]}
[0m04:48:30.056039 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-08 04:48:47.530054 | 58d4dc58-11f0-428e-9ad9-d2fbd27b560a ==============================
[0m04:48:47.530089 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:48:47.530998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['order_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:48:47.531350 [debug] [MainThread]: Tracking: tracking
[0m04:48:47.536229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca864ce0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca864cef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca864ce820>]}
[0m04:48:47.603725 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:48:47.604202 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:48:47.604643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58d4dc58-11f0-428e-9ad9-d2fbd27b560a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca8642f1c0>]}
[0m04:48:47.639237 [debug] [MainThread]: Parsing macros/etc.sql
[0m04:48:47.642038 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:48:47.666765 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:48:47.672369 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:48:47.675083 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:48:47.675651 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:48:47.676114 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:48:47.676722 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:48:47.677444 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:48:47.678106 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:48:47.678858 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:48:47.679324 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:48:47.680715 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:48:47.681859 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:48:47.682500 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:48:47.683808 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:48:47.684424 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:48:47.685049 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m04:48:47.687693 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m04:48:47.689483 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m04:48:47.694358 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m04:48:47.697226 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m04:48:47.712936 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m04:48:47.715787 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:48:47.716772 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:48:47.717584 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:48:47.718807 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:48:47.720278 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:48:47.723033 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:48:47.736774 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:48:47.743852 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:48:47.758125 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:48:47.762747 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:48:47.772385 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:48:47.775424 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:48:47.777728 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:48:47.778828 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:48:47.780160 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:48:47.781198 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:48:47.782540 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:48:47.788206 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:48:47.789171 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:48:47.790495 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:48:47.791810 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:48:47.792958 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:48:47.794076 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:48:47.795249 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:48:47.796164 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:48:47.798263 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:48:47.800165 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:48:47.802627 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:48:47.803868 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:48:47.804913 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:48:47.806260 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:48:47.807300 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:48:47.808471 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:48:47.809611 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:48:47.818555 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:48:47.823471 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:48:47.825971 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:48:47.829829 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:48:47.835465 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:48:47.838424 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:48:47.854096 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:48:47.858658 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:48:47.873613 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:48:47.875206 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:48:47.885158 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:48:47.886593 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:48:47.892154 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:48:47.895563 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:48:47.897932 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:48:47.902490 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:48:47.904337 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:48:47.906220 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:48:47.924306 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:48:47.931360 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:48:47.943604 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:48:47.945317 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:48:47.956870 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:48:47.973282 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:48:47.974880 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:48:47.976498 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:48:47.979016 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:48:47.982137 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m04:48:47.985065 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m04:48:47.986412 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m04:48:47.987923 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m04:48:47.990265 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m04:48:47.992335 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m04:48:47.995268 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m04:48:47.997520 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m04:48:47.998855 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m04:48:48.000689 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m04:48:48.003241 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m04:48:48.012083 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m04:48:48.014042 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m04:48:48.018134 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m04:48:48.020464 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m04:48:48.021984 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m04:48:48.024181 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m04:48:48.025879 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m04:48:48.027834 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:48:48.028897 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m04:48:48.030709 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m04:48:48.032840 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:48:48.038719 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m04:48:48.040069 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:48:48.041278 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:48:48.042623 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:48:48.043757 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:48:48.045645 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:48:48.048653 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:48:48.050145 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m04:48:48.052018 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:48:48.054313 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:48:48.059486 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:48:48.060644 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:48:48.066636 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:48:48.070143 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m04:48:48.073049 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m04:48:48.082048 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:48:48.084088 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:48:48.087577 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:48:48.089177 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:48:48.090199 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:48:48.100305 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m04:48:48.103114 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:48:48.104806 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:48:48.106155 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:48:48.107622 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:48:48.109146 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:48:48.111268 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:48:48.112911 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:48:48.115558 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:48:48.116850 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:48:48.118091 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:48:48.119341 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:48:48.120613 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:48:48.145316 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:48:48.148933 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:48:48.153216 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m04:48:48.156240 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:48:48.160477 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:48:48.162897 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:48:48.169266 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m04:48:48.171062 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:48:48.172501 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:48:48.185046 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m04:48:48.195376 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:48:48.199415 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:48:48.203646 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:48:48.205385 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:48:48.207136 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:48:48.215256 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:48:48.221513 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:48:48.225448 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:48:48.227236 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:48:48.230776 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:48:48.232572 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:48:48.238957 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m04:48:48.247877 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m04:48:48.254002 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m04:48:48.258231 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m04:48:48.913041 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m04:48:48.925403 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m04:48:48.927964 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m04:48:48.930450 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m04:48:48.933159 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m04:48:48.935693 [debug] [MainThread]: 1699: static parser successfully parsed marts/product_details.sql
[0m04:48:48.938274 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers.sql
[0m04:48:48.940935 [debug] [MainThread]: 1699: static parser successfully parsed marts/order_details.sql
[0m04:48:48.943792 [debug] [MainThread]: 1699: static parser successfully parsed marts/daily_revenue_by_product.sql
[0m04:48:49.031355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca863e6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca85e0db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca8639da30>]}


============================== 2022-08-08 04:53:00.628675 | c5399e54-a6a5-4025-b770-a84629c088a9 ==============================
[0m04:53:00.628733 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:53:00.629827 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:53:00.630189 [debug] [MainThread]: Tracking: tracking
[0m04:53:00.652907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d155a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d155adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d155a6d0>]}
[0m04:53:00.779493 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:53:00.780126 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:53:00.780578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5399e54-a6a5-4025-b770-a84629c088a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d14ee460>]}
[0m04:53:00.835802 [debug] [MainThread]: Parsing macros/etc.sql
[0m04:53:00.840529 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:53:00.886576 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:53:00.897983 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:53:00.904930 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:53:00.907953 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:53:00.908935 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:53:00.911180 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:53:00.912466 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:53:00.913588 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:53:00.915312 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:53:00.916833 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:53:00.925506 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:53:00.931669 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:53:00.933214 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:53:00.937102 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:53:00.938390 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:53:00.939942 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m04:53:00.947082 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m04:53:00.951529 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m04:53:00.963465 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m04:53:00.968792 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m04:53:00.999076 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m04:53:01.015764 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:53:01.017556 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:53:01.019071 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:53:01.020560 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:53:01.023100 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:53:01.028052 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:53:01.059191 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:53:01.072149 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:53:01.099366 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:53:01.107755 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:53:01.125920 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:53:01.131507 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:53:01.135624 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:53:01.137553 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:53:01.139552 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:53:01.141544 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:53:01.143961 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:53:01.154563 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:53:01.156168 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:53:01.158459 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:53:01.160834 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:53:01.162824 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:53:01.164795 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:53:01.166898 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:53:01.168446 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:53:01.172341 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:53:01.175802 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:53:01.180410 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:53:01.182495 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:53:01.184225 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:53:01.186652 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:53:01.188630 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:53:01.190731 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:53:01.192822 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:53:01.209057 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:53:01.218558 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:53:01.223065 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:53:01.230174 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:53:01.241797 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:53:01.247381 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:53:01.280993 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:53:01.292014 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:53:01.328655 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:53:01.331649 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:53:01.363444 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:53:01.367241 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:53:01.385315 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:53:01.396676 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:53:01.401329 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:53:01.426295 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:53:01.429678 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:53:01.438449 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:53:01.479457 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:53:01.493153 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:53:01.517887 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:53:01.521006 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:53:01.543076 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:53:01.575720 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:53:01.578614 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:53:01.581570 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:53:01.586252 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:53:01.591913 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m04:53:01.597734 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m04:53:01.600096 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m04:53:01.602854 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m04:53:01.607054 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m04:53:01.610803 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m04:53:01.616271 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m04:53:01.620356 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m04:53:01.622653 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m04:53:01.626025 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m04:53:01.631008 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m04:53:01.647882 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m04:53:01.651414 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m04:53:01.658075 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m04:53:01.662416 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m04:53:01.671759 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m04:53:01.676872 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m04:53:01.680068 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m04:53:01.683558 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:53:01.685682 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m04:53:01.688835 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m04:53:01.692859 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:53:01.703870 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m04:53:01.706262 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:53:01.708369 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:53:01.710653 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:53:01.712625 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:53:01.716145 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:53:01.721704 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:53:01.724497 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m04:53:01.727942 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:53:01.732165 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:53:01.742196 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:53:01.744353 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:53:01.755620 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:53:01.762475 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m04:53:01.766723 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m04:53:01.781217 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:53:01.784842 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:53:01.791669 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:53:01.794645 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:53:01.796688 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:53:01.815809 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m04:53:01.821064 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:53:01.824221 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:53:01.826670 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:53:01.829290 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:53:01.832122 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:53:01.836081 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:53:01.839128 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:53:01.844088 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:53:01.846401 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:53:01.848501 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:53:01.850593 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:53:01.852829 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:53:01.898094 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:53:01.904659 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:53:01.913087 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m04:53:01.918456 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:53:01.926401 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:53:01.930817 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:53:01.942580 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m04:53:01.945720 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:53:01.948265 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:53:01.969992 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m04:53:01.983506 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:53:01.990856 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:53:01.999825 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:53:02.003050 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:53:02.006135 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:53:02.021412 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:53:02.033629 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:53:02.040276 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:53:02.043600 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:53:02.050336 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:53:02.053477 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:53:02.065863 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m04:53:02.083348 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql


============================== 2022-08-08 04:53:02.089565 | ed77695b-f30e-4e5a-bfac-04c86efe8fd0 ==============================
[0m04:53:02.089615 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:53:02.091337 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['order_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:53:02.091707 [debug] [MainThread]: Tracking: tracking
[0m04:53:02.094339 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m04:53:02.099365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6539650280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6539650670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6539650d90>]}
[0m04:53:02.110408 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m04:53:02.196076 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:53:02.197022 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:53:02.197626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed77695b-f30e-4e5a-bfac-04c86efe8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65395b3c70>]}
[0m04:53:02.258043 [debug] [MainThread]: Parsing macros/etc.sql
[0m04:53:02.262810 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:53:02.318090 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:53:02.329057 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:53:02.334108 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:53:02.335012 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:53:02.335719 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:53:02.336715 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:53:02.337905 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:53:02.338993 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:53:02.340246 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:53:02.340953 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:53:02.343583 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:53:02.345496 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:53:02.346537 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:53:02.348905 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:53:02.349892 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:53:02.350935 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m04:53:02.355929 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m04:53:02.362167 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m04:53:02.372846 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m04:53:02.378388 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m04:53:02.410791 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m04:53:02.417533 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:53:02.420370 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:53:02.421770 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:53:02.423351 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:53:02.425959 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:53:02.431165 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:53:02.457841 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:53:02.471510 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:53:02.501095 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:53:02.509894 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:53:02.528496 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:53:02.534115 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:53:02.538265 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:53:02.540115 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:53:02.542117 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:53:02.543960 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:53:02.546297 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:53:02.557016 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:53:02.558584 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:53:02.560792 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:53:02.563186 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:53:02.565179 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:53:02.567167 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:53:02.569231 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:53:02.570790 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:53:02.574715 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:53:02.578166 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:53:02.582682 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:53:02.584746 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:53:02.586497 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:53:02.588864 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:53:02.590689 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:53:02.592743 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:53:02.594731 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:53:02.612604 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:53:02.623299 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:53:02.627744 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:53:02.635078 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:53:02.645877 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:53:02.651294 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:53:02.682586 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:53:02.692552 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:53:02.720719 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:53:02.723191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:53:02.739879 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:53:02.742191 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:53:02.753435 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:53:02.759950 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:53:02.764313 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:53:02.773113 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:53:02.776737 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:53:02.780180 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:53:02.815898 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:53:02.837225 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:53:02.862645 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:53:02.865775 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:53:02.888554 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:53:02.922845 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:53:02.925603 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:53:02.928554 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:53:02.933174 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:53:02.942376 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m04:53:02.948070 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m04:53:02.950412 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m04:53:02.953106 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m04:53:02.957295 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m04:53:02.960967 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m04:53:02.966286 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m04:53:02.970518 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m04:53:02.972841 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m04:53:02.976251 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m04:53:02.981046 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m04:53:02.999085 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m04:53:03.002592 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m04:53:03.009388 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m04:53:03.013697 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m04:53:03.016414 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m04:53:03.019549 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m04:53:03.022737 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m04:53:03.027317 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:53:03.029159 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m04:53:03.032256 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m04:53:03.036149 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:53:03.047029 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m04:53:03.049369 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:53:03.051542 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:53:03.053906 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:53:03.055878 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:53:03.059381 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:53:03.064899 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:53:03.067793 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m04:53:03.071177 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:53:03.075318 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:53:03.085367 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:53:03.087293 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:53:03.098553 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:53:03.110411 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m04:53:03.117541 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m04:53:03.119312 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m04:53:03.140887 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m04:53:03.145207 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m04:53:03.149469 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m04:53:03.154180 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m04:53:03.158803 [debug] [MainThread]: 1699: static parser successfully parsed marts/product_details.sql
[0m04:53:03.160504 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:53:03.163330 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers.sql
[0m04:53:03.164237 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:53:03.167859 [debug] [MainThread]: 1699: static parser successfully parsed marts/order_details.sql
[0m04:53:03.172468 [debug] [MainThread]: 1699: static parser successfully parsed marts/daily_revenue_by_product.sql
[0m04:53:03.177047 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:53:03.179749 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:53:03.181412 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:53:03.239259 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m04:53:03.243950 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:53:03.248882 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:53:03.260346 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:53:03.262810 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:53:03.265286 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:53:03.268743 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:53:03.297875 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:53:03.302829 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:53:03.305140 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:53:03.307233 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:53:03.309331 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:53:03.311575 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:53:03.357927 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:53:03.364448 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:53:03.372439 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m04:53:03.377624 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:53:03.385434 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:53:03.389786 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:53:03.401585 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m04:53:03.404576 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:53:03.407069 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:53:03.428239 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m04:53:03.441382 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:53:03.448666 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:53:03.456586 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:53:03.459647 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:53:03.462686 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:53:03.478164 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:53:03.488917 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:53:03.496192 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:53:03.499344 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:53:03.505809 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:53:03.508855 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:53:03.520892 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m04:53:03.535076 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m04:53:03.535210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m04:53:03.546844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5399e54-a6a5-4025-b770-a84629c088a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d0d1f0d0>]}
[0m04:53:03.548565 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m04:53:03.556210 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m04:53:03.572579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5399e54-a6a5-4025-b770-a84629c088a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d12e4c70>]}
[0m04:53:03.573161 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m04:53:03.573621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5399e54-a6a5-4025-b770-a84629c088a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d14c1f70>]}
[0m04:53:03.575427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d138f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d14c1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d14b17f0>]}
[0m04:53:04.214967 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m04:53:04.228055 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m04:53:04.230582 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m04:53:04.233044 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m04:53:04.235615 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m04:53:04.238097 [debug] [MainThread]: 1699: static parser successfully parsed marts/product_details.sql
[0m04:53:04.240591 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers.sql
[0m04:53:04.243187 [debug] [MainThread]: 1699: static parser successfully parsed marts/order_details.sql
[0m04:53:04.245923 [debug] [MainThread]: 1699: static parser successfully parsed marts/daily_revenue_by_product.sql
[0m04:53:04.480885 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m04:53:04.491515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed77695b-f30e-4e5a-bfac-04c86efe8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6538da50d0>]}
[0m04:53:04.513024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed77695b-f30e-4e5a-bfac-04c86efe8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65394f32e0>]}
[0m04:53:04.513556 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m04:53:04.514297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed77695b-f30e-4e5a-bfac-04c86efe8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65395b3100>]}
[0m04:53:04.516163 [info ] [MainThread]: 
[0m04:53:04.516741 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:53:04.517501 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m04:53:04.517820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:53:05.473988 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m04:53:05.474468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:53:05.639162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed77695b-f30e-4e5a-bfac-04c86efe8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6538e82ca0>]}
[0m04:53:05.639954 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m04:53:05.640346 [info ] [MainThread]: 
[0m04:53:05.658688 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.order_details
[0m04:53:05.659085 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.order_details ............................... [RUN]
[0m04:53:05.659678 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m04:53:05.659887 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.order_details
[0m04:53:05.660103 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.order_details
[0m04:53:05.669450 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m04:53:05.671642 [debug] [Thread-1  ]: finished collecting timing info
[0m04:53:05.671880 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.order_details
[0m04:53:05.706847 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m04:53:05.707408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:53:05.707691 [debug] [Thread-1  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),


    order_details as (
       
        select 
            orders.*,
            order_items.product_id,
            products.* except(id),
            product_prices.* except(id, product_id, price_started_at, price_ended_at, is_row_active)
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at between product_prices.price_started_at and product_prices.price_ended_at

    )

    select *
    from order_details;


[0m04:53:06.430484 [debug] [Thread-1  ]: finished collecting timing info
[0m04:53:06.431057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed77695b-f30e-4e5a-bfac-04c86efe8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6538d49ac0>]}
[0m04:53:06.431472 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.order_details .......................... [[32mOK[0m in 0.77s]
[0m04:53:06.432000 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.order_details
[0m04:53:06.433436 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:53:06.433847 [info ] [MainThread]: 
[0m04:53:06.434169 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m04:53:06.434541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:53:06.434717 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m04:53:06.447119 [info ] [MainThread]: 
[0m04:53:06.447447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:53:06.447823 [info ] [MainThread]: 
[0m04:53:06.448131 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:53:06.448550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6538da51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6538da5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6538e82ca0>]}


============================== 2022-08-08 05:02:25.424836 | ac6b74d0-1a71-4a22-9c45-c3821210c3dc ==============================
[0m05:02:25.424869 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:02:25.425620 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:02:25.425896 [debug] [MainThread]: Tracking: tracking
[0m05:02:25.430830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e25e9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e25e9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e25e9970>]}
[0m05:02:25.547205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:02:25.547822 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m05:02:25.563905 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m05:02:25.598085 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:02:25.604625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac6b74d0-1a71-4a22-9c45-c3821210c3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e1ed1f10>]}
[0m05:02:25.618521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac6b74d0-1a71-4a22-9c45-c3821210c3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e236bfd0>]}
[0m05:02:25.618917 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:02:25.619193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac6b74d0-1a71-4a22-9c45-c3821210c3dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e2343340>]}
[0m05:02:25.620167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e23433a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e236bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e236b5b0>]}


============================== 2022-08-08 05:02:32.247978 | 214e8187-fb8d-4b86-b317-d3cc33b7eac9 ==============================
[0m05:02:32.248017 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:02:32.248790 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:02:32.249067 [debug] [MainThread]: Tracking: tracking
[0m05:02:32.254192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933a25b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933a25bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933a25ba90>]}
[0m05:02:32.366795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:02:32.367418 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/order_details.sql
[0m05:02:32.383024 [debug] [MainThread]: 1699: static parser successfully parsed marts/order_details.sql
[0m05:02:32.404631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:02:32.411135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '214e8187-fb8d-4b86-b317-d3cc33b7eac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9339b880d0>]}
[0m05:02:32.425417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '214e8187-fb8d-4b86-b317-d3cc33b7eac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9339b9bf70>]}
[0m05:02:32.425835 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:02:32.426113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214e8187-fb8d-4b86-b317-d3cc33b7eac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933a019f40>]}
[0m05:02:32.427092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933a019fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9339b9b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933a0eed90>]}


============================== 2022-08-08 05:04:47.832145 | 598cb155-5735-44bf-a4cb-f585ae6e0a08 ==============================
[0m05:04:47.832197 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:04:47.833422 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:04:47.833837 [debug] [MainThread]: Tracking: tracking
[0m05:04:47.853302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46e424730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46e424f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46e424ac0>]}
[0m05:04:48.031245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:04:48.032195 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/order_details.sql


============================== 2022-08-08 05:04:48.038141 | b3c77d97-859f-4d4c-913f-7f8c7eabf2c9 ==============================
[0m05:04:48.038202 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:04:48.039287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['order_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:04:48.039580 [debug] [MainThread]: Tracking: tracking
[0m05:04:48.059432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d658280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d658670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d658d90>]}
[0m05:04:48.068537 [debug] [MainThread]: 1699: static parser successfully parsed marts/order_details.sql
[0m05:04:48.106455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:04:48.119285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '598cb155-5735-44bf-a4cb-f585ae6e0a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46dd710d0>]}
[0m05:04:48.141389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '598cb155-5735-44bf-a4cb-f585ae6e0a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46dd63f70>]}
[0m05:04:48.142004 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:04:48.142515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598cb155-5735-44bf-a4cb-f585ae6e0a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46e1e3f70>]}
[0m05:04:48.144061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46e1e3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46dd63190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46e2662e0>]}
[0m05:04:48.197519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:04:48.197895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:04:48.198893 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:04:48.209021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3c77d97-859f-4d4c-913f-7f8c7eabf2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d38b0d0>]}
[0m05:04:48.224131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3c77d97-859f-4d4c-913f-7f8c7eabf2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d476e50>]}
[0m05:04:48.224507 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:04:48.224832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3c77d97-859f-4d4c-913f-7f8c7eabf2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d3d2040>]}
[0m05:04:48.226470 [info ] [MainThread]: 
[0m05:04:48.227067 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:04:48.227961 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:04:48.228321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:04:49.490254 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:04:49.490726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:49.657863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3c77d97-859f-4d4c-913f-7f8c7eabf2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d476c70>]}
[0m05:04:49.658687 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:04:49.659089 [info ] [MainThread]: 
[0m05:04:49.664330 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.order_details
[0m05:04:49.664853 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.order_details ............................... [RUN]
[0m05:04:49.665738 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m05:04:49.666376 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.order_details
[0m05:04:49.666611 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.order_details
[0m05:04:49.671721 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m05:04:49.672476 [debug] [Thread-1  ]: finished collecting timing info
[0m05:04:49.672697 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.order_details
[0m05:04:49.705996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m05:04:49.706848 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:04:49.707133 [debug] [Thread-1  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),


    order_details as (
       
        select 
            orders.*,
            order_items.product_id,
            products.name as product_name,
            products.category as product_category,
            products.product_available_on,
            product_prices.* except(id, product_id, price_started_at, price_ended_at)
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at >= product_prices.price_started_at and 
            orders.created_at < product_prices.price_ended_at

    )

    select 
        id,
        created_at,
        created_on,
        year_of, 
        month_of,
        week_of,
        day_of_week_name,
        customer_id,
        state,
        address,
        zip,
        product_name,
        product_category,
        product_available_on,
        price_usd
    from order_details;


[0m05:04:50.451455 [debug] [Thread-1  ]: finished collecting timing info
[0m05:04:50.452012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c77d97-859f-4d4c-913f-7f8c7eabf2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d38b190>]}
[0m05:04:50.452431 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.order_details .......................... [[32mOK[0m in 0.79s]
[0m05:04:50.452966 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.order_details
[0m05:04:50.454490 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:04:50.454911 [info ] [MainThread]: 
[0m05:04:50.455225 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m05:04:50.455553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:04:50.455741 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m05:04:50.468122 [info ] [MainThread]: 
[0m05:04:50.468465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:04:50.468869 [info ] [MainThread]: 
[0m05:04:50.469178 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:04:50.469601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d33eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d38b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40d30ca60>]}


============================== 2022-08-08 05:26:18.663353 | 7ba3e14f-fe9f-486f-add0-22f5f38407b7 ==============================
[0m05:26:18.663388 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:26:18.664114 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:26:18.664424 [debug] [MainThread]: Tracking: tracking
[0m05:26:18.673532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc25748b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc2574670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc25746d0>]}
[0m05:26:18.795448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:26:18.795785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:26:18.796596 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:26:18.808004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ba3e14f-fe9f-486f-add0-22f5f38407b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc22fe0d0>]}
[0m05:26:18.821063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ba3e14f-fe9f-486f-add0-22f5f38407b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc23d3370>]}
[0m05:26:18.821427 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:26:18.821713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ba3e14f-fe9f-486f-add0-22f5f38407b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc23d30a0>]}
[0m05:26:18.822646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc23d31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc23d30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc23d32b0>]}


============================== 2022-08-08 05:27:38.952943 | b0070940-be48-4506-ae3d-ac6e76370772 ==============================
[0m05:27:38.952977 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:27:38.953792 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:27:38.954128 [debug] [MainThread]: Tracking: tracking
[0m05:27:38.958892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30fcf5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30fcf5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30fcf58e0>]}
[0m05:27:39.092744 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m05:27:39.093530 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/weekly_revenue_by_product_category.sql
[0m05:27:39.093881 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/marts/daily_revenue_by_product.sql
[0m05:27:39.121872 [debug] [MainThread]: 1699: static parser successfully parsed marts/weekly_revenue_by_product_category.sql
[0m05:27:39.158332 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:27:39.169822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0070940-be48-4506-ae3d-ac6e76370772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30f5490d0>]}
[0m05:27:39.191476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0070940-be48-4506-ae3d-ac6e76370772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30fcfa5e0>]}
[0m05:27:39.192017 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:27:39.192469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0070940-be48-4506-ae3d-ac6e76370772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30fa4d820>]}
[0m05:27:39.193954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30fa4d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30f5d53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30f5d5400>]}


============================== 2022-08-08 05:27:42.082776 | 78b488be-ab44-406b-8226-e80e8a36effb ==============================
[0m05:27:42.082813 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:27:42.083598 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:27:42.083900 [debug] [MainThread]: Tracking: tracking
[0m05:27:42.088575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b618e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b618e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b618e6a0>]}
[0m05:27:42.182174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:42.182471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:42.183838 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:27:42.192957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78b488be-ab44-406b-8226-e80e8a36effb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b5ebc0d0>]}
[0m05:27:42.206581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78b488be-ab44-406b-8226-e80e8a36effb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b5f0b700>]}
[0m05:27:42.206941 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:27:42.207229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78b488be-ab44-406b-8226-e80e8a36effb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b6118e20>]}
[0m05:27:42.208176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b6118e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b5f0b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b5f0b2b0>]}


============================== 2022-08-08 05:27:46.196082 | 957010fb-7db9-4920-bfae-aa5dec08e10a ==============================
[0m05:27:46.196117 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:27:46.196831 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:27:46.197100 [debug] [MainThread]: Tracking: tracking
[0m05:27:46.201868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b10958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b10956a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b1095700>]}
[0m05:27:46.294786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:46.295068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:46.295837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:27:46.306052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '957010fb-7db9-4920-bfae-aa5dec08e10a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b0e200d0>]}
[0m05:27:46.319332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '957010fb-7db9-4920-bfae-aa5dec08e10a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b0e74520>]}
[0m05:27:46.319701 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:27:46.319980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '957010fb-7db9-4920-bfae-aa5dec08e10a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b0e74250>]}
[0m05:27:46.320951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b0e743a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b0e74250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b0e740a0>]}


============================== 2022-08-08 05:27:53.919012 | 5b2a8673-845e-427d-ae35-50ec5043384c ==============================
[0m05:27:53.919048 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:27:53.920000 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['marts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:27:53.920326 [debug] [MainThread]: Tracking: tracking
[0m05:27:53.928067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209c1ebdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209c1eb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209c1ebcd0>]}
[0m05:27:54.028038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:54.028348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:54.029093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:27:54.038279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b2a8673-845e-427d-ae35-50ec5043384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209bf260d0>]}
[0m05:27:54.055920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b2a8673-845e-427d-ae35-50ec5043384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209c008b80>]}
[0m05:27:54.056502 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:27:54.057053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b2a8673-845e-427d-ae35-50ec5043384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209dd72a00>]}
[0m05:27:54.059725 [info ] [MainThread]: 
[0m05:27:54.060972 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:27:54.062581 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:27:54.063161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:57.095740 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:27:57.096207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:57.282842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b2a8673-845e-427d-ae35-50ec5043384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209bf62eb0>]}
[0m05:27:57.283655 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:27:57.284429 [info ] [MainThread]: 
[0m05:27:57.302775 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m05:27:57.303004 [debug] [Thread-2  ]: Began running node model.coffee_shop_zar.order_details
[0m05:27:57.303943 [info ] [Thread-2  ]: 2 of 4 START view model dbt_lauren.order_details ............................... [RUN]
[0m05:27:57.303598 [info ] [Thread-1  ]: 1 of 4 START table model dbt_lauren.customers .................................. [RUN]
[0m05:27:57.303221 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.product_details
[0m05:27:57.305877 [info ] [Thread-3  ]: 3 of 4 START view model dbt_lauren.product_details ............................. [RUN]
[0m05:27:57.307155 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.product_details"
[0m05:27:57.306391 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m05:27:57.307474 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.product_details
[0m05:27:57.308676 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.product_details
[0m05:27:57.308363 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m05:27:57.313965 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m05:27:57.313694 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.product_details"
[0m05:27:57.305192 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m05:27:57.318200 [debug] [Thread-2  ]: Began compiling node model.coffee_shop_zar.order_details
[0m05:27:57.318406 [debug] [Thread-2  ]: Compiling model.coffee_shop_zar.order_details
[0m05:27:57.317688 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m05:27:57.322341 [debug] [Thread-3  ]: finished collecting timing info
[0m05:27:57.323041 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.product_details
[0m05:27:57.325782 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m05:27:57.325993 [debug] [Thread-1  ]: finished collecting timing info
[0m05:27:57.352592 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m05:27:57.352852 [debug] [Thread-2  ]: finished collecting timing info
[0m05:27:57.374861 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.product_details"
[0m05:27:57.375540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:27:57.375791 [debug] [Thread-2  ]: Began executing node model.coffee_shop_zar.order_details
[0m05:27:57.376387 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:27:57.381876 [debug] [Thread-3  ]: On model.coffee_shop_zar.product_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.product_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`product_details`
  OPTIONS()
  as with 


    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),


    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    product_details as (
        select 
            products.id,
            products.name,
            products.category,
            products.created_at as product_available_at,
            product_prices.price,
            product_prices.created_at as price_started_at,
            product_prices.ended_at as price_ended_at,
            case
                when row_number() over (partition by products.id order by product_prices.created_at desc) = 1
                then true
                else false
            end as is_row_active

        from products
        left join product_prices on 
            products.id = product_prices.product_id
    )

    select *
    from product_details;


[0m05:27:57.381480 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m05:27:57.384486 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:27:57.384755 [debug] [Thread-2  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),


    order_details as (
       
        select 
            orders.*,
            order_items.product_id,
            products.name as product_name,
            products.category as product_category,
            products.product_available_on,
            product_prices.* except(id, product_id, price_started_at, price_ended_at)
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at >= product_prices.price_started_at and 
            orders.created_at < product_prices.price_ended_at

    )

    select 
        id,
        created_at,
        created_on,
        year_of, 
        month_of,
        week_of,
        day_of_week_name,
        customer_id,
        state,
        address,
        zip,
        product_name,
        product_category,
        product_available_on,
        price_usd
    from order_details;


[0m05:27:57.573039 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customers"
[0m05:27:57.573675 [debug] [Thread-1  ]: On model.coffee_shop_zar.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customers"} */


  create or replace table `aec-students`.`dbt_lauren`.`customers`
  
  
  OPTIONS()
  as (
    


/*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club`.`coffee_shop`.`customers`
    ),

    orders as (
      select * from `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as total_orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            ifnull(aggregate_orders.total_orders,0) as total_orders,
            aggregate_orders.first_order_at
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at
  );
  
[0m05:27:58.145490 [debug] [Thread-3  ]: finished collecting timing info
[0m05:27:58.146241 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2a8673-845e-427d-ae35-50ec5043384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209beaedc0>]}
[0m05:27:58.146835 [info ] [Thread-3  ]: 3 of 4 OK created view model dbt_lauren.product_details ........................ [[32mOK[0m in 0.84s]
[0m05:27:58.147993 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.product_details
[0m05:27:58.425664 [debug] [Thread-2  ]: finished collecting timing info
[0m05:27:58.426241 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2a8673-845e-427d-ae35-50ec5043384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209be410a0>]}
[0m05:27:58.426662 [info ] [Thread-2  ]: 2 of 4 OK created view model dbt_lauren.order_details .......................... [[32mOK[0m in 1.12s]
[0m05:27:58.427216 [debug] [Thread-2  ]: Finished running node model.coffee_shop_zar.order_details
[0m05:27:58.428066 [debug] [Thread-5  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:27:58.428390 [info ] [Thread-5  ]: 4 of 4 START view model dbt_lauren.weekly_revenue_by_product_category .......... [RUN]
[0m05:27:58.429155 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m05:27:58.429476 [debug] [Thread-5  ]: Began compiling node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:27:58.430162 [debug] [Thread-5  ]: Compiling model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:27:58.435884 [debug] [Thread-5  ]: Writing injected SQL for node "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m05:27:58.439300 [debug] [Thread-5  ]: finished collecting timing info
[0m05:27:58.439548 [debug] [Thread-5  ]: Began executing node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:27:58.444340 [debug] [Thread-5  ]: Writing runtime SQL for node "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m05:27:58.444759 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m05:27:58.445020 [debug] [Thread-5  ]: On model.coffee_shop_zar.weekly_revenue_by_product_category: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.weekly_revenue_by_product_category"} */


  create or replace view `aec-students`.`dbt_lauren`.`weekly_revenue_by_product_category`
  OPTIONS()
  as with 
    order_details as (
        select *
        from  `aec-students`.`dbt_lauren`.`order_details`
    ),

    weekly_aggregate as (

        select 
          week_of,
          product_category,
          sum(price_usd) as revenue_usd
        from order_details
        group by 
          week_of,
          product_category
    )

    select *
    from weekly_aggregate;


[0m05:27:59.273190 [debug] [Thread-5  ]: finished collecting timing info
[0m05:27:59.273898 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2a8673-845e-427d-ae35-50ec5043384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209be42c10>]}
[0m05:27:59.274463 [info ] [Thread-5  ]: 4 of 4 OK created view model dbt_lauren.weekly_revenue_by_product_category ..... [[32mOK[0m in 0.84s]
[0m05:27:59.276494 [debug] [Thread-5  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:28:03.202694 [debug] [Thread-1  ]: finished collecting timing info
[0m05:28:03.203368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2a8673-845e-427d-ae35-50ec5043384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209be69bb0>]}
[0m05:28:03.203833 [info ] [Thread-1  ]: 1 of 4 OK created table model dbt_lauren.customers ............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 5.90s]
[0m05:28:03.204408 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m05:28:03.206377 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:28:03.206833 [info ] [MainThread]: 
[0m05:28:03.207233 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m05:28:03.207668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:28:03.207905 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customers' was properly closed.
[0m05:28:03.208083 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m05:28:03.208251 [debug] [MainThread]: Connection 'model.coffee_shop_zar.product_details' was properly closed.
[0m05:28:03.208419 [debug] [MainThread]: Connection 'model.coffee_shop_zar.weekly_revenue_by_product_category' was properly closed.
[0m05:28:03.223180 [info ] [MainThread]: 
[0m05:28:03.223563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:28:03.224126 [info ] [MainThread]: 
[0m05:28:03.224607 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:28:03.225432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209bf0fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209bf0f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209be33b80>]}


============================== 2022-08-08 05:36:53.063414 | 25f3cfc1-8263-45df-ad9a-111e6bd75f5c ==============================
[0m05:36:53.063447 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:36:53.064171 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:36:53.064457 [debug] [MainThread]: Tracking: tracking
[0m05:36:53.069320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2ea23340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d305ab220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d305ab760>]}
[0m05:36:53.197856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:36:53.198308 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/weekly_revenue_by_new_existing_customers.sql
[0m05:36:53.213127 [debug] [MainThread]: 1699: static parser successfully parsed marts/weekly_revenue_by_new_existing_customers.sql
[0m05:36:53.237780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:36:53.251049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25f3cfc1-8263-45df-ad9a-111e6bd75f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2e3020d0>]}
[0m05:36:53.264845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25f3cfc1-8263-45df-ad9a-111e6bd75f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2e2f1220>]}
[0m05:36:53.265212 [info ] [MainThread]: Found 10 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:36:53.265569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f3cfc1-8263-45df-ad9a-111e6bd75f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2e2f1190>]}
[0m05:36:53.266508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2e2f1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2e2ff550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2e79ae80>]}


============================== 2022-08-08 05:37:38.806028 | f4b1a75f-9858-468d-bdab-7cdf341bc40e ==============================
[0m05:37:38.806060 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:37:38.806841 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:37:38.807163 [debug] [MainThread]: Tracking: tracking
[0m05:37:38.811942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ee101280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39efc87a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39efc873a0>]}
[0m05:37:38.932043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:37:38.932610 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/weekly_revenue_by_new_existing_customers.sql
[0m05:37:38.948136 [debug] [MainThread]: 1699: static parser successfully parsed marts/weekly_revenue_by_new_existing_customers.sql
[0m05:37:38.969107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:37:38.976370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4b1a75f-9858-468d-bdab-7cdf341bc40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ed9b30d0>]}
[0m05:37:38.990524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4b1a75f-9858-468d-bdab-7cdf341bc40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ee067040>]}
[0m05:37:38.990961 [info ] [MainThread]: Found 10 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:37:38.991253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b1a75f-9858-468d-bdab-7cdf341bc40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ee0674c0>]}
[0m05:37:38.992220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ee067970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ed9de1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ed9dfca0>]}


============================== 2022-08-08 05:37:42.353524 | 6933e972-6090-441f-9940-d91bc042fd7d ==============================
[0m05:37:42.353558 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:37:42.354490 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:37:42.355750 [debug] [MainThread]: Tracking: tracking
[0m05:37:42.361724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a8dae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a8da3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a8da9d0>]}
[0m05:37:42.454683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:37:42.454938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:37:42.455681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:37:42.466060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a667fd0>]}
[0m05:37:42.480215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a7652e0>]}
[0m05:37:42.480632 [info ] [MainThread]: Found 10 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:37:42.480993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a765070>]}
[0m05:37:42.483528 [info ] [MainThread]: 
[0m05:37:42.484354 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:37:42.486008 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:37:42.486476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:45.332330 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:37:45.332790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:37:45.525780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a89da30>]}
[0m05:37:45.526802 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:37:45.527354 [info ] [MainThread]: 
[0m05:37:45.560730 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m05:37:45.560971 [debug] [Thread-2  ]: Began running node model.coffee_shop_zar.product_details
[0m05:37:45.561170 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m05:37:45.562892 [info ] [Thread-3  ]: 3 of 10 START view model dbt_lauren.stg_coffee_shop__order_items ............... [RUN]
[0m05:37:45.563512 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m05:37:45.562082 [info ] [Thread-1  ]: 1 of 10 START table model dbt_lauren.customers ................................. [RUN]
[0m05:37:45.562281 [debug] [Thread-6  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__products
[0m05:37:45.562593 [info ] [Thread-2  ]: 2 of 10 START view model dbt_lauren.product_details ............................ [RUN]
[0m05:37:45.561470 [debug] [Thread-4  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m05:37:45.561755 [debug] [Thread-5  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m05:37:45.566634 [info ] [Thread-5  ]: 5 of 10 START view model dbt_lauren.stg_coffee_shop__product_prices ............ [RUN]
[0m05:37:45.564791 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m05:37:45.565092 [info ] [Thread-6  ]: 6 of 10 START view model dbt_lauren.stg_coffee_shop__products .................. [RUN]
[0m05:37:45.566165 [info ] [Thread-4  ]: 4 of 10 START view model dbt_lauren.stg_coffee_shop__orders .................... [RUN]
[0m05:37:45.569665 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m05:37:45.569941 [debug] [Thread-4  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__orders
[0m05:37:45.567732 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m05:37:45.570453 [debug] [Thread-5  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m05:37:45.568741 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__products"
[0m05:37:45.572019 [debug] [Thread-6  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__products
[0m05:37:45.572222 [debug] [Thread-6  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__products
[0m05:37:45.567065 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop_zar.product_details"
[0m05:37:45.579840 [debug] [Thread-2  ]: Began compiling node model.coffee_shop_zar.product_details
[0m05:37:45.580117 [debug] [Thread-2  ]: Compiling model.coffee_shop_zar.product_details
[0m05:37:45.564018 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m05:37:45.586173 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__order_items
[0m05:37:45.571737 [debug] [Thread-5  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m05:37:45.567972 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m05:37:45.585906 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop_zar.product_details"
[0m05:37:45.598359 [debug] [Thread-2  ]: finished collecting timing info
[0m05:37:45.570188 [debug] [Thread-4  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__orders
[0m05:37:45.591384 [debug] [Thread-5  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m05:37:45.592018 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m05:37:45.597860 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m05:37:45.598643 [debug] [Thread-2  ]: Began executing node model.coffee_shop_zar.product_details
[0m05:37:45.579475 [debug] [Thread-6  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__products"
[0m05:37:45.601769 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m05:37:45.605345 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m05:37:45.605996 [debug] [Thread-5  ]: finished collecting timing info
[0m05:37:45.622308 [debug] [Thread-3  ]: finished collecting timing info
[0m05:37:45.632769 [debug] [Thread-6  ]: finished collecting timing info
[0m05:37:45.641271 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop_zar.product_details"
[0m05:37:45.641814 [debug] [Thread-5  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m05:37:45.642163 [debug] [Thread-4  ]: finished collecting timing info
[0m05:37:45.642432 [debug] [Thread-1  ]: finished collecting timing info
[0m05:37:45.647257 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m05:37:45.642854 [debug] [Thread-6  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__products
[0m05:37:45.646605 [debug] [Thread-5  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m05:37:45.646946 [debug] [Thread-4  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__orders
[0m05:37:45.642633 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m05:37:45.647488 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:37:45.661142 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:37:45.664545 [debug] [Thread-6  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__products"
[0m05:37:45.668224 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m05:37:45.668419 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m05:37:45.671727 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m05:37:45.672039 [debug] [Thread-2  ]: On model.coffee_shop_zar.product_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.product_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`product_details`
  OPTIONS()
  as with 


    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),


    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    product_details as (
        select 
            products.id,
            products.name,
            products.category,
            products.created_at as product_available_at,
            product_prices.price,
            product_prices.created_at as price_started_at,
            product_prices.ended_at as price_ended_at,
            case
                when row_number() over (partition by products.id order by product_prices.created_at desc) = 1
                then true
                else false
            end as is_row_active

        from products
        left join product_prices on 
            products.id = product_prices.product_id
    )

    select *
    from product_details;


[0m05:37:45.674259 [debug] [Thread-5  ]: On model.coffee_shop_zar.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__product_prices"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
  OPTIONS()
  as with 

    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    renamed as (
        select 
            id,
            product_id,
            price as price_usd,
            created_at as price_started_at,
            ended_at as price_ended_at
        from product_prices
    )

    select *
    from renamed;


[0m05:37:45.675263 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:37:45.679687 [debug] [Thread-3  ]: On model.coffee_shop_zar.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__order_items"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
  OPTIONS()
  as with source as (

    select * from `analytics-engineers-club`.`coffee_shop`.`order_items`

),

renamed as (

    select
        id,
        order_id,
        product_id
    from source

)

select * from renamed;


[0m05:37:45.675794 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m05:37:45.675587 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:37:45.682035 [debug] [Thread-6  ]: On model.coffee_shop_zar.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__products"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
  OPTIONS()
  as with 
    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),

    renamed as (
        select 
            id,
            name,
            category,
            created_at as product_available_on
        from products

    )

    select *
    from renamed;


[0m05:37:45.682601 [debug] [Thread-4  ]: On model.coffee_shop_zar.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    renamed as (

        select 
            id,
            created_at as created_at,
            date(created_at) as created_on,
            extract(year from date(created_at)) as year_of,
            date_trunc(date(created_at), month) as month_of,
            date_trunc(date(created_at), week(MONDAY)) as week_of,
            case extract(dayofweek from date(created_at)) 
                when 1 then "Sunday"
                when 2 then "Monday"
                when 3 then "Tuesday"
                when 4 then "Wednesday"
                when 5 then "Thursday"
                when 6 then "Friday"
                when 7 then "Saturday"
            end as day_of_week_name,
            customer_id,
            total as total_amount_usd,
            state,
            address,
            zip
        from orders

    )

    select *
    from renamed;


[0m05:37:45.870763 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customers"
[0m05:37:45.871314 [debug] [Thread-1  ]: On model.coffee_shop_zar.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customers"} */


  create or replace table `aec-students`.`dbt_lauren`.`customers`
  
  
  OPTIONS()
  as (
    


/*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club`.`coffee_shop`.`customers`
    ),

    orders as (
      select * from `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as total_orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            ifnull(aggregate_orders.total_orders,0) as total_orders,
            aggregate_orders.first_order_at
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at
  );
  
[0m05:37:46.412962 [debug] [Thread-5  ]: finished collecting timing info
[0m05:37:46.413563 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a5f6f40>]}
[0m05:37:46.414018 [info ] [Thread-5  ]: 5 of 10 OK created view model dbt_lauren.stg_coffee_shop__product_prices ....... [[32mOK[0m in 0.85s]
[0m05:37:46.414919 [debug] [Thread-5  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m05:37:46.422710 [debug] [Thread-3  ]: finished collecting timing info
[0m05:37:46.423203 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a5f6b80>]}
[0m05:37:46.423622 [info ] [Thread-3  ]: 3 of 10 OK created view model dbt_lauren.stg_coffee_shop__order_items .......... [[32mOK[0m in 0.86s]
[0m05:37:46.424161 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m05:37:46.428516 [debug] [Thread-2  ]: finished collecting timing info
[0m05:37:46.428977 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a5f69a0>]}
[0m05:37:46.429423 [info ] [Thread-2  ]: 2 of 10 OK created view model dbt_lauren.product_details ....................... [[32mOK[0m in 0.86s]
[0m05:37:46.429936 [debug] [Thread-2  ]: Finished running node model.coffee_shop_zar.product_details
[0m05:37:46.450662 [debug] [Thread-4  ]: finished collecting timing info
[0m05:37:46.451146 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a5f6d60>]}
[0m05:37:46.451567 [info ] [Thread-4  ]: 4 of 10 OK created view model dbt_lauren.stg_coffee_shop__orders ............... [[32mOK[0m in 0.88s]
[0m05:37:46.452319 [debug] [Thread-4  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m05:37:46.681737 [debug] [Thread-6  ]: finished collecting timing info
[0m05:37:46.683910 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a5fe9d0>]}
[0m05:37:46.684678 [info ] [Thread-6  ]: 6 of 10 OK created view model dbt_lauren.stg_coffee_shop__products ............. [[32mOK[0m in 1.11s]
[0m05:37:46.685555 [debug] [Thread-6  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__products
[0m05:37:46.686223 [debug] [Thread-8  ]: Began running node model.coffee_shop_zar.order_details
[0m05:37:46.686682 [info ] [Thread-8  ]: 7 of 10 START view model dbt_lauren.order_details .............................. [RUN]
[0m05:37:46.687960 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m05:37:46.688279 [debug] [Thread-8  ]: Began compiling node model.coffee_shop_zar.order_details
[0m05:37:46.688547 [debug] [Thread-8  ]: Compiling model.coffee_shop_zar.order_details
[0m05:37:46.698116 [debug] [Thread-8  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m05:37:46.699075 [debug] [Thread-8  ]: finished collecting timing info
[0m05:37:46.699479 [debug] [Thread-8  ]: Began executing node model.coffee_shop_zar.order_details
[0m05:37:46.705121 [debug] [Thread-8  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m05:37:46.705983 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m05:37:46.706429 [debug] [Thread-8  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),


    order_details as (
       
        select 
            orders.*,
            order_items.product_id,
            products.name as product_name,
            products.category as product_category,
            products.product_available_on,
            product_prices.* except(id, product_id, price_started_at, price_ended_at)
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at >= product_prices.price_started_at and 
            orders.created_at < product_prices.price_ended_at

    )

    select 
        id,
        created_at,
        created_on,
        year_of, 
        month_of,
        week_of,
        day_of_week_name,
        customer_id,
        state,
        address,
        zip,
        product_name,
        product_category,
        product_available_on,
        price_usd
    from order_details;


[0m05:37:47.414842 [debug] [Thread-8  ]: finished collecting timing info
[0m05:37:47.415447 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a5a5d30>]}
[0m05:37:47.415875 [info ] [Thread-8  ]: 7 of 10 OK created view model dbt_lauren.order_details ......................... [[32mOK[0m in 0.73s]
[0m05:37:47.416807 [debug] [Thread-8  ]: Finished running node model.coffee_shop_zar.order_details
[0m05:37:47.417372 [debug] [Thread-5  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m05:37:47.417563 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:37:47.417898 [info ] [Thread-5  ]: 8 of 10 START view model dbt_lauren.weekly_revenue_by_new_existing_customers ... [RUN]
[0m05:37:47.418556 [info ] [Thread-3  ]: 9 of 10 START view model dbt_lauren.weekly_revenue_by_product_category ......... [RUN]
[0m05:37:47.420334 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m05:37:47.420547 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:37:47.420725 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:37:47.419643 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m05:37:47.425906 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m05:37:47.426205 [debug] [Thread-5  ]: Began compiling node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m05:37:47.426600 [debug] [Thread-5  ]: Compiling model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m05:37:47.429619 [debug] [Thread-5  ]: Writing injected SQL for node "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m05:37:47.430170 [debug] [Thread-3  ]: finished collecting timing info
[0m05:37:47.430436 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:37:47.434062 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m05:37:47.434512 [debug] [Thread-5  ]: finished collecting timing info
[0m05:37:47.434822 [debug] [Thread-5  ]: Began executing node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m05:37:47.438208 [debug] [Thread-5  ]: Writing runtime SQL for node "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m05:37:47.438685 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m05:37:47.439018 [debug] [Thread-3  ]: On model.coffee_shop_zar.weekly_revenue_by_product_category: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.weekly_revenue_by_product_category"} */


  create or replace view `aec-students`.`dbt_lauren`.`weekly_revenue_by_product_category`
  OPTIONS()
  as with 
    order_details as (
        select *
        from  `aec-students`.`dbt_lauren`.`order_details`
    ),

    weekly_aggregate as (

        select 
          week_of,
          product_category,
          sum(price_usd) as revenue_usd
        from order_details
        group by 
          week_of,
          product_category
    )

    select *
    from weekly_aggregate;


[0m05:37:47.440816 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m05:37:47.441412 [debug] [Thread-5  ]: On model.coffee_shop_zar.weekly_revenue_by_new_existing_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"} */


  create or replace view `aec-students`.`dbt_lauren`.`weekly_revenue_by_new_existing_customers`
  OPTIONS()
  as with 
    order_details as (
        select *,
          first_value(week_of) over (partition by customer_id order by created_at rows between unbounded preceding and unbounded following)
          as first_order_week_of
        from  `aec-students`.`dbt_lauren`.`order_details`
    ),

    weekly_aggregate as (
        select 
          week_of,
          sum(case when week_of = first_order_week_of then price_usd else 0 end) as new_customer_revenue_usd,
          sum(case when week_of > first_order_week_of then price_usd else 0 end) as existing_customer_revenue_usd
        from order_details
        group by 
          week_of

    )

    select *
    from weekly_aggregate;


[0m05:37:48.321731 [debug] [Thread-3  ]: finished collecting timing info
[0m05:37:48.322313 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81841afd0>]}
[0m05:37:48.322738 [info ] [Thread-3  ]: 9 of 10 OK created view model dbt_lauren.weekly_revenue_by_product_category .... [[32mOK[0m in 0.90s]
[0m05:37:48.323280 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m05:37:48.548892 [debug] [Thread-5  ]: finished collecting timing info
[0m05:37:48.549439 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff818434d60>]}
[0m05:37:48.549868 [info ] [Thread-5  ]: 8 of 10 OK created view model dbt_lauren.weekly_revenue_by_new_existing_customers  [[32mOK[0m in 1.13s]
[0m05:37:48.550678 [debug] [Thread-5  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m05:37:51.074114 [debug] [Thread-1  ]: finished collecting timing info
[0m05:37:51.074693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a5f6790>]}
[0m05:37:51.075129 [info ] [Thread-1  ]: 1 of 10 OK created table model dbt_lauren.customers ............................ [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 5.51s]
[0m05:37:51.075698 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m05:37:51.076827 [debug] [Thread-4  ]: Began running node model.coffee_shop_zar.monthly_users
[0m05:37:51.077214 [info ] [Thread-4  ]: 10 of 10 START view model dbt_lauren.monthly_users ............................. [RUN]
[0m05:37:51.078310 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop_zar.monthly_users"
[0m05:37:51.078583 [debug] [Thread-4  ]: Began compiling node model.coffee_shop_zar.monthly_users
[0m05:37:51.078828 [debug] [Thread-4  ]: Compiling model.coffee_shop_zar.monthly_users
[0m05:37:51.125700 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop_zar.monthly_users"
[0m05:37:51.126385 [debug] [Thread-4  ]: finished collecting timing info
[0m05:37:51.126730 [debug] [Thread-4  ]: Began executing node model.coffee_shop_zar.monthly_users
[0m05:37:51.134411 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop_zar.monthly_users"
[0m05:37:51.134997 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m05:37:51.135322 [debug] [Thread-4  ]: On model.coffee_shop_zar.monthly_users: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.monthly_users"} */


  create or replace view `aec-students`.`dbt_lauren`.`monthly_users`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
from `aec-students`.`dbt_lauren`.`customers`
group by 
    signup_month;


[0m05:37:52.007953 [debug] [Thread-4  ]: finished collecting timing info
[0m05:37:52.008523 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6933e972-6090-441f-9940-d91bc042fd7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a5f6df0>]}
[0m05:37:52.008958 [info ] [Thread-4  ]: 10 of 10 OK created view model dbt_lauren.monthly_users ........................ [[32mOK[0m in 0.93s]
[0m05:37:52.009507 [debug] [Thread-4  ]: Finished running node model.coffee_shop_zar.monthly_users
[0m05:37:52.012244 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:37:52.012839 [info ] [MainThread]: 
[0m05:37:52.013230 [info ] [MainThread]: Finished running 9 view models, 1 table model in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m05:37:52.013738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:37:52.014048 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customers' was properly closed.
[0m05:37:52.014262 [debug] [MainThread]: Connection 'model.coffee_shop_zar.weekly_revenue_by_product_category' was properly closed.
[0m05:37:52.014437 [debug] [MainThread]: Connection 'model.coffee_shop_zar.product_details' was properly closed.
[0m05:37:52.014607 [debug] [MainThread]: Connection 'model.coffee_shop_zar.weekly_revenue_by_new_existing_customers' was properly closed.
[0m05:37:52.014788 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__products' was properly closed.
[0m05:37:52.014956 [debug] [MainThread]: Connection 'model.coffee_shop_zar.monthly_users' was properly closed.
[0m05:37:52.015323 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m05:37:52.028767 [info ] [MainThread]: 
[0m05:37:52.029152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:37:52.029699 [info ] [MainThread]: 
[0m05:37:52.030142 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m05:37:52.030936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a64a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81a64a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff818401b50>]}


============================== 2022-08-08 05:42:57.887995 | f53f0063-9c30-4805-a6bb-3b87699aadc7 ==============================
[0m05:42:57.888026 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:42:57.888749 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:42:57.889015 [debug] [MainThread]: Tracking: tracking
[0m05:42:57.893631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94613438b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9461343670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94613436d0>]}
[0m05:42:57.987429 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 0 files changed.
[0m05:42:57.988035 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/monthly_users.sql
[0m05:42:57.988322 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/monthly_users.sql
[0m05:42:57.988572 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_zar://models/marts/product_details.sql
[0m05:42:58.005118 [debug] [MainThread]: 1699: static parser successfully parsed marts/monthly_users.sql
[0m05:42:58.035920 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:42:58.047024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f53f0063-9c30-4805-a6bb-3b87699aadc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9460bf40d0>]}
[0m05:42:58.065376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f53f0063-9c30-4805-a6bb-3b87699aadc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94610e8d90>]}
[0m05:42:58.065729 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:42:58.066001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f53f0063-9c30-4805-a6bb-3b87699aadc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94610ec250>]}
[0m05:42:58.066918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94610ec2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9460c751c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9460c75250>]}


============================== 2022-08-08 05:43:14.279363 | 36f06ce9-ddb1-45c8-8082-39c2dee6d96c ==============================
[0m05:43:14.279395 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:43:14.280172 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:43:14.280479 [debug] [MainThread]: Tracking: tracking
[0m05:43:14.285135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff257f70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff273812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff27381a90>]}
[0m05:43:14.406688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:43:14.407018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:43:14.408052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:43:14.417685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36f06ce9-ddb1-45c8-8082-39c2dee6d96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff255300d0>]}
[0m05:43:14.432390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36f06ce9-ddb1-45c8-8082-39c2dee6d96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff256055e0>]}
[0m05:43:14.432821 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:43:14.433104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f06ce9-ddb1-45c8-8082-39c2dee6d96c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff25605520>]}
[0m05:43:14.434057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff256054c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff25605370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff25605070>]}


============================== 2022-08-08 05:43:31.423909 | 08bce12b-ef96-4138-a146-75b69bdc5843 ==============================
[0m05:43:31.423945 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:43:31.424746 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:43:31.425049 [debug] [MainThread]: Tracking: tracking
[0m05:43:31.429703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01d93280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01d93670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01d93d90>]}
[0m05:43:31.522489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:43:31.522815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:43:31.523525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:43:31.531770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08bce12b-ef96-4138-a146-75b69bdc5843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01ac70d0>]}
[0m05:43:31.546464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08bce12b-ef96-4138-a146-75b69bdc5843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01bb8e50>]}
[0m05:43:31.546900 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:43:31.547191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08bce12b-ef96-4138-a146-75b69bdc5843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01ba0040>]}
[0m05:43:31.548151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01ba00a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01bb8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac01bb8970>]}


============================== 2022-08-08 05:43:47.943534 | 55e07932-38f0-4a94-aaff-dc5275b4dce7 ==============================
[0m05:43:47.943566 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:43:47.944277 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:43:47.944567 [debug] [MainThread]: Tracking: tracking
[0m05:43:47.949221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c610430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c610b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c610940>]}
[0m05:43:48.072725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:43:48.073111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:43:48.074111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:43:48.086522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55e07932-38f0-4a94-aaff-dc5275b4dce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c3480d0>]}
[0m05:43:48.109850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55e07932-38f0-4a94-aaff-dc5275b4dce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c38e6d0>]}
[0m05:43:48.110345 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:43:48.110726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55e07932-38f0-4a94-aaff-dc5275b4dce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c38e610>]}
[0m05:43:48.112274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c38e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c38e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15c38e1c0>]}


============================== 2022-08-08 05:43:54.178424 | 82401532-16e0-4a1b-bb2b-00c016082355 ==============================
[0m05:43:54.178457 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:43:54.179216 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:43:54.179543 [debug] [MainThread]: Tracking: tracking
[0m05:43:54.184186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09307230a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09322aa3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09322aa2b0>]}
[0m05:43:54.276099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:43:54.276381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:43:54.277079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:43:54.284470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82401532-16e0-4a1b-bb2b-00c016082355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09304590d0>]}
[0m05:43:54.298798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82401532-16e0-4a1b-bb2b-00c016082355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093052e5e0>]}
[0m05:43:54.299208 [info ] [MainThread]: Found 9 models, 11 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m05:43:54.299503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82401532-16e0-4a1b-bb2b-00c016082355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093052e520>]}
[0m05:43:54.300430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093052e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093052e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093052e070>]}


============================== 2022-08-08 05:44:39.868422 | bb900cd8-8b75-40d5-9250-88b9975996da ==============================
[0m05:44:39.868456 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:44:39.869202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:44:39.869520 [debug] [MainThread]: Tracking: tracking
[0m05:44:39.874247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a79882340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a79882100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a79882160>]}
[0m05:44:39.948296 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:44:39.948873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb900cd8-8b75-40d5-9250-88b9975996da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a79882730>]}
[0m05:44:40.004665 [debug] [MainThread]: Parsing macros/etc.sql
[0m05:44:40.013969 [debug] [MainThread]: Parsing macros/adapters.sql
[0m05:44:40.088932 [debug] [MainThread]: Parsing macros/catalog.sql
[0m05:44:40.106424 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:44:40.117735 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:44:40.118801 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:44:40.119837 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:44:40.120874 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:44:40.122103 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:44:40.123221 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:44:40.124494 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:44:40.125507 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:44:40.127983 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:44:40.129898 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:44:40.130994 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:44:40.133628 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:44:40.134956 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:44:40.136039 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m05:44:40.140867 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m05:44:40.151123 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m05:44:40.158900 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m05:44:40.172462 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m05:44:40.240713 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m05:44:40.245725 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:44:40.257113 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:44:40.258427 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:44:40.260003 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:44:40.262555 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:44:40.292259 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:44:40.320925 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:44:40.334458 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:44:40.364605 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:44:40.373496 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:44:40.392502 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:44:40.398641 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:44:40.402699 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:44:40.404583 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:44:40.406811 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:44:40.409581 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:44:40.411998 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:44:40.422953 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:44:40.424580 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:44:40.426923 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:44:40.429416 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:44:40.431602 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:44:40.433899 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:44:40.436051 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:44:40.437656 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:44:40.441944 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:44:40.445512 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:44:40.451951 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:44:40.454501 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:44:40.456351 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:44:40.458886 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:44:40.460757 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:44:40.462868 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:44:40.464956 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:44:40.482807 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:44:40.491254 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:44:40.496603 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:44:40.504586 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:44:40.515542 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:44:40.521216 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:44:40.552946 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:44:40.561438 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:44:40.591768 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:44:40.594629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:44:40.613250 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:44:40.615748 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:44:40.626222 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:44:40.632710 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:44:40.637110 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:44:40.645814 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:44:40.650322 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:44:40.654041 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:44:40.697124 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:44:40.710897 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:44:40.735203 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:44:40.739463 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:44:40.761904 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:44:40.794459 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:44:40.797721 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:44:40.800705 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:44:40.805360 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:44:40.811103 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m05:44:40.816571 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m05:44:40.819203 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m05:44:40.821949 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m05:44:40.826478 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m05:44:40.830507 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m05:44:40.835978 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m05:44:40.840366 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m05:44:40.842758 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m05:44:40.846172 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m05:44:40.851992 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m05:44:40.869199 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m05:44:40.872678 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m05:44:40.879533 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m05:44:40.883831 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m05:44:40.886561 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m05:44:40.889849 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m05:44:40.892995 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m05:44:40.897064 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m05:44:40.899395 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m05:44:40.902559 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m05:44:40.906533 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m05:44:40.917825 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m05:44:40.920447 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m05:44:40.922724 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m05:44:40.925232 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m05:44:40.927231 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m05:44:40.930749 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m05:44:40.937526 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m05:44:40.940260 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m05:44:40.943784 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m05:44:40.947999 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m05:44:40.967234 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m05:44:40.969185 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m05:44:40.987169 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m05:44:41.010518 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m05:44:41.015481 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m05:44:41.041613 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m05:44:41.045221 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m05:44:41.051174 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m05:44:41.053922 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m05:44:41.055659 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m05:44:41.077632 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m05:44:41.093626 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m05:44:41.096787 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m05:44:41.099132 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m05:44:41.101705 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m05:44:41.112538 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m05:44:41.118216 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m05:44:41.121008 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m05:44:41.128676 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m05:44:41.130799 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m05:44:41.136758 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m05:44:41.139014 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m05:44:41.141480 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m05:44:41.187690 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m05:44:41.194145 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m05:44:41.202312 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m05:44:41.207519 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m05:44:41.215327 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m05:44:41.219657 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m05:44:41.231495 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m05:44:41.234395 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m05:44:41.236881 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m05:44:41.258749 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m05:44:41.272052 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m05:44:41.279249 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m05:44:41.287165 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m05:44:41.290196 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m05:44:41.293240 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m05:44:41.308647 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m05:44:41.319328 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m05:44:41.325799 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m05:44:41.329014 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m05:44:41.335589 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m05:44:41.338650 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m05:44:41.351193 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m05:44:41.368279 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m05:44:41.380015 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m05:44:41.387926 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m05:44:42.321872 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m05:44:42.342995 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m05:44:42.679182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb900cd8-8b75-40d5-9250-88b9975996da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a791900d0>]}
[0m05:44:42.709186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb900cd8-8b75-40d5-9250-88b9975996da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a798a8b20>]}
[0m05:44:42.709753 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:44:42.710225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb900cd8-8b75-40d5-9250-88b9975996da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a798da040>]}
[0m05:44:42.711445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a79841d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a79843e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a79843ee0>]}


============================== 2022-08-08 05:44:44.253585 | 5881c650-11d0-429c-a4cf-abbc534eee40 ==============================
[0m05:44:44.253618 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:44:44.254346 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:44:44.254622 [debug] [MainThread]: Tracking: tracking
[0m05:44:44.259318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6872653880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6872653640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68726536a0>]}
[0m05:44:44.349748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:44:44.349987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:44:44.356848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5881c650-11d0-429c-a4cf-abbc534eee40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68723b70d0>]}
[0m05:44:44.368854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5881c650-11d0-429c-a4cf-abbc534eee40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6872511c40>]}
[0m05:44:44.369326 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m05:44:44.369630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5881c650-11d0-429c-a4cf-abbc534eee40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68726a7ca0>]}
[0m05:44:44.370421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68726a7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68725116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68725114c0>]}


============================== 2022-08-09 04:31:04.499127 | cfaeecd9-570d-472e-95df-58d777be38a2 ==============================
[0m04:31:04.499141 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:31:04.499682 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:31:04.499983 [debug] [MainThread]: Tracking: tracking
[0m04:31:04.505135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8515802250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8515802190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8515802280>]}
[0m04:31:04.531924 [debug] [MainThread]: Executing "git --help"
[0m04:31:04.537311 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:31:04.537880 [debug] [MainThread]: STDERR: "b''"
[0m04:31:04.538485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8515802250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85157ec670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85157ec8e0>]}


============================== 2022-08-09 04:33:50.883273 | 761de29d-4f05-4913-bafb-262d4d1627d1 ==============================
[0m04:33:50.883288 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:33:50.883996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:33:50.884327 [debug] [MainThread]: Tracking: tracking
[0m04:33:50.889649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cdcbc2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cdcbc2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cdcbc2400>]}
[0m04:33:52.078275 [debug] [MainThread]: Executing "git --help"
[0m04:33:52.084519 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:33:52.085101 [debug] [MainThread]: STDERR: "b''"
[0m04:33:52.095376 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m04:33:52.096208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:33:52.813475 [debug] [MainThread]: On debug: select 1 as id
[0m04:33:53.721946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cdedbd0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cdb0499d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cdb0492e0>]}
[0m04:33:54.265992 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-09 04:34:00.876376 | dd7e1db8-506d-4eef-8b4b-1ee2dc703bfc ==============================
[0m04:34:00.876410 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:34:00.877418 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['web_sessions'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:34:00.877836 [debug] [MainThread]: Tracking: tracking
[0m04:34:00.884930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2cb2970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2cb2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2cb2760>]}
[0m04:34:00.975731 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:34:00.976335 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:34:00.976893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd7e1db8-506d-4eef-8b4b-1ee2dc703bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2c9d4c0>]}
[0m04:34:01.189858 [debug] [MainThread]: Parsing macros/etc.sql
[0m04:34:01.198026 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:34:01.222549 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:34:01.228862 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:34:01.231584 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:34:01.232207 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:34:01.232721 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:34:01.233384 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:34:01.234145 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:34:01.234853 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:34:01.235631 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:34:01.236155 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:34:01.237598 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:34:01.238726 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:34:01.239406 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:34:01.240963 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:34:01.241616 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:34:01.242287 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m04:34:01.245054 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m04:34:01.246794 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m04:34:01.251394 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m04:34:01.254438 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m04:34:01.270387 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m04:34:01.273303 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:34:01.274308 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:34:01.275125 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:34:01.276107 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:34:01.277573 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:34:01.280358 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:34:01.294412 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:34:01.301823 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:34:01.327960 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:34:01.337755 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:34:01.356710 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:34:01.361386 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:34:01.365801 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:34:01.367977 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:34:01.370226 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:34:01.372331 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:34:01.374837 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:34:01.386561 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:34:01.388336 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:34:01.390924 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:34:01.393676 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:34:01.396008 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:34:01.398233 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:34:01.400516 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:34:01.402289 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:34:01.406417 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:34:01.410054 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:34:01.414860 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:34:01.417021 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:34:01.418116 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:34:01.419504 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:34:01.420678 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:34:01.421922 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:34:01.423163 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:34:01.432506 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:34:01.437437 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:34:01.439874 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:34:01.443899 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:34:01.449581 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:34:01.452553 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:34:01.469350 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:34:01.474137 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:34:01.490049 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:34:01.491683 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:34:01.501971 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:34:01.503411 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:34:01.508890 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:34:01.512551 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:34:01.515047 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:34:01.519548 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:34:01.521499 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:34:01.523493 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:34:01.546545 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:34:01.553583 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:34:01.566518 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:34:01.568317 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:34:01.579977 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:34:01.596656 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:34:01.598437 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:34:01.601466 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:34:01.606334 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:34:01.612094 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m04:34:01.617287 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m04:34:01.619731 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m04:34:01.622358 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m04:34:01.626631 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m04:34:01.630032 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m04:34:01.634818 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m04:34:01.638750 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m04:34:01.641118 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m04:34:01.644171 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m04:34:01.648560 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m04:34:01.664843 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m04:34:01.668260 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m04:34:01.674607 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m04:34:01.678716 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m04:34:01.681321 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m04:34:01.684401 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m04:34:01.687375 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m04:34:01.690942 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:34:01.692651 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m04:34:01.695820 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m04:34:01.699476 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:34:01.706413 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m04:34:01.707891 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:34:01.709222 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:34:01.710650 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:34:01.711860 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:34:01.714571 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:34:01.720097 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:34:01.722732 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m04:34:01.726063 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:34:01.730110 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:34:01.739405 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:34:01.743395 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:34:01.750781 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:34:01.754464 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m04:34:01.757332 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m04:34:01.766402 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:34:01.768458 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:34:01.772056 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:34:01.773729 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:34:01.774792 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:34:01.784810 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m04:34:01.787644 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:34:01.789489 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:34:01.790878 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:34:01.792411 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:34:01.793996 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:34:01.796192 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:34:01.797869 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:34:01.800603 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:34:01.801938 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:34:01.803164 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:34:01.804421 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:34:01.805722 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:34:01.830839 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:34:01.834331 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:34:01.838697 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m04:34:01.841562 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:34:01.845814 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:34:01.848240 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:34:01.854372 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m04:34:01.856101 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:34:01.857574 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:34:01.869252 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m04:34:01.876313 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:34:01.880201 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:34:01.885305 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:34:01.887035 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:34:01.888807 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:34:01.898494 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:34:01.911688 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:34:01.915982 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:34:01.917863 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:34:01.921558 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:34:01.923343 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:34:01.929803 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m04:34:01.938704 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m04:34:01.944853 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m04:34:01.949035 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m04:34:02.581867 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m04:34:02.594063 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m04:34:02.596736 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m04:34:02.599313 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m04:34:02.602049 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/stitch_visitor_events.sql
[0m04:34:02.604769 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m04:34:02.607280 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_new_existing_customers.sql
[0m04:34:02.610031 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/customers.sql
[0m04:34:02.612911 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/monthly_users.sql
[0m04:34:02.615410 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_product_category.sql
[0m04:34:02.618731 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m04:34:02.828501 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m04:34:02.836720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd7e1db8-506d-4eef-8b4b-1ee2dc703bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2514ac0>]}
[0m04:34:02.850048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd7e1db8-506d-4eef-8b4b-1ee2dc703bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2b803a0>]}
[0m04:34:02.850447 [info ] [MainThread]: Found 11 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m04:34:02.850827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd7e1db8-506d-4eef-8b4b-1ee2dc703bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d4ef0bb0>]}
[0m04:34:02.852650 [info ] [MainThread]: 
[0m04:34:02.853836 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:34:02.855000 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m04:34:02.855418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:03.971193 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m04:34:03.971918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:04.234612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd7e1db8-506d-4eef-8b4b-1ee2dc703bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2520220>]}
[0m04:34:04.235718 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m04:34:04.236389 [info ] [MainThread]: 
[0m04:34:04.245255 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.web_sessions
[0m04:34:04.246024 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.web_sessions ................................ [RUN]
[0m04:34:04.246746 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.web_sessions"
[0m04:34:04.247095 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.web_sessions
[0m04:34:04.247358 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.web_sessions
[0m04:34:04.254011 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.web_sessions"
[0m04:34:04.260564 [debug] [Thread-1  ]: finished collecting timing info
[0m04:34:04.260865 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.web_sessions
[0m04:34:04.293855 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.web_sessions"
[0m04:34:04.294438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:34:04.294758 [debug] [Thread-1  ]: On model.coffee_shop_zar.web_sessions: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.web_sessions"} */


  create or replace view `aec-students`.`dbt_lauren`.`web_sessions`
  OPTIONS()
  as with 
  web_tracking as (
    select *,
      first_value(customer_id ignore nulls) over (partition by visitor_id order by timestamp rows between unbounded preceding and unbounded following) as _customer_id
    from `analytics-engineers-club`.`web_tracking`.`pageviews`
  ),

  id_combos as (
    select  
      customer_id,
      to_hex(md5(string_agg(visitor_id))) as stitched_visitor_id
    from web_tracking
    where 
      customer_id is not null
    group by 
      customer_id

  ),

  stitched as (

 select 
  web_tracking.id,
  web_tracking.device_type,
  web_tracking.timestamp as event_at,
  web_tracking.page,
  web_tracking._customer_id as customer_id,
  ifnull(id_combos.stitched_visitor_id, web_tracking.visitor_id) as stitched_visitor_id
 from web_tracking
 left join id_combos on 
   web_tracking._customer_id = id_combos.customer_id

  ),

  get_session_id as (

  select 
    id,
    device_type,
    event_at,
    ifnull(
      timestamp_diff(
          event_at,
          lag(event_at) over (partition by stitched_visitor_id order by event_at),
          minute
      ),0)  as previous_event_min,

      case 
        when ifnull(
              timestamp_diff(
                  event_at,
                  lag(event_at) over (partition by stitched_visitor_id order by event_at),
                  minute
              ),0) <= 30
        then first_value(id) over (partition by stitched_visitor_id order by event_at rows between unbounded preceding and current row)
        else id 
      end as session_id,
    page,
    customer_id,
    stitched_visitor_id
  from stitched
  ),

  add_session_start_end as (

  select 
    id,
    session_id,
    min(event_at) over (partition by session_id) as session_start_at,
    max(event_at) over (partition by session_id) as session_end_at,
    event_at,
    customer_id,
    stitched_visitor_id,
    device_type,
    page
  from get_session_id

  )

  select *
  from add_session_start_end;


[0m04:34:05.072684 [debug] [Thread-1  ]: finished collecting timing info
[0m04:34:05.073463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd7e1db8-506d-4eef-8b4b-1ee2dc703bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d22f6d90>]}
[0m04:34:05.074003 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.web_sessions ........................... [[32mOK[0m in 0.83s]
[0m04:34:05.074658 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.web_sessions
[0m04:34:05.077213 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:34:05.077769 [info ] [MainThread]: 
[0m04:34:05.078119 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m04:34:05.078639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:05.078918 [debug] [MainThread]: Connection 'model.coffee_shop_zar.web_sessions' was properly closed.
[0m04:34:05.096586 [info ] [MainThread]: 
[0m04:34:05.097001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:34:05.097611 [info ] [MainThread]: 
[0m04:34:05.098128 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:34:05.098884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d4ef0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2326af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d2326250>]}


============================== 2022-08-09 04:36:42.346067 | 5a38955e-1a34-41d5-9b07-95f9564feb22 ==============================
[0m04:36:42.346098 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:36:42.347148 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['web_sessions'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:36:42.347523 [debug] [MainThread]: Tracking: tracking
[0m04:36:42.353515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b92b4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b92b4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b92b44f0>]}
[0m04:36:42.450894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:36:42.451553 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/web_analytics/web_session_metrics.sql
[0m04:36:42.469674 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m04:36:42.492455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m04:36:42.500355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a38955e-1a34-41d5-9b07-95f9564feb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b8b8a0d0>]}
[0m04:36:42.514622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a38955e-1a34-41d5-9b07-95f9564feb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15bae438b0>]}
[0m04:36:42.515116 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m04:36:42.515560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a38955e-1a34-41d5-9b07-95f9564feb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b9033f70>]}
[0m04:36:42.517701 [info ] [MainThread]: 
[0m04:36:42.519058 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:36:42.520298 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m04:36:42.520835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:43.566519 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m04:36:43.567076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:43.829693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a38955e-1a34-41d5-9b07-95f9564feb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b92b8550>]}
[0m04:36:43.830819 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m04:36:43.831420 [info ] [MainThread]: 
[0m04:36:43.838992 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.web_sessions
[0m04:36:43.839431 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.web_sessions ................................ [RUN]
[0m04:36:43.840153 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.web_sessions"
[0m04:36:43.840400 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.web_sessions
[0m04:36:43.840634 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.web_sessions
[0m04:36:43.846110 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.web_sessions"
[0m04:36:43.846924 [debug] [Thread-1  ]: finished collecting timing info
[0m04:36:43.847233 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.web_sessions
[0m04:36:43.884810 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.web_sessions"
[0m04:36:43.885740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:36:43.886258 [debug] [Thread-1  ]: On model.coffee_shop_zar.web_sessions: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.web_sessions"} */


  create or replace view `aec-students`.`dbt_lauren`.`web_sessions`
  OPTIONS()
  as with 
  web_tracking as (
    select *,
      first_value(customer_id ignore nulls) over (partition by visitor_id order by timestamp rows between unbounded preceding and unbounded following) as _customer_id
    from `analytics-engineers-club`.`web_tracking`.`pageviews`
  ),

  id_combos as (
    select  
      customer_id,
      to_hex(md5(string_agg(visitor_id))) as stitched_visitor_id
    from web_tracking
    where 
      customer_id is not null
    group by 
      customer_id

  ),

  stitched as (

 select 
  web_tracking.id,
  web_tracking.device_type,
  web_tracking.timestamp as event_at,
  web_tracking.page,
  web_tracking._customer_id as customer_id,
  ifnull(id_combos.stitched_visitor_id, web_tracking.visitor_id) as stitched_visitor_id
 from web_tracking
 left join id_combos on 
   web_tracking._customer_id = id_combos.customer_id

  ),

  get_session_id as (

  select 
    id,
    device_type,
    event_at,
    ifnull(
      timestamp_diff(
          event_at,
          lag(event_at) over (partition by stitched_visitor_id order by event_at),
          minute
      ),0)  as previous_event_min,

      case 
        when ifnull(
              timestamp_diff(
                  event_at,
                  lag(event_at) over (partition by stitched_visitor_id order by event_at),
                  minute
              ),0) <= 30
        then first_value(id) over (partition by stitched_visitor_id order by event_at rows between unbounded preceding and current row)
        else id 
      end as session_id,
    page,
    customer_id,
    stitched_visitor_id
  from stitched
  ),

  add_session_start_end as (

  select 
    id,
    session_id,
    min(event_at) over (partition by session_id) as session_start_at,
    max(event_at) over (partition by session_id) as session_end_at,
    event_at,
    customer_id,
    stitched_visitor_id,
    device_type,
    page
  from get_session_id

  )

  select *
  from add_session_start_end;


[0m04:36:44.615604 [debug] [Thread-1  ]: finished collecting timing info
[0m04:36:44.616411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a38955e-1a34-41d5-9b07-95f9564feb22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b8a649a0>]}
[0m04:36:44.616999 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.web_sessions ........................... [[32mOK[0m in 0.78s]
[0m04:36:44.617677 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.web_sessions
[0m04:36:44.619574 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:36:44.620033 [info ] [MainThread]: 
[0m04:36:44.620438 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m04:36:44.620973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:44.621263 [debug] [MainThread]: Connection 'model.coffee_shop_zar.web_sessions' was properly closed.
[0m04:36:44.636623 [info ] [MainThread]: 
[0m04:36:44.637039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:44.637636 [info ] [MainThread]: 
[0m04:36:44.638149 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:36:44.638898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b8b99cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b92b8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b8a64520>]}


============================== 2022-08-09 04:36:57.531242 | 80f3cfd0-987f-481b-9cb6-e79168e18f1b ==============================
[0m04:36:57.531287 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:36:57.532381 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['web_sessions'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:36:57.532817 [debug] [MainThread]: Tracking: tracking
[0m04:36:57.540101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c434b2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c434b2ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c434b2610>]}
[0m04:36:57.640235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:36:57.641016 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/web_analytics/web_sessions.sql
[0m04:36:57.659829 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m04:36:57.682695 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m04:36:57.692551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80f3cfd0-987f-481b-9cb6-e79168e18f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c42d890d0>]}
[0m04:36:57.707379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80f3cfd0-987f-481b-9cb6-e79168e18f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c43343fd0>]}
[0m04:36:57.707883 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m04:36:57.708348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f3cfd0-987f-481b-9cb6-e79168e18f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4328e880>]}
[0m04:36:57.710571 [info ] [MainThread]: 
[0m04:36:57.711688 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:36:57.713609 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m04:36:57.713996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:58.791115 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m04:36:58.791854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:59.035397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f3cfd0-987f-481b-9cb6-e79168e18f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4349b3a0>]}
[0m04:36:59.036364 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m04:36:59.036866 [info ] [MainThread]: 
[0m04:36:59.044102 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.web_sessions
[0m04:36:59.044523 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.web_sessions ............................... [RUN]
[0m04:36:59.045185 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.web_sessions"
[0m04:36:59.045423 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.web_sessions
[0m04:36:59.045662 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.web_sessions
[0m04:36:59.051637 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.web_sessions"
[0m04:36:59.052239 [debug] [Thread-1  ]: finished collecting timing info
[0m04:36:59.052515 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.web_sessions
[0m04:36:59.073783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:36:59.550429 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.web_sessions"
[0m04:36:59.551278 [debug] [Thread-1  ]: On model.coffee_shop_zar.web_sessions: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.web_sessions"} */


  create or replace table `aec-students`.`dbt_lauren`.`web_sessions`
  
  
  OPTIONS()
  as (
    


with 
  web_tracking as (
    select *,
      first_value(customer_id ignore nulls) over (partition by visitor_id order by timestamp rows between unbounded preceding and unbounded following) as _customer_id
    from `analytics-engineers-club`.`web_tracking`.`pageviews`
  ),

  id_combos as (
    select  
      customer_id,
      to_hex(md5(string_agg(visitor_id))) as stitched_visitor_id
    from web_tracking
    where 
      customer_id is not null
    group by 
      customer_id

  ),

  stitched as (

 select 
  web_tracking.id,
  web_tracking.device_type,
  web_tracking.timestamp as event_at,
  web_tracking.page,
  web_tracking._customer_id as customer_id,
  ifnull(id_combos.stitched_visitor_id, web_tracking.visitor_id) as stitched_visitor_id
 from web_tracking
 left join id_combos on 
   web_tracking._customer_id = id_combos.customer_id

  ),

  get_session_id as (

  select 
    id,
    device_type,
    event_at,
    ifnull(
      timestamp_diff(
          event_at,
          lag(event_at) over (partition by stitched_visitor_id order by event_at),
          minute
      ),0)  as previous_event_min,

      case 
        when ifnull(
              timestamp_diff(
                  event_at,
                  lag(event_at) over (partition by stitched_visitor_id order by event_at),
                  minute
              ),0) <= 30
        then first_value(id) over (partition by stitched_visitor_id order by event_at rows between unbounded preceding and current row)
        else id 
      end as session_id,
    page,
    customer_id,
    stitched_visitor_id
  from stitched
  ),

  add_session_start_end as (

  select 
    id,
    session_id,
    min(event_at) over (partition by session_id) as session_start_at,
    max(event_at) over (partition by session_id) as session_end_at,
    event_at,
    customer_id,
    stitched_visitor_id,
    device_type,
    page
  from get_session_id

  )

  select *
  from add_session_start_end
  );
  
[0m04:37:20.294867 [debug] [Thread-1  ]: finished collecting timing info
[0m04:37:20.295623 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80f3cfd0-987f-481b-9cb6-e79168e18f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c42c480a0>]}
[0m04:37:20.296188 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_lauren.web_sessions .......................... [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 21.25s]
[0m04:37:20.296860 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.web_sessions
[0m04:37:20.299134 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m04:37:20.299624 [info ] [MainThread]: 
[0m04:37:20.299972 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.59 seconds (22.59s).
[0m04:37:20.301015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:20.301295 [debug] [MainThread]: Connection 'model.coffee_shop_zar.web_sessions' was properly closed.
[0m04:37:20.317223 [info ] [MainThread]: 
[0m04:37:20.317709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:37:20.318374 [info ] [MainThread]: 
[0m04:37:20.318935 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:37:20.319717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c42d96ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c43343c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c42dc8d60>]}


============================== 2022-08-09 04:57:34.308272 | 278ba99b-4ac5-4c84-9105-3e71ccf1b38c ==============================
[0m04:57:34.308303 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:57:34.310005 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:57:34.310418 [debug] [MainThread]: Tracking: tracking
[0m04:57:34.315471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02976b33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02992b90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02992b9a90>]}
[0m04:57:34.440516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:34.440766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:34.441551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m04:57:34.451715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '278ba99b-4ac5-4c84-9105-3e71ccf1b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02973f20d0>]}
[0m04:57:34.466884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '278ba99b-4ac5-4c84-9105-3e71ccf1b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02975474c0>]}
[0m04:57:34.467345 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m04:57:34.467765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '278ba99b-4ac5-4c84-9105-3e71ccf1b38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0297547550>]}
[0m04:57:34.469250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0297547340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0297547430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02975470d0>]}


============================== 2022-08-09 05:01:01.084792 | 124de6ff-d2bb-4458-be62-7120bc8604c9 ==============================
[0m05:01:01.084849 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:01:01.085937 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:01:01.086263 [debug] [MainThread]: Tracking: tracking
[0m05:01:01.097017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d23605460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d23605d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d23605cd0>]}
[0m05:01:01.338251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:01:01.339131 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/web_analytics/web_sessions.sql
[0m05:01:01.368425 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m05:01:01.423234 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:01:01.436716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '124de6ff-d2bb-4458-be62-7120bc8604c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d22ecc0d0>]}
[0m05:01:01.463985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '124de6ff-d2bb-4458-be62-7120bc8604c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2344f760>]}
[0m05:01:01.464596 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:01:01.465064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '124de6ff-d2bb-4458-be62-7120bc8604c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d233cf580>]}
[0m05:01:01.466693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2344f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d233cf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d23494970>]}


============================== 2022-08-09 05:01:02.908100 | 5b8ebeca-171a-49e8-a6e1-23bd8b8b2774 ==============================
[0m05:01:02.908128 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:01:02.908974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['web_sessions'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:01:02.909277 [debug] [MainThread]: Tracking: tracking
[0m05:01:02.914123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9577350a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959339af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9593395b0>]}
[0m05:01:03.012672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:01:03.012955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:01:03.013706 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:01:03.021391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b8ebeca-171a-49e8-a6e1-23bd8b8b2774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9574740d0>]}
[0m05:01:03.035665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b8ebeca-171a-49e8-a6e1-23bd8b8b2774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9575b7490>]}
[0m05:01:03.036068 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:01:03.036374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b8ebeca-171a-49e8-a6e1-23bd8b8b2774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9575b7520>]}
[0m05:01:03.037990 [info ] [MainThread]: 
[0m05:01:03.038563 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:01:03.039456 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:01:03.039916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:01:05.965831 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:01:05.966263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:06.225391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b8ebeca-171a-49e8-a6e1-23bd8b8b2774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9575b7130>]}
[0m05:01:06.226131 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:01:06.226506 [info ] [MainThread]: 
[0m05:01:06.231798 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.web_sessions
[0m05:01:06.232156 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.web_sessions ............................... [RUN]
[0m05:01:06.232630 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.web_sessions"
[0m05:01:06.232797 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.web_sessions
[0m05:01:06.232977 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.web_sessions
[0m05:01:06.238776 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.web_sessions"
[0m05:01:06.239254 [debug] [Thread-1  ]: finished collecting timing info
[0m05:01:06.239486 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.web_sessions
[0m05:01:06.260971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:01:06.537433 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.web_sessions"
[0m05:01:06.538080 [debug] [Thread-1  ]: On model.coffee_shop_zar.web_sessions: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.web_sessions"} */


  create or replace table `aec-students`.`dbt_lauren`.`web_sessions`
  
  
  OPTIONS()
  as (
    


with 
  web_tracking as (
    select *,
      first_value(customer_id ignore nulls) over (partition by visitor_id order by timestamp rows between unbounded preceding and unbounded following) as _customer_id
    from `analytics-engineers-club`.`web_tracking`.`pageviews`
  ),

  id_combos as (
    select  
      customer_id,
      to_hex(md5(string_agg(visitor_id order by visitor_id))) as stitched_visitor_id
    from web_tracking
    where 
      customer_id is not null
    group by 
      customer_id

  ),

  stitched as (

 select 
  web_tracking.id,
  web_tracking.device_type,
  web_tracking.timestamp as event_at,
  web_tracking.page,
  web_tracking._customer_id as customer_id,
  ifnull(id_combos.stitched_visitor_id, web_tracking.visitor_id) as stitched_visitor_id
 from web_tracking
 left join id_combos on 
   web_tracking._customer_id = id_combos.customer_id

  ),

  get_session_id as (

  select 
    id,
    device_type,
    event_at,
    ifnull(
      timestamp_diff(
          event_at,
          lag(event_at) over (partition by stitched_visitor_id order by event_at),
          minute
      ),0)  as previous_event_min,

      case 
        when ifnull(
              timestamp_diff(
                  event_at,
                  lag(event_at) over (partition by stitched_visitor_id order by event_at),
                  minute
              ),0) <= 30
        then first_value(id) over (partition by stitched_visitor_id order by event_at rows between unbounded preceding and current row)
        else id 
      end as session_id,
    page,
    customer_id,
    stitched_visitor_id
  from stitched
  ),

  add_session_start_end as (

  select 
    id,
    session_id,
    min(event_at) over (partition by session_id) as session_start_at,
    max(event_at) over (partition by session_id) as session_end_at,
    event_at,
    customer_id,
    stitched_visitor_id,
    device_type,
    page
  from get_session_id

  )

  select *
  from add_session_start_end
  );
  
[0m05:01:25.318709 [debug] [Thread-1  ]: finished collecting timing info
[0m05:01:25.319300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b8ebeca-171a-49e8-a6e1-23bd8b8b2774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95744fe20>]}
[0m05:01:25.319744 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_lauren.web_sessions .......................... [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 19.09s]
[0m05:01:25.320270 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.web_sessions
[0m05:01:25.321782 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:01:25.322186 [info ] [MainThread]: 
[0m05:01:25.322506 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.28 seconds (22.28s).
[0m05:01:25.322862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:01:25.323041 [debug] [MainThread]: Connection 'model.coffee_shop_zar.web_sessions' was properly closed.
[0m05:01:25.336353 [info ] [MainThread]: 
[0m05:01:25.336905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:01:25.337607 [info ] [MainThread]: 
[0m05:01:25.338075 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:01:25.338504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9574d8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb957341f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9574b8fa0>]}


============================== 2022-08-13 06:00:27.856429 | d0ea0bc1-4847-48b1-af8c-e626527674c8 ==============================
[0m06:00:27.856473 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:00:27.857374 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m06:00:27.857728 [debug] [MainThread]: Tracking: tracking
[0m06:00:27.874045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a5f6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a5f64f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a5f64c0>]}
[0m06:00:27.994632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:27.994938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:27.995712 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m06:00:28.006936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0ea0bc1-4847-48b1-af8c-e626527674c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a3320d0>]}
[0m06:00:28.020314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0ea0bc1-4847-48b1-af8c-e626527674c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a480550>]}
[0m06:00:28.020668 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m06:00:28.020958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ea0bc1-4847-48b1-af8c-e626527674c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a4805e0>]}
[0m06:00:28.021944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a4803d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a4804c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e1a480160>]}


============================== 2022-08-13 06:13:16.709920 | a3066d13-ffa5-4904-a425-a30e343fe072 ==============================
[0m06:13:16.710018 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:13:16.711352 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m06:13:16.711730 [debug] [MainThread]: Tracking: tracking
[0m06:13:16.720133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ed76a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ed764f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ed764c0>]}
[0m06:13:16.844026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:13:16.844302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:13:16.845084 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m06:13:16.856291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3066d13-ffa5-4904-a425-a30e343fe072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610eab40d0>]}
[0m06:13:16.870155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3066d13-ffa5-4904-a425-a30e343fe072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ec00550>]}
[0m06:13:16.870571 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m06:13:16.870842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3066d13-ffa5-4904-a425-a30e343fe072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ec005e0>]}
[0m06:13:16.871794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ec003d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ec004c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610ec00160>]}


============================== 2022-08-13 06:19:12.690294 | 00a12198-4321-42ee-9e29-b00c4c2fa79e ==============================
[0m06:19:12.690330 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:19:12.691172 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m06:19:12.691512 [debug] [MainThread]: Tracking: tracking
[0m06:19:12.698203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe6a18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe6a1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe6a16d0>]}
[0m06:19:12.828476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:12.828785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:12.829544 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m06:19:12.841694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00a12198-4321-42ee-9e29-b00c4c2fa79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe3b20d0>]}
[0m06:19:12.857680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00a12198-4321-42ee-9e29-b00c4c2fa79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe500340>]}
[0m06:19:12.858216 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m06:19:12.858665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a12198-4321-42ee-9e29-b00c4c2fa79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe500160>]}
[0m06:19:12.860187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe500220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe500160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fe500040>]}


============================== 2022-08-13 07:28:56.375564 | a974acfe-dac5-44d2-b71b-9b7168727d0d ==============================
[0m07:28:56.375600 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:28:56.376423 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m07:28:56.376810 [debug] [MainThread]: Tracking: tracking
[0m07:28:56.387259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c7a38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c7a3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c7a36d0>]}
[0m07:28:56.511966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:28:56.512550 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/web_analytics/web_sessions.sql
[0m07:28:56.528686 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m07:28:56.551965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m07:28:56.558600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a974acfe-dac5-44d2-b71b-9b7168727d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c0490d0>]}
[0m07:28:56.573335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a974acfe-dac5-44d2-b71b-9b7168727d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c5ceb80>]}
[0m07:28:56.573738 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m07:28:56.574038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a974acfe-dac5-44d2-b71b-9b7168727d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c54e9a0>]}
[0m07:28:56.575000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c5cebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c54e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2c615ac0>]}


============================== 2022-08-13 07:29:05.550142 | f9127727-b9dd-4578-94a5-28c095a709b0 ==============================
[0m07:29:05.550173 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:29:05.550928 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['web_sessions'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:29:05.551195 [debug] [MainThread]: Tracking: tracking
[0m07:29:05.557411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb560f50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb57c872b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb57c87a90>]}
[0m07:29:05.657414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:05.657681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:05.658439 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m07:29:05.667007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9127727-b9dd-4578-94a5-28c095a709b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55e320d0>]}
[0m07:29:05.682447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9127727-b9dd-4578-94a5-28c095a709b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55f7b490>]}
[0m07:29:05.682932 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m07:29:05.683588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9127727-b9dd-4578-94a5-28c095a709b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55f7b520>]}
[0m07:29:05.685255 [info ] [MainThread]: 
[0m07:29:05.685885 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:29:05.686793 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m07:29:05.687139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:08.576399 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m07:29:08.576882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:08.863662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9127727-b9dd-4578-94a5-28c095a709b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55f7b130>]}
[0m07:29:08.864414 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m07:29:08.864804 [info ] [MainThread]: 
[0m07:29:08.869747 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.web_sessions
[0m07:29:08.870116 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.web_sessions ............................... [RUN]
[0m07:29:08.870739 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.web_sessions"
[0m07:29:08.870982 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.web_sessions
[0m07:29:08.871209 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.web_sessions
[0m07:29:08.876887 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.web_sessions"
[0m07:29:08.877418 [debug] [Thread-1  ]: finished collecting timing info
[0m07:29:08.877655 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.web_sessions
[0m07:29:08.903786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:29:09.152274 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.web_sessions"
[0m07:29:09.153001 [debug] [Thread-1  ]: On model.coffee_shop_zar.web_sessions: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.web_sessions"} */


  create or replace table `aec-students`.`dbt_lauren`.`web_sessions`
  
  
  OPTIONS()
  as (
    


with 
  web_tracking as (
    select *,
      first_value(customer_id ignore nulls) over (partition by visitor_id order by timestamp rows between unbounded preceding and unbounded following) as _customer_id
    from `analytics-engineers-club`.`web_tracking`.`pageviews`
  ),

  id_combos as (
    select  
      customer_id,
      to_hex(md5(string_agg(visitor_id order by visitor_id))) as stitched_visitor_id
    from web_tracking
    where 
      customer_id is not null
    group by 
      customer_id

  ),

  stitched as (

    select 
      web_tracking.id,
      web_tracking.device_type,
      web_tracking.timestamp as event_at,
      web_tracking.page,
      web_tracking._customer_id as customer_id,
      ifnull(id_combos.stitched_visitor_id, web_tracking.visitor_id) as stitched_visitor_id
    from web_tracking
    left join id_combos on 
      web_tracking._customer_id = id_combos.customer_id

  ),

  add_previous_next_event as (

    select *,
      lag(event_at) over (partition by stitched_visitor_id order by event_at) as previous_event_at,
      lead(event_at) over (partition by stitched_visitor_id order by event_at) as next_event_at
    from stitched

  ),

  calculate_start_end as (

      select *,
        case 
          when timestamp_diff(event_at, previous_event_at, minute) > 30 or previous_event_at is null then true else false 
        end as is_start,
        case 
          when timestamp_diff(next_event_at, event_at, minute) > 30 or next_event_at is null then true else false 
        end as is_end,
      from add_previous_next_event

  ),

  add_session_id as (

      select *,
        to_hex(md5(
          concat(stitched_visitor_id,
          sum(case when is_start then 1 else 0 end) over (partition by stitched_visitor_id order by event_at rows between unbounded preceding and current row)
          )
        )) as session_id
      from calculate_start_end

  ),



  add_session_start_end as (

  select 
    id,
    session_id,
    min(event_at) over (partition by session_id) as session_start_at,
    max(event_at) over (partition by session_id) as session_end_at,
    event_at,
    customer_id,
    stitched_visitor_id,
    device_type,
    page
  from add_session_id

  )

  select *
  from add_session_start_end
  );
  


============================== 2022-08-13 07:29:21.652181 | 801e0e4b-8ac4-42d8-aedf-633dece8b27b ==============================
[0m07:29:21.652280 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:29:21.653124 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m07:29:21.653479 [debug] [MainThread]: Tracking: tracking
[0m07:29:21.661356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6630390d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff661445dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff661445c10>]}
[0m07:29:21.755964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:21.756229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:21.756993 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m07:29:21.765301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '801e0e4b-8ac4-42d8-aedf-633dece8b27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6611720d0>]}
[0m07:29:21.778911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '801e0e4b-8ac4-42d8-aedf-633dece8b27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6612d2670>]}
[0m07:29:21.779386 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m07:29:21.779749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '801e0e4b-8ac4-42d8-aedf-633dece8b27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6612d2700>]}
[0m07:29:21.780780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6612d24f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6612d25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6612d2250>]}
[0m07:29:34.608146 [debug] [Thread-1  ]: finished collecting timing info
[0m07:29:34.608738 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127727-b9dd-4578-94a5-28c095a709b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55e0deb0>]}
[0m07:29:34.609167 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_lauren.web_sessions .......................... [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 25.74s]
[0m07:29:34.609720 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.web_sessions
[0m07:29:34.611303 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:29:34.611713 [info ] [MainThread]: 
[0m07:29:34.612121 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 28.93 seconds (28.93s).
[0m07:29:34.612471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:34.612660 [debug] [MainThread]: Connection 'model.coffee_shop_zar.web_sessions' was properly closed.
[0m07:29:34.625488 [info ] [MainThread]: 
[0m07:29:34.625807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:34.626206 [info ] [MainThread]: 
[0m07:29:34.626532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:34.626977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55dfb1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55d07b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55d07ac0>]}


============================== 2022-08-13 17:25:31.715631 | f58ee444-1ae6-4714-b606-7a3e18c1b784 ==============================
[0m17:25:31.715665 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:25:31.716965 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:25:31.717328 [debug] [MainThread]: Tracking: tracking
[0m17:25:31.723184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3424435b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3424435400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3424435490>]}
[0m17:25:31.846484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:31.846783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:31.847519 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:25:31.858170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f58ee444-1ae6-4714-b606-7a3e18c1b784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34241730d0>]}
[0m17:25:31.875213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f58ee444-1ae6-4714-b606-7a3e18c1b784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34242c3160>]}
[0m17:25:31.875576 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:25:31.875849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58ee444-1ae6-4714-b606-7a3e18c1b784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34242c3040>]}
[0m17:25:31.876803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34242c3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34242d8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34242d89a0>]}


============================== 2022-08-13 17:25:51.180196 | 7add0eb4-fa4c-4d0c-aec9-910dea769d92 ==============================
[0m17:25:51.180227 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:25:51.180951 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:25:51.181226 [debug] [MainThread]: Tracking: tracking
[0m17:25:51.185911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5eb36640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5eb36160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5eb36b50>]}
[0m17:25:51.284291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:51.284792 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/web_analytics/web_session_metrics.sql
[0m17:25:51.299214 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m17:25:51.311588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5e8e2f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5e9bca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c5e871250>]}


============================== 2022-08-13 17:26:01.439783 | 04cf33f6-9982-42ba-b16e-0f3437d04cf8 ==============================
[0m17:26:01.439846 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:26:01.440978 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:26:01.441353 [debug] [MainThread]: Tracking: tracking
[0m17:26:01.458228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3fc2a38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3fc2a3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3fc2a36d0>]}


============================== 2022-08-13 17:26:01.666174 | 8fa89505-4f2a-4410-ab7d-ec7fe33a3568 ==============================
[0m17:26:01.666224 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:26:01.670117 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['web_session_metrics'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:26:01.670524 [debug] [MainThread]: Tracking: tracking
[0m17:26:01.690783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701e1c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701e1c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701e1c190>]}
[0m17:26:01.692368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:26:01.693228 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/web_analytics/web_session_metrics.sql
[0m17:26:01.755943 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m17:26:01.796211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3fc010580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3fc0f7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3fc030eb0>]}
[0m17:26:01.820163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:26:01.820677 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/web_analytics/web_session_metrics.sql
[0m17:26:01.837229 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m17:26:01.850024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701b92100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701c7c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5701bafa30>]}


============================== 2022-08-13 17:26:30.836768 | d98281a2-1e6e-4ea3-9283-73140318043a ==============================
[0m17:26:30.836826 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:26:30.837936 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:26:30.838310 [debug] [MainThread]: Tracking: tracking
[0m17:26:30.852041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f7e18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f7e16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f7e1700>]}
[0m17:26:31.029816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:26:31.030651 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/web_analytics/web_session_metrics.sql
[0m17:26:31.057744 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m17:26:31.094498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:26:31.106627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd98281a2-1e6e-4ea3-9283-73140318043a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f08a0d0>]}
[0m17:26:31.128676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd98281a2-1e6e-4ea3-9283-73140318043a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f79b880>]}
[0m17:26:31.129215 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:26:31.129665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd98281a2-1e6e-4ea3-9283-73140318043a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f79baf0>]}
[0m17:26:31.131221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f79ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f655c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1f6559d0>]}


============================== 2022-08-13 17:26:31.204891 | ea0e9cd1-b6dc-4db3-b8fd-2844fc94911e ==============================
[0m17:26:31.204927 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:26:31.205937 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['web_session_metrics'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:26:31.206273 [debug] [MainThread]: Tracking: tracking
[0m17:26:31.211158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168925d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168925d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168925d6d0>]}
[0m17:26:31.357378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:31.357627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:31.358378 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:26:31.365852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea0e9cd1-b6dc-4db3-b8fd-2844fc94911e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1688f740d0>]}
[0m17:26:31.379027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea0e9cd1-b6dc-4db3-b8fd-2844fc94911e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16890c13a0>]}
[0m17:26:31.379351 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:26:31.379677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea0e9cd1-b6dc-4db3-b8fd-2844fc94911e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16890c10d0>]}
[0m17:26:31.381420 [info ] [MainThread]: 
[0m17:26:31.381995 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:26:31.382843 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:26:31.383239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:34.539693 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:26:34.540163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:34.838676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea0e9cd1-b6dc-4db3-b8fd-2844fc94911e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1689236ac0>]}
[0m17:26:34.839613 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:26:34.840130 [info ] [MainThread]: 
[0m17:26:34.845586 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.web_session_metrics
[0m17:26:34.845965 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.web_session_metrics ......................... [RUN]
[0m17:26:34.846653 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.web_session_metrics"
[0m17:26:34.847187 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.web_session_metrics
[0m17:26:34.847698 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.web_session_metrics
[0m17:26:34.852031 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.web_session_metrics"
[0m17:26:34.855665 [debug] [Thread-1  ]: finished collecting timing info
[0m17:26:34.855905 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.web_session_metrics
[0m17:26:34.892210 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.web_session_metrics"
[0m17:26:34.892611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:26:34.892861 [debug] [Thread-1  ]: On model.coffee_shop_zar.web_session_metrics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.web_session_metrics"} */


  create or replace view `aec-students`.`dbt_lauren`.`web_session_metrics`
  OPTIONS()
  as with 
  session_detail as (

    select 
      session_id,
      session_end_at, session_start_at, 
      stitched_visitor_id,
      customer_id,
      device_type,
      page,
      round((timestamp_diff(session_end_at, session_start_at, second) / 60),2) as session_duration,
      case when page = "order-confirmation" then true else false end as was_purchase_made,
      date_trunc(date(session_start_at), month) as session_month,
      date(session_start_at) as session_date,
      extract(dayofweek from date(session_start_at)) as day_of_week,
      extract(hour from (session_start_at)) as hour_of_day
    from `aec-students`.`dbt_lauren`.`web_sessions`
  
  ),

  session_metrics as (

  select 
    session_id,
    stitched_visitor_id,
    customer_id,
    session_duration,
    session_month,
    session_date,
    day_of_week,
    hour_of_day,
    count(distinct device_type) as number_of_devices,
    max(was_purchase_made) as was_purchase_made,
    count(page) as pages_visited
  from session_detail
  group by 
    session_id,
    stitched_visitor_id,
    customer_id,
    session_duration,
    session_month,
    session_date,
    day_of_week,
    hour_of_day

  )

  select *
  from session_metrics;


[0m17:26:36.026996 [debug] [Thread-1  ]: finished collecting timing info
[0m17:26:36.027565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea0e9cd1-b6dc-4db3-b8fd-2844fc94911e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1688f4cca0>]}
[0m17:26:36.028024 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.web_session_metrics .................... [[32mOK[0m in 1.18s]
[0m17:26:36.028556 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.web_session_metrics
[0m17:26:36.030126 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:26:36.030554 [info ] [MainThread]: 
[0m17:26:36.030941 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m17:26:36.031313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:36.031504 [debug] [MainThread]: Connection 'model.coffee_shop_zar.web_session_metrics' was properly closed.
[0m17:26:36.046720 [info ] [MainThread]: 
[0m17:26:36.047134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:36.047592 [info ] [MainThread]: 
[0m17:26:36.047916 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:26:36.048451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168925d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1688fd85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1688f61730>]}


============================== 2022-08-13 17:34:58.451669 | 383f59d7-bee3-47e6-ac84-26061838ee7a ==============================
[0m17:34:58.451703 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:34:58.452380 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:34:58.452707 [debug] [MainThread]: Tracking: tracking
[0m17:34:58.457550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad345700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad345eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad345a60>]}
[0m17:34:58.586106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:58.586377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:58.587156 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:34:58.599260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '383f59d7-bee3-47e6-ac84-26061838ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad07af40>]}
[0m17:34:58.613914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '383f59d7-bee3-47e6-ac84-26061838ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad1d4fd0>]}
[0m17:34:58.614278 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:34:58.614528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '383f59d7-bee3-47e6-ac84-26061838ee7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad0b6fd0>]}
[0m17:34:58.615526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b04e5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad1d4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad1d4910>]}


============================== 2022-08-13 17:42:34.058462 | 158a0cc4-be2d-4b80-bc05-907ebfd9e5f0 ==============================
[0m17:42:34.058491 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:42:34.059194 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:42:34.059515 [debug] [MainThread]: Tracking: tracking
[0m17:42:34.064285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac06638b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac0663670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac06636d0>]}
[0m17:42:34.243601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:42:34.243975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:42:34.245141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:42:34.261718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '158a0cc4-be2d-4b80-bc05-907ebfd9e5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac03740d0>]}
[0m17:42:34.287030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '158a0cc4-be2d-4b80-bc05-907ebfd9e5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac04bc370>]}
[0m17:42:34.287376 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:42:34.287629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158a0cc4-be2d-4b80-bc05-907ebfd9e5f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac04bc0a0>]}
[0m17:42:34.288620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac04bc160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac04bc0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ac04bc040>]}


============================== 2022-08-13 17:56:43.041946 | 282e446f-722e-4525-bfcf-a70e2610947a ==============================
[0m17:56:43.041986 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:56:43.043552 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:56:43.044022 [debug] [MainThread]: Tracking: tracking
[0m17:56:43.057941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2792137640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2792137160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27921375b0>]}
[0m17:56:43.200990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:56:43.201470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:56:43.202924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:56:43.215890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '282e446f-722e-4525-bfcf-a70e2610947a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2791e740d0>]}
[0m17:56:43.231632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '282e446f-722e-4525-bfcf-a70e2610947a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2791fb86d0>]}
[0m17:56:43.232083 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:56:43.232405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '282e446f-722e-4525-bfcf-a70e2610947a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2791fb8610>]}
[0m17:56:43.233501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2791fb8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2791fb84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2791fb81c0>]}


============================== 2022-08-13 18:02:18.411525 | 18a8d237-75c4-460b-9c5e-f849199e5068 ==============================
[0m18:02:18.411564 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:02:18.413002 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:02:18.414106 [debug] [MainThread]: Tracking: tracking
[0m18:02:18.421945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3f73970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3f73220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3f73910>]}
[0m18:02:18.550809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:02:18.551089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:02:18.552002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:02:18.566060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18a8d237-75c4-460b-9c5e-f849199e5068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3cb1ac0>]}
[0m18:02:18.580990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18a8d237-75c4-460b-9c5e-f849199e5068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3e02220>]}
[0m18:02:18.581377 [info ] [MainThread]: Found 12 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:02:18.581668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a8d237-75c4-460b-9c5e-f849199e5068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3e02100>]}
[0m18:02:18.583243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3e02130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3e14d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b3e14a60>]}


============================== 2022-08-13 18:13:03.994909 | d1fbcaec-a5da-4523-9d2c-e35fcf793225 ==============================
[0m18:13:03.994961 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:13:03.996141 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:13:03.996509 [debug] [MainThread]: Tracking: tracking
[0m18:13:04.009347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9ccf1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9e9392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9e9393a0>]}
[0m18:13:04.171222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:13:04.172057 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/calendar/date_details.sql
[0m18:13:04.200546 [debug] [MainThread]: 1603: static parser failed on marts/calendar/date_details.sql
[0m18:13:04.276419 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/calendar/date_details.sql
[0m18:13:04.295278 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:13:04.308645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1fbcaec-a5da-4523-9d2c-e35fcf793225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9ca240d0>]}
[0m18:13:04.330708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1fbcaec-a5da-4523-9d2c-e35fcf793225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9ca79f70>]}
[0m18:13:04.331252 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:13:04.331724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1fbcaec-a5da-4523-9d2c-e35fcf793225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9ca79f40>]}
[0m18:13:04.333282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9ca79f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9ca79dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9ca79550>]}


============================== 2022-08-13 18:13:05.444350 | 216db18c-b865-413d-8abf-b4aae41675f0 ==============================
[0m18:13:05.444400 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:13:05.445925 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['date_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:13:05.446312 [debug] [MainThread]: Tracking: tracking
[0m18:13:05.478795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd405dde8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd405dde670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd405dde6d0>]}
[0m18:13:05.654473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:05.654940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:05.656294 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:13:05.668828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '216db18c-b865-413d-8abf-b4aae41675f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd405af60d0>]}
[0m18:13:05.699106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '216db18c-b865-413d-8abf-b4aae41675f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd405c40490>]}
[0m18:13:05.699659 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:13:05.700259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '216db18c-b865-413d-8abf-b4aae41675f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd405c40610>]}
[0m18:13:05.703017 [info ] [MainThread]: 
[0m18:13:05.703934 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:13:05.705436 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:13:05.715496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:08.641355 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:13:08.641942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:08.865132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '216db18c-b865-413d-8abf-b4aae41675f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd405c40100>]}
[0m18:13:08.865952 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:13:08.866336 [info ] [MainThread]: 
[0m18:13:08.871883 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.date_details
[0m18:13:08.872332 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.date_details ................................ [RUN]
[0m18:13:08.872954 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.date_details"
[0m18:13:08.873216 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.date_details
[0m18:13:08.873418 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.date_details
[0m18:13:08.903279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:08.903575 [debug] [Thread-1  ]: On model.coffee_shop_zar.date_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.date_details"} */


        select datetime_diff(
        cast(dateadd(year, 20, current_date) as datetime),
        cast(to_date('01/01/2015', 'mm/dd/yyyy') as datetime),
        day
    )
[0m18:13:09.335242 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: dateadd; Did you mean date_add? at [5:14]')
[0m18:13:10.606181 [debug] [Thread-1  ]: finished collecting timing info
[0m18:13:10.608162 [debug] [Thread-1  ]: Database Error in model date_details (models/marts/calendar/date_details.sql)
  Function not found: dateadd; Did you mean date_add? at [5:14]
[0m18:13:10.609080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216db18c-b865-413d-8abf-b4aae41675f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd405ae6ca0>]}
[0m18:13:10.609492 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.date_details ....................... [[31mERROR[0m in 1.74s]
[0m18:13:10.610021 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.date_details
[0m18:13:10.611732 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:13:10.612146 [info ] [MainThread]: 
[0m18:13:10.612459 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m18:13:10.612807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:10.612986 [debug] [MainThread]: Connection 'model.coffee_shop_zar.date_details' was properly closed.
[0m18:13:10.626325 [info ] [MainThread]: 
[0m18:13:10.626668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:13:10.627121 [info ] [MainThread]: 
[0m18:13:10.627510 [error] [MainThread]: [33mDatabase Error in model date_details (models/marts/calendar/date_details.sql)[0m
[0m18:13:10.627918 [error] [MainThread]:   Function not found: dateadd; Did you mean date_add? at [5:14]
[0m18:13:10.628283 [info ] [MainThread]: 
[0m18:13:10.628638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:13:10.629086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4059c7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4059c7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4059c7af0>]}


============================== 2022-08-13 18:13:49.673187 | cb468615-adda-4a85-bbc7-e8bb6499fe77 ==============================
[0m18:13:49.673239 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:13:49.674437 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:13:49.674822 [debug] [MainThread]: Tracking: tracking
[0m18:13:49.691428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723eeff5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723eeff940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723eeff6d0>]}
[0m18:13:49.800900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:49.801511 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/calendar/date_details.sql
[0m18:13:49.816265 [debug] [MainThread]: 1603: static parser failed on marts/calendar/date_details.sql
[0m18:13:49.862633 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/calendar/date_details.sql
[0m18:13:49.874788 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:13:49.881388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb468615-adda-4a85-bbc7-e8bb6499fe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ec260d0>]}
[0m18:13:49.895354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb468615-adda-4a85-bbc7-e8bb6499fe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ed54160>]}
[0m18:13:49.895772 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:13:49.896050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb468615-adda-4a85-bbc7-e8bb6499fe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ed54190>]}
[0m18:13:49.897052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ef05610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ef05070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ef05eb0>]}


============================== 2022-08-13 18:13:58.926953 | 0cf2cf69-589d-4f1b-9496-a6a034167f26 ==============================
[0m18:13:58.926982 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:13:58.927849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['date_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:13:58.928161 [debug] [MainThread]: Tracking: tracking
[0m18:13:58.934547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9eb7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9eb7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9eb73a0>]}
[0m18:13:59.033749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:59.034082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:59.034905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:13:59.043413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cf2cf69-589d-4f1b-9496-a6a034167f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9bf50d0>]}
[0m18:13:59.057079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cf2cf69-589d-4f1b-9496-a6a034167f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9d4b9d0>]}
[0m18:13:59.057445 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:13:59.057788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cf2cf69-589d-4f1b-9496-a6a034167f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9d4bb50>]}
[0m18:13:59.059496 [info ] [MainThread]: 
[0m18:13:59.060106 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:13:59.061046 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:13:59.061395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:00.224052 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:14:00.225570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:00.513185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cf2cf69-589d-4f1b-9496-a6a034167f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9bf5220>]}
[0m18:14:00.513988 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:14:00.514380 [info ] [MainThread]: 
[0m18:14:00.520009 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.date_details
[0m18:14:00.520435 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.date_details ................................ [RUN]
[0m18:14:00.521051 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.date_details"
[0m18:14:00.521475 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.date_details
[0m18:14:00.522086 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.date_details
[0m18:14:00.548480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:14:00.548773 [debug] [Thread-1  ]: On model.coffee_shop_zar.date_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.date_details"} */


        select datetime_diff(
        cast(dateadd(year, 20, current_date) as datetime),
        cast(to_date('01/01/2015', 'mm/dd/yyyy') as datetime),
        day
    )
[0m18:14:01.041567 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: dateadd; Did you mean date_add? at [5:14]')
[0m18:14:02.343384 [debug] [Thread-1  ]: finished collecting timing info
[0m18:14:02.343950 [debug] [Thread-1  ]: Database Error in model date_details (models/marts/calendar/date_details.sql)
  Function not found: dateadd; Did you mean date_add? at [5:14]
[0m18:14:02.344360 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cf2cf69-589d-4f1b-9496-a6a034167f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9bca1c0>]}
[0m18:14:02.344790 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.date_details ....................... [[31mERROR[0m in 1.82s]
[0m18:14:02.345329 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.date_details
[0m18:14:02.346993 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:14:02.347480 [info ] [MainThread]: 
[0m18:14:02.347831 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m18:14:02.348228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:02.348414 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m18:14:02.348572 [debug] [MainThread]: Connection 'model.coffee_shop_zar.date_details' was properly closed.
[0m18:14:02.367883 [info ] [MainThread]: 
[0m18:14:02.368268 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:14:02.368720 [info ] [MainThread]: 
[0m18:14:02.369037 [error] [MainThread]: [33mDatabase Error in model date_details (models/marts/calendar/date_details.sql)[0m
[0m18:14:02.369339 [error] [MainThread]:   Function not found: dateadd; Did you mean date_add? at [5:14]
[0m18:14:02.369644 [info ] [MainThread]: 
[0m18:14:02.369943 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:14:02.370384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9abf7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9bf5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a9ac5c40>]}


============================== 2022-08-13 18:15:24.845024 | 08eca847-3db6-4ca3-af79-38c5233b4be4 ==============================
[0m18:15:24.845061 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:15:24.845765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:15:24.846064 [debug] [MainThread]: Tracking: tracking
[0m18:15:24.852953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e41e18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e41e1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e41e16d0>]}
[0m18:15:24.951248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:15:24.951868 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/calendar/date_details.sql
[0m18:15:24.967938 [debug] [MainThread]: 1603: static parser failed on marts/calendar/date_details.sql
[0m18:15:25.010504 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/calendar/date_details.sql
[0m18:15:25.020752 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:15:25.027418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08eca847-3db6-4ca3-af79-38c5233b4be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e3ee50d0>]}
[0m18:15:25.042121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08eca847-3db6-4ca3-af79-38c5233b4be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e400fdf0>]}
[0m18:15:25.042536 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:15:25.042810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08eca847-3db6-4ca3-af79-38c5233b4be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e400fe20>]}
[0m18:15:25.043836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e400fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e3f39d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e3f39640>]}


============================== 2022-08-13 18:16:02.108064 | 07719568-face-41b6-b484-55c2215d1607 ==============================
[0m18:16:02.108096 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:16:02.108810 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:16:02.109117 [debug] [MainThread]: Tracking: tracking
[0m18:16:02.115539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2f218b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2f21670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2f216d0>]}
[0m18:16:02.214576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:02.215216 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/calendar/date_details.sql
[0m18:16:02.233059 [debug] [MainThread]: 1603: static parser failed on marts/calendar/date_details.sql
[0m18:16:02.277547 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/calendar/date_details.sql
[0m18:16:02.287922 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:16:02.295172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07719568-face-41b6-b484-55c2215d1607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2c250d0>]}
[0m18:16:02.308743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07719568-face-41b6-b484-55c2215d1607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2d4fdf0>]}
[0m18:16:02.309152 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:16:02.309424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07719568-face-41b6-b484-55c2215d1607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2d4fe20>]}
[0m18:16:02.310436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2d4fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2c79d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c2c79640>]}


============================== 2022-08-13 18:16:49.080065 | 29a8ec6b-4f64-4576-9cc8-fe53b5c96a15 ==============================
[0m18:16:49.080097 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:16:49.080852 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:16:49.081165 [debug] [MainThread]: Tracking: tracking
[0m18:16:49.087565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc684a85640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc684a85f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc684a85ac0>]}
[0m18:16:49.186452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:49.187078 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/calendar/date_details.sql
[0m18:16:49.201832 [debug] [MainThread]: 1603: static parser failed on marts/calendar/date_details.sql
[0m18:16:49.246192 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/calendar/date_details.sql
[0m18:16:49.256609 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:16:49.263035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29a8ec6b-4f64-4576-9cc8-fe53b5c96a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6847a40d0>]}
[0m18:16:49.276257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29a8ec6b-4f64-4576-9cc8-fe53b5c96a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6848d0af0>]}
[0m18:16:49.276640 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:16:49.276923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29a8ec6b-4f64-4576-9cc8-fe53b5c96a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6848d0b20>]}
[0m18:16:49.277915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6848d0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc684915c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6849159d0>]}


============================== 2022-08-13 18:16:52.876789 | 8ef162e3-6d53-47b6-af2e-85f320454913 ==============================
[0m18:16:52.876821 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:16:52.878048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['date_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:16:52.878428 [debug] [MainThread]: Tracking: tracking
[0m18:16:52.886487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3633987580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631e07c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631e07dc0>]}
[0m18:16:52.988439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:52.988706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:52.989517 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:16:52.997432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ef162e3-6d53-47b6-af2e-85f320454913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631b340d0>]}
[0m18:16:53.011103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef162e3-6d53-47b6-af2e-85f320454913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631c93910>]}
[0m18:16:53.011465 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:16:53.011817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef162e3-6d53-47b6-af2e-85f320454913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631c93a90>]}
[0m18:16:53.013502 [info ] [MainThread]: 
[0m18:16:53.014100 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:16:53.015030 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:16:53.015373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:54.102660 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:16:54.103157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:54.310106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef162e3-6d53-47b6-af2e-85f320454913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631dd1c40>]}
[0m18:16:54.310899 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:16:54.311289 [info ] [MainThread]: 
[0m18:16:54.316463 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.date_details
[0m18:16:54.316875 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.date_details ................................ [RUN]
[0m18:16:54.317533 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.date_details"
[0m18:16:54.317755 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.date_details
[0m18:16:54.317969 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.date_details
[0m18:16:54.344846 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:54.345215 [debug] [Thread-1  ]: On model.coffee_shop_zar.date_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.date_details"} */


        select datetime_diff(
        cast(date_add(current_date, interval 20 year ) as datetime),
        cast(date('2018-01-01') as datetime),
        day
    )
[0m18:16:55.498010 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.date_details"
[0m18:16:55.503316 [debug] [Thread-1  ]: finished collecting timing info
[0m18:16:55.503714 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.date_details
[0m18:16:55.572810 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.date_details"
[0m18:16:55.573529 [debug] [Thread-1  ]: On model.coffee_shop_zar.date_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.date_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`date_details`
  OPTIONS()
  as WITH date_spine AS (

  





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 8990
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( date('2018-01-01') as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= date_add(current_date, interval 20 year )

)

select * from filtered



)

select *
from date_spine

;


[0m18:16:56.289049 [debug] [Thread-1  ]: finished collecting timing info
[0m18:16:56.289668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef162e3-6d53-47b6-af2e-85f320454913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631abdb50>]}
[0m18:16:56.290113 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.date_details ........................... [[32mOK[0m in 1.97s]
[0m18:16:56.290667 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.date_details
[0m18:16:56.292340 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:16:56.292743 [info ] [MainThread]: 
[0m18:16:56.293046 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m18:16:56.293358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:56.293522 [debug] [MainThread]: Connection 'model.coffee_shop_zar.date_details' was properly closed.
[0m18:16:56.306591 [info ] [MainThread]: 
[0m18:16:56.306925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:56.307285 [info ] [MainThread]: 
[0m18:16:56.307587 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:16:56.308035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631b34130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631b99df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3631ad48e0>]}


============================== 2022-08-13 18:30:34.533225 | dcf37463-5080-47c5-a440-dc8f6fa39af7 ==============================
[0m18:30:34.533259 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:30:34.534030 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:30:34.534331 [debug] [MainThread]: Tracking: tracking
[0m18:30:34.540387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d6dd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d6dd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d6dd970>]}
[0m18:30:34.685853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:34.686191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:34.688070 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:30:34.699775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcf37463-5080-47c5-a440-dc8f6fa39af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d3f50d0>]}
[0m18:30:34.717387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcf37463-5080-47c5-a440-dc8f6fa39af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d551c70>]}
[0m18:30:34.717800 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:30:34.718113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcf37463-5080-47c5-a440-dc8f6fa39af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d551df0>]}
[0m18:30:34.719191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d551d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d551c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37d551a30>]}


============================== 2022-08-13 18:34:21.569301 | 00b251dd-926c-479a-8aab-601d5c3ed5a9 ==============================
[0m18:34:21.569344 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:34:21.570239 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:34:21.570621 [debug] [MainThread]: Tracking: tracking
[0m18:34:21.576830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb516f69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb516f64f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb516f64c0>]}
[0m18:34:21.673735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:21.674449 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/calendar/date_details.sql
[0m18:34:21.690673 [debug] [MainThread]: 1699: static parser successfully parsed marts/calendar/date_details.sql
[0m18:34:21.713574 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:34:21.720632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00b251dd-926c-479a-8aab-601d5c3ed5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb50fcc0d0>]}
[0m18:34:21.736065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00b251dd-926c-479a-8aab-601d5c3ed5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb515550a0>]}
[0m18:34:21.736536 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:34:21.736909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00b251dd-926c-479a-8aab-601d5c3ed5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb516c73a0>]}
[0m18:34:21.738114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb516f30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb516f3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb516f3490>]}


============================== 2022-08-13 18:34:25.580773 | 9fc848be-5b7b-403c-9ff7-e06e91dfc325 ==============================
[0m18:34:25.580813 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:34:25.581730 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['date_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:34:25.582057 [debug] [MainThread]: Tracking: tracking
[0m18:34:25.587640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb7873d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb787e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb787a30>]}
[0m18:34:25.688572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:25.688918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:25.689842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:34:25.698517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fc848be-5b7b-403c-9ff7-e06e91dfc325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb4b50d0>]}
[0m18:34:25.713695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fc848be-5b7b-403c-9ff7-e06e91dfc325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb602280>]}
[0m18:34:25.714142 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:34:25.714667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fc848be-5b7b-403c-9ff7-e06e91dfc325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb6020d0>]}
[0m18:34:25.716495 [info ] [MainThread]: 
[0m18:34:25.717158 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:34:25.718164 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:34:25.718599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:28.953679 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:34:28.954181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:29.174779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fc848be-5b7b-403c-9ff7-e06e91dfc325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb602100>]}
[0m18:34:29.175854 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:34:29.176458 [info ] [MainThread]: 
[0m18:34:29.182175 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.date_details
[0m18:34:29.182639 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.date_details ................................ [RUN]
[0m18:34:29.183472 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.date_details"
[0m18:34:29.183980 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.date_details
[0m18:34:29.184319 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.date_details
[0m18:34:29.187415 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.date_details"
[0m18:34:29.190858 [debug] [Thread-1  ]: finished collecting timing info
[0m18:34:29.191176 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.date_details
[0m18:34:29.231140 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.date_details"
[0m18:34:29.231828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:34:29.232208 [debug] [Thread-1  ]: On model.coffee_shop_zar.date_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.date_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`date_details`
  OPTIONS()
  as with date_spine AS (
    
    select date_day
    from (
      select generate_date_array("2018-01-01", date_add(current_date, interval 20 year), interval 1 day) as dates
    ), 
    unnest(dates) as date_day

),


calculated as (

    select
      date_day,
      date_day as date_actual,
      format_date('%A', date_day) as day_name,
      extract(month from date_day) as month_actual,
      extract(year from date_day) as year_actual,
      extract(quarter from date_day) as quarter_actual,
      extract(week from date_day) as week_actual,
      date_trunc(date_day, month) as first_day_of_month,
      last_day(date_day) as last_day_of_month,
      (extract(year from date_day) || '-Q' || extract(quarter from date_day)) as quarter_name
    from date_spine
)

select *
from calculated;


[0m18:34:30.483805 [debug] [Thread-1  ]: finished collecting timing info
[0m18:34:30.484537 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fc848be-5b7b-403c-9ff7-e06e91dfc325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb475d30>]}
[0m18:34:30.485026 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.date_details ........................... [[32mOK[0m in 1.30s]
[0m18:34:30.485632 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.date_details
[0m18:34:30.487262 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:34:30.487695 [info ] [MainThread]: 
[0m18:34:30.488068 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m18:34:30.488510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:30.488718 [debug] [MainThread]: Connection 'model.coffee_shop_zar.date_details' was properly closed.
[0m18:34:30.504816 [info ] [MainThread]: 
[0m18:34:30.505210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:30.505650 [info ] [MainThread]: 
[0m18:34:30.506024 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:30.506543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb776c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb4fafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5eb38b670>]}


============================== 2022-08-13 18:37:26.155034 | 8cbcbc9a-11e9-4d36-a7ac-259ec4611e6b ==============================
[0m18:37:26.155065 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:37:26.155964 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['date_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:37:26.156299 [debug] [MainThread]: Tracking: tracking
[0m18:37:26.161991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb05b7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb05b7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb05b7ca0>]}
[0m18:37:26.259023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:26.259395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:26.260304 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:37:26.268783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cbcbc9a-11e9-4d36-a7ac-259ec4611e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb02f60d0>]}
[0m18:37:26.283493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cbcbc9a-11e9-4d36-a7ac-259ec4611e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb04383a0>]}
[0m18:37:26.283932 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:37:26.284307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cbcbc9a-11e9-4d36-a7ac-259ec4611e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb0438520>]}
[0m18:37:26.286087 [info ] [MainThread]: 
[0m18:37:26.286748 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:37:26.287758 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:37:26.288169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:27.429860 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:37:27.430381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:27.657907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cbcbc9a-11e9-4d36-a7ac-259ec4611e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb0438130>]}
[0m18:37:27.658777 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:37:27.659208 [info ] [MainThread]: 
[0m18:37:27.663865 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.date_details
[0m18:37:27.664294 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.date_details ................................ [RUN]
[0m18:37:27.665009 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.date_details"
[0m18:37:27.665260 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.date_details
[0m18:37:27.665511 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.date_details
[0m18:37:27.669326 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.date_details"
[0m18:37:27.669878 [debug] [Thread-1  ]: finished collecting timing info
[0m18:37:27.670135 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.date_details
[0m18:37:27.707194 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.date_details"
[0m18:37:27.707859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:27.708217 [debug] [Thread-1  ]: On model.coffee_shop_zar.date_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.date_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`date_details`
  OPTIONS()
  as with date_spine AS (
    
    select date_day
    from (
      select generate_date_array("2018-01-01", date_add(current_date, interval 20 year), interval 1 day) as dates
    ), 
    unnest(dates) as date_day

),


calculated as (

    select
      date_day,
      date_day as date_actual,
      format_date('%A', date_day) as day_name,
      extract(month from date_day) as month_actual,
      extract(year from date_day) as year_actual,
      extract(quarter from date_day) as quarter_actual,
      extract(week from date_day) as week_actual,
      date_trunc(date_day, month) as first_day_of_month,
      last_day(date_day) as last_day_of_month,
      (extract(year from date_day) || '-Q' || extract(quarter from date_day)) as quarter_name
    from date_spine
)

select *
from calculated;


[0m18:37:28.563602 [debug] [Thread-1  ]: finished collecting timing info
[0m18:37:28.564674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cbcbc9a-11e9-4d36-a7ac-259ec4611e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb01e0430>]}
[0m18:37:28.565413 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.date_details ........................... [[32mOK[0m in 0.90s]
[0m18:37:28.566620 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.date_details
[0m18:37:28.568468 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:37:28.569112 [info ] [MainThread]: 
[0m18:37:28.569555 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m18:37:28.569902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:28.570074 [debug] [MainThread]: Connection 'model.coffee_shop_zar.date_details' was properly closed.
[0m18:37:28.586326 [info ] [MainThread]: 
[0m18:37:28.586921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:28.587473 [info ] [MainThread]: 
[0m18:37:28.587830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:37:28.588354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb033bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb059ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb02c6fd0>]}


============================== 2022-08-13 18:38:21.787165 | ebc9e6a8-bdcd-4b78-af4d-8f990a4f0c20 ==============================
[0m18:38:21.787229 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:38:21.788604 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:38:21.789042 [debug] [MainThread]: Tracking: tracking
[0m18:38:21.796818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df977a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df9774f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df9774c0>]}
[0m18:38:21.944249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:21.945269 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/calendar/date_details.sql
[0m18:38:21.972822 [debug] [MainThread]: 1699: static parser successfully parsed marts/calendar/date_details.sql
[0m18:38:22.011617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:38:22.043431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebc9e6a8-bdcd-4b78-af4d-8f990a4f0c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df24b0d0>]}
[0m18:38:22.072178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebc9e6a8-bdcd-4b78-af4d-8f990a4f0c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df7d50a0>]}
[0m18:38:22.073003 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:38:22.073636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebc9e6a8-bdcd-4b78-af4d-8f990a4f0c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df9470a0>]}
[0m18:38:22.075734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df947160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df6f8e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39df6f87f0>]}


============================== 2022-08-13 18:38:22.556695 | a49bda8e-ba6b-4b9e-8adf-b089c2bedcb8 ==============================
[0m18:38:22.556729 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:38:22.557567 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['date_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:38:22.557877 [debug] [MainThread]: Tracking: tracking
[0m18:38:22.563426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa517447730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa517447f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa517447ac0>]}
[0m18:38:22.705062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:22.705523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:22.706818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:38:22.723022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a49bda8e-ba6b-4b9e-8adf-b089c2bedcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5171750d0>]}
[0m18:38:22.747378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a49bda8e-ba6b-4b9e-8adf-b089c2bedcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5172c3310>]}
[0m18:38:22.747979 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:38:22.748767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a49bda8e-ba6b-4b9e-8adf-b089c2bedcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5172c3160>]}
[0m18:38:22.751354 [info ] [MainThread]: 
[0m18:38:22.752404 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:38:22.754054 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:38:22.754840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:23.870513 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:38:23.871093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:24.141433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a49bda8e-ba6b-4b9e-8adf-b089c2bedcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5174369d0>]}
[0m18:38:24.142440 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:38:24.142947 [info ] [MainThread]: 
[0m18:38:24.147893 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.date_details
[0m18:38:24.148286 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.date_details ................................ [RUN]
[0m18:38:24.148948 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.date_details"
[0m18:38:24.149188 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.date_details
[0m18:38:24.149416 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.date_details
[0m18:38:24.153275 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.date_details"
[0m18:38:24.153770 [debug] [Thread-1  ]: finished collecting timing info
[0m18:38:24.154004 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.date_details
[0m18:38:24.192792 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.date_details"
[0m18:38:24.193428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:24.193773 [debug] [Thread-1  ]: On model.coffee_shop_zar.date_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.date_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`date_details`
  OPTIONS()
  as with date_spine AS (
    
    select date_day
    from (
      select generate_date_array("2018-01-01", date_add(current_date, interval 20 year), interval 1 day) as dates
    ), 
    unnest(dates) as date_day

),


calculated as (

    select
      date_day,
      date_day as date_actual,
      format_date('%A', date_day) as day_name,
      extract(month from date_day) as month_actual,
      extract(year from date_day) as year_actual,
      extract(quarter from date_day) as quarter_actual,
      extract(week from date_day) as week_actual,
      date_trunc(date_day, week) as week_start_on,
      date_add(date_trunc(date_day, week), interval 6 day) as week_end_on,
      date_trunc(date_day, month) as first_day_of_month,
      last_day(date_day) as last_day_of_month,
      (extract(year from date_day) || '-Q' || extract(quarter from date_day)) as quarter_name
    from date_spine
)

select *
from calculated;


[0m18:38:24.825085 [debug] [Thread-1  ]: finished collecting timing info
[0m18:38:24.825774 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a49bda8e-ba6b-4b9e-8adf-b089c2bedcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa517158160>]}
[0m18:38:24.826248 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.date_details ........................... [[32mOK[0m in 0.68s]
[0m18:38:24.826845 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.date_details
[0m18:38:24.828488 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:38:24.828948 [info ] [MainThread]: 
[0m18:38:24.829306 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m18:38:24.829691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:24.829970 [debug] [MainThread]: Connection 'model.coffee_shop_zar.date_details' was properly closed.
[0m18:38:24.844011 [info ] [MainThread]: 
[0m18:38:24.844513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:24.845032 [info ] [MainThread]: 
[0m18:38:24.845453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:38:24.845993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51741a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5171bbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa517158d90>]}


============================== 2022-08-13 18:45:17.894054 | ff5f1d7a-768f-4e26-bebb-ca35fcde0a99 ==============================
[0m18:45:17.894087 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:45:17.894915 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:45:17.895268 [debug] [MainThread]: Tracking: tracking
[0m18:45:17.900084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafdb5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafdb5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafdb5130>]}
[0m18:45:18.026012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:18.026327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:18.027112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:45:18.039396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff5f1d7a-768f-4e26-bebb-ca35fcde0a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafafbf40>]}
[0m18:45:18.059110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff5f1d7a-768f-4e26-bebb-ca35fcde0a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafc53e20>]}
[0m18:45:18.059562 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:45:18.059966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff5f1d7a-768f-4e26-bebb-ca35fcde0a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafc43070>]}
[0m18:45:18.060956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafc430a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafc53b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeafc538b0>]}


============================== 2022-08-13 18:53:54.662788 | 1abda00f-505c-4af9-b409-2d94eac4d828 ==============================
[0m18:53:54.662825 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:53:54.663600 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:53:54.663894 [debug] [MainThread]: Tracking: tracking
[0m18:53:54.671389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80412a18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80412a16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80412a1700>]}
[0m18:53:54.803743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:54.804114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:54.805003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:53:54.818087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1abda00f-505c-4af9-b409-2d94eac4d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8040fb30d0>]}
[0m18:53:54.832660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1abda00f-505c-4af9-b409-2d94eac4d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8041114670>]}
[0m18:53:54.833110 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:53:54.833436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1abda00f-505c-4af9-b409-2d94eac4d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80411147f0>]}
[0m18:53:54.834926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8041114790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8041114610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8041114430>]}


============================== 2022-08-13 18:54:30.731540 | d6746bd1-f0a8-4bd9-9af8-2da6d6aa44b9 ==============================
[0m18:54:30.731592 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:54:30.732699 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:54:30.733093 [debug] [MainThread]: Tracking: tracking
[0m18:54:30.739120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d29561c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d2956a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d29569d0>]}
[0m18:54:30.890715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:54:30.891623 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:54:30.919250 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:54:30.985951 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:54:30.998786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6746bd1-f0a8-4bd9-9af8-2da6d6aa44b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d223a0d0>]}
[0m18:54:31.020809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6746bd1-f0a8-4bd9-9af8-2da6d6aa44b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d26ba7c0>]}
[0m18:54:31.021343 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:54:31.021771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6746bd1-f0a8-4bd9-9af8-2da6d6aa44b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d2711ac0>]}
[0m18:54:31.023315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d267e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d2934d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d2934190>]}


============================== 2022-08-13 18:54:31.519601 | e2eaa859-08c6-4d1a-bfda-56bcc2ff98b2 ==============================
[0m18:54:31.519631 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:54:31.520474 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_coffee_shop__orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:54:31.520814 [debug] [MainThread]: Tracking: tracking
[0m18:54:31.525589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d1b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d1b51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d1b5af0>]}
[0m18:54:31.719215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:31.719665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:31.720962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:54:31.733879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2eaa859-08c6-4d1a-bfda-56bcc2ff98b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235cef50d0>]}
[0m18:54:31.759396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2eaa859-08c6-4d1a-bfda-56bcc2ff98b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d04d850>]}
[0m18:54:31.760023 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:54:31.760524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2eaa859-08c6-4d1a-bfda-56bcc2ff98b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d04d9d0>]}
[0m18:54:31.763083 [info ] [MainThread]: 
[0m18:54:31.763897 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:54:31.765227 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:54:31.765687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:34.869057 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:54:34.869636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:35.162514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2eaa859-08c6-4d1a-bfda-56bcc2ff98b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235cef5220>]}
[0m18:54:35.163481 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:54:35.163977 [info ] [MainThread]: 
[0m18:54:35.216837 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:35.217438 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.stg_coffee_shop__orders ..................... [RUN]
[0m18:54:35.218299 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:35.218598 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:35.218896 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:35.232338 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:35.233705 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:35.234078 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:35.332841 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:35.333635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:35.334073 [debug] [Thread-1  ]: On model.coffee_shop_zar.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    renamed as (

        select 
            id,
            created_at as created_at,
            date(created_at) as created_on,
            extract(year from date(created_at)) as year_of,
            date_trunc(date(created_at), month) as month_of,
            date_trunc(date(created_at)) as week_of,
            case extract(dayofweek from date(created_at)) 
                when 1 then "Sunday"
                when 2 then "Monday"
                when 3 then "Tuesday"
                when 4 then "Wednesday"
                when 5 then "Thursday"
                when 6 then "Friday"
                when 7 then "Saturday"
            end as day_of_week_name,
            customer_id,
            total as total_amount_usd,
            state,
            address,
            zip
        from orders

    )

    select *
    from renamed;


[0m18:54:36.697556 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function DATE_TRUNC for argument types: DATE. Supported signatures: DATE_TRUNC(DATE, DATE_TIME_PART); DATE_TRUNC(DATETIME, DATE_TIME_PART); DATE_TRUNC(TIMESTAMP, DATE_TIME_PART, [STRING]) at [20:13]')


============================== 2022-08-13 18:54:37.395473 | eb560ac1-a8f1-44df-b097-0abb624e27e3 ==============================
[0m18:54:37.395505 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:54:37.396404 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_coffee_shop__orders+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:54:37.396716 [debug] [MainThread]: Tracking: tracking
[0m18:54:37.403616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee54f5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee70f9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee70f9a00>]}
[0m18:54:37.506297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:37.506565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:37.507358 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:54:37.515559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb560ac1-a8f1-44df-b097-0abb624e27e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee52340d0>]}
[0m18:54:37.529606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb560ac1-a8f1-44df-b097-0abb624e27e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee5393700>]}
[0m18:54:37.530087 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:54:37.530546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb560ac1-a8f1-44df-b097-0abb624e27e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee5393880>]}
[0m18:54:37.532334 [info ] [MainThread]: 
[0m18:54:37.532938 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:54:37.533983 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:54:37.534327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:38.417378 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:38.417912 [debug] [Thread-1  ]: Database Error in model stg_coffee_shop__orders (models/staging/coffee_shop/stg_coffee_shop__orders.sql)
  No matching signature for function DATE_TRUNC for argument types: DATE. Supported signatures: DATE_TRUNC(DATE, DATE_TIME_PART); DATE_TRUNC(DATETIME, DATE_TIME_PART); DATE_TRUNC(TIMESTAMP, DATE_TIME_PART, [STRING]) at [20:13]
  compiled SQL at target/run/coffee_shop_zar/models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:54:38.418264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2eaa859-08c6-4d1a-bfda-56bcc2ff98b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235ceeaee0>]}
[0m18:54:38.418655 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.stg_coffee_shop__orders ............ [[31mERROR[0m in 3.20s]
[0m18:54:38.419230 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:38.420920 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:54:38.421487 [info ] [MainThread]: 
[0m18:54:38.421969 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m18:54:38.422563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:38.422941 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m18:54:38.423216 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__orders' was properly closed.
[0m18:54:38.442585 [info ] [MainThread]: 
[0m18:54:38.443113 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:54:38.443610 [info ] [MainThread]: 
[0m18:54:38.444075 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop__orders (models/staging/coffee_shop/stg_coffee_shop__orders.sql)[0m
[0m18:54:38.444702 [error] [MainThread]:   No matching signature for function DATE_TRUNC for argument types: DATE. Supported signatures: DATE_TRUNC(DATE, DATE_TIME_PART); DATE_TRUNC(DATETIME, DATE_TIME_PART); DATE_TRUNC(TIMESTAMP, DATE_TIME_PART, [STRING]) at [20:13]
[0m18:54:38.445156 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:54:38.445614 [info ] [MainThread]: 
[0m18:54:38.446239 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:54:38.446849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d18ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235cdbf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235cec28b0>]}
[0m18:54:38.674718 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:54:38.675157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:38.898060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb560ac1-a8f1-44df-b097-0abb624e27e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee54f4c40>]}
[0m18:54:38.899103 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:54:38.899657 [info ] [MainThread]: 
[0m18:54:38.905666 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:38.906168 [info ] [Thread-1  ]: 1 of 4 START view model dbt_lauren.stg_coffee_shop__orders ..................... [RUN]
[0m18:54:38.907002 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:38.907312 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:38.907629 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:38.916812 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:38.917364 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:38.917644 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:38.978968 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:38.979584 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:54:38.979918 [debug] [Thread-1  ]: On model.coffee_shop_zar.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    renamed as (

        select 
            id,
            created_at as created_at,
            date(created_at) as created_on,
            extract(year from date(created_at)) as year_of,
            date_trunc(date(created_at), month) as month_of,
            date_trunc(date(created_at)) as week_of,
            case extract(dayofweek from date(created_at)) 
                when 1 then "Sunday"
                when 2 then "Monday"
                when 3 then "Tuesday"
                when 4 then "Wednesday"
                when 5 then "Thursday"
                when 6 then "Friday"
                when 7 then "Saturday"
            end as day_of_week_name,
            customer_id,
            total as total_amount_usd,
            state,
            address,
            zip
        from orders

    )

    select *
    from renamed;


[0m18:54:39.611866 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function DATE_TRUNC for argument types: DATE. Supported signatures: DATE_TRUNC(DATE, DATE_TIME_PART); DATE_TRUNC(DATETIME, DATE_TIME_PART); DATE_TRUNC(TIMESTAMP, DATE_TIME_PART, [STRING]) at [20:13]')
[0m18:54:40.841836 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:40.842440 [debug] [Thread-1  ]: Database Error in model stg_coffee_shop__orders (models/staging/coffee_shop/stg_coffee_shop__orders.sql)
  No matching signature for function DATE_TRUNC for argument types: DATE. Supported signatures: DATE_TRUNC(DATE, DATE_TIME_PART); DATE_TRUNC(DATETIME, DATE_TIME_PART); DATE_TRUNC(TIMESTAMP, DATE_TIME_PART, [STRING]) at [20:13]
  compiled SQL at target/run/coffee_shop_zar/models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:54:40.842825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb560ac1-a8f1-44df-b097-0abb624e27e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee51f23d0>]}
[0m18:54:40.843245 [error] [Thread-1  ]: 1 of 4 ERROR creating view model dbt_lauren.stg_coffee_shop__orders ............ [[31mERROR[0m in 1.94s]
[0m18:54:40.843839 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:40.844784 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.order_details
[0m18:54:40.845009 [info ] [Thread-3  ]: 2 of 4 SKIP relation dbt_lauren.order_details .................................. [[33mSKIP[0m]
[0m18:54:40.845405 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.order_details
[0m18:54:40.846153 [debug] [Thread-5  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m18:54:40.846517 [debug] [Thread-6  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m18:54:40.846961 [info ] [Thread-6  ]: 4 of 4 SKIP relation dbt_lauren.weekly_revenue_by_product_category ............. [[33mSKIP[0m]
[0m18:54:40.847363 [debug] [Thread-6  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m18:54:40.846738 [info ] [Thread-5  ]: 3 of 4 SKIP relation dbt_lauren.weekly_revenue_by_new_existing_customers ....... [[33mSKIP[0m]
[0m18:54:40.847865 [debug] [Thread-5  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m18:54:40.849194 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:54:40.849614 [info ] [MainThread]: 
[0m18:54:40.849894 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m18:54:40.850271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:40.850481 [debug] [MainThread]: Connection 'list_aec-students_dbt_lauren' was properly closed.
[0m18:54:40.851164 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__orders' was properly closed.
[0m18:54:40.864409 [info ] [MainThread]: 
[0m18:54:40.864805 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:54:40.865208 [info ] [MainThread]: 
[0m18:54:40.865540 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop__orders (models/staging/coffee_shop/stg_coffee_shop__orders.sql)[0m
[0m18:54:40.865837 [error] [MainThread]:   No matching signature for function DATE_TRUNC for argument types: DATE. Supported signatures: DATE_TRUNC(DATE, DATE_TIME_PART); DATE_TRUNC(DATETIME, DATE_TIME_PART); DATE_TRUNC(TIMESTAMP, DATE_TIME_PART, [STRING]) at [20:13]
[0m18:54:40.866129 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:54:40.866447 [info ] [MainThread]: 
[0m18:54:40.866740 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m18:54:40.867170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee50faf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee5393550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee5106b80>]}


============================== 2022-08-13 18:54:55.880386 | 35251e55-3747-437d-9133-cffcfac1ee7d ==============================
[0m18:54:55.880434 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:54:55.881702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_coffee_shop__orders+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:54:55.882090 [debug] [MainThread]: Tracking: tracking
[0m18:54:55.888478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2d2de880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2d2de640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2d2de6a0>]}
[0m18:54:56.030332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:54:56.031202 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:54:56.058751 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:54:56.130045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:54:56.142960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35251e55-3747-437d-9133-cffcfac1ee7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2cbeef70>]}
[0m18:54:56.165871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35251e55-3747-437d-9133-cffcfac1ee7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2d10ee80>]}
[0m18:54:56.166396 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:54:56.167032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35251e55-3747-437d-9133-cffcfac1ee7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2d2b4280>]}
[0m18:54:56.169782 [info ] [MainThread]: 
[0m18:54:56.170724 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:54:56.172226 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:54:56.172860 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-13 18:54:56.941074 | 6eec0733-0e50-4e2e-a32a-f3ee311c6ae1 ==============================
[0m18:54:56.941124 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:54:56.942241 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:54:56.942610 [debug] [MainThread]: Tracking: tracking
[0m18:54:56.948643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5755ce18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5755ce16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5755ce1700>]}
[0m18:54:57.175328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:57.176010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:57.178875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:54:57.201187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eec0733-0e50-4e2e-a32a-f3ee311c6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57559f50d0>]}
[0m18:54:57.231703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eec0733-0e50-4e2e-a32a-f3ee311c6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5755b4f670>]}
[0m18:54:57.232460 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:54:57.233013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eec0733-0e50-4e2e-a32a-f3ee311c6ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5755b4f7f0>]}
[0m18:54:57.234892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5755b4f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5755b4f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5755b4f430>]}
[0m18:54:57.763318 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:54:57.763808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:57.979056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35251e55-3747-437d-9133-cffcfac1ee7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2d03a700>]}
[0m18:54:57.979806 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:54:57.980182 [info ] [MainThread]: 
[0m18:54:57.984459 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:57.984887 [info ] [Thread-1  ]: 1 of 4 START view model dbt_lauren.stg_coffee_shop__orders ..................... [RUN]
[0m18:54:57.985430 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:57.985610 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:57.985793 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:57.990847 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:57.991950 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:57.992189 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:58.024863 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m18:54:58.025360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:58.025621 [debug] [Thread-1  ]: On model.coffee_shop_zar.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    renamed as (

        select 
            id,
            created_at as created_at,
            date(created_at) as created_on,
            extract(year from date(created_at)) as year_of,
            date_trunc(date(created_at), month) as month_of,
            date_trunc(date(created_at), week) as week_of,
            case extract(dayofweek from date(created_at)) 
                when 1 then "Sunday"
                when 2 then "Monday"
                when 3 then "Tuesday"
                when 4 then "Wednesday"
                when 5 then "Thursday"
                when 6 then "Friday"
                when 7 then "Saturday"
            end as day_of_week_name,
            customer_id,
            total as total_amount_usd,
            state,
            address,
            zip
        from orders

    )

    select *
    from renamed;


[0m18:54:58.797082 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:58.797670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35251e55-3747-437d-9133-cffcfac1ee7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2ca666d0>]}
[0m18:54:58.798089 [info ] [Thread-1  ]: 1 of 4 OK created view model dbt_lauren.stg_coffee_shop__orders ................ [[32mOK[0m in 0.81s]
[0m18:54:58.798671 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m18:54:58.799467 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.order_details
[0m18:54:58.799816 [info ] [Thread-3  ]: 2 of 4 START view model dbt_lauren.order_details ............................... [RUN]
[0m18:54:58.800332 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m18:54:58.800503 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.order_details
[0m18:54:58.800697 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.order_details
[0m18:54:58.808059 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m18:54:58.813059 [debug] [Thread-3  ]: finished collecting timing info
[0m18:54:58.813321 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.order_details
[0m18:54:58.818197 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m18:54:58.818609 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:54:58.818834 [debug] [Thread-3  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),


    order_details as (
       
        select 
            orders.*,
            order_items.product_id,
            products.name as product_name,
            products.category as product_category,
            products.product_available_on,
            product_prices.* except(id, product_id, price_started_at, price_ended_at)
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at >= product_prices.price_started_at and 
            orders.created_at < product_prices.price_ended_at

    )

    select 
        id,
        created_at,
        created_on,
        year_of, 
        month_of,
        week_of,
        day_of_week_name,
        customer_id,
        state,
        address,
        zip,
        product_name,
        product_category,
        product_available_on,
        price_usd
    from order_details;


[0m18:54:59.908845 [debug] [Thread-3  ]: finished collecting timing info
[0m18:54:59.909423 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35251e55-3747-437d-9133-cffcfac1ee7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2cb0a640>]}
[0m18:54:59.909828 [info ] [Thread-3  ]: 2 of 4 OK created view model dbt_lauren.order_details .......................... [[32mOK[0m in 1.11s]
[0m18:54:59.910312 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.order_details
[0m18:54:59.911082 [debug] [Thread-5  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m18:54:59.911343 [debug] [Thread-6  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m18:54:59.911854 [info ] [Thread-6  ]: 4 of 4 START view model dbt_lauren.weekly_revenue_by_product_category .......... [RUN]
[0m18:54:59.912358 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m18:54:59.912544 [debug] [Thread-6  ]: Began compiling node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m18:54:59.912719 [debug] [Thread-6  ]: Compiling model.coffee_shop_zar.weekly_revenue_by_product_category
[0m18:54:59.916005 [debug] [Thread-6  ]: Writing injected SQL for node "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m18:54:59.916368 [debug] [Thread-6  ]: finished collecting timing info
[0m18:54:59.916576 [debug] [Thread-6  ]: Began executing node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m18:54:59.911577 [info ] [Thread-5  ]: 3 of 4 START view model dbt_lauren.weekly_revenue_by_new_existing_customers .... [RUN]
[0m18:54:59.920610 [debug] [Thread-6  ]: Writing runtime SQL for node "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m18:54:59.921173 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m18:54:59.921531 [debug] [Thread-5  ]: Began compiling node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m18:54:59.921813 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m18:54:59.921988 [debug] [Thread-5  ]: Compiling model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m18:54:59.922221 [debug] [Thread-6  ]: On model.coffee_shop_zar.weekly_revenue_by_product_category: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.weekly_revenue_by_product_category"} */


  create or replace view `aec-students`.`dbt_lauren`.`weekly_revenue_by_product_category`
  OPTIONS()
  as with 
    order_details as (
        select *
        from  `aec-students`.`dbt_lauren`.`order_details`
    ),

    weekly_aggregate as (

        select 
          week_of,
          product_category,
          sum(price_usd) as revenue_usd
        from order_details
        group by 
          week_of,
          product_category
    )

    select *
    from weekly_aggregate;


[0m18:54:59.925156 [debug] [Thread-5  ]: Writing injected SQL for node "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m18:54:59.927570 [debug] [Thread-5  ]: finished collecting timing info
[0m18:54:59.928097 [debug] [Thread-5  ]: Began executing node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m18:54:59.931710 [debug] [Thread-5  ]: Writing runtime SQL for node "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m18:54:59.932130 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m18:54:59.932464 [debug] [Thread-5  ]: On model.coffee_shop_zar.weekly_revenue_by_new_existing_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"} */


  create or replace view `aec-students`.`dbt_lauren`.`weekly_revenue_by_new_existing_customers`
  OPTIONS()
  as with 
    order_details as (
        select *,
          first_value(week_of) over (partition by customer_id order by created_at rows between unbounded preceding and unbounded following)
          as first_order_week_of
        from  `aec-students`.`dbt_lauren`.`order_details`
    ),

    weekly_aggregate as (
        select 
          week_of,
          sum(case when week_of = first_order_week_of then price_usd else 0 end) as new_customer_revenue_usd,
          sum(case when week_of > first_order_week_of then price_usd else 0 end) as existing_customer_revenue_usd
        from order_details
        group by 
          week_of

    )

    select *
    from weekly_aggregate;


[0m18:55:01.040007 [debug] [Thread-5  ]: finished collecting timing info
[0m18:55:01.040636 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35251e55-3747-437d-9133-cffcfac1ee7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2cb8a070>]}
[0m18:55:01.041067 [info ] [Thread-5  ]: 3 of 4 OK created view model dbt_lauren.weekly_revenue_by_new_existing_customers  [[32mOK[0m in 1.12s]
[0m18:55:01.041598 [debug] [Thread-5  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m18:55:01.058257 [debug] [Thread-6  ]: finished collecting timing info
[0m18:55:01.058722 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35251e55-3747-437d-9133-cffcfac1ee7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f2cb8a100>]}
[0m18:55:01.059112 [info ] [Thread-6  ]: 4 of 4 OK created view model dbt_lauren.weekly_revenue_by_product_category ..... [[32mOK[0m in 1.15s]
[0m18:55:01.059605 [debug] [Thread-6  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m18:55:01.061086 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:55:01.061522 [info ] [MainThread]: 
[0m18:55:01.061828 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m18:55:01.062150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:01.062318 [debug] [MainThread]: Connection 'model.coffee_shop_zar.stg_coffee_shop__orders' was properly closed.
[0m18:55:01.062463 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m18:55:01.062602 [debug] [MainThread]: Connection 'model.coffee_shop_zar.weekly_revenue_by_product_category' was properly closed.
[0m18:55:01.062740 [debug] [MainThread]: Connection 'model.coffee_shop_zar.weekly_revenue_by_new_existing_customers' was properly closed.
[0m18:55:01.119228 [info ] [MainThread]: 
[0m18:55:01.119590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:01.119989 [info ] [MainThread]: 
[0m18:55:01.120298 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:55:01.120722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f305080d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f30508190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f305730a0>]}


============================== 2022-08-13 19:03:15.462247 | 40b5cbc3-2967-4ad4-8463-62d7a30ab8e9 ==============================
[0m19:03:15.462282 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:03:15.463701 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m19:03:15.464133 [debug] [MainThread]: Tracking: tracking
[0m19:03:15.473006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc73077640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc73077d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc73077cd0>]}
[0m19:03:15.602526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:15.602868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:15.603649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m19:03:15.615155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40b5cbc3-2967-4ad4-8463-62d7a30ab8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc72db60d0>]}
[0m19:03:15.631814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40b5cbc3-2967-4ad4-8463-62d7a30ab8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc72f057f0>]}
[0m19:03:15.632217 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m19:03:15.632506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40b5cbc3-2967-4ad4-8463-62d7a30ab8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc72f05970>]}
[0m19:03:15.633518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc72f05910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc72f05790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc72f055b0>]}


============================== 2022-08-14 04:49:34.939866 | f94e12fc-9122-4039-8fa7-522e8bf851d7 ==============================
[0m04:49:34.939900 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:49:34.940632 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:49:34.940918 [debug] [MainThread]: Tracking: tracking
[0m04:49:34.947164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63d218e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63d216a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63d21700>]}
[0m04:49:35.081887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:35.082214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:35.083008 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m04:49:35.101389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f94e12fc-9122-4039-8fa7-522e8bf851d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63a340d0>]}
[0m04:49:35.123502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f94e12fc-9122-4039-8fa7-522e8bf851d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63b94670>]}
[0m04:49:35.124004 [info ] [MainThread]: Found 13 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m04:49:35.124486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f94e12fc-9122-4039-8fa7-522e8bf851d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63b947f0>]}
[0m04:49:35.125991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63b94790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63b94610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d63b94430>]}


============================== 2022-08-14 05:02:07.297114 | 68698a6e-de3d-4061-bb01-d62adffe3271 ==============================
[0m05:02:07.297152 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:02:07.298221 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:02:07.298597 [debug] [MainThread]: Tracking: tracking
[0m05:02:07.306058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806bd769d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806bd764f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806bd764c0>]}
[0m05:02:07.452488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:02:07.453009 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m05:02:07.467948 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/ltv_cohorts.sql
[0m05:02:07.498674 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:02:07.505117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68698a6e-de3d-4061-bb01-d62adffe3271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806b64c0d0>]}
[0m05:02:07.518932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68698a6e-de3d-4061-bb01-d62adffe3271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806baf9850>]}
[0m05:02:07.519438 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:02:07.519904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68698a6e-de3d-4061-bb01-d62adffe3271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806baf9910>]}
[0m05:02:07.521486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806bab26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806baf9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806baf9880>]}


============================== 2022-08-14 05:04:24.294407 | 36be3024-03ea-40b3-9033-d89fe06d18f0 ==============================
[0m05:04:24.294457 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:04:24.295585 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:04:24.296044 [debug] [MainThread]: Tracking: tracking
[0m05:04:24.307121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962dca1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962dca16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962dca1730>]}
[0m05:04:24.456540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:04:24.457383 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m05:04:24.484906 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m05:04:24.520893 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m05:04:24.541619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:04:24.555515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36be3024-03ea-40b3-9033-d89fe06d18f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962d998f40>]}
[0m05:04:24.578961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36be3024-03ea-40b3-9033-d89fe06d18f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962dada100>]}
[0m05:04:24.579496 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:04:24.579945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36be3024-03ea-40b3-9033-d89fe06d18f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962dad1fd0>]}
[0m05:04:24.581564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962dad1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962dc76250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962dc76d30>]}


============================== 2022-08-14 05:04:25.667741 | 8a1d9031-6d68-4268-8f69-948a52bb72f0 ==============================
[0m05:04:25.667773 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:04:25.668852 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:04:25.669158 [debug] [MainThread]: Tracking: tracking
[0m05:04:25.678552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c6af5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c6af5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c6af53a0>]}
[0m05:04:25.831853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:04:25.832263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:04:25.833638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:04:25.844293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a1d9031-6d68-4268-8f69-948a52bb72f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c68370d0>]}
[0m05:04:25.858758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a1d9031-6d68-4268-8f69-948a52bb72f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c6993d90>]}
[0m05:04:25.859116 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:04:25.859458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a1d9031-6d68-4268-8f69-948a52bb72f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c6993cd0>]}
[0m05:04:25.861261 [info ] [MainThread]: 
[0m05:04:25.861827 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:04:25.862728 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:04:25.863056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:04:29.039030 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:04:29.039528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:29.264625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a1d9031-6d68-4268-8f69-948a52bb72f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c8687730>]}
[0m05:04:29.265384 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:04:29.265763 [info ] [MainThread]: 
[0m05:04:29.271063 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m05:04:29.271510 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.ltv_cohorts ................................. [RUN]
[0m05:04:29.272185 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m05:04:29.272391 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m05:04:29.272638 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m05:04:29.285245 [debug] [Thread-1  ]: finished collecting timing info
[0m05:04:29.285628 [debug] [Thread-1  ]: Compilation Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  dbt was unable to infer all dependencies for the model "ltv_cohorts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "ltv_cohorts":
  
  -- depends_on: {{ ref('order_details') }}
  
  > in macro statement (macros/etc/statement.sql)
  > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m05:04:29.285974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a1d9031-6d68-4268-8f69-948a52bb72f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c6818640>]}
[0m05:04:29.286317 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.ltv_cohorts ........................ [[31mERROR[0m in 0.01s]
[0m05:04:29.286786 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m05:04:29.288179 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:04:29.288546 [info ] [MainThread]: 
[0m05:04:29.288835 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m05:04:29.289132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:04:29.289296 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m05:04:29.306401 [info ] [MainThread]: 
[0m05:04:29.306733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:04:29.307109 [info ] [MainThread]: 
[0m05:04:29.307425 [error] [MainThread]: [33mCompilation Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m05:04:29.307724 [error] [MainThread]:   dbt was unable to infer all dependencies for the model "ltv_cohorts".
[0m05:04:29.308056 [error] [MainThread]:   This typically happens when ref() is placed within a conditional block.
[0m05:04:29.308356 [error] [MainThread]:   
[0m05:04:29.308646 [error] [MainThread]:   To fix this, add the following hint to the top of the model "ltv_cohorts":
[0m05:04:29.308940 [error] [MainThread]:   
[0m05:04:29.309231 [error] [MainThread]:   -- depends_on: {{ ref('order_details') }}
[0m05:04:29.309522 [error] [MainThread]:   
[0m05:04:29.309812 [error] [MainThread]:   > in macro statement (macros/etc/statement.sql)
[0m05:04:29.310099 [error] [MainThread]:   > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m05:04:29.310389 [error] [MainThread]:   > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m05:04:29.310699 [info ] [MainThread]: 
[0m05:04:29.311005 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:04:29.311441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c68a0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c6707ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2c6837fd0>]}


============================== 2022-08-14 05:05:39.145887 | 6e481d2a-1df7-4f88-adb0-5e8612d66961 ==============================
[0m05:05:39.145940 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:05:39.147341 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:05:39.147718 [debug] [MainThread]: Tracking: tracking
[0m05:05:39.165269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d926b5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d926b53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d926b5940>]}
[0m05:05:39.333667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:05:39.334595 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m05:05:39.361512 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m05:05:39.397873 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m05:05:39.414540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:05:39.426948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e481d2a-1df7-4f88-adb0-5e8612d66961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d923e1ac0>]}
[0m05:05:39.449854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e481d2a-1df7-4f88-adb0-5e8612d66961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d92518220>]}
[0m05:05:39.450421 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:05:39.451121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e481d2a-1df7-4f88-adb0-5e8612d66961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d92518280>]}
[0m05:05:39.453766 [info ] [MainThread]: 
[0m05:05:39.454764 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:05:39.456218 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:05:39.457562 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 05:05:39.783382 | 13b5f343-ad67-4918-82ba-363dc2817a5a ==============================
[0m05:05:39.783434 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:05:39.784638 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:05:39.785001 [debug] [MainThread]: Tracking: tracking
[0m05:05:39.813317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65325364f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6532536e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65325369a0>]}
[0m05:05:40.023309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:05:40.023813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:05:40.026261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:05:40.040389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13b5f343-ad67-4918-82ba-363dc2817a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65322770d0>]}
[0m05:05:40.074823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13b5f343-ad67-4918-82ba-363dc2817a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65323d3c70>]}
[0m05:05:40.075458 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:05:40.075961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13b5f343-ad67-4918-82ba-363dc2817a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65323d3d00>]}
[0m05:05:40.077619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65323d3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65323d3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65323d3940>]}
[0m05:05:40.986928 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:05:40.987429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:05:41.243913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e481d2a-1df7-4f88-adb0-5e8612d66961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d9268ec40>]}
[0m05:05:41.244704 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:05:41.245091 [info ] [MainThread]: 
[0m05:05:41.249659 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m05:05:41.250070 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.ltv_cohorts ................................. [RUN]
[0m05:05:41.250663 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m05:05:41.251274 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m05:05:41.251633 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m05:05:41.262277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:05:41.262583 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */
select min(created_on) as reference_start_date, max(created_on) as reference_end_date from `aec-students`.`dbt_lauren`.`order_details`
[0m05:05:43.854011 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m05:05:43.857856 [debug] [Thread-1  ]: finished collecting timing info
[0m05:05:43.858145 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m05:05:43.889447 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m05:05:43.890031 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace view `aec-students`.`dbt_lauren`.`ltv_cohorts`
  OPTIONS()
  as depends_on: `aec-students`.`dbt_lauren`.`order_details`with
  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_actual = week_start_on
      and date_actual >= reference_start_date
      and date_actual <= reference_end_date
  ),

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      sum(price_usd) as revenue
    from `aec-students.dbt_lauren.order_details` 
    group by 
      customer_id,
      week_of
  ),

  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.customer_first_order
    from date_details
    cross join (select customer_id, min(week_of) as customer_first_order from weekly_customer_revenue group by customer_id) as cohorts
    where date_details.week_start_on >= cohorts.customer_first_order
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.customer_first_order,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  )


select *
from cohort_details
order by customer_id, week_start_on;


[0m05:05:44.109450 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "depends_on" at [6:6]')
[0m05:05:45.066811 [debug] [Thread-1  ]: finished collecting timing info
[0m05:05:45.067416 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "depends_on" at [6:6]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m05:05:45.067832 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e481d2a-1df7-4f88-adb0-5e8612d66961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d922f5ee0>]}
[0m05:05:45.068284 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.ltv_cohorts ........................ [[31mERROR[0m in 3.82s]
[0m05:05:45.068834 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m05:05:45.070430 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:05:45.070820 [info ] [MainThread]: 
[0m05:05:45.071107 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m05:05:45.071423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:05:45.071588 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m05:05:45.085507 [info ] [MainThread]: 
[0m05:05:45.085847 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:05:45.086241 [info ] [MainThread]: 
[0m05:05:45.086568 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m05:05:45.086874 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "depends_on" at [6:6]
[0m05:05:45.087168 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m05:05:45.087476 [info ] [MainThread]: 
[0m05:05:45.087797 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:05:45.088262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d9268eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d92442ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d924075e0>]}


============================== 2022-08-14 05:05:56.105487 | 49e3d91a-f2a1-47cd-94a1-f9605833d4fc ==============================
[0m05:05:56.105521 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:05:56.106285 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:05:56.106600 [debug] [MainThread]: Tracking: tracking
[0m05:05:56.114775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845fe28b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845fe2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845fe26d0>]}
[0m05:05:56.212192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:05:56.212818 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m05:05:56.228069 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m05:05:56.249054 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m05:05:56.260682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:05:56.267498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e3d91a-f2a1-47cd-94a1-f9605833d4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845ce00d0>]}
[0m05:05:56.281800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e3d91a-f2a1-47cd-94a1-f9605833d4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845e11e80>]}
[0m05:05:56.282177 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:05:56.282471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e3d91a-f2a1-47cd-94a1-f9605833d4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845e11ee0>]}
[0m05:05:56.283501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845e11eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845d3cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2845d3ce20>]}


============================== 2022-08-14 05:06:12.224785 | ed120da5-e98e-463a-980d-6a7ba168f455 ==============================
[0m05:06:12.224811 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:06:12.225626 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:06:12.225920 [debug] [MainThread]: Tracking: tracking
[0m05:06:12.232164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2dde8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2dde670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2dde6d0>]}
[0m05:06:12.330368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:06:12.330675 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:06:12.331475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:06:12.339353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed120da5-e98e-463a-980d-6a7ba168f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2af90d0>]}
[0m05:06:12.353137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed120da5-e98e-463a-980d-6a7ba168f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2c49910>]}
[0m05:06:12.353498 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:06:12.353841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed120da5-e98e-463a-980d-6a7ba168f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2c499a0>]}
[0m05:06:12.355541 [info ] [MainThread]: 
[0m05:06:12.356141 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:06:12.357088 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:06:12.357443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:06:13.437105 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:06:13.437767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:06:13.695846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed120da5-e98e-463a-980d-6a7ba168f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2c49340>]}
[0m05:06:13.696644 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:06:13.697026 [info ] [MainThread]: 
[0m05:06:13.701788 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m05:06:13.702149 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.ltv_cohorts ................................. [RUN]
[0m05:06:13.702734 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m05:06:13.702949 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m05:06:13.703169 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m05:06:13.715199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:06:13.715485 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */
select min(created_on) as reference_start_date, max(created_on) as reference_end_date from `aec-students`.`dbt_lauren`.`order_details`
[0m05:06:15.033041 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m05:06:15.033604 [debug] [Thread-1  ]: finished collecting timing info
[0m05:06:15.033858 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m05:06:15.065996 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m05:06:15.066495 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace view `aec-students`.`dbt_lauren`.`ltv_cohorts`
  OPTIONS()
  as -- depends_on: `aec-students`.`dbt_lauren`.`order_details`with
  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_actual = week_start_on
      and date_actual >= reference_start_date
      and date_actual <= reference_end_date
  ),

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      sum(price_usd) as revenue
    from `aec-students.dbt_lauren.order_details` 
    group by 
      customer_id,
      week_of
  ),

  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.customer_first_order
    from date_details
    cross join (select customer_id, min(week_of) as customer_first_order from weekly_customer_revenue group by customer_id) as cohorts
    where date_details.week_start_on >= cohorts.customer_first_order
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.customer_first_order,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  )


select *
from cohort_details
order by customer_id, week_start_on;


[0m05:06:15.308395 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "date_details" at [7:3]')
[0m05:06:16.611219 [debug] [Thread-1  ]: finished collecting timing info
[0m05:06:16.611795 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "date_details" at [7:3]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m05:06:16.612223 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed120da5-e98e-463a-980d-6a7ba168f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2a97910>]}
[0m05:06:16.612659 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.ltv_cohorts ........................ [[31mERROR[0m in 2.91s]
[0m05:06:16.613212 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m05:06:16.614860 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:06:16.615253 [info ] [MainThread]: 
[0m05:06:16.615543 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m05:06:16.615859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:06:16.616048 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m05:06:16.629119 [info ] [MainThread]: 
[0m05:06:16.629461 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:06:16.629845 [info ] [MainThread]: 
[0m05:06:16.630175 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m05:06:16.630480 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "date_details" at [7:3]
[0m05:06:16.630781 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m05:06:16.631168 [info ] [MainThread]: 
[0m05:06:16.631535 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:06:16.632077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2dde250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb2db6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eb29cad90>]}


============================== 2022-08-14 05:07:28.880634 | 4e62a64f-f145-441f-a7da-7a468fc8dc04 ==============================
[0m05:07:28.880668 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:07:28.881432 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:07:28.881778 [debug] [MainThread]: Tracking: tracking
[0m05:07:28.887987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9353785460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9353785d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9353785cd0>]}
[0m05:07:28.986499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:07:28.987042 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m05:07:29.003075 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m05:07:29.025666 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m05:07:29.036791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:07:29.043256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e62a64f-f145-441f-a7da-7a468fc8dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935349f0d0>]}
[0m05:07:29.056190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e62a64f-f145-441f-a7da-7a468fc8dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93535d4a60>]}
[0m05:07:29.056553 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:07:29.056909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e62a64f-f145-441f-a7da-7a468fc8dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93535d4b50>]}
[0m05:07:29.058064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93535d4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93534fde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93534fdc10>]}


============================== 2022-08-14 05:07:34.260804 | 3685aea3-f5a7-43af-bb63-d5d4c65c86fc ==============================
[0m05:07:34.260860 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:07:34.261884 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:07:34.262191 [debug] [MainThread]: Tracking: tracking
[0m05:07:34.268472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206c1b5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206c1b53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206c1b5b80>]}
[0m05:07:34.367297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:07:34.367535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:07:34.368351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:07:34.375857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3685aea3-f5a7-43af-bb63-d5d4c65c86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206bef80d0>]}
[0m05:07:34.390685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3685aea3-f5a7-43af-bb63-d5d4c65c86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206c04ed90>]}
[0m05:07:34.391021 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:07:34.391332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3685aea3-f5a7-43af-bb63-d5d4c65c86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206c04ecd0>]}
[0m05:07:34.393000 [info ] [MainThread]: 
[0m05:07:34.393584 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:07:34.394468 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:07:34.394791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:07:35.545771 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:07:35.546394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:07:35.828571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3685aea3-f5a7-43af-bb63-d5d4c65c86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206dd476a0>]}
[0m05:07:35.829314 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:07:35.829705 [info ] [MainThread]: 
[0m05:07:35.834235 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m05:07:35.834588 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.ltv_cohorts ................................. [RUN]
[0m05:07:35.835169 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m05:07:35.835366 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m05:07:35.835579 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m05:07:35.846957 [debug] [Thread-1  ]: finished collecting timing info
[0m05:07:35.847335 [debug] [Thread-1  ]: Compilation Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  dbt was unable to infer all dependencies for the model "ltv_cohorts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "ltv_cohorts":
  
  -- depends_on: {{ ref('order_details') }}
  
  > in macro statement (macros/etc/statement.sql)
  > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m05:07:35.847685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3685aea3-f5a7-43af-bb63-d5d4c65c86fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206bede970>]}
[0m05:07:35.848056 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.ltv_cohorts ........................ [[31mERROR[0m in 0.01s]
[0m05:07:35.848523 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m05:07:35.849943 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:07:35.850305 [info ] [MainThread]: 
[0m05:07:35.850583 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m05:07:35.850904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:07:35.851063 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m05:07:35.867346 [info ] [MainThread]: 
[0m05:07:35.867679 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:07:35.868082 [info ] [MainThread]: 
[0m05:07:35.868395 [error] [MainThread]: [33mCompilation Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m05:07:35.868691 [error] [MainThread]:   dbt was unable to infer all dependencies for the model "ltv_cohorts".
[0m05:07:35.868982 [error] [MainThread]:   This typically happens when ref() is placed within a conditional block.
[0m05:07:35.869278 [error] [MainThread]:   
[0m05:07:35.869570 [error] [MainThread]:   To fix this, add the following hint to the top of the model "ltv_cohorts":
[0m05:07:35.869851 [error] [MainThread]:   
[0m05:07:35.870133 [error] [MainThread]:   -- depends_on: {{ ref('order_details') }}
[0m05:07:35.870414 [error] [MainThread]:   
[0m05:07:35.870701 [error] [MainThread]:   > in macro statement (macros/etc/statement.sql)
[0m05:07:35.870990 [error] [MainThread]:   > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m05:07:35.871273 [error] [MainThread]:   > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m05:07:35.871572 [info ] [MainThread]: 
[0m05:07:35.871871 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:07:35.872310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206bdc8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206bdc8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206bef8f10>]}


============================== 2022-08-14 05:10:41.090134 | 1e2c6eec-e430-4843-b010-c201be2cadf0 ==============================
[0m05:10:41.090197 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:10:41.091661 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:10:41.092089 [debug] [MainThread]: Tracking: tracking
[0m05:10:41.104965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f9b7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f9b7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f9b78e0>]}
[0m05:10:41.269887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:10:41.270729 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m05:10:41.297648 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m05:10:41.335046 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m05:10:41.352370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:10:41.366244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e2c6eec-e430-4843-b010-c201be2cadf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f6e10d0>]}
[0m05:10:41.390097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e2c6eec-e430-4843-b010-c201be2cadf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f812df0>]}
[0m05:10:41.390661 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:10:41.392216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e2c6eec-e430-4843-b010-c201be2cadf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f812e50>]}
[0m05:10:41.395404 [info ] [MainThread]: 
[0m05:10:41.396329 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:10:41.397966 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:10:41.398973 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 05:10:42.756752 | c38f644d-77f5-4ba4-95c8-70073edee06e ==============================
[0m05:10:42.756806 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:10:42.757910 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:10:42.762555 [debug] [MainThread]: Tracking: tracking
[0m05:10:42.781245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144e561c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144e56a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144e569d0>]}
[0m05:10:42.937211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:10:42.937468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:10:42.938264 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:10:42.946280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c38f644d-77f5-4ba4-95c8-70073edee06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144b790d0>]}
[0m05:10:42.959659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c38f644d-77f5-4ba4-95c8-70073edee06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144cd0af0>]}
[0m05:10:42.960036 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:10:42.960303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c38f644d-77f5-4ba4-95c8-70073edee06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144cd0b80>]}
[0m05:10:42.961346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144cd0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144cd0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa144cd07c0>]}
[0m05:10:43.406808 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:10:43.407252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:43.663971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e2c6eec-e430-4843-b010-c201be2cadf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f73df10>]}
[0m05:10:43.665249 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:10:43.665781 [info ] [MainThread]: 
[0m05:10:43.670559 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m05:10:43.670921 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.ltv_cohorts ................................. [RUN]
[0m05:10:43.671521 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m05:10:43.671725 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m05:10:43.671968 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m05:10:43.682902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:10:43.683188 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */
select min(created_on) as reference_start_date, max(created_on) as reference_end_date from `aec-students`.`dbt_lauren`.`order_details`
[0m05:10:45.183168 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m05:10:45.183747 [debug] [Thread-1  ]: finished collecting timing info
[0m05:10:45.184034 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m05:10:45.213599 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m05:10:45.214094 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace view `aec-students`.`dbt_lauren`.`ltv_cohorts`
  OPTIONS()
  as -- depends_on: `aec-students`.`dbt_lauren`.`order_details`

with
  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_actual = week_start_on
      and date_actual >= reference_start_date
      and date_actual <= reference_end_date
  ),

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      sum(price_usd) as revenue
    from `aec-students.dbt_lauren.order_details` 
    group by 
      customer_id,
      week_of
  ),

  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.customer_first_order
    from date_details
    cross join (select customer_id, min(week_of) as customer_first_order from weekly_customer_revenue group by customer_id) as cohorts
    where date_details.week_start_on >= cohorts.customer_first_order
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.customer_first_order,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  )


select *
from cohort_details
order by customer_id, week_start_on;


[0m05:10:46.036697 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reference_start_date at [14:26]')
[0m05:10:48.227656 [debug] [Thread-1  ]: finished collecting timing info
[0m05:10:48.228224 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  Unrecognized name: reference_start_date at [14:26]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m05:10:48.228629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e2c6eec-e430-4843-b010-c201be2cadf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f569fa0>]}
[0m05:10:48.229051 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.ltv_cohorts ........................ [[31mERROR[0m in 4.56s]
[0m05:10:48.229583 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m05:10:48.231130 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:10:48.231523 [info ] [MainThread]: 
[0m05:10:48.231828 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m05:10:48.232166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:10:48.232324 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m05:10:48.245555 [info ] [MainThread]: 
[0m05:10:48.245866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:10:48.246213 [info ] [MainThread]: 
[0m05:10:48.246505 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m05:10:48.246783 [error] [MainThread]:   Unrecognized name: reference_start_date at [14:26]
[0m05:10:48.247043 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m05:10:48.247315 [info ] [MainThread]: 
[0m05:10:48.247591 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:10:48.247986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f9c7a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f9c7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b3f65c040>]}


============================== 2022-08-14 05:20:32.420574 | 6dcd5f60-8d45-4798-9aa4-72d79cc774db ==============================
[0m05:20:32.420606 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:20:32.421336 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:20:32.421642 [debug] [MainThread]: Tracking: tracking
[0m05:20:32.426781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f76b5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f76b5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f76b5430>]}
[0m05:20:32.580186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:20:32.580598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:20:32.581544 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:20:32.592957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dcd5f60-8d45-4798-9aa4-72d79cc774db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f73f80d0>]}
[0m05:20:32.610217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dcd5f60-8d45-4798-9aa4-72d79cc774db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f75423d0>]}
[0m05:20:32.610607 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:20:32.610898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dcd5f60-8d45-4798-9aa4-72d79cc774db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f75421f0>]}
[0m05:20:32.612804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f75422b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f75421f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f7542160>]}


============================== 2022-08-14 05:29:36.870822 | eeb9da02-8107-4bdf-8d84-e8d22f342352 ==============================
[0m05:29:36.870857 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:29:36.872447 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:29:36.873586 [debug] [MainThread]: Tracking: tracking
[0m05:29:36.881597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4342b6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa435eb95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa435eb92b0>]}
[0m05:29:37.015681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:29:37.016012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:29:37.017068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:29:37.028341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeb9da02-8107-4bdf-8d84-e8d22f342352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa433ff80d0>]}
[0m05:29:37.046366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeb9da02-8107-4bdf-8d84-e8d22f342352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43414bb20>]}
[0m05:29:37.046737 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:29:37.047096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb9da02-8107-4bdf-8d84-e8d22f342352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43414bbb0>]}
[0m05:29:37.048641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43414b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43414ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43414b7f0>]}


============================== 2022-08-14 05:30:26.446951 | 8387179c-7f94-4ca7-ae49-6efcc578830d ==============================
[0m05:30:26.447000 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:30:26.448772 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:30:26.449233 [debug] [MainThread]: Tracking: tracking
[0m05:30:26.470471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b488730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b488f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b488ac0>]}
[0m05:30:26.644165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:30:26.645405 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m05:30:26.679856 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/ltv_cohorts.sql
[0m05:30:26.722456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:30:26.735884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8387179c-7f94-4ca7-ae49-6efcc578830d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ad4a0d0>]}
[0m05:30:26.759393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8387179c-7f94-4ca7-ae49-6efcc578830d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b2d4c10>]}
[0m05:30:26.759962 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:30:26.760665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8387179c-7f94-4ca7-ae49-6efcc578830d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b2d4c70>]}
[0m05:30:26.763272 [info ] [MainThread]: 
[0m05:30:26.764225 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:30:26.765525 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m05:30:26.766187 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 05:30:29.326820 | 31438f06-ed93-4b93-bcbe-e31d7857816d ==============================
[0m05:30:29.326852 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:30:29.327647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:30:29.328034 [debug] [MainThread]: Tracking: tracking
[0m05:30:29.343221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c63f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c63f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c63f6d0>]}
[0m05:30:29.486695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:30:29.487037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:30:29.487872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:30:29.501123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31438f06-ed93-4b93-bcbe-e31d7857816d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c3780d0>]}
[0m05:30:29.522659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31438f06-ed93-4b93-bcbe-e31d7857816d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c4cfcd0>]}
[0m05:30:29.523210 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:30:29.523682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31438f06-ed93-4b93-bcbe-e31d7857816d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c4cfd60>]}
[0m05:30:29.525287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c4cfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c4cfc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c4cf9a0>]}
[0m05:30:30.365791 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m05:30:30.366257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:30.591583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8387179c-7f94-4ca7-ae49-6efcc578830d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b1fdca0>]}
[0m05:30:30.592754 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:30:30.593335 [info ] [MainThread]: 
[0m05:30:30.613353 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m05:30:30.613742 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.ltv_cohorts ................................. [RUN]
[0m05:30:30.614265 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m05:30:30.614468 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m05:30:30.614685 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m05:30:30.619313 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m05:30:30.620055 [debug] [Thread-1  ]: finished collecting timing info
[0m05:30:30.620371 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m05:30:30.692307 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m05:30:30.692899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:30:30.693197 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace view `aec-students`.`dbt_lauren`.`ltv_cohorts`
  OPTIONS()
  as with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  )


select *
from cohort_details
order by customer_id, week_start_on;


[0m05:30:31.670409 [debug] [Thread-1  ]: finished collecting timing info
[0m05:30:31.670998 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8387179c-7f94-4ca7-ae49-6efcc578830d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ac1c0a0>]}
[0m05:30:31.671438 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.ltv_cohorts ............................ [[32mOK[0m in 1.06s]
[0m05:30:31.671999 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m05:30:31.673523 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m05:30:31.673925 [info ] [MainThread]: 
[0m05:30:31.674225 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m05:30:31.674562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:31.674732 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m05:30:31.693446 [info ] [MainThread]: 
[0m05:30:31.693952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:30:31.694436 [info ] [MainThread]: 
[0m05:30:31.694859 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:30:31.695464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b478d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b1fd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ac1cd30>]}


============================== 2022-08-14 05:47:56.462556 | 6ec31613-b00f-4f52-9495-72768e587e62 ==============================
[0m05:47:56.462590 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:47:56.463418 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:47:56.463796 [debug] [MainThread]: Tracking: tracking
[0m05:47:56.478647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45efff10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f1bf9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f1bf9250>]}
[0m05:47:56.605557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:47:56.605828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:47:56.606730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:47:56.618381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ec31613-b00f-4f52-9495-72768e587e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45efd370d0>]}
[0m05:47:56.634206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ec31613-b00f-4f52-9495-72768e587e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45efe8fb50>]}
[0m05:47:56.634541 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:47:56.634811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ec31613-b00f-4f52-9495-72768e587e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45efe8fbe0>]}
[0m05:47:56.635777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45efe8f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45efe8fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45efe8f820>]}


============================== 2022-08-14 06:01:44.316683 | ab99090e-1086-47d0-b8b5-74f9ea7de1a1 ==============================
[0m06:01:44.316721 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:01:44.317846 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m06:01:44.318217 [debug] [MainThread]: Tracking: tracking
[0m06:01:44.325997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3d037a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3d0374f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3d0374c0>]}
[0m06:01:44.462657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:01:44.462945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:01:44.463801 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m06:01:44.475493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab99090e-1086-47d0-b8b5-74f9ea7de1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3cd770d0>]}
[0m06:01:44.491156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab99090e-1086-47d0-b8b5-74f9ea7de1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3cecfc10>]}
[0m06:01:44.491545 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m06:01:44.491824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab99090e-1086-47d0-b8b5-74f9ea7de1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3cecfca0>]}
[0m06:01:44.492884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3cecfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3cecfb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3cecf8e0>]}


============================== 2022-08-14 06:03:10.707989 | d743f86e-cb4f-48c6-858c-a984ad0b63af ==============================
[0m06:03:10.708024 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:03:10.708803 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m06:03:10.709144 [debug] [MainThread]: Tracking: tracking
[0m06:03:10.719265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056623f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056623f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056623fa30>]}
[0m06:03:10.813749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:03:10.814344 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m06:03:10.829391 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/ltv_cohorts.sql
[0m06:03:10.850592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m06:03:10.857169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd743f86e-cb4f-48c6-858c-a984ad0b63af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0565b04f40>]}
[0m06:03:10.874159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd743f86e-cb4f-48c6-858c-a984ad0b63af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0566096370>]}
[0m06:03:10.874530 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m06:03:10.874807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd743f86e-cb4f-48c6-858c-a984ad0b63af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05660963d0>]}
[0m06:03:10.875785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05660963a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0565fc3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0565fc3a00>]}


============================== 2022-08-14 06:03:14.010845 | cb84438b-8205-49fa-bc1b-edec1c7cc31b ==============================
[0m06:03:14.010880 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:03:14.011581 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m06:03:14.011863 [debug] [MainThread]: Tracking: tracking
[0m06:03:14.018012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77381a18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77381a1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77381a16d0>]}
[0m06:03:14.118031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:03:14.118298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:03:14.119111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m06:03:14.127254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb84438b-8205-49fa-bc1b-edec1c7cc31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7737eb90d0>]}
[0m06:03:14.141510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb84438b-8205-49fa-bc1b-edec1c7cc31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773800e9a0>]}
[0m06:03:14.142036 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m06:03:14.142443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb84438b-8205-49fa-bc1b-edec1c7cc31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773800ea30>]}
[0m06:03:14.144032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773800e820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773800e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773800e670>]}


============================== 2022-08-14 17:50:33.029793 | aff7a9df-8a98-4c82-a963-d93dc9952f2d ==============================
[0m17:50:33.029854 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:50:33.040029 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:50:33.040473 [debug] [MainThread]: Tracking: tracking
[0m17:50:33.051781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d7628b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d762670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d7626d0>]}
[0m17:50:33.187714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:33.189701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:33.191790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:50:33.203681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aff7a9df-8a98-4c82-a963-d93dc9952f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d4790d0>]}
[0m17:50:33.219872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aff7a9df-8a98-4c82-a963-d93dc9952f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d5ce940>]}
[0m17:50:33.220271 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:50:33.220562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff7a9df-8a98-4c82-a963-d93dc9952f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d5ce9d0>]}
[0m17:50:33.221566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d5ce7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d5ce8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9d5ce610>]}


============================== 2022-08-14 17:56:01.619628 | f7a7809c-7726-4f9b-b869-acaa3ee3ef8c ==============================
[0m17:56:01.619658 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:56:01.620556 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:56:01.620914 [debug] [MainThread]: Tracking: tracking
[0m17:56:01.630171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb4df8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb4df670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb4df6d0>]}
[0m17:56:01.728759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:56:01.729073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:56:01.729874 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:56:01.738182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7a7809c-7726-4f9b-b869-acaa3ee3ef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb1f90d0>]}
[0m17:56:01.751726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7a7809c-7726-4f9b-b869-acaa3ee3ef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb34d9d0>]}
[0m17:56:01.752080 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:56:01.752418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7a7809c-7726-4f9b-b869-acaa3ee3ef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb34da60>]}
[0m17:56:01.754133 [info ] [MainThread]: 
[0m17:56:01.754719 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:56:01.755630 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:56:01.755974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:04.580896 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:56:04.581340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:04.816258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7a7809c-7726-4f9b-b869-acaa3ee3ef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb49e7c0>]}
[0m17:56:04.817257 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:56:04.817745 [info ] [MainThread]: 
[0m17:56:04.832125 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m17:56:04.832642 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.ltv_cohorts ................................. [RUN]
[0m17:56:04.833153 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m17:56:04.833331 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m17:56:04.833542 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m17:56:04.838063 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:56:04.838508 [debug] [Thread-1  ]: finished collecting timing info
[0m17:56:04.838840 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m17:56:04.887989 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:56:04.888501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:56:04.888767 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace view `aec-students`.`dbt_lauren`.`ltv_cohorts`
  OPTIONS()
  as with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week;


[0m17:56:05.873168 [debug] [Thread-1  ]: finished collecting timing info
[0m17:56:05.873750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a7809c-7726-4f9b-b869-acaa3ee3ef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb1dc3d0>]}
[0m17:56:05.874173 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.ltv_cohorts ............................ [[32mOK[0m in 1.04s]
[0m17:56:05.874713 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m17:56:05.876211 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:56:05.876677 [info ] [MainThread]: 
[0m17:56:05.876995 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m17:56:05.877330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:05.877555 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m17:56:05.890618 [info ] [MainThread]: 
[0m17:56:05.890940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:05.891349 [info ] [MainThread]: 
[0m17:56:05.891660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:56:05.892063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb0ea0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb4dfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecb1dc250>]}


============================== 2022-08-14 17:56:47.473057 | 61958b74-993e-4d9e-9c2d-e5967f72e150 ==============================
[0m17:56:47.473109 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:56:47.474247 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:56:47.474568 [debug] [MainThread]: Tracking: tracking
[0m17:56:47.494843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166719d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166719d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166719d6d0>]}
[0m17:56:47.644939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:47.645715 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m17:56:47.672651 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m17:56:47.699084 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m17:56:47.716331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:56:47.727954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61958b74-993e-4d9e-9c2d-e5967f72e150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666e810d0>]}
[0m17:56:47.749891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61958b74-993e-4d9e-9c2d-e5967f72e150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666fd2f10>]}
[0m17:56:47.750341 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:56:47.750758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61958b74-993e-4d9e-9c2d-e5967f72e150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666fd2f70>]}
[0m17:56:47.753321 [info ] [MainThread]: 
[0m17:56:47.754143 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:56:47.763028 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:56:47.763492 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 17:56:49.511011 | 4a519a7e-cb7f-4c47-bcc8-0af1aaa67982 ==============================
[0m17:56:49.511047 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:56:49.511906 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:56:49.512275 [debug] [MainThread]: Tracking: tracking
[0m17:56:49.518643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffd135220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffd135a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffd135940>]}
[0m17:56:49.614784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:56:49.615060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:56:49.615842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:56:49.623722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a519a7e-cb7f-4c47-bcc8-0af1aaa67982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffce780d0>]}
[0m17:56:49.636473 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:56:49.637080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:49.640660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a519a7e-cb7f-4c47-bcc8-0af1aaa67982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffcfc23a0>]}
[0m17:56:49.641013 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:56:49.641286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a519a7e-cb7f-4c47-bcc8-0af1aaa67982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffcfc21c0>]}
[0m17:56:49.642249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffcfc2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffcfc21c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffcfc2130>]}
[0m17:56:49.852523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61958b74-993e-4d9e-9c2d-e5967f72e150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666efdee0>]}
[0m17:56:49.853498 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:56:49.854002 [info ] [MainThread]: 
[0m17:56:49.865222 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m17:56:49.865735 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m17:56:49.866564 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m17:56:49.866870 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m17:56:49.867192 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m17:56:49.881616 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:56:49.884675 [debug] [Thread-1  ]: finished collecting timing info
[0m17:56:49.885029 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m17:56:49.902509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:56:50.354203 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:56:50.354850 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
     




with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= start_date and 
      date_actual <= end_date

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m17:56:51.074497 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: start_date at [35:22]')
[0m17:56:52.728526 [debug] [Thread-1  ]: finished collecting timing info
[0m17:56:52.729048 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  Unrecognized name: start_date at [35:22]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:56:52.729411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61958b74-993e-4d9e-9c2d-e5967f72e150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666cffbb0>]}
[0m17:56:52.729815 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 2.86s]
[0m17:56:52.730363 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m17:56:52.731949 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:56:52.732380 [info ] [MainThread]: 
[0m17:56:52.732675 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m17:56:52.732998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:52.733158 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m17:56:52.746076 [info ] [MainThread]: 
[0m17:56:52.746394 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:52.746762 [info ] [MainThread]: 
[0m17:56:52.747069 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m17:56:52.747358 [error] [MainThread]:   Unrecognized name: start_date at [35:22]
[0m17:56:52.747646 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:56:52.747941 [info ] [MainThread]: 
[0m17:56:52.748234 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:56:52.748722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1667176850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666efd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666e1ddc0>]}


============================== 2022-08-14 17:57:09.958344 | 79841ecd-f602-475d-bca3-0457b88d7f0f ==============================
[0m17:57:09.958389 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:57:09.959859 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:57:09.960289 [debug] [MainThread]: Tracking: tracking
[0m17:57:09.983486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1f1e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1f1e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1f1e700>]}
[0m17:57:10.147423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:10.148227 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m17:57:10.175007 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m17:57:10.201754 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m17:57:10.217965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:57:10.229679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79841ecd-f602-475d-bca3-0457b88d7f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1c200d0>]}
[0m17:57:10.251992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79841ecd-f602-475d-bca3-0457b88d7f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1d5a0a0>]}
[0m17:57:10.252537 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:57:10.253178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79841ecd-f602-475d-bca3-0457b88d7f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1eda970>]}
[0m17:57:10.255747 [info ] [MainThread]: 
[0m17:57:10.256652 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:57:10.257965 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:57:10.258617 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 17:57:11.312572 | 230ec6a2-4a12-45c6-ac9a-7d1cc994823d ==============================
[0m17:57:11.312634 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:57:11.313746 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:57:11.314160 [debug] [MainThread]: Tracking: tracking
[0m17:57:11.340741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6056a350a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6056a35f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6056a35820>]}
[0m17:57:11.494235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:11.494708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:11.496042 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:57:11.508418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '230ec6a2-4a12-45c6-ac9a-7d1cc994823d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60567790d0>]}
[0m17:57:11.531759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '230ec6a2-4a12-45c6-ac9a-7d1cc994823d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60568ca730>]}
[0m17:57:11.532283 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:57:11.532720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '230ec6a2-4a12-45c6-ac9a-7d1cc994823d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60568ca7c0>]}
[0m17:57:11.534232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60568ca5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60568ca6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60568ca400>]}
[0m17:57:11.875484 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:57:11.875957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:12.113273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79841ecd-f602-475d-bca3-0457b88d7f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1c7df10>]}
[0m17:57:12.114397 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:57:12.114998 [info ] [MainThread]: 
[0m17:57:12.126736 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m17:57:12.127379 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m17:57:12.128415 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m17:57:12.128887 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m17:57:12.129244 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m17:57:12.143018 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:57:12.143744 [debug] [Thread-1  ]: finished collecting timing info
[0m17:57:12.144098 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m17:57:12.204789 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:57:12.205710 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:57:12.206127 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
    

 


with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= start_date and 
      date_actual <= end_date

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m17:57:13.145782 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: start_date at [35:22]')
[0m17:57:14.248799 [debug] [Thread-1  ]: finished collecting timing info
[0m17:57:14.249584 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  Unrecognized name: start_date at [35:22]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:57:14.249975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79841ecd-f602-475d-bca3-0457b88d7f0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1a972e0>]}
[0m17:57:14.250391 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 2.12s]
[0m17:57:14.250966 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m17:57:14.252720 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:57:14.253125 [info ] [MainThread]: 
[0m17:57:14.253458 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m17:57:14.253774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:14.253940 [debug] [MainThread]: Connection 'list_aec-students_dbt_lauren' was properly closed.
[0m17:57:14.254087 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m17:57:14.266394 [info ] [MainThread]: 
[0m17:57:14.266710 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:57:14.267059 [info ] [MainThread]: 
[0m17:57:14.267352 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m17:57:14.267623 [error] [MainThread]:   Unrecognized name: start_date at [35:22]
[0m17:57:14.267911 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:57:14.268215 [info ] [MainThread]: 
[0m17:57:14.268539 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:57:14.268946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1f07490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1b9b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac1a84f70>]}


============================== 2022-08-14 17:57:57.912370 | 66f65eee-4de9-4f8f-b9f8-3c46efbdb254 ==============================
[0m17:57:57.912416 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:57:57.913580 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:57:57.913956 [debug] [MainThread]: Tracking: tracking
[0m17:57:57.922129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4eb35430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4eb35c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4eb353a0>]}
[0m17:57:58.068415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:58.069272 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m17:57:58.096148 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m17:57:58.123487 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m17:57:58.139810 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:57:58.151569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66f65eee-4de9-4f8f-b9f8-3c46efbdb254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4e85af10>]}
[0m17:57:58.173724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66f65eee-4de9-4f8f-b9f8-3c46efbdb254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4e999220>]}
[0m17:57:58.174260 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:57:58.174787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f65eee-4de9-4f8f-b9f8-3c46efbdb254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4e999280>]}
[0m17:57:58.177684 [info ] [MainThread]: 
[0m17:57:58.178613 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:57:58.179810 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:57:58.180501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:59.775340 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:57:59.776064 [debug] [ThreadPool]: Opening a new connection, currently in state closed


============================== 2022-08-14 17:58:00.028474 | 8f78c175-6dd6-45c4-93c2-16023f7b7d6e ==============================
[0m17:58:00.028506 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:58:00.029252 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:58:00.029572 [debug] [MainThread]: Tracking: tracking
[0m17:58:00.035366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9054228b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa905422670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9054226d0>]}
[0m17:58:00.134191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:00.134496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:00.135298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:58:00.143508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f78c175-6dd6-45c4-93c2-16023f7b7d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9051380d0>]}
[0m17:58:00.157356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f78c175-6dd6-45c4-93c2-16023f7b7d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9052918e0>]}
[0m17:58:00.157726 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:58:00.157991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f78c175-6dd6-45c4-93c2-16023f7b7d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa905291970>]}
[0m17:58:00.158957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa905291760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa905291850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9052915b0>]}
[0m17:58:00.181899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f65eee-4de9-4f8f-b9f8-3c46efbdb254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4eb10c40>]}
[0m17:58:00.182782 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:58:00.183156 [info ] [MainThread]: 
[0m17:58:00.187752 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m17:58:00.188103 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m17:58:00.188707 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m17:58:00.188925 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m17:58:00.189141 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m17:58:00.198323 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:58:00.198784 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:00.199014 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m17:58:00.235399 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:58:00.235901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:00.236165 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
    

 


with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= start_date and 
      date_actual <= end_date

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m17:58:01.156984 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: start_date at [35:22]')
[0m17:58:02.847798 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:02.848371 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  Unrecognized name: start_date at [35:22]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:58:02.848781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f65eee-4de9-4f8f-b9f8-3c46efbdb254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4e6c76d0>]}
[0m17:58:02.849193 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 2.66s]
[0m17:58:02.849745 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m17:58:02.851271 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:58:02.851705 [info ] [MainThread]: 
[0m17:58:02.852019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m17:58:02.852373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:02.852551 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m17:58:02.865064 [info ] [MainThread]: 
[0m17:58:02.865382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:58:02.865740 [info ] [MainThread]: 
[0m17:58:02.866041 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m17:58:02.866323 [error] [MainThread]:   Unrecognized name: start_date at [35:22]
[0m17:58:02.866600 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:58:02.866887 [info ] [MainThread]: 
[0m17:58:02.867203 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:58:02.867593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4e9d18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4eb10130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4e7dea30>]}


============================== 2022-08-14 17:58:22.427586 | ff56ec5c-bf6c-4b87-afb5-57e5e7a2a6c4 ==============================
[0m17:58:22.427632 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:58:22.428769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:58:22.429106 [debug] [MainThread]: Tracking: tracking
[0m17:58:22.455989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a911f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a911f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a911f6d0>]}
[0m17:58:22.614180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:58:22.615004 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m17:58:22.643183 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m17:58:22.670151 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m17:58:22.686119 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:58:22.698598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff56ec5c-bf6c-4b87-afb5-57e5e7a2a6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8e200d0>]}
[0m17:58:22.720072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff56ec5c-bf6c-4b87-afb5-57e5e7a2a6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8f53f10>]}
[0m17:58:22.720584 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:58:22.721188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff56ec5c-bf6c-4b87-afb5-57e5e7a2a6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8f53f70>]}
[0m17:58:22.723738 [info ] [MainThread]: 
[0m17:58:22.724628 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:58:22.725802 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:58:22.726306 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 17:58:23.464235 | 580268c2-ccee-4888-8ad3-5bb76341bfba ==============================
[0m17:58:23.464306 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:58:23.465444 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:58:23.465854 [debug] [MainThread]: Tracking: tracking
[0m17:58:23.479065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf56579580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf54985c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf54985dc0>]}
[0m17:58:23.627457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:23.627890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:23.629348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:58:23.644407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '580268c2-ccee-4888-8ad3-5bb76341bfba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf546b80d0>]}
[0m17:58:23.668015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '580268c2-ccee-4888-8ad3-5bb76341bfba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5480fd60>]}
[0m17:58:23.668596 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:58:23.669123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '580268c2-ccee-4888-8ad3-5bb76341bfba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5480fdf0>]}
[0m17:58:23.670781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5480fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5480fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5480fa30>]}
[0m17:58:24.203982 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:58:24.205707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:24.484278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff56ec5c-bf6c-4b87-afb5-57e5e7a2a6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8e7eee0>]}
[0m17:58:24.485033 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:58:24.485412 [info ] [MainThread]: 
[0m17:58:24.490133 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m17:58:24.490475 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m17:58:24.491081 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m17:58:24.491307 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m17:58:24.491510 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m17:58:24.499487 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:58:24.499960 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:24.500182 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m17:58:24.536001 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:58:24.536509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:24.536776 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
    

 


with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= 2020-12-27 and 
      date_actual <= 2021-10-01

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m17:58:25.277418 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator >= for argument types: DATE, INT64. Supported signature: ANY >= ANY at [35:7]')
[0m17:58:26.622863 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:26.624233 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  No matching signature for operator >= for argument types: DATE, INT64. Supported signature: ANY >= ANY at [35:7]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:58:26.624874 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff56ec5c-bf6c-4b87-afb5-57e5e7a2a6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8c974c0>]}
[0m17:58:26.625509 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 2.13s]
[0m17:58:26.626278 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m17:58:26.629172 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:58:26.629767 [info ] [MainThread]: 
[0m17:58:26.630186 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m17:58:26.631186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:26.631358 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m17:58:26.631508 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m17:58:26.643899 [info ] [MainThread]: 
[0m17:58:26.644214 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:58:26.644596 [info ] [MainThread]: 
[0m17:58:26.644889 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m17:58:26.645170 [error] [MainThread]:   No matching signature for operator >= for argument types: DATE, INT64. Supported signature: ANY >= ANY at [35:7]
[0m17:58:26.645444 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:58:26.645732 [info ] [MainThread]: 
[0m17:58:26.646388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:58:26.646792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8e47130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8e7e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8c9c820>]}


============================== 2022-08-14 17:58:54.447815 | 5c6cb265-fef8-407a-8ffa-93bd22ef8a57 ==============================
[0m17:58:54.447871 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:58:54.449428 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:58:54.449841 [debug] [MainThread]: Tracking: tracking
[0m17:58:54.470377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3fb7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3fb7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3fb7760>]}
[0m17:58:54.655356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:58:54.656205 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m17:58:54.684620 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m17:58:54.711937 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m17:58:54.728580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:58:54.740963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c6cb265-fef8-407a-8ffa-93bd22ef8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3ce00d0>]}
[0m17:58:54.763278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c6cb265-fef8-407a-8ffa-93bd22ef8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3e12d30>]}
[0m17:58:54.763813 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:58:54.764364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6cb265-fef8-407a-8ffa-93bd22ef8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3e12d90>]}
[0m17:58:54.768006 [info ] [MainThread]: 
[0m17:58:54.768936 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:58:54.778174 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:58:54.780514 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 17:58:55.509417 | 6d509b98-837f-4031-8eb1-daf1cd5fe9e6 ==============================
[0m17:58:55.509473 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:58:55.510649 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:58:55.511084 [debug] [MainThread]: Tracking: tracking
[0m17:58:55.528157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37539e28b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37539e2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37539e26d0>]}
[0m17:58:55.752877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:55.753329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:55.754775 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:58:55.768293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d509b98-837f-4031-8eb1-daf1cd5fe9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37536f90d0>]}
[0m17:58:55.792087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d509b98-837f-4031-8eb1-daf1cd5fe9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375384a970>]}
[0m17:58:55.792615 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:58:55.793053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d509b98-837f-4031-8eb1-daf1cd5fe9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375384aa00>]}
[0m17:58:55.794634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375384a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375384a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375384a640>]}
[0m17:58:56.356760 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:58:56.361697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:56.649468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6cb265-fef8-407a-8ffa-93bd22ef8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3d3dca0>]}
[0m17:58:56.650267 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:58:56.650650 [info ] [MainThread]: 
[0m17:58:56.655293 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m17:58:56.655651 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m17:58:56.656220 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m17:58:56.656445 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m17:58:56.656654 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m17:58:56.666714 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:56.667081 [debug] [Thread-1  ]: Compilation Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  'date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:58:56.667404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6cb265-fef8-407a-8ffa-93bd22ef8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3c82d00>]}
[0m17:58:56.667742 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 0.01s]
[0m17:58:56.668202 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m17:58:56.669606 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:58:56.669978 [info ] [MainThread]: 
[0m17:58:56.670277 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m17:58:56.670597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:56.670757 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m17:58:56.683049 [info ] [MainThread]: 
[0m17:58:56.683363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:58:56.683705 [info ] [MainThread]: 
[0m17:58:56.683995 [error] [MainThread]: [33mCompilation Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m17:58:56.684302 [error] [MainThread]:   'date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:58:56.684598 [info ] [MainThread]: 
[0m17:58:56.684879 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:58:56.685269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3e49700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3e49310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f3c62c70>]}


============================== 2022-08-14 17:59:23.067799 | a4114abb-9207-4d3a-9983-56a26e809a5f ==============================
[0m17:59:23.067847 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:59:23.069393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:59:23.069833 [debug] [MainThread]: Tracking: tracking
[0m17:59:23.089762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a92b2f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a92b2ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a92b2f970>]}
[0m17:59:23.273105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:23.273990 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m17:59:23.302679 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m17:59:23.329756 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m17:59:23.346024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:59:23.357918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4114abb-9207-4d3a-9983-56a26e809a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a927e00d0>]}
[0m17:59:23.379913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4114abb-9207-4d3a-9983-56a26e809a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a929163a0>]}
[0m17:59:23.380462 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:59:23.381076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4114abb-9207-4d3a-9983-56a26e809a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a92916400>]}
[0m17:59:23.383614 [info ] [MainThread]: 
[0m17:59:23.384518 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:59:23.385714 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:59:23.386383 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 17:59:25.081369 | fc031fde-a107-4782-8bf0-7994251a3ebe ==============================
[0m17:59:25.081403 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:59:25.082079 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m17:59:25.082366 [debug] [MainThread]: Tracking: tracking
[0m17:59:25.088157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0971a28b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0971a2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0971a26d0>]}
[0m17:59:25.191990 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:59:25.196722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:25.262283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:25.262755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:25.264098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m17:59:25.277969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc031fde-a107-4782-8bf0-7994251a3ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa096eb90d0>]}
[0m17:59:25.301263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc031fde-a107-4782-8bf0-7994251a3ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09700e970>]}
[0m17:59:25.301764 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:59:25.302197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc031fde-a107-4782-8bf0-7994251a3ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09700ea00>]}
[0m17:59:25.303719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09700e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09700e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09700e640>]}
[0m17:59:25.464842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4114abb-9207-4d3a-9983-56a26e809a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a92b2f700>]}
[0m17:59:25.465839 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:59:25.466360 [info ] [MainThread]: 
[0m17:59:25.496756 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m17:59:25.497236 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m17:59:25.497993 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m17:59:25.498273 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m17:59:25.498571 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m17:59:25.525982 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:59:25.526654 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:25.526970 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m17:59:25.689981 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m17:59:25.690551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:59:25.692678 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
    

 


with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= date(2020-12-27) and 
      date_actual <= date(2021-10-01)

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m17:59:26.504741 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function DATE for argument types: INT64. Supported signatures: DATE(TIMESTAMP, [STRING]); DATE(DATETIME); DATE(INT64, INT64, INT64); DATE(DATE); DATE(STRING) at [35:22]')
[0m17:59:27.965682 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:27.966265 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  No matching signature for function DATE for argument types: INT64. Supported signatures: DATE(TIMESTAMP, [STRING]); DATE(DATETIME); DATE(INT64, INT64, INT64); DATE(DATE); DATE(STRING) at [35:22]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:59:27.966659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4114abb-9207-4d3a-9983-56a26e809a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a92651c70>]}
[0m17:59:27.967073 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 2.47s]
[0m17:59:27.967615 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m17:59:27.969157 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:59:27.969545 [info ] [MainThread]: 
[0m17:59:27.969850 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m17:59:27.970172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:27.970330 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m17:59:27.982696 [info ] [MainThread]: 
[0m17:59:27.983010 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:59:27.983355 [info ] [MainThread]: 
[0m17:59:27.983654 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m17:59:27.983937 [error] [MainThread]:   No matching signature for function DATE for argument types: INT64. Supported signatures: DATE(TIMESTAMP, [STRING]); DATE(DATETIME); DATE(INT64, INT64, INT64); DATE(DATE); DATE(STRING) at [35:22]
[0m17:59:27.984203 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m17:59:27.984540 [info ] [MainThread]: 
[0m17:59:27.984836 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:59:27.985253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a928423a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a928429d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a927a41c0>]}


============================== 2022-08-14 18:00:38.297853 | 37b722d8-9779-4cc4-9420-d53fbb3aee89 ==============================
[0m18:00:38.297888 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:00:38.298799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:00:38.299086 [debug] [MainThread]: Tracking: tracking
[0m18:00:38.307728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0582a1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0582a1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0582a16a0>]}
[0m18:00:38.410245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:38.411019 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/ltv_cohorts.sql
[0m18:00:38.435825 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m18:00:38.454385 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m18:00:38.463513 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:00:38.469852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37b722d8-9779-4cc4-9420-d53fbb3aee89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe057fa00d0>]}
[0m18:00:38.483203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37b722d8-9779-4cc4-9420-d53fbb3aee89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0580d0fa0>]}
[0m18:00:38.483540 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:00:38.483806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37b722d8-9779-4cc4-9420-d53fbb3aee89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe058276280>]}
[0m18:00:38.484833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0580d90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0582a1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe058276280>]}


============================== 2022-08-14 18:00:49.792131 | d2b837fa-a6e7-4632-8d41-33c38dcf1da9 ==============================
[0m18:00:49.792175 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:00:49.793457 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:00:49.793858 [debug] [MainThread]: Tracking: tracking
[0m18:00:49.799340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64c754f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64c75e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64c75970>]}
[0m18:00:49.950842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:49.951146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:49.951956 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:00:49.961947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2b837fa-a6e7-4632-8d41-33c38dcf1da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a649b80d0>]}
[0m18:00:49.984088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2b837fa-a6e7-4632-8d41-33c38dcf1da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64b0dc70>]}
[0m18:00:49.984620 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:00:49.985125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b837fa-a6e7-4632-8d41-33c38dcf1da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64b0dd00>]}
[0m18:00:49.987706 [info ] [MainThread]: 
[0m18:00:49.988572 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:00:49.990044 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:00:49.990703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:51.083372 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:00:51.083816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:51.298218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b837fa-a6e7-4632-8d41-33c38dcf1da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a668079d0>]}
[0m18:00:51.298946 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:00:51.299324 [info ] [MainThread]: 
[0m18:00:51.303967 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m18:00:51.304348 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m18:00:51.304953 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m18:00:51.305651 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m18:00:51.305890 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m18:00:51.312037 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m18:00:51.312509 [debug] [Thread-1  ]: finished collecting timing info
[0m18:00:51.312712 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m18:00:51.375045 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m18:00:51.375638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:51.375964 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
    

 


with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= date(start_date) and 
      date_actual <= date(end_date)

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m18:00:52.276452 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: start_date at [35:27]')
[0m18:00:53.922006 [debug] [Thread-1  ]: finished collecting timing info
[0m18:00:53.922516 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  Unrecognized name: start_date at [35:27]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m18:00:53.922871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b837fa-a6e7-4632-8d41-33c38dcf1da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64933730>]}
[0m18:00:53.923289 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 2.62s]
[0m18:00:53.923826 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m18:00:53.925500 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:00:53.925909 [info ] [MainThread]: 
[0m18:00:53.926221 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m18:00:53.926532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:53.926711 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m18:00:53.939891 [info ] [MainThread]: 
[0m18:00:53.940265 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:53.940627 [info ] [MainThread]: 
[0m18:00:53.940926 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m18:00:53.941207 [error] [MainThread]:   Unrecognized name: start_date at [35:27]
[0m18:00:53.941497 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m18:00:53.941796 [info ] [MainThread]: 
[0m18:00:53.942079 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:00:53.942498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64a02bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64a203a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a64888a60>]}


============================== 2022-08-14 18:02:58.755589 | 514b3d6b-5f2c-401f-92d5-b6708f67dd19 ==============================
[0m18:02:58.755642 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:02:58.756795 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:02:58.757157 [debug] [MainThread]: Tracking: tracking
[0m18:02:58.763762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2914936280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2914936670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2914936d90>]}
[0m18:02:58.842296 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:02:58.842894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '514b3d6b-5f2c-401f-92d5-b6708f67dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291491c520>]}
[0m18:02:58.910690 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:02:58.915181 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:02:58.965951 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:02:58.978179 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:02:58.983175 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:02:58.985967 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:02:58.987435 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:02:58.988471 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:02:58.989703 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:02:58.990785 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:02:58.991999 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:02:58.992725 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:02:58.995287 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:02:58.997254 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:02:58.998306 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:02:59.000931 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:02:59.001920 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:02:59.003022 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:02:59.007990 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:02:59.011045 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:02:59.021109 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:02:59.026485 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:02:59.060396 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:02:59.065862 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:02:59.067579 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:02:59.068999 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:02:59.070631 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:02:59.073572 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:02:59.078655 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:02:59.105307 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:02:59.119050 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:02:59.148095 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:02:59.156823 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:02:59.176801 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:02:59.182363 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:02:59.186499 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:02:59.188369 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:02:59.190407 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:02:59.192159 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:02:59.194587 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:02:59.205634 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:02:59.207224 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:02:59.209730 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:02:59.212110 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:02:59.215219 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:02:59.217293 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:02:59.219525 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:02:59.221138 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:02:59.225124 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:02:59.228746 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:02:59.233601 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:02:59.235744 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:02:59.237585 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:02:59.240014 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:02:59.241903 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:02:59.244136 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:02:59.246261 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:02:59.261574 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:02:59.270519 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:02:59.284268 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:02:59.310000 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:02:59.339785 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:02:59.348852 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:02:59.382499 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:02:59.391261 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:02:59.422229 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:02:59.425217 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:02:59.444015 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:02:59.446569 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:02:59.457535 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:02:59.464140 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:02:59.468554 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:02:59.487945 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:02:59.492765 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:02:59.496273 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:02:59.532216 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:02:59.545702 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:02:59.574106 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:02:59.577241 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:02:59.599650 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:02:59.633207 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:02:59.636060 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:02:59.639076 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:02:59.643779 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:02:59.649550 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m18:02:59.655112 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m18:02:59.657655 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m18:02:59.660403 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m18:02:59.664758 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m18:02:59.668670 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m18:02:59.674595 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m18:02:59.679138 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m18:02:59.681582 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m18:02:59.684915 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m18:02:59.689839 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m18:02:59.707304 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m18:02:59.710906 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m18:02:59.717502 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m18:02:59.722016 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m18:02:59.724801 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m18:02:59.728624 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m18:02:59.731812 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m18:02:59.735363 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m18:02:59.737263 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m18:02:59.740390 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m18:02:59.744342 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m18:02:59.755372 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m18:02:59.757818 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m18:02:59.759952 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m18:02:59.762304 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m18:02:59.764372 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m18:02:59.769023 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m18:02:59.775023 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m18:02:59.777794 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m18:02:59.781287 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m18:02:59.785601 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m18:02:59.795814 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m18:02:59.798075 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m18:02:59.809506 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m18:02:59.817334 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m18:02:59.822348 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m18:02:59.839722 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m18:02:59.843427 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m18:02:59.849620 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m18:02:59.852624 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m18:02:59.854410 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m18:02:59.874351 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m18:02:59.879476 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m18:02:59.882624 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m18:02:59.885039 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m18:02:59.887651 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m18:02:59.890405 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:02:59.894488 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:02:59.897482 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:02:59.902726 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:02:59.905228 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:02:59.907599 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:02:59.909770 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:02:59.912120 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m18:02:59.961850 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:02:59.969476 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:02:59.977874 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m18:02:59.983166 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:02:59.991182 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:02:59.995734 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:03:00.007283 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m18:03:00.010233 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:03:00.012765 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:03:00.035559 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m18:03:00.048991 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:03:00.057091 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:03:00.065744 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:03:00.069106 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:03:00.072215 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:03:00.087361 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:03:00.098289 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:03:00.104925 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:03:00.108205 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:03:00.114773 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:03:00.117945 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:03:00.130196 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m18:03:00.148162 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m18:03:00.160597 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m18:03:00.169950 [debug] [MainThread]: Parsing macros/helpers/helpers.sql


============================== 2022-08-14 18:03:00.728202 | 1a1cb6dd-86ba-4589-af92-021cbdc6b50f ==============================
[0m18:03:00.728264 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:03:00.729205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:03:00.729503 [debug] [MainThread]: Tracking: tracking
[0m18:03:00.742074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83333b65b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83333b68b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83333b6160>]}
[0m18:03:00.862913 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:03:00.863577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a1cb6dd-86ba-4589-af92-021cbdc6b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83333b3430>]}
[0m18:03:00.929848 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:03:00.934680 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:03:00.983376 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:03:00.994565 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:03:00.999819 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:03:01.000776 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:03:01.001545 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:03:01.002587 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:03:01.003878 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:03:01.005028 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:03:01.006310 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:03:01.007089 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:03:01.009783 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:03:01.011799 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:03:01.012930 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:03:01.016492 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:03:01.017537 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:03:01.018615 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:03:01.025205 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:03:01.028430 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:03:01.037714 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:03:01.043288 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:03:01.075719 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:03:01.081306 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:03:01.083063 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:03:01.084482 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:03:01.086124 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:03:01.088949 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:03:01.094263 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:03:01.121962 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:03:01.135933 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:03:01.164910 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:03:01.175195 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:03:01.193539 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:03:01.199241 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:03:01.203434 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:03:01.205376 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:03:01.207366 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:03:01.209221 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:03:01.209479 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m18:03:01.211686 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:03:01.223929 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:03:01.225716 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:03:01.228079 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:03:01.230569 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m18:03:01.230754 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:03:01.232882 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:03:01.234794 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m18:03:01.235028 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:03:01.237247 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:03:01.238882 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:03:01.238936 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:03:01.242920 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:03:01.243230 [debug] [MainThread]: 1699: static parser successfully parsed marts/calendar/date_details.sql
[0m18:03:01.246551 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:03:01.247312 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m18:03:01.251398 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/stitch_visitor_events.sql
[0m18:03:01.251539 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:03:01.253729 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:03:01.255572 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:03:01.255785 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m18:03:01.258184 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:03:01.260193 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:03:01.260255 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_new_existing_customers.sql
[0m18:03:01.260550 [debug] [MainThread]: 1611: conducting full jinja rendering sample on marts/coffee_shop/weekly_revenue_by_new_existing_customers.sql
[0m18:03:01.262422 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:03:01.264461 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:03:01.281047 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:03:01.285628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '514b3d6b-5f2c-401f-92d5-b6708f67dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291475cac0>]}
[0m18:03:01.287811 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m18:03:01.289796 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:03:01.294325 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:03:01.297075 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m18:03:01.299140 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/customers.sql
[0m18:03:01.302156 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:03:01.303429 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/monthly_users.sql
[0m18:03:01.307339 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_product_category.sql
[0m18:03:01.311682 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m18:03:01.313608 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:03:01.318857 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:03:01.350723 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:03:01.376161 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:03:01.425595 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:03:01.428619 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:03:01.461735 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:03:01.467233 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:03:01.483319 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:03:01.494822 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:03:01.502466 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:03:01.516347 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:03:01.520639 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:03:01.524152 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:03:01.564605 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:03:01.582038 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:03:01.607050 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:03:01.610049 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:03:01.634464 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:03:01.666700 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:03:01.669552 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:03:01.672669 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:03:01.677501 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:03:01.683349 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m18:03:01.688579 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m18:03:01.689382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:03:01.691024 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m18:03:01.693766 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m18:03:01.698990 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m18:03:01.701636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '514b3d6b-5f2c-401f-92d5-b6708f67dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29140bcac0>]}
[0m18:03:01.702882 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m18:03:01.709799 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m18:03:01.715609 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m18:03:01.718367 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m18:03:01.721789 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m18:03:01.727270 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m18:03:01.744428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '514b3d6b-5f2c-401f-92d5-b6708f67dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29147f5490>]}
[0m18:03:01.744803 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m18:03:01.744990 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:03:01.745611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '514b3d6b-5f2c-401f-92d5-b6708f67dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291491c100>]}
[0m18:03:01.748090 [info ] [MainThread]: 
[0m18:03:01.748341 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m18:03:01.749009 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:03:01.754676 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:03:01.756113 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m18:03:01.756512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:01.763723 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m18:03:01.770640 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m18:03:01.774697 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m18:03:01.779161 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m18:03:01.790691 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m18:03:01.796312 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m18:03:01.799467 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m18:03:01.804503 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m18:03:01.818016 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m18:03:01.820831 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m18:03:01.829346 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m18:03:01.831664 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m18:03:01.833808 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m18:03:01.838171 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m18:03:01.844988 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m18:03:01.847717 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m18:03:01.854741 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m18:03:01.859778 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m18:03:01.890972 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m18:03:01.897886 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m18:03:01.910375 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m18:03:01.923186 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m18:03:01.928100 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m18:03:01.944678 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m18:03:01.948315 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m18:03:01.954542 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m18:03:01.957449 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m18:03:01.959237 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m18:03:01.979267 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m18:03:01.984468 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m18:03:01.987623 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m18:03:01.989999 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m18:03:01.992710 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m18:03:01.995477 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:03:01.999595 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:03:02.002590 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:03:02.007410 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:03:02.009928 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:03:02.012076 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:03:02.015340 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:03:02.017579 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m18:03:02.066804 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:03:02.081060 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:03:02.093115 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m18:03:02.098902 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:03:02.106715 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:03:02.111112 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:03:02.122918 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m18:03:02.125909 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:03:02.128495 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:03:02.150348 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m18:03:02.163825 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:03:02.172461 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:03:02.180637 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:03:02.183719 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:03:02.187053 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:03:02.202558 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:03:02.213316 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:03:02.221106 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:03:02.224326 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:03:02.231060 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:03:02.234180 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:03:02.246116 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m18:03:02.263206 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m18:03:02.274749 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m18:03:02.282491 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m18:03:03.280767 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m18:03:03.300610 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m18:03:03.304472 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m18:03:03.308315 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:03:03.312340 [debug] [MainThread]: 1699: static parser successfully parsed marts/calendar/date_details.sql
[0m18:03:03.314633 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m18:03:03.316919 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/stitch_visitor_events.sql
[0m18:03:03.319382 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m18:03:03.321869 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_new_existing_customers.sql
[0m18:03:03.324850 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m18:03:03.332264 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m18:03:03.333548 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/customers.sql
[0m18:03:03.335825 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/monthly_users.sql
[0m18:03:03.338066 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_product_category.sql
[0m18:03:03.340752 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m18:03:03.498672 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:03:03.499330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:03.558539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:03:03.569301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a1cb6dd-86ba-4589-af92-021cbdc6b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8332c980d0>]}
[0m18:03:03.591118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a1cb6dd-86ba-4589-af92-021cbdc6b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8333263250>]}
[0m18:03:03.591563 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:03:03.591943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1cb6dd-86ba-4589-af92-021cbdc6b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83333b3160>]}
[0m18:03:03.593335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83333b6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833338c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833338c220>]}
[0m18:03:03.777386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '514b3d6b-5f2c-401f-92d5-b6708f67dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29140af220>]}
[0m18:03:03.778433 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:03:03.779004 [info ] [MainThread]: 
[0m18:03:03.842936 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m18:03:03.852520 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m18:03:03.853442 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m18:03:03.857595 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m18:03:03.857965 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m18:03:03.868395 [debug] [Thread-1  ]: finished collecting timing info
[0m18:03:03.868979 [debug] [Thread-1  ]: Compilation Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  Required var 'end_date' not found in config:
  Vars supplied to ltv_cohorts = {
      "start_date": "2021-10-01"
  }
  
  > in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m18:03:03.869484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b3d6b-5f2c-401f-92d5-b6708f67dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290ff528b0>]}
[0m18:03:03.870030 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 0.02s]
[0m18:03:03.870769 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m18:03:03.872847 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:03:03.873378 [info ] [MainThread]: 
[0m18:03:03.873798 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m18:03:03.874137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:03.874276 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m18:03:03.887021 [info ] [MainThread]: 
[0m18:03:03.887333 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:03.887657 [info ] [MainThread]: 
[0m18:03:03.887938 [error] [MainThread]: [33mCompilation Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m18:03:03.888201 [error] [MainThread]:   Required var 'end_date' not found in config:
[0m18:03:03.888489 [error] [MainThread]:   Vars supplied to ltv_cohorts = {
[0m18:03:03.888749 [error] [MainThread]:       "start_date": "2021-10-01"
[0m18:03:03.889006 [error] [MainThread]:   }
[0m18:03:03.889263 [error] [MainThread]:   
[0m18:03:03.889520 [error] [MainThread]:   > in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m18:03:03.889775 [error] [MainThread]:   > called by model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
[0m18:03:03.890046 [info ] [MainThread]: 
[0m18:03:03.890316 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:03:03.890688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29140f6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29141a6c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29140af1f0>]}


============================== 2022-08-14 18:03:17.813437 | bcd0f6a5-bae2-4b28-9038-bb2eb1e73e40 ==============================
[0m18:03:17.813470 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:03:17.814181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:03:17.814475 [debug] [MainThread]: Tracking: tracking
[0m18:03:17.820575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20ee22880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20ee22640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20ee226a0>]}
[0m18:03:17.927051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:17.927317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:17.928130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:03:17.935967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcd0f6a5-bae2-4b28-9038-bb2eb1e73e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20eb370d0>]}
[0m18:03:17.949323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcd0f6a5-bae2-4b28-9038-bb2eb1e73e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20ec95910>]}
[0m18:03:17.949658 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:03:17.949927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd0f6a5-bae2-4b28-9038-bb2eb1e73e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20edf6dc0>]}
[0m18:03:17.950888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20edf6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20ec95520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20ec95340>]}


============================== 2022-08-14 18:03:25.202463 | 59e02d60-ded4-4e63-a025-8a366f3afc77 ==============================
[0m18:03:25.202492 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:03:25.203234 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['dbt_project.yml'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:03:25.203509 [debug] [MainThread]: Tracking: tracking
[0m18:03:25.210634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2fb6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2fb63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2fb6be0>]}
[0m18:03:25.281742 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:03:25.282176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59e02d60-ded4-4e63-a025-8a366f3afc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2fc7af0>]}
[0m18:03:25.314527 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:03:25.317289 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:03:25.340983 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:03:25.351790 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:03:25.356792 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:03:25.357663 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:03:25.358397 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:03:25.359394 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:03:25.360658 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:03:25.361731 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:03:25.362936 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:03:25.363632 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:03:25.366087 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:03:25.367933 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:03:25.368945 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:03:25.371220 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:03:25.372200 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:03:25.373246 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:03:25.377828 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:03:25.382153 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:03:25.390760 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:03:25.397427 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:03:25.429171 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:03:25.434467 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:03:25.436084 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:03:25.438105 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:03:25.440493 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:03:25.445444 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:03:25.458551 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:03:25.487607 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:03:25.500911 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:03:25.525467 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:03:25.533168 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:03:25.550192 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:03:25.555345 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:03:25.559027 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:03:25.560715 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:03:25.562460 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:03:25.564039 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:03:25.566184 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:03:25.577248 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:03:25.578858 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:03:25.581015 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:03:25.583181 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:03:25.585029 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:03:25.586801 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:03:25.588751 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:03:25.590234 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:03:25.593876 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:03:25.597128 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:03:25.601364 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:03:25.603284 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:03:25.604965 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:03:25.606551 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:03:25.608339 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:03:25.610384 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:03:25.612360 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:03:25.628335 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:03:25.637916 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:03:25.644102 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:03:25.648116 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:03:25.653712 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:03:25.656613 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:03:25.672279 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:03:25.676735 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:03:25.697715 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:03:25.699287 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:03:25.708800 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:03:25.710186 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:03:25.715542 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:03:25.718887 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:03:25.721250 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:03:25.726076 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:03:25.727906 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:03:25.730068 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:03:25.747591 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:03:25.754483 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:03:25.767151 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:03:25.768847 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:03:25.780492 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:03:25.808015 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:03:25.809592 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:03:25.811176 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:03:25.813692 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:03:25.817228 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m18:03:25.820079 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m18:03:25.821598 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m18:03:25.823077 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m18:03:25.825320 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m18:03:25.827351 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m18:03:25.830821 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m18:03:25.833132 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m18:03:25.834463 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m18:03:25.836295 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m18:03:25.838791 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m18:03:25.849269 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m18:03:25.851174 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m18:03:25.854773 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m18:03:25.857036 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m18:03:25.858537 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m18:03:25.860222 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m18:03:25.862208 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m18:03:25.864096 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m18:03:25.865182 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m18:03:25.866899 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m18:03:25.869069 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m18:03:25.874945 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m18:03:25.876318 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m18:03:25.877497 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m18:03:25.878788 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m18:03:25.879857 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m18:03:25.881900 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m18:03:25.885511 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m18:03:25.886979 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m18:03:25.888830 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m18:03:25.891343 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m18:03:25.896506 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m18:03:25.897645 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m18:03:25.903491 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m18:03:25.906996 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m18:03:25.909650 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m18:03:25.918303 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m18:03:25.920236 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m18:03:25.923543 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m18:03:25.925131 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m18:03:25.926155 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m18:03:25.936340 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m18:03:25.939112 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m18:03:25.940800 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m18:03:25.942270 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m18:03:25.944079 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m18:03:25.945683 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:03:25.947766 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:03:25.949390 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:03:25.951999 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:03:25.953282 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:03:25.954430 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:03:25.955569 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:03:25.956820 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m18:03:25.981196 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:03:25.984653 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:03:25.988939 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m18:03:25.991947 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:03:25.996150 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:03:25.998504 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:03:26.004396 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m18:03:26.006030 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:03:26.007423 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:03:26.019363 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m18:03:26.027623 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:03:26.031694 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:03:26.035838 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:03:26.037502 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:03:26.039229 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:03:26.047265 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:03:26.052997 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:03:26.056419 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:03:26.058111 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:03:26.061610 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:03:26.063289 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:03:26.069791 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m18:03:26.078621 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m18:03:26.084703 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m18:03:26.089127 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m18:03:26.638259 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m18:03:26.658820 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m18:03:26.662954 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m18:03:26.667089 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:03:26.671332 [debug] [MainThread]: 1699: static parser successfully parsed marts/calendar/date_details.sql
[0m18:03:26.675332 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m18:03:26.679386 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/stitch_visitor_events.sql
[0m18:03:26.684430 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m18:03:26.690428 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_new_existing_customers.sql
[0m18:03:26.703559 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m18:03:26.716629 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m18:03:26.718898 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/customers.sql
[0m18:03:26.723143 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/monthly_users.sql
[0m18:03:26.727873 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_product_category.sql
[0m18:03:26.732820 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m18:03:27.089742 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:03:27.101416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59e02d60-ded4-4e63-a025-8a366f3afc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2870af0>]}
[0m18:03:27.124222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59e02d60-ded4-4e63-a025-8a366f3afc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2fb3c10>]}
[0m18:03:27.124792 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:03:27.125662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59e02d60-ded4-4e63-a025-8a366f3afc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2f4a580>]}
[0m18:03:27.126635 [warn ] [MainThread]: The selection criterion 'dbt_project.yml' does not match any nodes
[0m18:03:27.128600 [info ] [MainThread]: 
[0m18:03:27.129217 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m18:03:27.148359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2e1dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2f4cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a2f4c280>]}


============================== 2022-08-14 18:03:29.857464 | e4e6ff32-cd1a-436a-8cf2-1888d2da4c4f ==============================
[0m18:03:29.857495 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:03:29.858363 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:03:29.858709 [debug] [MainThread]: Tracking: tracking
[0m18:03:29.869437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb5f5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb5f5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb5f5b80>]}
[0m18:03:29.963598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:29.963874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:29.964666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:03:29.972458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4e6ff32-cd1a-436a-8cf2-1888d2da4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb3370d0>]}
[0m18:03:29.986129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4e6ff32-cd1a-436a-8cf2-1888d2da4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb497be0>]}
[0m18:03:29.986476 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:03:29.986801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4e6ff32-cd1a-436a-8cf2-1888d2da4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb497c70>]}
[0m18:03:29.988431 [info ] [MainThread]: 
[0m18:03:29.988997 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:03:29.989875 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:03:29.990228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:31.031324 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:03:31.031802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:31.271491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4e6ff32-cd1a-436a-8cf2-1888d2da4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb5d0ca0>]}
[0m18:03:31.272335 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:03:31.272717 [info ] [MainThread]: 
[0m18:03:31.277465 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m18:03:31.277802 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m18:03:31.278360 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m18:03:31.278555 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m18:03:31.278771 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m18:03:31.284802 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m18:03:31.285268 [debug] [Thread-1  ]: finished collecting timing info
[0m18:03:31.285485 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m18:03:31.324658 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m18:03:31.325127 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:03:31.325377 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
    

with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= 2020-12-27 and 
      date_actual <= 2021-10-01

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m18:03:32.177564 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator >= for argument types: DATE, INT64. Supported signature: ANY >= ANY at [32:7]')
[0m18:03:33.646105 [debug] [Thread-1  ]: finished collecting timing info
[0m18:03:33.646647 [debug] [Thread-1  ]: Database Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)
  No matching signature for operator >= for argument types: DATE, INT64. Supported signature: ANY >= ANY at [32:7]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m18:03:33.647026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4e6ff32-cd1a-436a-8cf2-1888d2da4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb3208b0>]}
[0m18:03:33.647444 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.ltv_cohorts ....................... [[31mERROR[0m in 2.37s]
[0m18:03:33.648016 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m18:03:33.649629 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:03:33.650025 [info ] [MainThread]: 
[0m18:03:33.650329 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m18:03:33.650641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:33.650802 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m18:03:33.663343 [info ] [MainThread]: 
[0m18:03:33.663653 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:33.663982 [info ] [MainThread]: 
[0m18:03:33.664287 [error] [MainThread]: [33mDatabase Error in model ltv_cohorts (models/marts/coffee_shop/ltv_cohorts.sql)[0m
[0m18:03:33.664576 [error] [MainThread]:   No matching signature for operator >= for argument types: DATE, INT64. Supported signature: ANY >= ANY at [32:7]
[0m18:03:33.664837 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/ltv_cohorts.sql
[0m18:03:33.665110 [info ] [MainThread]: 
[0m18:03:33.665380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:03:33.665761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb607220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb497550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb206ac0>]}


============================== 2022-08-14 18:06:09.762911 | 31290f33-4e32-4e9a-b9f0-a4eb7334ca36 ==============================
[0m18:06:09.762947 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:06:09.763800 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['ltv_cohorts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:06:09.764153 [debug] [MainThread]: Tracking: tracking
[0m18:06:09.773323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff249edf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff249edf640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff249edf6a0>]}
[0m18:06:09.851022 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:06:09.851461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31290f33-4e32-4e9a-b9f0-a4eb7334ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff249eb6a90>]}
[0m18:06:09.884467 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:06:09.887315 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:06:09.911108 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:06:09.916731 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:06:09.919364 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:06:09.919899 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:06:09.920349 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:06:09.920934 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:06:09.921637 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:06:09.922266 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:06:09.922955 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:06:09.923387 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:06:09.924772 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:06:09.925824 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:06:09.926423 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:06:09.927702 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:06:09.928288 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:06:09.928903 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:06:09.931521 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:06:09.933179 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:06:09.937801 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:06:09.940625 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:06:09.956427 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:06:09.959211 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:06:09.960170 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:06:09.960939 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:06:09.961817 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:06:09.963218 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:06:09.966818 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:06:09.980460 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:06:09.987479 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:06:10.001721 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:06:10.006249 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:06:10.016569 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:06:10.019487 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:06:10.021867 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:06:10.022907 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:06:10.024294 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:06:10.025289 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:06:10.026585 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:06:10.032130 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:06:10.033065 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:06:10.034335 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:06:10.035633 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:06:10.036759 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:06:10.037936 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:06:10.039109 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:06:10.040048 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:06:10.042142 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:06:10.044019 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:06:10.046624 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:06:10.047812 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:06:10.048826 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:06:10.050121 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:06:10.051105 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:06:10.052266 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:06:10.053371 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:06:10.061757 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:06:10.068239 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:06:10.072456 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:06:10.077488 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:06:10.083091 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:06:10.085971 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:06:10.101806 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:06:10.106278 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:06:10.121350 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:06:10.122927 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:06:10.132219 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:06:10.133605 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:06:10.138944 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:06:10.142596 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:06:10.144979 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:06:10.149441 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:06:10.151261 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:06:10.153144 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:06:10.171627 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:06:10.178763 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:06:10.191180 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:06:10.192890 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:06:10.204476 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:06:10.221933 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:06:10.223485 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:06:10.225110 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:06:10.227588 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:06:10.230805 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m18:06:10.233687 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m18:06:10.234995 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m18:06:10.236497 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m18:06:10.238723 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m18:06:10.240880 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m18:06:10.243839 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m18:06:10.246099 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m18:06:10.247375 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m18:06:10.249177 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m18:06:10.251677 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m18:06:10.260396 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m18:06:10.262293 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m18:06:10.265848 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m18:06:10.268114 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m18:06:10.269615 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m18:06:10.271287 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m18:06:10.272977 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m18:06:10.274827 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m18:06:10.275870 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m18:06:10.277672 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m18:06:10.279748 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m18:06:10.285589 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m18:06:10.287056 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m18:06:10.288221 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m18:06:10.289536 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m18:06:10.290627 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m18:06:10.292468 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m18:06:10.296339 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m18:06:10.298673 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m18:06:10.301191 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m18:06:10.303454 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m18:06:10.308658 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m18:06:10.309762 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m18:06:10.315716 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m18:06:10.319187 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m18:06:10.321822 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m18:06:10.330470 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m18:06:10.332430 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m18:06:10.335744 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m18:06:10.337345 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m18:06:10.338341 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m18:06:10.348131 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m18:06:10.350882 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m18:06:10.352570 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m18:06:10.353915 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m18:06:10.355349 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m18:06:10.356883 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:06:10.358954 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:06:10.360596 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:06:10.363149 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:06:10.364413 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:06:10.365559 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:06:10.367198 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:06:10.368467 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m18:06:10.392786 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:06:10.396200 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:06:10.400464 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m18:06:10.403283 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:06:10.407446 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:06:10.409853 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:06:10.416389 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m18:06:10.418031 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:06:10.419403 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:06:10.430595 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m18:06:10.437553 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:06:10.441466 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:06:10.445650 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:06:10.447316 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:06:10.449057 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:06:10.456963 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:06:10.462579 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:06:10.465980 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:06:10.467700 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:06:10.471155 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:06:10.472849 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:06:10.479083 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m18:06:10.488045 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m18:06:10.494138 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m18:06:10.498306 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m18:06:10.991209 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m18:06:11.003323 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m18:06:11.005744 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m18:06:11.008061 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m18:06:11.010482 [debug] [MainThread]: 1699: static parser successfully parsed marts/calendar/date_details.sql
[0m18:06:11.012740 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m18:06:11.015527 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/stitch_visitor_events.sql
[0m18:06:11.017941 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m18:06:11.020556 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_new_existing_customers.sql
[0m18:06:11.022959 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m18:06:11.030016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m18:06:11.031709 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/customers.sql
[0m18:06:11.035143 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/monthly_users.sql
[0m18:06:11.039013 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_product_category.sql
[0m18:06:11.043561 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m18:06:11.302570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:06:11.313522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31290f33-4e32-4e9a-b9f0-a4eb7334ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2497940d0>]}
[0m18:06:11.335072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31290f33-4e32-4e9a-b9f0-a4eb7334ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff249cb01f0>]}
[0m18:06:11.335563 [info ] [MainThread]: Found 14 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:06:11.336131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31290f33-4e32-4e9a-b9f0-a4eb7334ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff249eb6e80>]}
[0m18:06:11.339183 [info ] [MainThread]: 
[0m18:06:11.341816 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:06:11.343312 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:06:11.343740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:12.491362 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:06:12.492023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:12.744658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31290f33-4e32-4e9a-b9f0-a4eb7334ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2497a4fd0>]}
[0m18:06:12.745741 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:06:12.746206 [info ] [MainThread]: 
[0m18:06:12.752269 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m18:06:12.752643 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.ltv_cohorts ................................ [RUN]
[0m18:06:12.753170 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m18:06:12.753357 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m18:06:12.753581 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m18:06:12.759527 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m18:06:12.759979 [debug] [Thread-1  ]: finished collecting timing info
[0m18:06:12.760182 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m18:06:12.799002 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m18:06:12.799519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:12.799794 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
    

with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= date('2020-12-27') and 
      date_actual <= date('2021-10-01')

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m18:06:19.783754 [debug] [Thread-1  ]: finished collecting timing info
[0m18:06:19.784806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31290f33-4e32-4e9a-b9f0-a4eb7334ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24957ed90>]}
[0m18:06:19.785665 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_lauren.ltv_cohorts ........................... [[32mCREATE TABLE (276.0 rows, 32.2 MB processed)[0m in 7.03s]
[0m18:06:19.786363 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m18:06:19.787926 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:06:19.788393 [info ] [MainThread]: 
[0m18:06:19.788737 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m18:06:19.789091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:19.789267 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m18:06:19.789424 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m18:06:19.803528 [info ] [MainThread]: 
[0m18:06:19.803865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:19.804277 [info ] [MainThread]: 
[0m18:06:19.804588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:06:19.805000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24d9905b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24976dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2495a41c0>]}


============================== 2022-08-14 18:31:45.931898 | d79c1d06-22b3-4b71-86fc-138048a89cea ==============================
[0m18:31:45.931924 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:31:45.933281 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:31:45.933646 [debug] [MainThread]: Tracking: tracking
[0m18:31:45.942251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737f129970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737f129940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737f1299a0>]}
[0m18:31:46.202308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:31:46.202865 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/coffee_shop/cohorts.sql
[0m18:31:46.203237 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/order_details.sql
[0m18:31:46.218865 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/cohorts.sql
[0m18:31:46.243720 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m18:31:46.255182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:31:46.261514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd79c1d06-22b3-4b71-86fc-138048a89cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737ebcf0d0>]}
[0m18:31:46.274664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd79c1d06-22b3-4b71-86fc-138048a89cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737f0fbca0>]}
[0m18:31:46.275020 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:31:46.275295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd79c1d06-22b3-4b71-86fc-138048a89cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737eee1ac0>]}
[0m18:31:46.276311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737f0fbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737eee1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f737efa9ac0>]}


============================== 2022-08-14 18:32:00.042267 | 9103b0fd-739f-4340-bb45-50f0dc4d6f92 ==============================
[0m18:32:00.042316 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:32:00.043587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:32:00.044019 [debug] [MainThread]: Tracking: tracking
[0m18:32:00.067754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f62deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f62d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f62dee0>]}
[0m18:32:00.300705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:32:00.301773 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/order_details.sql
[0m18:32:00.354782 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m18:32:00.394020 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:32:00.407163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9103b0fd-739f-4340-bb45-50f0dc4d6f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f0a90d0>]}
[0m18:32:00.442703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9103b0fd-739f-4340-bb45-50f0dc4d6f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f4369d0>]}
[0m18:32:00.444272 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:32:00.445154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9103b0fd-739f-4340-bb45-50f0dc4d6f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f3b7f70>]}
[0m18:32:00.447241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f436a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f3b7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f35ec70>]}


============================== 2022-08-14 18:32:00.899714 | 9b6e8bd5-acfd-48b6-8db0-9ebd0f9c2226 ==============================
[0m18:32:00.899756 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:32:00.900712 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['order_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:32:00.901015 [debug] [MainThread]: Tracking: tracking
[0m18:32:00.933141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec048c6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec048c6be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec048c6c40>]}
[0m18:32:01.091970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:01.092464 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:01.093960 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:32:01.109624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b6e8bd5-acfd-48b6-8db0-9ebd0f9c2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec045e40d0>]}
[0m18:32:01.163198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b6e8bd5-acfd-48b6-8db0-9ebd0f9c2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec04734310>]}
[0m18:32:01.163834 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:32:01.164391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b6e8bd5-acfd-48b6-8db0-9ebd0f9c2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec04734070>]}
[0m18:32:01.167108 [info ] [MainThread]: 
[0m18:32:01.167953 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:32:01.169241 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m18:32:01.169691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:02.600157 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m18:32:02.600938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:02.876105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b6e8bd5-acfd-48b6-8db0-9ebd0f9c2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec04882610>]}
[0m18:32:02.876908 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:32:02.877287 [info ] [MainThread]: 
[0m18:32:02.882193 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.order_details
[0m18:32:02.882542 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.order_details ............................... [RUN]
[0m18:32:02.883781 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m18:32:02.884023 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.order_details
[0m18:32:02.884265 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.order_details
[0m18:32:02.893429 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m18:32:02.897120 [debug] [Thread-1  ]: finished collecting timing info
[0m18:32:02.897343 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.order_details
[0m18:32:02.929943 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m18:32:02.930452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:02.930716 [debug] [Thread-1  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),


    order_details as (
       
        select 
            orders.*,
            min(created_on) over (partition by orders.customer_id) as customer_first_order_on,
            order_items.product_id,
            products.name as product_name,
            products.category as product_category,
            products.product_available_on,
            product_prices.* except(id, product_id, price_started_at, price_ended_at)
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at >= product_prices.price_started_at and 
            orders.created_at < product_prices.price_ended_at

    )

    select 
        id,
        created_at,
        created_on,
        year_of, 
        month_of,
        week_of,
        day_of_week_name,
        customer_id,
        customer_first_order_on,
        state,
        address,
        zip,
        product_name,
        product_category,
        product_available_on,
        price_usd
    from order_details;


[0m18:32:03.997183 [debug] [Thread-1  ]: finished collecting timing info
[0m18:32:03.997958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b6e8bd5-acfd-48b6-8db0-9ebd0f9c2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec044cb2e0>]}
[0m18:32:03.998381 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.order_details .......................... [[32mOK[0m in 1.11s]
[0m18:32:03.998917 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.order_details
[0m18:32:04.000449 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:32:04.000907 [info ] [MainThread]: 
[0m18:32:04.001221 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m18:32:04.001551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:04.001731 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m18:32:04.016096 [info ] [MainThread]: 
[0m18:32:04.016440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:04.016810 [info ] [MainThread]: 
[0m18:32:04.017113 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:32:04.017517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec045ab6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec045abeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec045abd30>]}


============================== 2022-08-14 18:48:46.284039 | c30700a0-a897-4855-b28a-74566af30f2c ==============================
[0m18:48:46.284065 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:48:46.284734 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:48:46.285029 [debug] [MainThread]: Tracking: tracking
[0m18:48:46.295401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9411c4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9411c4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9411c49a0>]}
[0m18:48:46.443726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:46.444120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:46.445567 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:48:46.457667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c30700a0-a897-4855-b28a-74566af30f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb940ee00d0>]}
[0m18:48:46.473539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c30700a0-a897-4855-b28a-74566af30f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94102d4c0>]}
[0m18:48:46.473871 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:48:46.474202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c30700a0-a897-4855-b28a-74566af30f2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94ef89b20>]}
[0m18:48:46.475235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94ef89b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94102d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94102d160>]}


============================== 2022-08-14 18:54:42.241634 | 45371a90-736e-47b8-acb7-47a6040d267c ==============================
[0m18:54:42.241663 [info ] [MainThread]: Running with dbt=1.2.0
[0m18:54:42.242639 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m18:54:42.242847 [debug] [MainThread]: Tracking: tracking
[0m18:54:42.247467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327e051f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327e053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327e055b0>]}
[0m18:54:42.377450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:42.377782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:42.378638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m18:54:42.390613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45371a90-736e-47b8-acb7-47a6040d267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327b520d0>]}
[0m18:54:42.404067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45371a90-736e-47b8-acb7-47a6040d267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327ca2610>]}
[0m18:54:42.404425 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m18:54:42.404698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45371a90-736e-47b8-acb7-47a6040d267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327ca2550>]}
[0m18:54:42.405703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327ca24f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327ca2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa327ca20d0>]}


============================== 2022-08-14 19:00:12.638059 | 81ed4e3a-cfc3-4f51-9d3c-0dc17c7ce2b7 ==============================
[0m19:00:12.638090 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:00:12.640258 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m19:00:12.640790 [debug] [MainThread]: Tracking: tracking
[0m19:00:12.652897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41577d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41577ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41577d8b0>]}
[0m19:00:12.778216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:12.778509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:12.779429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m19:00:12.791467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ed4e3a-cfc3-4f51-9d3c-0dc17c7ce2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4154700d0>]}
[0m19:00:12.805304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ed4e3a-cfc3-4f51-9d3c-0dc17c7ce2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4155ce700>]}
[0m19:00:12.805739 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m19:00:12.806023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ed4e3a-cfc3-4f51-9d3c-0dc17c7ce2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd423549520>]}
[0m19:00:12.807547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd423549520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4155ce160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4155ce2b0>]}


============================== 2022-08-14 19:10:59.768397 | 018ffa50-7055-447d-a168-9a6578b3f8ef ==============================
[0m19:10:59.768437 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:10:59.769702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m19:10:59.770149 [debug] [MainThread]: Tracking: tracking
[0m19:10:59.789654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd095024c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd095024b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd095024190>]}
[0m19:11:00.023233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:00.024367 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/order_details.sql
[0m19:11:00.057500 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m19:11:00.095394 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m19:11:00.108815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '018ffa50-7055-447d-a168-9a6578b3f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd094af90d0>]}
[0m19:11:00.133434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '018ffa50-7055-447d-a168-9a6578b3f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd094ffa430>]}
[0m19:11:00.134130 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m19:11:00.134643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018ffa50-7055-447d-a168-9a6578b3f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd094e0bc70>]}
[0m19:11:00.136505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd094ffa550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd094e0bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd094ed9ac0>]}


============================== 2022-08-14 19:11:00.432135 | 6d49d119-7b4e-4b06-bf80-da9431c91203 ==============================
[0m19:11:00.432184 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:11:00.433590 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['order_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:11:00.434024 [debug] [MainThread]: Tracking: tracking
[0m19:11:00.450315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f285a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f285adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f285a8b0>]}
[0m19:11:00.652409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:11:00.652752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:11:00.653671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m19:11:00.663136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d49d119-7b4e-4b06-bf80-da9431c91203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f254f0d0>]}
[0m19:11:00.677932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d49d119-7b4e-4b06-bf80-da9431c91203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f26ac700>]}
[0m19:11:00.678328 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m19:11:00.678703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d49d119-7b4e-4b06-bf80-da9431c91203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28006083a0>]}
[0m19:11:00.680793 [info ] [MainThread]: 
[0m19:11:00.681421 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:11:00.682366 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m19:11:00.682713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:03.824695 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m19:11:03.825228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:04.087902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d49d119-7b4e-4b06-bf80-da9431c91203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f258fa00>]}
[0m19:11:04.088709 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m19:11:04.089147 [info ] [MainThread]: 
[0m19:11:04.125589 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.order_details
[0m19:11:04.126120 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.order_details ............................... [RUN]
[0m19:11:04.126889 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m19:11:04.127164 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.order_details
[0m19:11:04.127446 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.order_details
[0m19:11:04.141418 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m19:11:04.142116 [debug] [Thread-1  ]: finished collecting timing info
[0m19:11:04.142446 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.order_details
[0m19:11:04.207053 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m19:11:04.207936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:11:04.208261 [debug] [Thread-1  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),

    web_sessions as (
        select *
        from `aec-students`.`dbt_lauren`.`web_sessions`
    )


    order_details as (
       
        select 
            orders.*,
            min(created_on) over (partition by orders.customer_id) as customer_first_order_on,
            order_items.product_id,
            products.name as product_name,
            products.category as product_category,
            products.product_available_on,
            product_prices.* except(id, product_id, price_started_at, price_ended_at),
            web_sessions.session_id,
            web_sessions.session_start_at,
            web_sessions.session_end_at,
            round(
                timestamp_diff(
                web_sessions.session_end_at,
                web_sessions.session_start_at,
                second
                ) / 60
                ,2
            ) as session_duration,
            round(
                timestamp_diff(
                web_sessions.event_at,
                web_sessions.session_start_at,
                second
                ) / 60,
                2
            ) as time_to_purchase,
            web_sessions.device_type
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at >= product_prices.price_started_at and 
            orders.created_at < product_prices.price_ended_at

        left join web_sessions on 
            orders.customer_id = web_sessions.customer_id and 
            orders.created_at = web_sessions.event_at

    )

    select 
        id,
        created_at,
        created_on,
        year_of, 
        month_of,
        week_of,
        day_of_week_name,
        customer_id,
        customer_first_order_on,
        state,
        address,
        zip,
        product_name,
        product_category,
        price_usd,
        session_id,
        session_start_at,
        session_end_at,
        session_duration,
        time_to_purchase,
        device_type
    from order_details;


[0m19:11:04.536114 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "order_details" at [35:5]')
[0m19:11:05.754857 [debug] [Thread-1  ]: finished collecting timing info
[0m19:11:05.755430 [debug] [Thread-1  ]: Database Error in model order_details (models/marts/coffee_shop/order_details.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "order_details" at [35:5]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/order_details.sql
[0m19:11:05.755822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d49d119-7b4e-4b06-bf80-da9431c91203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f24ceb80>]}
[0m19:11:05.756222 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.order_details ...................... [[31mERROR[0m in 1.63s]
[0m19:11:05.756763 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.order_details
[0m19:11:05.758492 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:11:05.758947 [info ] [MainThread]: 
[0m19:11:05.759270 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m19:11:05.759615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:05.759814 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m19:11:05.773248 [info ] [MainThread]: 
[0m19:11:05.773640 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:11:05.774067 [info ] [MainThread]: 
[0m19:11:05.774388 [error] [MainThread]: [33mDatabase Error in model order_details (models/marts/coffee_shop/order_details.sql)[0m
[0m19:11:05.774692 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "order_details" at [35:5]
[0m19:11:05.774977 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/order_details.sql
[0m19:11:05.775284 [info ] [MainThread]: 
[0m19:11:05.775585 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:11:05.776034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f254f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f26ac520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f24d06a0>]}


============================== 2022-08-14 19:11:20.708959 | f21c194c-99d4-459b-9e68-8db9d86db3fe ==============================
[0m19:11:20.709012 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:11:20.710262 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['order_details'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:11:20.710636 [debug] [MainThread]: Tracking: tracking
[0m19:11:20.735469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a356ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a356ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a356edf0>]}
[0m19:11:20.920276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:20.921206 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/order_details.sql
[0m19:11:20.949500 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m19:11:21.020634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m19:11:21.031548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f21c194c-99d4-459b-9e68-8db9d86db3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a30180d0>]}
[0m19:11:21.064936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f21c194c-99d4-459b-9e68-8db9d86db3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a33ae130>]}
[0m19:11:21.065875 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m19:11:21.066390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f21c194c-99d4-459b-9e68-8db9d86db3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a3523d30>]}
[0m19:11:21.069097 [info ] [MainThread]: 
[0m19:11:21.070095 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:11:21.071373 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m19:11:21.071817 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 19:11:22.239887 | 63243ff2-f300-43ee-9d18-f44875349ef6 ==============================
[0m19:11:22.239938 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:11:22.247603 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m19:11:22.248011 [debug] [MainThread]: Tracking: tracking
[0m19:11:22.286183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6eb2e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6eb2eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6eb2ec70>]}
[0m19:11:22.569576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:11:22.570266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:11:22.571734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m19:11:22.585813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63243ff2-f300-43ee-9d18-f44875349ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6e8780d0>]}
[0m19:11:22.610100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63243ff2-f300-43ee-9d18-f44875349ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6e9c7520>]}
[0m19:11:22.610735 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m19:11:22.611219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63243ff2-f300-43ee-9d18-f44875349ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6e9c7490>]}
[0m19:11:22.612839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6e9c73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6e9c7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6e9c70d0>]}
[0m19:11:23.016078 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m19:11:23.016528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:23.252494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f21c194c-99d4-459b-9e68-8db9d86db3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a33ee7f0>]}
[0m19:11:23.253575 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m19:11:23.254169 [info ] [MainThread]: 
[0m19:11:23.261256 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.order_details
[0m19:11:23.262355 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.order_details ............................... [RUN]
[0m19:11:23.263663 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m19:11:23.263986 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.order_details
[0m19:11:23.264294 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.order_details
[0m19:11:23.275035 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m19:11:23.275793 [debug] [Thread-1  ]: finished collecting timing info
[0m19:11:23.276190 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.order_details
[0m19:11:23.331969 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m19:11:23.332886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:11:23.333418 [debug] [Thread-1  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),

    web_sessions as (
        select *
        from `aec-students`.`dbt_lauren`.`web_sessions`
    ),


    order_details as (
       
        select 
            orders.*,
            min(created_on) over (partition by orders.customer_id) as customer_first_order_on,
            order_items.product_id,
            products.name as product_name,
            products.category as product_category,
            products.product_available_on,
            product_prices.* except(id, product_id, price_started_at, price_ended_at),
            web_sessions.session_id,
            web_sessions.session_start_at,
            web_sessions.session_end_at,
            round(
                timestamp_diff(
                web_sessions.session_end_at,
                web_sessions.session_start_at,
                second
                ) / 60
                ,2
            ) as session_duration,
            round(
                timestamp_diff(
                web_sessions.event_at,
                web_sessions.session_start_at,
                second
                ) / 60,
                2
            ) as time_to_purchase,
            web_sessions.device_type
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at >= product_prices.price_started_at and 
            orders.created_at < product_prices.price_ended_at

        left join web_sessions on 
            orders.customer_id = web_sessions.customer_id and 
            orders.created_at = web_sessions.event_at

    )

    select 
        id,
        created_at,
        created_on,
        year_of, 
        month_of,
        week_of,
        day_of_week_name,
        customer_id,
        customer_first_order_on,
        state,
        address,
        zip,
        product_name,
        product_category,
        price_usd,
        session_id,
        session_start_at,
        session_end_at,
        session_duration,
        time_to_purchase,
        device_type
    from order_details;


[0m19:11:24.467393 [debug] [Thread-1  ]: finished collecting timing info
[0m19:11:24.468027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f21c194c-99d4-459b-9e68-8db9d86db3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a30449d0>]}
[0m19:11:24.468470 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.order_details .......................... [[32mOK[0m in 1.20s]
[0m19:11:24.469014 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.order_details
[0m19:11:24.470672 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:11:24.471083 [info ] [MainThread]: 
[0m19:11:24.471392 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m19:11:24.471761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:24.471931 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m19:11:24.488038 [info ] [MainThread]: 
[0m19:11:24.488397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:11:24.488786 [info ] [MainThread]: 
[0m19:11:24.489120 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:11:24.489551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a32d0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a35440d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a2edc6a0>]}


============================== 2022-08-14 19:49:10.318491 | d324f3e7-b7e7-4e77-85a8-653fec520ad2 ==============================
[0m19:49:10.318525 [info ] [MainThread]: Running with dbt=1.2.0
[0m19:49:10.321139 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m19:49:10.322028 [debug] [MainThread]: Tracking: tracking
[0m19:49:10.337243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bdb245b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bdb24910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bdb24850>]}
[0m19:49:10.472248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:10.472542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:10.473497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m19:49:10.485393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd324f3e7-b7e7-4e77-85a8-653fec520ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bd86eaf0>]}
[0m19:49:10.499417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd324f3e7-b7e7-4e77-85a8-653fec520ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bd9bd250>]}
[0m19:49:10.499837 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m19:49:10.500144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd324f3e7-b7e7-4e77-85a8-653fec520ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bd9bd1c0>]}
[0m19:49:10.501759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bd9bd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bd9d4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bd9d4a90>]}


============================== 2022-08-14 20:16:14.516104 | 44ed849c-1e1c-40fa-9e5d-eb4236bb4f93 ==============================
[0m20:16:14.516132 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:16:14.516836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m20:16:14.517116 [debug] [MainThread]: Tracking: tracking
[0m20:16:14.523937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc4a3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc4a33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc4a3310>]}
[0m20:16:14.656809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:14.657171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:14.658703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m20:16:14.671667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44ed849c-1e1c-40fa-9e5d-eb4236bb4f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc1e80d0>]}
[0m20:16:14.687566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44ed849c-1e1c-40fa-9e5d-eb4236bb4f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc335580>]}
[0m20:16:14.687980 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m20:16:14.688284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44ed849c-1e1c-40fa-9e5d-eb4236bb4f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc3354f0>]}
[0m20:16:14.689342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc335400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc3351f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afc3354f0>]}


============================== 2022-08-14 20:17:59.782126 | ad94a42f-8735-4d00-95c8-c52628bf6587 ==============================
[0m20:17:59.782157 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:17:59.782897 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m20:17:59.783232 [debug] [MainThread]: Tracking: tracking
[0m20:17:59.790023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8877b9b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8877b9bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8877b52550>]}
[0m20:17:59.882344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:17:59.882624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:17:59.883511 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m20:17:59.892589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad94a42f-8735-4d00-95c8-c52628bf6587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88778890d0>]}
[0m20:17:59.906296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad94a42f-8735-4d00-95c8-c52628bf6587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88779e8760>]}
[0m20:17:59.906660 [info ] [MainThread]: Found 15 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m20:17:59.906927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad94a42f-8735-4d00-95c8-c52628bf6587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88779e8670>]}
[0m20:17:59.907929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88779e8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88779e8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88779e81f0>]}


============================== 2022-08-14 20:24:55.269629 | 665cde96-2285-41dd-a3ba-07b39f817346 ==============================
[0m20:24:55.269673 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:24:55.270793 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m20:24:55.271154 [debug] [MainThread]: Tracking: tracking
[0m20:24:55.279242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6d43760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6d436a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6d43130>]}
[0m20:24:55.458609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:24:55.459438 [debug] [MainThread]: Partial parsing: added file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m20:24:55.494448 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m20:24:55.537089 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m20:24:55.556054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m20:24:55.576432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '665cde96-2285-41dd-a3ba-07b39f817346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6a7b0d0>]}
[0m20:24:55.610401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '665cde96-2285-41dd-a3ba-07b39f817346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6bf7f10>]}
[0m20:24:55.613974 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m20:24:55.614477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '665cde96-2285-41dd-a3ba-07b39f817346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6bf7fa0>]}
[0m20:24:55.616145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6bf7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6bf7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c6bf7a60>]}


============================== 2022-08-14 20:25:01.097987 | 212e7aa8-22af-4977-a546-c9601c7ad545 ==============================
[0m20:25:01.098042 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:25:01.099273 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customer_daily_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:25:01.099684 [debug] [MainThread]: Tracking: tracking
[0m20:25:01.125966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d755b2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d755b29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d755b2940>]}
[0m20:25:01.391510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:01.396804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:01.398435 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m20:25:01.424583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '212e7aa8-22af-4977-a546-c9601c7ad545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d752d80d0>]}
[0m20:25:01.452314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '212e7aa8-22af-4977-a546-c9601c7ad545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d75435cd0>]}
[0m20:25:01.452911 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m20:25:01.453423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '212e7aa8-22af-4977-a546-c9601c7ad545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d75435be0>]}
[0m20:25:01.455962 [info ] [MainThread]: 
[0m20:25:01.457754 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:25:01.459016 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m20:25:01.459481 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-14 20:25:01.644583 | a1a64366-2e1b-4972-ab86-7be6b6294783 ==============================
[0m20:25:01.644640 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:25:01.645839 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m20:25:01.646201 [debug] [MainThread]: Tracking: tracking
[0m20:25:01.657292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c09e9fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c09e9fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c09e9fc40>]}
[0m20:25:01.841849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:01.842146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:01.843055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m20:25:01.854385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a64366-2e1b-4972-ab86-7be6b6294783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c09bc10d0>]}
[0m20:25:01.869995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1a64366-2e1b-4972-ab86-7be6b6294783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c09d07700>]}
[0m20:25:01.870570 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m20:25:01.871033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a64366-2e1b-4972-ab86-7be6b6294783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c09d07610>]}
[0m20:25:01.872784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c17c89a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c09d07430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c09d07580>]}
[0m20:25:04.657022 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m20:25:04.657501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:04.936377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '212e7aa8-22af-4977-a546-c9601c7ad545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d754355b0>]}
[0m20:25:04.937151 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m20:25:04.937545 [info ] [MainThread]: 
[0m20:25:04.952950 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m20:25:04.953302 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.customer_daily_orders ....................... [RUN]
[0m20:25:04.954603 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m20:25:04.955102 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m20:25:04.955320 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m20:25:04.969477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:04.969780 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */

    
select distinct device_type from `aec-students`.`dbt_lauren`.`order_details`
order by 1

  
[0m20:25:08.495225 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m20:25:08.498646 [debug] [Thread-1  ]: finished collecting timing info
[0m20:25:08.499004 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m20:25:08.528808 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m20:25:08.529328 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`customer_daily_orders`
  OPTIONS()
  as -- depends_on: `aec-students`.`dbt_lauren`.`order_details`











with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = '' then 1 else 0 end) as _count,
      sum(case when device_type = '' then price_usd else 0 end) as _amount,
      
      sum(case when device_type = '' then 1 else 0 end) as _count,
      sum(case when device_type = '' then price_usd else 0 end) as _amount,
      
      sum(case when device_type = '' then 1 else 0 end) as _count,
      sum(case when device_type = '' then price_usd else 0 end) as _amount,
      
      sum(case when device_type = '' then 1 else 0 end) as _count,
      sum(case when device_type = '' then price_usd else 0 end) as _amount,
      
      sum(case when device_type = '' then 1 else 0 end) as _count,
      sum(case when device_type = '' then price_usd else 0 end) as _amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  )


  select 
    date_spine.*,
    daily_orders.* except(customer_id)
  from date_spine
  left join daily_orders on 
    date_spine.date_actual = daily_orders.created_on and 
    date_spine.customer_id = daily_orders.customer_id
  where date_spine.customer_id = "00059434-788d-429c-932b-48c07300ba92"
  order by date_actual;


[0m20:25:09.177387 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name _count at [18:1]')
[0m20:25:10.882594 [debug] [Thread-1  ]: finished collecting timing info
[0m20:25:10.883112 [debug] [Thread-1  ]: Database Error in model customer_daily_orders (models/marts/coffee_shop/customer_daily_orders.sql)
  CREATE VIEW has columns with duplicate name _count at [18:1]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/customer_daily_orders.sql
[0m20:25:10.883489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212e7aa8-22af-4977-a546-c9601c7ad545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d75273df0>]}
[0m20:25:10.883887 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dbt_lauren.customer_daily_orders .............. [[31mERROR[0m in 5.93s]
[0m20:25:10.884422 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m20:25:10.885981 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:25:10.886401 [info ] [MainThread]: 
[0m20:25:10.886706 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m20:25:10.887071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:10.887269 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m20:25:10.901223 [info ] [MainThread]: 
[0m20:25:10.901571 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:25:10.901922 [info ] [MainThread]: 
[0m20:25:10.902265 [error] [MainThread]: [33mDatabase Error in model customer_daily_orders (models/marts/coffee_shop/customer_daily_orders.sql)[0m
[0m20:25:10.902550 [error] [MainThread]:   CREATE VIEW has columns with duplicate name _count at [18:1]
[0m20:25:10.902822 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/customer_daily_orders.sql
[0m20:25:10.903106 [info ] [MainThread]: 
[0m20:25:10.903380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:25:10.903785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d85572640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d752abb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d75297160>]}


============================== 2022-08-14 20:27:06.824551 | 73c2cc5a-656e-4693-a0f3-4400262bd382 ==============================
[0m20:27:06.824599 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:27:06.825828 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m20:27:06.826238 [debug] [MainThread]: Tracking: tracking
[0m20:27:06.853956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128dff370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128dff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128dff340>]}


============================== 2022-08-14 20:27:07.005254 | 0c2be12e-9466-4684-99d0-171f7008059c ==============================
[0m20:27:07.005306 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:27:07.006802 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customer_daily_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:27:07.007200 [debug] [MainThread]: Tracking: tracking
[0m20:27:07.009170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:07.010051 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m20:27:07.037198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a764bec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a764bebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a764bec40>]}
[0m20:27:07.045666 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m20:27:07.145409 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m20:27:07.187090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m20:27:07.205348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73c2cc5a-656e-4693-a0f3-4400262bd382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128b320d0>]}
[0m20:27:07.233740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:07.234604 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m20:27:07.255117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73c2cc5a-656e-4693-a0f3-4400262bd382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128dd8160>]}
[0m20:27:07.255685 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m20:27:07.256091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c2cc5a-656e-4693-a0f3-4400262bd382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4136bc9130>]}
[0m20:27:07.257616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128dd81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128afe580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128b6a370>]}
[0m20:27:07.273378 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m20:27:07.321176 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m20:27:07.332092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m20:27:07.338683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c2be12e-9466-4684-99d0-171f7008059c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a761ef0d0>]}
[0m20:27:07.352344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c2be12e-9466-4684-99d0-171f7008059c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a842887f0>]}
[0m20:27:07.352723 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m20:27:07.353038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c2be12e-9466-4684-99d0-171f7008059c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a762f8760>]}
[0m20:27:07.354776 [info ] [MainThread]: 
[0m20:27:07.355355 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:27:07.356214 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m20:27:07.356569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:08.622807 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m20:27:08.623275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:08.852829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c2be12e-9466-4684-99d0-171f7008059c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a76328340>]}
[0m20:27:08.853609 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m20:27:08.854013 [info ] [MainThread]: 
[0m20:27:08.858234 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m20:27:08.858572 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.customer_daily_orders ....................... [RUN]
[0m20:27:08.859114 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m20:27:08.859314 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m20:27:08.859525 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m20:27:08.877559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:27:08.877884 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */
select
                device_type as value

            from `aec-students`.`dbt_lauren`.`order_details`

            

            group by device_type
            order by count(*) desc

            

        
[0m20:27:12.443696 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m20:27:12.444334 [debug] [Thread-1  ]: finished collecting timing info
[0m20:27:12.444615 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m20:27:12.473669 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m20:27:12.474271 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`customer_daily_orders`
  OPTIONS()
  as -- depends_on: `aec-students`.`dbt_lauren`.`order_details`





with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = 'Android' then 1 else 0 end) as Android_count,
      sum(case when device_type = 'Android' then price_usd else 0 end) as Android_amount,
      
      sum(case when device_type = 'iPhone' then 1 else 0 end) as iPhone_count,
      sum(case when device_type = 'iPhone' then price_usd else 0 end) as iPhone_amount,
      
      sum(case when device_type = 'windows' then 1 else 0 end) as windows_count,
      sum(case when device_type = 'windows' then price_usd else 0 end) as windows_amount,
      
      sum(case when device_type = 'linux' then 1 else 0 end) as linux_count,
      sum(case when device_type = 'linux' then price_usd else 0 end) as linux_amount,
      
      sum(case when device_type = 'macOS' then 1 else 0 end) as macOS_count,
      sum(case when device_type = 'macOS' then price_usd else 0 end) as macOS_amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  )


  select 
    date_spine.*,
    daily_orders.* except(customer_id)
  from date_spine
  left join daily_orders on 
    date_spine.date_actual = daily_orders.created_on and 
    date_spine.customer_id = daily_orders.customer_id
  where date_spine.customer_id = "00059434-788d-429c-932b-48c07300ba92"
  order by date_actual;


[0m20:27:13.213502 [debug] [Thread-1  ]: finished collecting timing info
[0m20:27:13.214097 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c2be12e-9466-4684-99d0-171f7008059c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a76188640>]}
[0m20:27:13.214520 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.customer_daily_orders .................. [[32mOK[0m in 4.36s]
[0m20:27:13.215039 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m20:27:13.216294 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:27:13.216689 [info ] [MainThread]: 
[0m20:27:13.216995 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m20:27:13.217313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:13.217508 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m20:27:13.241309 [info ] [MainThread]: 
[0m20:27:13.241890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:13.242481 [info ] [MainThread]: 
[0m20:27:13.242983 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:27:13.243621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a761cabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a76038fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a760389a0>]}


============================== 2022-08-14 20:27:26.420933 | f99f065e-2106-4ad2-97fd-766a06294407 ==============================
[0m20:27:26.420987 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:27:26.422514 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m20:27:26.422956 [debug] [MainThread]: Tracking: tracking
[0m20:27:26.440006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6110b07c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6110b07be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6110b07c40>]}
[0m20:27:26.588540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:26.589017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:26.590650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m20:27:26.606797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f99f065e-2106-4ad2-97fd-766a06294407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61108270d0>]}
[0m20:27:26.639453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f99f065e-2106-4ad2-97fd-766a06294407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611096e730>]}
[0m20:27:26.639866 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m20:27:26.640141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99f065e-2106-4ad2-97fd-766a06294407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611096e640>]}
[0m20:27:26.641185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611e8c97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611096e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611096e5b0>]}


============================== 2022-08-15 02:30:06.813842 | b4306cee-b280-4447-929c-0c52800d3481 ==============================
[0m02:30:06.813869 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:30:06.814817 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:30:06.815282 [debug] [MainThread]: Tracking: tracking
[0m02:30:06.822486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8e43430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8e43ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8e43130>]}
[0m02:30:06.942558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:06.943001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:06.943923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m02:30:06.955654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4306cee-b280-4447-929c-0c52800d3481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8b7f0d0>]}
[0m02:30:06.973220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4306cee-b280-4447-929c-0c52800d3481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8cdae50>]}
[0m02:30:06.974504 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:30:06.974903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4306cee-b280-4447-929c-0c52800d3481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8cdad60>]}
[0m02:30:06.976033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8cdab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8cdacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9f8cda9d0>]}


============================== 2022-08-15 02:32:01.249565 | 079f192b-5a7f-425e-81c3-bac8a6d51c10 ==============================
[0m02:32:01.249615 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:32:01.255091 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customer_daily_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:32:01.257314 [debug] [MainThread]: Tracking: tracking
[0m02:32:01.282107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43dc030250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43dc0303a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43dc030310>]}
[0m02:32:01.433412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:32:01.433901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:32:01.435438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m02:32:01.449637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '079f192b-5a7f-425e-81c3-bac8a6d51c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43d7d540d0>]}
[0m02:32:01.474066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '079f192b-5a7f-425e-81c3-bac8a6d51c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43d7eaa910>]}
[0m02:32:01.474589 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:32:01.475132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079f192b-5a7f-425e-81c3-bac8a6d51c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43d7eaa820>]}
[0m02:32:01.477778 [info ] [MainThread]: 
[0m02:32:01.478620 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:32:01.479931 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m02:32:01.480387 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-15 02:32:02.755674 | 870d2340-d563-441d-b913-f737958947bb ==============================
[0m02:32:02.755741 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:32:02.760441 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:32:02.761512 [debug] [MainThread]: Tracking: tracking
[0m02:32:02.770459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f42820cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f42820910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f42820880>]}
[0m02:32:02.983258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:32:02.983589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:32:02.984594 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m02:32:02.997021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '870d2340-d563-441d-b913-f737958947bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f425730d0>]}
[0m02:32:03.023863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '870d2340-d563-441d-b913-f737958947bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f426c0490>]}
[0m02:32:03.024455 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:32:03.024883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '870d2340-d563-441d-b913-f737958947bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f426c0400>]}
[0m02:32:03.026556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f426c0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f426c0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f426c0160>]}
[0m02:32:05.283997 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m02:32:05.284648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:32:05.513205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079f192b-5a7f-425e-81c3-bac8a6d51c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43dc0307f0>]}
[0m02:32:05.514027 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m02:32:05.514454 [info ] [MainThread]: 
[0m02:32:05.537904 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m02:32:05.538330 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.customer_daily_orders ....................... [RUN]
[0m02:32:05.540083 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m02:32:05.540324 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m02:32:05.540535 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m02:32:05.569586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:32:05.570002 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */
select
                device_type as value

            from `aec-students`.`dbt_lauren`.`order_details`

            

            group by device_type
            order by count(*) desc

            

        
[0m02:32:06.943776 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m02:32:06.944545 [debug] [Thread-1  ]: finished collecting timing info
[0m02:32:06.944888 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m02:32:06.978932 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m02:32:06.979610 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`customer_daily_orders`
  OPTIONS()
  as -- depends_on: `aec-students`.`dbt_lauren`.`order_details`





with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = 'Android' then 1 else 0 end) as Android_count,
      sum(case when device_type = 'Android' then price_usd else 0 end) as Android_amount,
      
      sum(case when device_type = 'iPhone' then 1 else 0 end) as iPhone_count,
      sum(case when device_type = 'iPhone' then price_usd else 0 end) as iPhone_amount,
      
      sum(case when device_type = 'windows' then 1 else 0 end) as windows_count,
      sum(case when device_type = 'windows' then price_usd else 0 end) as windows_amount,
      
      sum(case when device_type = 'linux' then 1 else 0 end) as linux_count,
      sum(case when device_type = 'linux' then price_usd else 0 end) as linux_amount,
      
      sum(case when device_type = 'macOS' then 1 else 0 end) as macOS_count,
      sum(case when device_type = 'macOS' then price_usd else 0 end) as macOS_amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  )


  select 
    date_spine.*,
    daily_orders.* except(customer_id)
  from date_spine
  left join daily_orders on 
    date_spine.date_actual = daily_orders.created_on and 
    date_spine.customer_id = daily_orders.customer_id
  where date_spine.customer_id = "00059434-788d-429c-932b-48c07300ba92"
  order by date_actual;


[0m02:32:07.865923 [debug] [Thread-1  ]: finished collecting timing info
[0m02:32:07.866848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '079f192b-5a7f-425e-81c3-bac8a6d51c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43d7c3af10>]}
[0m02:32:07.867497 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.customer_daily_orders .................. [[32mOK[0m in 2.33s]
[0m02:32:07.868224 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m02:32:07.870090 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:32:07.870975 [info ] [MainThread]: 
[0m02:32:07.871444 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.39 seconds (6.39s).
[0m02:32:07.871866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:32:07.872430 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m02:32:07.897838 [info ] [MainThread]: 
[0m02:32:07.898340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:32:07.898864 [info ] [MainThread]: 
[0m02:32:07.899274 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:32:07.899854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43d7fe8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43d7d3b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43d7d3be50>]}


============================== 2022-08-15 02:35:28.175088 | 8c37d1f9-c3cc-4beb-aa36-e0d6960fde65 ==============================
[0m02:35:28.175120 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:35:28.175955 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:35:28.176307 [debug] [MainThread]: Tracking: tracking
[0m02:35:28.183399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b932c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b932d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b932280>]}
[0m02:35:28.297594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:35:28.298279 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m02:35:28.330766 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m02:35:28.360501 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m02:35:28.371569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m02:35:28.377938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c37d1f9-c3cc-4beb-aa36-e0d6960fde65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b5e7fa0>]}
[0m02:35:28.394786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c37d1f9-c3cc-4beb-aa36-e0d6960fde65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b8ae760>]}
[0m02:35:28.395155 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:35:28.395443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c37d1f9-c3cc-4beb-aa36-e0d6960fde65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b8ae880>]}
[0m02:35:28.396489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b8ae4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b669eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044b669c70>]}


============================== 2022-08-15 02:35:37.492660 | e22ef9fe-1e23-489f-ad26-88770dfde1b2 ==============================
[0m02:35:37.492721 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:35:37.498271 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customer_daily_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:35:37.498663 [debug] [MainThread]: Tracking: tracking
[0m02:35:37.512552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8edf970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8edf940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8edf9a0>]}
[0m02:35:37.685374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:35:37.686363 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m02:35:37.713549 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m02:35:37.763381 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m02:35:37.782845 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m02:35:37.795808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e22ef9fe-1e23-489f-ad26-88770dfde1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8c050d0>]}
[0m02:35:37.820430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e22ef9fe-1e23-489f-ad26-88770dfde1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8d1a8e0>]}
[0m02:35:37.820995 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:35:37.821675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e22ef9fe-1e23-489f-ad26-88770dfde1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b6cc8bb0>]}
[0m02:35:37.824394 [info ] [MainThread]: 
[0m02:35:37.825372 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:35:37.826662 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m02:35:37.827491 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-08-15 02:35:38.915866 | be189965-337a-45b3-a22b-f96362be9623 ==============================
[0m02:35:38.915919 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:35:38.917199 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:35:38.917671 [debug] [MainThread]: Tracking: tracking
[0m02:35:38.935908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb310064e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb310064700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3100646a0>]}
[0m02:35:39.105105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:35:39.105643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:35:39.107256 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m02:35:39.121266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be189965-337a-45b3-a22b-f96362be9623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30bd940d0>]}
[0m02:35:39.143185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be189965-337a-45b3-a22b-f96362be9623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30bef09a0>]}
[0m02:35:39.143608 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:35:39.143921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be189965-337a-45b3-a22b-f96362be9623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30bef08b0>]}
[0m02:35:39.145040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30bef06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30bef0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30bef0520>]}
[0m02:35:39.462333 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m02:35:39.462862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:39.679241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e22ef9fe-1e23-489f-ad26-88770dfde1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8d550a0>]}
[0m02:35:39.680498 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m02:35:39.681300 [info ] [MainThread]: 
[0m02:35:39.747440 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m02:35:39.748167 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.customer_daily_orders ...................... [RUN]
[0m02:35:39.749205 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m02:35:39.749591 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m02:35:39.749969 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m02:35:39.800999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:35:39.801544 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */
select
                device_type as value

            from `aec-students`.`dbt_lauren`.`order_details`

            

            group by device_type
            order by count(*) desc

            

        
[0m02:35:41.229401 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m02:35:41.230172 [debug] [Thread-1  ]: finished collecting timing info
[0m02:35:41.230522 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m02:35:41.572044 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m02:35:41.572802 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace table `aec-students`.`dbt_lauren`.`customer_daily_orders`
  
  
  OPTIONS()
  as (
    




with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = '[' then 1 else 0 end) as [_count,
      sum(case when device_type = '[' then price_usd else 0 end) as [_amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = 'a' then 1 else 0 end) as a_count,
      sum(case when device_type = 'a' then price_usd else 0 end) as a_amount,
      
      sum(case when device_type = 'n' then 1 else 0 end) as n_count,
      sum(case when device_type = 'n' then price_usd else 0 end) as n_amount,
      
      sum(case when device_type = 'd' then 1 else 0 end) as d_count,
      sum(case when device_type = 'd' then price_usd else 0 end) as d_amount,
      
      sum(case when device_type = 'r' then 1 else 0 end) as r_count,
      sum(case when device_type = 'r' then price_usd else 0 end) as r_amount,
      
      sum(case when device_type = 'o' then 1 else 0 end) as o_count,
      sum(case when device_type = 'o' then price_usd else 0 end) as o_amount,
      
      sum(case when device_type = 'i' then 1 else 0 end) as i_count,
      sum(case when device_type = 'i' then price_usd else 0 end) as i_amount,
      
      sum(case when device_type = 'd' then 1 else 0 end) as d_count,
      sum(case when device_type = 'd' then price_usd else 0 end) as d_amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = ',' then 1 else 0 end) as ,_count,
      sum(case when device_type = ',' then price_usd else 0 end) as ,_amount,
      
      sum(case when device_type = '_' then 1 else 0 end) as __count,
      sum(case when device_type = '_' then price_usd else 0 end) as __amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = 'i' then 1 else 0 end) as i_count,
      sum(case when device_type = 'i' then price_usd else 0 end) as i_amount,
      
      sum(case when device_type = 'p' then 1 else 0 end) as p_count,
      sum(case when device_type = 'p' then price_usd else 0 end) as p_amount,
      
      sum(case when device_type = 'h' then 1 else 0 end) as h_count,
      sum(case when device_type = 'h' then price_usd else 0 end) as h_amount,
      
      sum(case when device_type = 'o' then 1 else 0 end) as o_count,
      sum(case when device_type = 'o' then price_usd else 0 end) as o_amount,
      
      sum(case when device_type = 'n' then 1 else 0 end) as n_count,
      sum(case when device_type = 'n' then price_usd else 0 end) as n_amount,
      
      sum(case when device_type = 'e' then 1 else 0 end) as e_count,
      sum(case when device_type = 'e' then price_usd else 0 end) as e_amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = ',' then 1 else 0 end) as ,_count,
      sum(case when device_type = ',' then price_usd else 0 end) as ,_amount,
      
      sum(case when device_type = '_' then 1 else 0 end) as __count,
      sum(case when device_type = '_' then price_usd else 0 end) as __amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = 'w' then 1 else 0 end) as w_count,
      sum(case when device_type = 'w' then price_usd else 0 end) as w_amount,
      
      sum(case when device_type = 'i' then 1 else 0 end) as i_count,
      sum(case when device_type = 'i' then price_usd else 0 end) as i_amount,
      
      sum(case when device_type = 'n' then 1 else 0 end) as n_count,
      sum(case when device_type = 'n' then price_usd else 0 end) as n_amount,
      
      sum(case when device_type = 'd' then 1 else 0 end) as d_count,
      sum(case when device_type = 'd' then price_usd else 0 end) as d_amount,
      
      sum(case when device_type = 'o' then 1 else 0 end) as o_count,
      sum(case when device_type = 'o' then price_usd else 0 end) as o_amount,
      
      sum(case when device_type = 'w' then 1 else 0 end) as w_count,
      sum(case when device_type = 'w' then price_usd else 0 end) as w_amount,
      
      sum(case when device_type = 's' then 1 else 0 end) as s_count,
      sum(case when device_type = 's' then price_usd else 0 end) as s_amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = ',' then 1 else 0 end) as ,_count,
      sum(case when device_type = ',' then price_usd else 0 end) as ,_amount,
      
      sum(case when device_type = '_' then 1 else 0 end) as __count,
      sum(case when device_type = '_' then price_usd else 0 end) as __amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = 'l' then 1 else 0 end) as l_count,
      sum(case when device_type = 'l' then price_usd else 0 end) as l_amount,
      
      sum(case when device_type = 'i' then 1 else 0 end) as i_count,
      sum(case when device_type = 'i' then price_usd else 0 end) as i_amount,
      
      sum(case when device_type = 'n' then 1 else 0 end) as n_count,
      sum(case when device_type = 'n' then price_usd else 0 end) as n_amount,
      
      sum(case when device_type = 'u' then 1 else 0 end) as u_count,
      sum(case when device_type = 'u' then price_usd else 0 end) as u_amount,
      
      sum(case when device_type = 'x' then 1 else 0 end) as x_count,
      sum(case when device_type = 'x' then price_usd else 0 end) as x_amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = ',' then 1 else 0 end) as ,_count,
      sum(case when device_type = ',' then price_usd else 0 end) as ,_amount,
      
      sum(case when device_type = '_' then 1 else 0 end) as __count,
      sum(case when device_type = '_' then price_usd else 0 end) as __amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = 'm' then 1 else 0 end) as m_count,
      sum(case when device_type = 'm' then price_usd else 0 end) as m_amount,
      
      sum(case when device_type = 'a' then 1 else 0 end) as a_count,
      sum(case when device_type = 'a' then price_usd else 0 end) as a_amount,
      
      sum(case when device_type = 'c' then 1 else 0 end) as c_count,
      sum(case when device_type = 'c' then price_usd else 0 end) as c_amount,
      
      sum(case when device_type = 'o' then 1 else 0 end) as o_count,
      sum(case when device_type = 'o' then price_usd else 0 end) as o_amount,
      
      sum(case when device_type = 's' then 1 else 0 end) as s_count,
      sum(case when device_type = 's' then price_usd else 0 end) as s_amount,
      
      sum(case when device_type = ''' then 1 else 0 end) as '_count,
      sum(case when device_type = ''' then price_usd else 0 end) as '_amount,
      
      sum(case when device_type = ']' then 1 else 0 end) as ]_count,
      sum(case when device_type = ']' then price_usd else 0 end) as ]_amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  )


  select 
    date_spine.*,
    daily_orders.* except(customer_id)
  from date_spine
  left join daily_orders on 
    date_spine.date_actual = daily_orders.created_on and 
    date_spine.customer_id = daily_orders.customer_id
  where date_spine.customer_id = "00059434-788d-429c-932b-48c07300ba92"
  order by date_actual
  );
  
[0m02:35:41.791795 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "[" at [34:61]. If this is a table identifier, escape the name with `, e.g. `table.name` rather than [table.name].')
[0m02:35:42.759808 [debug] [Thread-1  ]: finished collecting timing info
[0m02:35:42.760469 [debug] [Thread-1  ]: Database Error in model customer_daily_orders (models/marts/coffee_shop/customer_daily_orders.sql)
  Syntax error: Unexpected "[" at [34:61]. If this is a table identifier, escape the name with `, e.g. `table.name` rather than [table.name].
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/customer_daily_orders.sql
[0m02:35:42.760924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e22ef9fe-1e23-489f-ad26-88770dfde1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8b62f10>]}
[0m02:35:42.761388 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.customer_daily_orders ............. [[31mERROR[0m in 3.01s]
[0m02:35:42.761974 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m02:35:42.763675 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:35:42.764145 [info ] [MainThread]: 
[0m02:35:42.764486 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m02:35:42.764847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:42.765044 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m02:35:42.783862 [info ] [MainThread]: 
[0m02:35:42.784240 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:35:42.784660 [info ] [MainThread]: 
[0m02:35:42.785006 [error] [MainThread]: [33mDatabase Error in model customer_daily_orders (models/marts/coffee_shop/customer_daily_orders.sql)[0m
[0m02:35:42.785376 [error] [MainThread]:   Syntax error: Unexpected "[" at [34:61]. If this is a table identifier, escape the name with `, e.g. `table.name` rather than [table.name].
[0m02:35:42.785674 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/customer_daily_orders.sql
[0m02:35:42.786000 [info ] [MainThread]: 
[0m02:35:42.786324 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:35:42.786817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8edf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8b76df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8b76850>]}


============================== 2022-08-15 02:36:50.612130 | ac3693d8-ba8c-4efb-be0e-a4836bf4abd6 ==============================
[0m02:36:50.612191 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:36:50.613491 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:36:50.613917 [debug] [MainThread]: Tracking: tracking
[0m02:36:50.622448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c9af11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c9af13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c9af1850>]}
[0m02:36:50.765782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:36:50.766729 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m02:36:50.796200 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql


============================== 2022-08-15 02:36:50.814059 | 9135f6f6-0521-4b8c-be37-7db2ee836d8b ==============================
[0m02:36:50.814118 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:36:50.815787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customer_daily_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:36:50.816238 [debug] [MainThread]: Tracking: tracking
[0m02:36:50.826346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35548e0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35548e0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35548e0700>]}
[0m02:36:50.873907 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m02:36:50.915829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m02:36:50.935150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac3693d8-ba8c-4efb-be0e-a4836bf4abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c98480a0>]}
[0m02:36:50.962150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac3693d8-ba8c-4efb-be0e-a4836bf4abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d7909b20>]}
[0m02:36:50.963794 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:36:50.964265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac3693d8-ba8c-4efb-be0e-a4836bf4abd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c9ac7580>]}
[0m02:36:50.965947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c9ac7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c9883f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c9883d00>]}
[0m02:36:50.968405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:36:50.969675 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m02:36:50.987463 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m02:36:51.015766 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m02:36:51.027284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m02:36:51.033676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9135f6f6-0521-4b8c-be37-7db2ee836d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35546060d0>]}
[0m02:36:51.048781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9135f6f6-0521-4b8c-be37-7db2ee836d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355471a8b0>]}
[0m02:36:51.049150 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m02:36:51.049500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9135f6f6-0521-4b8c-be37-7db2ee836d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35626c9130>]}
[0m02:36:51.051292 [info ] [MainThread]: 
[0m02:36:51.051885 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:36:51.052810 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m02:36:51.053189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:52.458027 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m02:36:52.458687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:52.724959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9135f6f6-0521-4b8c-be37-7db2ee836d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35548af460>]}
[0m02:36:52.725975 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m02:36:52.726507 [info ] [MainThread]: 
[0m02:36:52.732617 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m02:36:52.733038 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.customer_daily_orders ...................... [RUN]
[0m02:36:52.733715 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m02:36:52.734010 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m02:36:52.734335 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m02:36:52.753827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:36:52.754163 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */
select
                device_type as value

            from `aec-students`.`dbt_lauren`.`order_details`

            

            group by device_type
            order by count(*) desc

            

        
[0m02:36:54.244807 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m02:36:54.245436 [debug] [Thread-1  ]: finished collecting timing info
[0m02:36:54.245776 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m02:36:54.278618 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m02:36:54.279122 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace table `aec-students`.`dbt_lauren`.`customer_daily_orders`
  
  
  OPTIONS()
  as (
    




with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = 'Android' then 1 else 0 end) as android_count,
      sum(case when device_type = 'Android' then price_usd else 0 end) as android_amount,
      
      sum(case when device_type = 'iPhone' then 1 else 0 end) as iphone_count,
      sum(case when device_type = 'iPhone' then price_usd else 0 end) as iphone_amount,
      
      sum(case when device_type = 'windows' then 1 else 0 end) as windows_count,
      sum(case when device_type = 'windows' then price_usd else 0 end) as windows_amount,
      
      sum(case when device_type = 'linux' then 1 else 0 end) as linux_count,
      sum(case when device_type = 'linux' then price_usd else 0 end) as linux_amount,
      
      sum(case when device_type = 'macOS' then 1 else 0 end) as macos_count,
      sum(case when device_type = 'macOS' then price_usd else 0 end) as macos_amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  )


  select 
    date_spine.*,
    daily_orders.* except(customer_id)
  from date_spine
  left join daily_orders on 
    date_spine.date_actual = daily_orders.created_on and 
    date_spine.customer_id = daily_orders.customer_id
  where date_spine.customer_id = "00059434-788d-429c-932b-48c07300ba92"
  order by date_actual
  );
  
[0m02:36:58.098602 [debug] [Thread-1  ]: finished collecting timing info
[0m02:36:58.099232 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9135f6f6-0521-4b8c-be37-7db2ee836d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35544621c0>]}
[0m02:36:58.099693 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_lauren.customer_daily_orders ................. [[32mCREATE TABLE (200.0 rows, 466.0 MB processed)[0m in 5.37s]
[0m02:36:58.100283 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m02:36:58.101849 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:36:58.102268 [info ] [MainThread]: 
[0m02:36:58.102574 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m02:36:58.102997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:58.103201 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m02:36:58.118991 [info ] [MainThread]: 
[0m02:36:58.119354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:36:58.119784 [info ] [MainThread]: 
[0m02:36:58.120145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:36:58.120643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35548e0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35548e08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35544440a0>]}


============================== 2022-08-15 03:17:43.584185 | ed3f64f8-4991-49e2-a471-fa72e2dff419 ==============================
[0m03:17:43.584209 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:17:43.585329 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m03:17:43.585702 [debug] [MainThread]: Tracking: tracking
[0m03:17:43.591875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e06826a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e06823d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e06825b0>]}
[0m03:17:43.719617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:17:43.719915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:17:43.720792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:17:43.733860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed3f64f8-4991-49e2-a471-fa72e2dff419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e03d10d0>]}
[0m03:17:43.751292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed3f64f8-4991-49e2-a471-fa72e2dff419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e052c970>]}
[0m03:17:43.751658 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:17:43.751926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed3f64f8-4991-49e2-a471-fa72e2dff419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e052c880>]}
[0m03:17:43.752955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e052c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e052c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e052c4f0>]}


============================== 2022-08-15 03:24:53.239739 | 8bdd42a1-260f-430a-955b-7fbe68c2345e ==============================
[0m03:24:53.239769 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:24:53.240918 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m03:24:53.241306 [debug] [MainThread]: Tracking: tracking
[0m03:24:53.247639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118b1d4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118b1d4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118b1d4850>]}
[0m03:24:53.377737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:24:53.378014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:24:53.378913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:24:53.390243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bdd42a1-260f-430a-955b-7fbe68c2345e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118af230d0>]}
[0m03:24:53.407164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bdd42a1-260f-430a-955b-7fbe68c2345e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118b07b940>]}
[0m03:24:53.407545 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:24:53.407811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bdd42a1-260f-430a-955b-7fbe68c2345e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118b07b850>]}
[0m03:24:53.408840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118b07b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118b07b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118b07b4c0>]}


============================== 2022-08-15 03:28:46.108721 | c0725b4c-b097-478a-96c2-b17c8a65cf2d ==============================
[0m03:28:46.108771 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:28:46.109937 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m03:28:46.110284 [debug] [MainThread]: Tracking: tracking
[0m03:28:46.136255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef8d3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef8d3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef8d3eb0>]}
[0m03:28:46.300302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:28:46.301212 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m03:28:46.332072 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m03:28:46.388625 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m03:28:46.410224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:28:46.423755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0725b4c-b097-478a-96c2-b17c8a65cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef6380d0>]}
[0m03:28:46.447490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0725b4c-b097-478a-96c2-b17c8a65cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef741610>]}
[0m03:28:46.448047 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:28:46.448500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0725b4c-b097-478a-96c2-b17c8a65cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef741640>]}
[0m03:28:46.450823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef7416d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef784c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ef7849d0>]}


============================== 2022-08-15 03:28:48.606177 | 937a7391-978b-4e4c-b353-c6dfa5d99df1 ==============================
[0m03:28:48.606204 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:28:48.607293 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customer_daily_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:28:48.607594 [debug] [MainThread]: Tracking: tracking
[0m03:28:48.614249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37e0bed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37e0bec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37e0bef70>]}
[0m03:28:48.705868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:28:48.706130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:28:48.706986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:28:48.715449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '937a7391-978b-4e4c-b353-c6dfa5d99df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37ddb30d0>]}
[0m03:28:48.729152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '937a7391-978b-4e4c-b353-c6dfa5d99df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37df09a30>]}
[0m03:28:48.729494 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:28:48.729804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '937a7391-978b-4e4c-b353-c6dfa5d99df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37df09940>]}
[0m03:28:48.731972 [info ] [MainThread]: 
[0m03:28:48.732535 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:28:48.733445 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m03:28:48.733791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:28:51.731540 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m03:28:51.732104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:28:51.944449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '937a7391-978b-4e4c-b353-c6dfa5d99df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37e0bec40>]}
[0m03:28:51.945209 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:28:51.945635 [info ] [MainThread]: 
[0m03:28:51.968308 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m03:28:51.968693 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.customer_daily_orders ...................... [RUN]
[0m03:28:51.970119 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m03:28:51.970338 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m03:28:51.970560 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m03:28:52.005566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:52.005897 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */
select
                device_type as value

            from `aec-students`.`dbt_lauren`.`order_details`

            

            group by device_type
            order by count(*) desc

            

        
[0m03:28:53.739131 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m03:28:53.739639 [debug] [Thread-1  ]: finished collecting timing info
[0m03:28:53.739883 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m03:28:53.903556 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m03:28:53.904181 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace table `aec-students`.`dbt_lauren`.`customer_daily_orders`
  
  
  OPTIONS()
  as (
    




with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = 'Android' then 1 else 0 end) as android_count,
      sum(case when device_type = 'Android' then price_usd else 0 end) as android_amount,
      
      sum(case when device_type = 'iPhone' then 1 else 0 end) as iphone_count,
      sum(case when device_type = 'iPhone' then price_usd else 0 end) as iphone_amount,
      
      sum(case when device_type = 'windows' then 1 else 0 end) as windows_count,
      sum(case when device_type = 'windows' then price_usd else 0 end) as windows_amount,
      
      sum(case when device_type = 'linux' then 1 else 0 end) as linux_count,
      sum(case when device_type = 'linux' then price_usd else 0 end) as linux_amount,
      
      sum(case when device_type = 'macOS' then 1 else 0 end) as macos_count,
      sum(case when device_type = 'macOS' then price_usd else 0 end) as macos_amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  ),

  final as (
    
    select 
      date_spine.date_actual,
      date_spine.day_name,
      date_spine.month_actual,
      date_spine.year_actual,
      date_spine.quarter_actual,
      date_spine.week_actual,
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.first_day_of_month,
      date_spine.last_day_of_month,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.customer_first_order_on,
      daily_orders.purchase_count,
      daily_orders.revenue_amount,
      daily_orders.session_count,
      daily_orders.average_session_duration,

      
      ifnull( android_count, 0) as android_count,
      ifnull( android_amount, 0) as android_amount,
      
      ifnull( iphone_count, 0) as iphone_count,
      ifnull( iphone_amount, 0) as iphone_amount,
      
      ifnull( windows_count, 0) as windows_count,
      ifnull( windows_amount, 0) as windows_amount,
      
      ifnull( linux_count, 0) as linux_count,
      ifnull( linux_amount, 0) as linux_amount,
      
      ifnull( macos_count, 0) as macos_count,
      ifnull( macos_amount, 0) as macos_amount,
      
    

    from date_spine
    left join daily_orders on 
      date_spine.date_actual = daily_orders.created_on and 
      date_spine.customer_id = daily_orders.customer_id

  )

  select *
  from final
  );
  
[0m03:28:54.682255 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name customer_first_order_on not found inside date_spine at [93:18]')
[0m03:28:56.353709 [debug] [Thread-1  ]: finished collecting timing info
[0m03:28:56.354245 [debug] [Thread-1  ]: Database Error in model customer_daily_orders (models/marts/coffee_shop/customer_daily_orders.sql)
  Name customer_first_order_on not found inside date_spine at [93:18]
  compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/customer_daily_orders.sql
[0m03:28:56.354620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937a7391-978b-4e4c-b353-c6dfa5d99df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37dd55e20>]}
[0m03:28:56.355013 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbt_lauren.customer_daily_orders ............. [[31mERROR[0m in 4.39s]
[0m03:28:56.355527 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m03:28:56.357166 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:28:56.357567 [info ] [MainThread]: 
[0m03:28:56.357867 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m03:28:56.358248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:28:56.358423 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m03:28:56.372566 [info ] [MainThread]: 
[0m03:28:56.372879 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:28:56.373269 [info ] [MainThread]: 
[0m03:28:56.373571 [error] [MainThread]: [33mDatabase Error in model customer_daily_orders (models/marts/coffee_shop/customer_daily_orders.sql)[0m
[0m03:28:56.373853 [error] [MainThread]:   Name customer_first_order_on not found inside date_spine at [93:18]
[0m03:28:56.374136 [error] [MainThread]:   compiled SQL at target/run/coffee_shop_zar/models/marts/coffee_shop/customer_daily_orders.sql
[0m03:28:56.374608 [info ] [MainThread]: 
[0m03:28:56.374908 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:28:56.375311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38ddd36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37df097c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37dd257f0>]}


============================== 2022-08-15 03:29:17.007959 | 5b6c1a7c-2495-447f-9fb9-cf1a195ba134 ==============================
[0m03:29:17.008005 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:29:17.009182 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m03:29:17.009565 [debug] [MainThread]: Tracking: tracking
[0m03:29:17.028279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbdb50dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbdb50940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbdb50100>]}
[0m03:29:17.197589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:29:17.198442 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m03:29:17.225438 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m03:29:17.279145 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m03:29:17.297256 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:29:17.308564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b6c1a7c-2495-447f-9fb9-cf1a195ba134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbd8830d0>]}
[0m03:29:17.331805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b6c1a7c-2495-447f-9fb9-cf1a195ba134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbdb0cbe0>]}
[0m03:29:17.332336 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:29:17.332780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b6c1a7c-2495-447f-9fb9-cf1a195ba134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbdb0c6a0>]}
[0m03:29:17.334420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbd885b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbdb261f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbdb262e0>]}


============================== 2022-08-15 03:29:20.389825 | 14e01587-f97b-49ef-a71a-e48f80b40c6c ==============================
[0m03:29:20.389850 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:29:20.390648 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customer_daily_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:29:20.390945 [debug] [MainThread]: Tracking: tracking
[0m03:29:20.397100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb042007bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb042007b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb042007be0>]}
[0m03:29:20.493720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:29:20.493972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:29:20.494794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:29:20.503213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14e01587-f97b-49ef-a71a-e48f80b40c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb041d270d0>]}
[0m03:29:20.516393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14e01587-f97b-49ef-a71a-e48f80b40c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb041e7b790>]}
[0m03:29:20.516725 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:29:20.517046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14e01587-f97b-49ef-a71a-e48f80b40c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb041e7b6a0>]}
[0m03:29:20.519164 [info ] [MainThread]: 
[0m03:29:20.519716 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:29:20.520550 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m03:29:20.520889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:21.522847 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m03:29:21.523296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:21.717748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14e01587-f97b-49ef-a71a-e48f80b40c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb041fead00>]}
[0m03:29:21.718667 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:29:21.719054 [info ] [MainThread]: 
[0m03:29:21.725499 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m03:29:21.725889 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.customer_daily_orders ...................... [RUN]
[0m03:29:21.727738 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m03:29:21.728092 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m03:29:21.728344 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m03:29:21.783145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:21.783695 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */
select
                device_type as value

            from `aec-students`.`dbt_lauren`.`order_details`

            

            group by device_type
            order by count(*) desc

            

        
[0m03:29:23.093553 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m03:29:23.094052 [debug] [Thread-1  ]: finished collecting timing info
[0m03:29:23.094292 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m03:29:23.224301 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m03:29:23.224904 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace table `aec-students`.`dbt_lauren`.`customer_daily_orders`
  
  
  OPTIONS()
  as (
    




with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = 'Android' then 1 else 0 end) as android_count,
      sum(case when device_type = 'Android' then price_usd else 0 end) as android_amount,
      
      sum(case when device_type = 'iPhone' then 1 else 0 end) as iphone_count,
      sum(case when device_type = 'iPhone' then price_usd else 0 end) as iphone_amount,
      
      sum(case when device_type = 'windows' then 1 else 0 end) as windows_count,
      sum(case when device_type = 'windows' then price_usd else 0 end) as windows_amount,
      
      sum(case when device_type = 'linux' then 1 else 0 end) as linux_count,
      sum(case when device_type = 'linux' then price_usd else 0 end) as linux_amount,
      
      sum(case when device_type = 'macOS' then 1 else 0 end) as macos_count,
      sum(case when device_type = 'macOS' then price_usd else 0 end) as macos_amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id,
      orders.customer_first_order_on
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  ),

  final as (
    
    select 
      date_spine.date_actual,
      date_spine.day_name,
      date_spine.month_actual,
      date_spine.year_actual,
      date_spine.quarter_actual,
      date_spine.week_actual,
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.first_day_of_month,
      date_spine.last_day_of_month,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.customer_first_order_on,
      daily_orders.purchase_count,
      daily_orders.revenue_amount,
      daily_orders.session_count,
      daily_orders.average_session_duration,

      
      ifnull( android_count, 0) as android_count,
      ifnull( android_amount, 0) as android_amount,
      
      ifnull( iphone_count, 0) as iphone_count,
      ifnull( iphone_amount, 0) as iphone_amount,
      
      ifnull( windows_count, 0) as windows_count,
      ifnull( windows_amount, 0) as windows_amount,
      
      ifnull( linux_count, 0) as linux_count,
      ifnull( linux_amount, 0) as linux_amount,
      
      ifnull( macos_count, 0) as macos_count,
      ifnull( macos_amount, 0) as macos_amount,
      
    

    from date_spine
    left join daily_orders on 
      date_spine.date_actual = daily_orders.created_on and 
      date_spine.customer_id = daily_orders.customer_id

  )

  select *
  from final
  );
  
[0m03:29:41.276114 [debug] [Thread-1  ]: finished collecting timing info
[0m03:29:41.276698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14e01587-f97b-49ef-a71a-e48f80b40c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb041c9f700>]}
[0m03:29:41.277124 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_lauren.customer_daily_orders ................. [[32mCREATE TABLE (35.2m rows, 466.0 MB processed)[0m in 19.55s]
[0m03:29:41.277637 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m03:29:41.279098 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:29:41.279499 [info ] [MainThread]: 
[0m03:29:41.279795 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.76 seconds (20.76s).
[0m03:29:41.280129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:41.280286 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m03:29:41.295903 [info ] [MainThread]: 
[0m03:29:41.296218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:29:41.296571 [info ] [MainThread]: 
[0m03:29:41.296856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:29:41.297273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb041fb32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb041e7b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb041d0dbb0>]}


============================== 2022-08-15 03:30:54.203642 | 77701a28-941f-4b94-811a-35bff71949e3 ==============================
[0m03:30:54.203684 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:30:54.204808 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m03:30:54.205217 [debug] [MainThread]: Tracking: tracking
[0m03:30:54.213053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04efb994c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04efb99220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04efb4b430>]}
[0m03:30:54.347524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:30:54.348403 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_zar://models/marts/coffee_shop/customer_daily_orders.sql
[0m03:30:54.375517 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m03:30:54.431599 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m03:30:54.449653 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:30:54.461055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77701a28-941f-4b94-811a-35bff71949e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ef89ff70>]}
[0m03:30:54.484456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77701a28-941f-4b94-811a-35bff71949e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04efb161c0>]}
[0m03:30:54.484981 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:30:54.485443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77701a28-941f-4b94-811a-35bff71949e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0501949790>]}
[0m03:30:54.487054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04efb165e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ef8cfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ef8cfca0>]}


============================== 2022-08-15 03:30:55.528956 | 506d9893-7f58-4a4b-aea0-dbf58557f3bb ==============================
[0m03:30:55.528983 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:30:55.529975 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['customer_daily_orders'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:30:55.530301 [debug] [MainThread]: Tracking: tracking
[0m03:30:55.537175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5f119250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5f1193a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5f119310>]}
[0m03:30:55.630656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:30:55.630920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:30:55.631864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:30:55.640418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '506d9893-7f58-4a4b-aea0-dbf58557f3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ee620d0>]}
[0m03:30:55.653717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '506d9893-7f58-4a4b-aea0-dbf58557f3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5efb68e0>]}
[0m03:30:55.654054 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:30:55.654362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '506d9893-7f58-4a4b-aea0-dbf58557f3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5efb67f0>]}
[0m03:30:55.656024 [info ] [MainThread]: 
[0m03:30:55.656577 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:30:55.657443 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m03:30:55.657781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:30:56.680360 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m03:30:56.680784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:56.935674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '506d9893-7f58-4a4b-aea0-dbf58557f3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5f1197f0>]}
[0m03:30:56.936442 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:30:56.936819 [info ] [MainThread]: 
[0m03:30:56.942887 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m03:30:56.943233 [info ] [Thread-1  ]: 1 of 1 START table model dbt_lauren.customer_daily_orders ...................... [RUN]
[0m03:30:56.945277 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m03:30:56.945508 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m03:30:56.945725 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m03:30:56.976754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:56.977065 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */
select
                device_type as value

            from `aec-students`.`dbt_lauren`.`order_details`

            

            group by device_type
            order by count(*) desc

            

        
[0m03:30:58.334020 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m03:30:58.334708 [debug] [Thread-1  ]: finished collecting timing info
[0m03:30:58.335067 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m03:30:58.507284 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m03:30:58.507888 [debug] [Thread-1  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace table `aec-students`.`dbt_lauren`.`customer_daily_orders`
  
  
  OPTIONS()
  as (
    




with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = 'Android' then 1 else 0 end) as android_count,
      sum(case when device_type = 'Android' then price_usd else 0 end) as android_amount,
      
      sum(case when device_type = 'iPhone' then 1 else 0 end) as iphone_count,
      sum(case when device_type = 'iPhone' then price_usd else 0 end) as iphone_amount,
      
      sum(case when device_type = 'windows' then 1 else 0 end) as windows_count,
      sum(case when device_type = 'windows' then price_usd else 0 end) as windows_amount,
      
      sum(case when device_type = 'linux' then 1 else 0 end) as linux_count,
      sum(case when device_type = 'linux' then price_usd else 0 end) as linux_amount,
      
      sum(case when device_type = 'macOS' then 1 else 0 end) as macos_count,
      sum(case when device_type = 'macOS' then price_usd else 0 end) as macos_amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id,
      orders.customer_first_order_on
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  ),

  final as (
    
    select 
      date_spine.date_actual,
      date_spine.day_name,
      date_spine.month_actual,
      date_spine.year_actual,
      date_spine.quarter_actual,
      date_spine.week_actual,
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.first_day_of_month,
      date_spine.last_day_of_month,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.customer_first_order_on,
      ifnull(daily_orders.purchase_count,0) as purchase_count,
      ifnull(daily_orders.revenue_amount,0) as revenue_amount,
      ifnull(daily_orders.session_count,0) as session_count,
      ifnull(daily_orders.average_session_duration,0) as average_session_duration,

      
      ifnull( android_count, 0) as android_count,
      ifnull( android_amount, 0) as android_amount,
      
      ifnull( iphone_count, 0) as iphone_count,
      ifnull( iphone_amount, 0) as iphone_amount,
      
      ifnull( windows_count, 0) as windows_count,
      ifnull( windows_amount, 0) as windows_amount,
      
      ifnull( linux_count, 0) as linux_count,
      ifnull( linux_amount, 0) as linux_amount,
      
      ifnull( macos_count, 0) as macos_count,
      ifnull( macos_amount, 0) as macos_amount,
      
    

    from date_spine
    left join daily_orders on 
      date_spine.date_actual = daily_orders.created_on and 
      date_spine.customer_id = daily_orders.customer_id

  )

  select *
  from final
  );
  
[0m03:31:16.446235 [debug] [Thread-1  ]: finished collecting timing info
[0m03:31:16.446831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506d9893-7f58-4a4b-aea0-dbf58557f3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ed46f70>]}
[0m03:31:16.447257 [info ] [Thread-1  ]: 1 of 1 OK created table model dbt_lauren.customer_daily_orders ................. [[32mCREATE TABLE (35.2m rows, 466.0 MB processed)[0m in 19.50s]
[0m03:31:16.447807 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m03:31:16.449313 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:31:16.449712 [info ] [MainThread]: 
[0m03:31:16.450002 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.79 seconds (20.79s).
[0m03:31:16.450255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:31:16.450378 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m03:31:16.465495 [info ] [MainThread]: 
[0m03:31:16.465817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:31:16.466164 [info ] [MainThread]: 
[0m03:31:16.466453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:31:16.466851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ee4c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ee488e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5ee48640>]}


============================== 2022-08-15 03:47:21.789498 | 1ee7c6eb-2825-4958-914b-fb1bf5b0590d ==============================
[0m03:47:21.789527 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:47:21.790219 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m03:47:21.790523 [debug] [MainThread]: Tracking: tracking
[0m03:47:21.796693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169ad90370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169ad902e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169ad90340>]}
[0m03:47:21.890750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:47:21.891022 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:47:21.891865 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m03:47:21.900539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ee7c6eb-2825-4958-914b-fb1bf5b0590d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169aab80d0>]}
[0m03:47:21.914012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ee7c6eb-2825-4958-914b-fb1bf5b0590d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169ac11850>]}
[0m03:47:21.914450 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m03:47:21.914714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ee7c6eb-2825-4958-914b-fb1bf5b0590d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169ac11760>]}
[0m03:47:21.915695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169ac11580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169ac116d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169ac113d0>]}


============================== 2022-08-15 04:16:42.582594 | 082379d3-8fde-4ed2-99fc-60a4d1fc5bc6 ==============================
[0m04:16:42.582621 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:16:42.583379 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:16:42.583673 [debug] [MainThread]: Tracking: tracking
[0m04:16:42.590473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb3743970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb37433d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb3743910>]}
[0m04:16:42.721965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:16:42.722277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:16:42.723256 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m04:16:42.735365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '082379d3-8fde-4ed2-99fc-60a4d1fc5bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb343b0d0>]}
[0m04:16:42.755210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '082379d3-8fde-4ed2-99fc-60a4d1fc5bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb3592b20>]}
[0m04:16:42.755585 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m04:16:42.755866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '082379d3-8fde-4ed2-99fc-60a4d1fc5bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb3592a30>]}
[0m04:16:42.756939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb3592850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb35929a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb35926a0>]}


============================== 2022-08-15 05:50:47.620110 | 90407631-7775-4d23-b6fb-3d4ea03ea9df ==============================
[0m05:50:47.620138 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:50:47.621010 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m05:50:47.621468 [debug] [MainThread]: Tracking: tracking
[0m05:50:47.632680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad930970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad9303d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad930910>]}
[0m05:50:47.770922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:50:47.771208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:50:47.772179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m05:50:47.783683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90407631-7775-4d23-b6fb-3d4ea03ea9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad6270d0>]}
[0m05:50:47.797093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90407631-7775-4d23-b6fb-3d4ea03ea9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad782b20>]}
[0m05:50:47.797445 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m05:50:47.797724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90407631-7775-4d23-b6fb-3d4ea03ea9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad782a30>]}
[0m05:50:47.798729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad782850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad7829a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaad7826a0>]}


============================== 2022-08-15 15:08:00.013262 | 85eac30d-85ac-4322-a465-55fe6d189a07 ==============================
[0m15:08:00.013293 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:08:00.020468 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m15:08:00.020847 [debug] [MainThread]: Tracking: tracking
[0m15:08:00.030606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a802fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a8022e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a7f0130>]}
[0m15:08:00.161391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:00.161803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:00.163268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:08:00.175865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85eac30d-85ac-4322-a465-55fe6d189a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a544f40>]}
[0m15:08:00.189168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85eac30d-85ac-4322-a465-55fe6d189a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a69bf70>]}
[0m15:08:00.189509 [info ] [MainThread]: Found 16 models, 12 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:08:00.189772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85eac30d-85ac-4322-a465-55fe6d189a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a69be80>]}
[0m15:08:00.190770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a69bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a69bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682a69baf0>]}


============================== 2022-08-15 15:20:01.804714 | bec5604f-1914-4da1-969e-698c3d52855c ==============================
[0m15:20:01.804741 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:20:01.805586 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m15:20:01.805926 [debug] [MainThread]: Tracking: tracking
[0m15:20:01.814946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ef9e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ef9ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ef9e760>]}
[0m15:20:01.998823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:01.999582 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop.yml
[0m15:20:02.014784 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m15:20:02.084792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:20:02.091971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bec5604f-1914-4da1-969e-698c3d52855c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984e9950a0>]}
[0m15:20:02.106514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bec5604f-1914-4da1-969e-698c3d52855c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ecd4700>]}
[0m15:20:02.106954 [info ] [MainThread]: Found 16 models, 13 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:20:02.107254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec5604f-1914-4da1-969e-698c3d52855c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ecd4670>]}
[0m15:20:02.108511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9860d49820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ef42e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ef42220>]}


============================== 2022-08-15 15:34:46.420743 | 2eaf8510-da99-4861-ac76-f6d85369e806 ==============================
[0m15:34:46.420765 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:34:46.422982 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m15:34:46.423303 [debug] [MainThread]: Tracking: tracking
[0m15:34:46.431680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c98a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c98a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c98a910>]}
[0m15:34:46.582623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:46.583149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:46.584284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:34:46.597861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eaf8510-da99-4861-ac76-f6d85369e806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c6810d0>]}
[0m15:34:46.611970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eaf8510-da99-4861-ac76-f6d85369e806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c7cbd60>]}
[0m15:34:46.612383 [info ] [MainThread]: Found 16 models, 13 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:34:46.612814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eaf8510-da99-4861-ac76-f6d85369e806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c7cbc70>]}
[0m15:34:46.614471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c7cbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c7cbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c7cb8e0>]}


============================== 2022-08-15 15:34:57.445838 | f0981e2f-409d-4ee0-ba67-747b52d7a728 ==============================
[0m15:34:57.445867 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:34:57.446855 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['stg_coffee_shop__product_prices'], 'which': 'test', 'rpc_method': 'test'}
[0m15:34:57.448041 [debug] [MainThread]: Tracking: tracking
[0m15:34:57.455077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd22da400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd229c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd229ce50>]}
[0m15:34:57.555155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:57.555473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:57.556382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:34:57.565173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0981e2f-409d-4ee0-ba67-747b52d7a728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd1fc40d0>]}
[0m15:34:57.579028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0981e2f-409d-4ee0-ba67-747b52d7a728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd2107d60>]}
[0m15:34:57.579416 [info ] [MainThread]: Found 16 models, 13 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:34:57.579790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0981e2f-409d-4ee0-ba67-747b52d7a728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd22da400>]}
[0m15:34:57.582199 [info ] [MainThread]: 
[0m15:34:57.583012 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:34:57.585478 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m15:34:57.585812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:00.586547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0981e2f-409d-4ee0-ba67-747b52d7a728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd20039a0>]}
[0m15:35:00.587389 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:35:00.587822 [info ] [MainThread]: 
[0m15:35:00.601963 [debug] [Thread-1  ]: Began running node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:35:00.602254 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at  [RUN]
[0m15:35:00.602899 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee"
[0m15:35:00.603212 [debug] [Thread-1  ]: Began compiling node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:35:00.604174 [debug] [Thread-1  ]: Compiling test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:35:00.626273 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee"
[0m15:35:00.630674 [debug] [Thread-1  ]: finished collecting timing info
[0m15:35:00.630982 [debug] [Thread-1  ]: Began executing node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:35:00.652003 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee"
[0m15:35:00.652485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:35:00.652772 [debug] [Thread-1  ]: On test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        price_started_at as lower_bound,
        price_ended_at as upper_bound,

        lead(price_started_at) over (
            
            order by price_started_at
        ) as next_lower_bound,

        row_number() over (
            
            order by price_started_at desc
        ) = 1 as is_last_record

    from `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions nore cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m15:35:02.894056 [debug] [Thread-1  ]: finished collecting timing info
[0m15:35:02.894685 [error] [Thread-1  ]: 1 of 1 FAIL 14 dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at  [[31mFAIL 14[0m in 2.29s]
[0m15:35:02.895340 [debug] [Thread-1  ]: Finished running node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:35:02.897030 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:35:02.897664 [info ] [MainThread]: 
[0m15:35:02.898621 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m15:35:02.899162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:02.899467 [debug] [MainThread]: Connection 'test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee' was properly closed.
[0m15:35:02.914344 [info ] [MainThread]: 
[0m15:35:02.914758 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:35:02.915293 [info ] [MainThread]: 
[0m15:35:02.915777 [error] [MainThread]: [31mFailure in test dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at (models/staging/coffee_shop/stg_coffee_shop.yml)[0m
[0m15:35:02.916287 [error] [MainThread]:   Got 14 results, configured to fail if != 0
[0m15:35:02.916842 [info ] [MainThread]: 
[0m15:35:02.917667 [info ] [MainThread]:   compiled SQL at target/compiled/coffee_shop_zar/models/staging/coffee_shop/stg_coffee_shop.yml/dbt_utils_mutually_exclusive_r_92e471ac4fc60a540c813363ee360672.sql
[0m15:35:02.918169 [info ] [MainThread]: 
[0m15:35:02.918667 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:35:02.919660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be1fec160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd21071f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bd1f425b0>]}


============================== 2022-08-15 15:37:02.901646 | e7ec2977-7dd8-469e-ae51-38114cb5969a ==============================
[0m15:37:02.901701 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:37:02.902890 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['stg_coffee_shop__product_prices'], 'which': 'test', 'rpc_method': 'test'}
[0m15:37:02.903255 [debug] [MainThread]: Tracking: tracking
[0m15:37:02.939883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f87216af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f87216a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f87216760>]}
[0m15:37:03.088014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:03.088405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:03.089747 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:37:03.113350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ec2977-7dd8-469e-ae51-38114cb5969a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f86f6aac0>]}
[0m15:37:03.127750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ec2977-7dd8-469e-ae51-38114cb5969a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8709f220>]}
[0m15:37:03.128497 [info ] [MainThread]: Found 16 models, 13 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:37:03.129065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ec2977-7dd8-469e-ae51-38114cb5969a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8709f190>]}
[0m15:37:03.131984 [info ] [MainThread]: 
[0m15:37:03.132857 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:37:03.135926 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m15:37:03.136345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:04.174142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ec2977-7dd8-469e-ae51-38114cb5969a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f86fb1d30>]}
[0m15:37:04.174996 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:37:04.175416 [info ] [MainThread]: 
[0m15:37:04.181387 [debug] [Thread-1  ]: Began running node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:37:04.181718 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at  [RUN]
[0m15:37:04.182413 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee"
[0m15:37:04.182677 [debug] [Thread-1  ]: Began compiling node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:37:04.182918 [debug] [Thread-1  ]: Compiling test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:37:04.205564 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee"
[0m15:37:04.206128 [debug] [Thread-1  ]: finished collecting timing info
[0m15:37:04.206449 [debug] [Thread-1  ]: Began executing node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:37:04.228336 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee"
[0m15:37:04.228828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:37:04.229127 [debug] [Thread-1  ]: On test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        price_started_at as lower_bound,
        price_ended_at as upper_bound,

        lead(price_started_at) over (
            
            order by price_started_at
        ) as next_lower_bound,

        row_number() over (
            
            order by price_started_at desc
        ) = 1 as is_last_record

    from `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions nore cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m15:37:05.520854 [debug] [Thread-1  ]: finished collecting timing info
[0m15:37:05.521514 [error] [Thread-1  ]: 1 of 1 FAIL 14 dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at  [[31mFAIL 14[0m in 1.34s]
[0m15:37:05.522146 [debug] [Thread-1  ]: Finished running node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee
[0m15:37:05.525392 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:37:05.525823 [info ] [MainThread]: 
[0m15:37:05.526179 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m15:37:05.526678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:05.526956 [debug] [MainThread]: Connection 'test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at.91ecc8adee' was properly closed.
[0m15:37:05.541811 [info ] [MainThread]: 
[0m15:37:05.542213 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:05.542737 [info ] [MainThread]: 
[0m15:37:05.543309 [error] [MainThread]: [31mFailure in test dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__price_ended_at (models/staging/coffee_shop/stg_coffee_shop.yml)[0m
[0m15:37:05.544369 [error] [MainThread]:   Got 14 results, configured to fail if != 0
[0m15:37:05.544841 [info ] [MainThread]: 
[0m15:37:05.545315 [info ] [MainThread]:   compiled SQL at target/compiled/coffee_shop_zar/models/staging/coffee_shop/stg_coffee_shop.yml/dbt_utils_mutually_exclusive_r_92e471ac4fc60a540c813363ee360672.sql
[0m15:37:05.545793 [info ] [MainThread]: 
[0m15:37:05.546238 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:37:05.547100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f9afac1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f870b5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f86ef1e50>]}


============================== 2022-08-15 15:41:01.154209 | 34c05129-0fe2-41e0-b4c1-76c055e66315 ==============================
[0m15:41:01.154238 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:41:01.157002 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['stg_coffee_shop__product_prices'], 'which': 'test', 'rpc_method': 'test'}
[0m15:41:01.157442 [debug] [MainThread]: Tracking: tracking
[0m15:41:01.171659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f788df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f788ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f788760>]}
[0m15:41:01.263792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:01.264502 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop_zar://models/staging/coffee_shop/stg_coffee_shop.yml
[0m15:41:01.279610 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m15:41:01.348888 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:41:01.356485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c05129-0fe2-41e0-b4c1-76c055e66315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f22fa30>]}
[0m15:41:01.377021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c05129-0fe2-41e0-b4c1-76c055e66315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f5f3370>]}
[0m15:41:01.377588 [info ] [MainThread]: Found 16 models, 13 tests, 0 snapshots, 0 analyses, 530 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:41:01.378893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c05129-0fe2-41e0-b4c1-76c055e66315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f5f3280>]}
[0m15:41:01.382771 [info ] [MainThread]: 
[0m15:41:01.386202 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:41:01.389008 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m15:41:01.389661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:02.437661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c05129-0fe2-41e0-b4c1-76c055e66315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f51fe20>]}
[0m15:41:02.438519 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:41:02.438931 [info ] [MainThread]: 
[0m15:41:02.445455 [debug] [Thread-1  ]: Began running node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb
[0m15:41:02.445737 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at  [RUN]
[0m15:41:02.446419 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb"
[0m15:41:02.446757 [debug] [Thread-1  ]: Began compiling node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb
[0m15:41:02.446993 [debug] [Thread-1  ]: Compiling test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb
[0m15:41:02.457954 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb"
[0m15:41:02.458387 [debug] [Thread-1  ]: finished collecting timing info
[0m15:41:02.458607 [debug] [Thread-1  ]: Began executing node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb
[0m15:41:02.480726 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb"
[0m15:41:02.481167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:41:02.481457 [debug] [Thread-1  ]: On test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        product_id as partition_by_col,
        
        price_started_at as lower_bound,
        price_ended_at as upper_bound,

        lead(price_started_at) over (
            partition by product_id
            order by price_started_at
        ) as next_lower_bound,

        row_number() over (
            partition by product_id
            order by price_started_at desc
        ) = 1 as is_last_record

    from `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions nore cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m15:41:04.197948 [debug] [Thread-1  ]: finished collecting timing info
[0m15:41:04.198570 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at  [[32mPASS[0m in 1.75s]
[0m15:41:04.199228 [debug] [Thread-1  ]: Finished running node test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb
[0m15:41:04.202589 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:41:04.203079 [info ] [MainThread]: 
[0m15:41:04.203412 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m15:41:04.203821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:04.204074 [debug] [MainThread]: Connection 'test.coffee_shop_zar.dbt_utils_mutually_exclusive_ranges_stg_coffee_shop__product_prices_not_allowed__price_started_at__product_id__price_ended_at.450d9745bb' was properly closed.
[0m15:41:04.223690 [info ] [MainThread]: 
[0m15:41:04.224102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:04.224799 [info ] [MainThread]: 
[0m15:41:04.225871 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:41:04.226658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71815852e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f51fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716f2aadc0>]}


============================== 2022-08-15 15:44:37.367270 | b779ace4-d98a-4c1b-9751-019a8f9dadbf ==============================
[0m15:44:37.367282 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:44:37.367736 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:44:37.368012 [debug] [MainThread]: Tracking: tracking
[0m15:44:37.374218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11f4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11888b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11887c0>]}
[0m15:44:37.375686 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x75ztzkp'
[0m15:44:37.376294 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:44:37.568604 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:44:37.569259 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:44:37.678696 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:44:37.701460 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m15:44:37.809824 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m15:44:37.813486 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/github.json
[0m15:44:38.016369 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/github.json 200
[0m15:44:38.041553 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/github_source.json
[0m15:44:38.154521 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/github_source.json 200
[0m15:44:38.158686 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
[0m15:44:38.272492 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
[0m15:44:38.349716 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:44:38.999644 [info ] [MainThread]:   Installed from version 0.8.6
[0m15:44:39.000359 [info ] [MainThread]:   Up to date!
[0m15:44:39.001427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b779ace4-d98a-4c1b-9751-019a8f9dadbf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1141460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1188070>]}
[0m15:44:39.002207 [info ] [MainThread]: Installing dbt-labs/codegen
[0m15:44:39.393874 [info ] [MainThread]:   Installed from version 0.7.0
[0m15:44:39.394292 [info ] [MainThread]:   Up to date!
[0m15:44:39.395132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b779ace4-d98a-4c1b-9751-019a8f9dadbf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11881c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11884c0>]}
[0m15:44:39.396321 [info ] [MainThread]: Installing fivetran/github
[0m15:44:40.207214 [info ] [MainThread]:   Installed from version 0.5.1
[0m15:44:40.207648 [info ] [MainThread]:   Up to date!
[0m15:44:40.208202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b779ace4-d98a-4c1b-9751-019a8f9dadbf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11d8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11d8070>]}
[0m15:44:40.208653 [info ] [MainThread]: Installing fivetran/github_source
[0m15:44:40.985605 [info ] [MainThread]:   Installed from version 0.5.0
[0m15:44:40.986038 [info ] [MainThread]:   Up to date!
[0m15:44:40.986789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b779ace4-d98a-4c1b-9751-019a8f9dadbf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11d8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f11d8040>]}
[0m15:44:40.987777 [info ] [MainThread]: Installing fivetran/fivetran_utils
[0m15:44:41.405174 [info ] [MainThread]:   Installed from version 0.3.8
[0m15:44:41.405644 [info ] [MainThread]:   Up to date!
[0m15:44:41.406354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b779ace4-d98a-4c1b-9751-019a8f9dadbf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f10d24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f10d2670>]}
[0m15:44:41.407343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1188790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f112dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f112dd00>]}


============================== 2022-08-15 15:48:24.981951 | 9b7cae61-f225-4406-ac3f-915880796706 ==============================
[0m15:48:24.981978 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:48:24.982829 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:48:24.983515 [debug] [MainThread]: Tracking: tracking
[0m15:48:24.996765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d6e4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d6e4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d6e44c0>]}
[0m15:48:25.084165 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:48:25.084615 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:48:25.085102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d6dc0a0>]}
[0m15:48:25.150959 [debug] [MainThread]: Parsing macros/etc.sql
[0m15:48:25.153783 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:48:25.177740 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:48:25.183400 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:48:25.186172 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:48:25.186768 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:48:25.187238 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:48:25.187835 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:48:25.188549 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:48:25.189211 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:48:25.189945 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:48:25.190390 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:48:25.191898 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:48:25.192993 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:48:25.193647 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:48:25.194961 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:48:25.195648 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:48:25.196289 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m15:48:25.198852 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m15:48:25.200572 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m15:48:25.205333 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m15:48:25.208180 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m15:48:25.225984 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m15:48:25.228863 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:48:25.229886 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:48:25.230688 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:48:25.231599 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:48:25.233062 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:48:25.235841 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:48:25.249300 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:48:25.256490 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:48:25.271562 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:48:25.277140 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:48:25.291084 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:48:25.296318 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:48:25.299122 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:48:25.300222 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:48:25.301383 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:48:25.302394 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:48:25.303701 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:48:25.311177 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:48:25.312192 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:48:25.313581 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:48:25.314924 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:48:25.316063 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:48:25.317177 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:48:25.318411 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:48:25.319805 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:48:25.322026 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:48:25.324769 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:48:25.329452 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:48:25.331522 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:48:25.333443 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:48:25.335826 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:48:25.337876 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:48:25.339949 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:48:25.341996 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:48:25.359057 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:48:25.366513 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:48:25.369636 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:48:25.377708 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:48:25.388916 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:48:25.392933 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:48:25.411102 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:48:25.415584 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:48:25.430781 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:48:25.432387 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:48:25.441723 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:48:25.443114 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:48:25.448528 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:48:25.451984 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:48:25.454328 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:48:25.458836 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:48:25.460664 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:48:25.462546 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:48:25.481355 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:48:25.488424 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:48:25.500676 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:48:25.502380 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:48:25.513846 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:48:25.531622 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:48:25.533216 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:48:25.534916 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:48:25.537474 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:48:25.540472 [debug] [MainThread]: Parsing macros/fill_staging_columns.sql
[0m15:48:25.545082 [debug] [MainThread]: Parsing macros/json_extract.sql
[0m15:48:25.548218 [debug] [MainThread]: Parsing macros/union_relations.sql
[0m15:48:25.557089 [debug] [MainThread]: Parsing macros/try_cast.sql
[0m15:48:25.561367 [debug] [MainThread]: Parsing macros/timestamp_add.sql
[0m15:48:25.564751 [debug] [MainThread]: Parsing macros/fill_pass_through_columns.sql
[0m15:48:25.566391 [debug] [MainThread]: Parsing macros/dummy_coalesce_value.sql
[0m15:48:25.569816 [debug] [MainThread]: Parsing macros/add_dbt_source_relation.sql
[0m15:48:25.570657 [debug] [MainThread]: Parsing macros/enabled_vars_one_true.sql
[0m15:48:25.571768 [debug] [MainThread]: Parsing macros/first_value.sql
[0m15:48:25.573980 [debug] [MainThread]: Parsing macros/add_pass_through_columns.sql
[0m15:48:25.576194 [debug] [MainThread]: Parsing macros/ceiling.sql
[0m15:48:25.577478 [debug] [MainThread]: Parsing macros/source_relation.sql
[0m15:48:25.580030 [debug] [MainThread]: Parsing macros/max_bool.sql
[0m15:48:25.581687 [debug] [MainThread]: Parsing macros/persist_pass_through_columns.sql
[0m15:48:25.582820 [debug] [MainThread]: Parsing macros/calculated_fields.sql
[0m15:48:25.584136 [debug] [MainThread]: Parsing macros/percentile.sql
[0m15:48:25.587944 [debug] [MainThread]: Parsing macros/remove_prefix_from_columns.sql
[0m15:48:25.589619 [debug] [MainThread]: Parsing macros/union_data.sql
[0m15:48:25.596182 [debug] [MainThread]: Parsing macros/json_parse.sql
[0m15:48:25.602046 [debug] [MainThread]: Parsing macros/empty_variable_warning.sql
[0m15:48:25.603162 [debug] [MainThread]: Parsing macros/pivot_json_extract.sql
[0m15:48:25.604337 [debug] [MainThread]: Parsing macros/snowflake_seed_data.sql
[0m15:48:25.605415 [debug] [MainThread]: Parsing macros/enabled_vars.sql
[0m15:48:25.606530 [debug] [MainThread]: Parsing macros/timestamp_diff.sql
[0m15:48:25.616827 [debug] [MainThread]: Parsing macros/collect_freshness.sql
[0m15:48:25.620629 [debug] [MainThread]: Parsing macros/string_agg.sql
[0m15:48:25.623020 [debug] [MainThread]: Parsing macros/seed_data_helper.sql
[0m15:48:25.624542 [debug] [MainThread]: Parsing macros/array_agg.sql
[0m15:48:25.625873 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m15:48:25.628707 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m15:48:25.630082 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m15:48:25.631703 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m15:48:25.633876 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m15:48:25.635924 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m15:48:25.638807 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m15:48:25.641046 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m15:48:25.642382 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m15:48:25.644366 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m15:48:25.646877 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:48:25.655752 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m15:48:25.657667 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m15:48:25.661217 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m15:48:25.663484 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m15:48:25.664985 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m15:48:25.666678 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m15:48:25.669299 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m15:48:25.671222 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m15:48:25.672299 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m15:48:25.674242 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m15:48:25.676362 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m15:48:25.682423 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m15:48:25.683824 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m15:48:25.685037 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m15:48:25.686402 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m15:48:25.687526 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m15:48:25.689438 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m15:48:25.692379 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m15:48:25.693891 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m15:48:25.695764 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m15:48:25.698043 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m15:48:25.703180 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m15:48:25.704309 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m15:48:25.710185 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m15:48:25.713658 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m15:48:25.716318 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m15:48:25.726099 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m15:48:25.728102 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m15:48:25.731677 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m15:48:25.733321 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m15:48:25.734336 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m15:48:25.744058 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m15:48:25.746840 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m15:48:25.748531 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m15:48:25.749905 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m15:48:25.751343 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m15:48:25.752886 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:48:25.755013 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:48:25.756634 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:48:25.759366 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:48:25.760684 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:48:25.761901 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:48:25.763081 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:48:25.764352 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m15:48:25.792062 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:48:25.798489 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:48:25.806079 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m15:48:25.810909 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:48:25.817621 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:48:25.821634 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:48:25.831818 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m15:48:25.834230 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:48:25.836255 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:48:25.858610 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m15:48:25.870846 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:48:25.878535 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:48:25.886294 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:48:25.889974 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:48:25.892961 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:48:25.903115 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:48:25.908822 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:48:25.914735 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:48:25.917920 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:48:25.924217 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:48:25.927222 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:48:25.940964 [debug] [MainThread]: Parsing macros/get_issue_merged_columns.sql
[0m15:48:25.943344 [debug] [MainThread]: Parsing macros/get_label_columns.sql
[0m15:48:25.945535 [debug] [MainThread]: Parsing macros/get_issue_assignee_columns.sql
[0m15:48:25.946969 [debug] [MainThread]: Parsing macros/get_issue_label_columns.sql
[0m15:48:25.948299 [debug] [MainThread]: Parsing macros/get_issue_comment_columns.sql
[0m15:48:25.950475 [debug] [MainThread]: Parsing macros/get_team_columns.sql
[0m15:48:25.952819 [debug] [MainThread]: Parsing macros/get_issue_closed_history_columns.sql
[0m15:48:25.954820 [debug] [MainThread]: Parsing macros/get_pull_request_review_columns.sql
[0m15:48:25.957150 [debug] [MainThread]: Parsing macros/get_repository_columns.sql
[0m15:48:25.960443 [debug] [MainThread]: Parsing macros/get_user_columns.sql
[0m15:48:25.961992 [debug] [MainThread]: Parsing macros/get_issue_columns.sql
[0m15:48:25.965527 [debug] [MainThread]: Parsing macros/get_pull_request_columns.sql
[0m15:48:25.969118 [debug] [MainThread]: Parsing macros/get_repo_team_columns.sql
[0m15:48:25.971659 [debug] [MainThread]: Parsing macros/get_requested_reviewer_history_columns.sql
[0m15:48:25.973659 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m15:48:25.982872 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m15:48:25.989527 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m15:48:25.993722 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m15:48:26.570843 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m15:48:26.583489 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m15:48:26.586533 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m15:48:26.588975 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m15:48:26.591405 [debug] [MainThread]: 1699: static parser successfully parsed marts/calendar/date_details.sql
[0m15:48:26.593851 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m15:48:26.596418 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/stitch_visitor_events.sql
[0m15:48:26.598938 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m15:48:26.602694 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_new_existing_customers.sql
[0m15:48:26.606468 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m15:48:26.648534 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m15:48:26.650430 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m15:48:26.659650 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m15:48:26.661802 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/customers.sql
[0m15:48:26.666055 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/monthly_users.sql
[0m15:48:26.670029 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_product_category.sql
[0m15:48:26.678909 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/cohorts.sql
[0m15:48:26.683225 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m15:48:26.821892 [debug] [MainThread]: 1603: static parser failed on stg_github__issue.sql
[0m15:48:26.858856 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue.sql
[0m15:48:26.860109 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request.sql
[0m15:48:26.880339 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request.sql
[0m15:48:26.881664 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_assignee.sql
[0m15:48:26.892546 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_assignee.sql
[0m15:48:26.893751 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_closed_history.sql
[0m15:48:26.905875 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_closed_history.sql
[0m15:48:26.907068 [debug] [MainThread]: 1603: static parser failed on stg_github__label.sql
[0m15:48:26.919646 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__label.sql
[0m15:48:26.921321 [debug] [MainThread]: 1603: static parser failed on stg_github__team.sql
[0m15:48:26.935142 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__team.sql
[0m15:48:26.936311 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_comment.sql
[0m15:48:26.950178 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_comment.sql
[0m15:48:26.951367 [debug] [MainThread]: 1603: static parser failed on stg_github__requested_reviewer_history.sql
[0m15:48:26.963641 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__requested_reviewer_history.sql
[0m15:48:26.964807 [debug] [MainThread]: 1603: static parser failed on stg_github__user.sql
[0m15:48:26.977637 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__user.sql
[0m15:48:26.978829 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_merged.sql
[0m15:48:26.990953 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_merged.sql
[0m15:48:26.992118 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_label.sql
[0m15:48:27.001579 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_label.sql
[0m15:48:27.002763 [debug] [MainThread]: 1603: static parser failed on stg_github__repo_team.sql
[0m15:48:27.014476 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repo_team.sql
[0m15:48:27.015684 [debug] [MainThread]: 1603: static parser failed on stg_github__repository.sql
[0m15:48:27.032740 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repository.sql
[0m15:48:27.033913 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request_review.sql
[0m15:48:27.048384 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request_review.sql
[0m15:48:27.049554 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repository_tmp.sql
[0m15:48:27.054384 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repository_tmp.sql
[0m15:48:27.055564 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__user_tmp.sql
[0m15:48:27.061157 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__user_tmp.sql
[0m15:48:27.062317 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__label_tmp.sql
[0m15:48:27.067723 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__label_tmp.sql
[0m15:48:27.068894 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:48:27.073882 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:48:27.075116 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__team_tmp.sql
[0m15:48:27.079993 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__team_tmp.sql
[0m15:48:27.081163 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_assignee_tmp.sql
[0m15:48:27.086156 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_assignee_tmp.sql
[0m15:48:27.087307 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_comment_tmp.sql
[0m15:48:27.092217 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_comment_tmp.sql
[0m15:48:27.093398 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_tmp.sql
[0m15:48:27.099410 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_tmp.sql
[0m15:48:27.100577 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_merged_tmp.sql
[0m15:48:27.106293 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_merged_tmp.sql
[0m15:48:27.107504 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_review_tmp.sql
[0m15:48:27.112336 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_review_tmp.sql
[0m15:48:27.113671 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repo_team_tmp.sql
[0m15:48:27.120153 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repo_team_tmp.sql
[0m15:48:27.121571 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:48:27.126366 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:48:27.127523 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_label_tmp.sql
[0m15:48:27.133260 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_label_tmp.sql
[0m15:48:27.134446 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_tmp.sql
[0m15:48:27.139316 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_tmp.sql
[0m15:48:27.155308 [debug] [MainThread]: 1603: static parser failed on github__quarterly_metrics.sql
[0m15:48:27.162532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__quarterly_metrics.sql
[0m15:48:27.163667 [debug] [MainThread]: 1603: static parser failed on github__weekly_metrics.sql
[0m15:48:27.169336 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__weekly_metrics.sql
[0m15:48:27.170465 [debug] [MainThread]: 1603: static parser failed on github__monthly_metrics.sql
[0m15:48:27.175319 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__monthly_metrics.sql
[0m15:48:27.176535 [debug] [MainThread]: 1603: static parser failed on github__issues.sql
[0m15:48:27.181244 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__issues.sql
[0m15:48:27.182477 [debug] [MainThread]: 1603: static parser failed on github__daily_metrics.sql
[0m15:48:27.190385 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__daily_metrics.sql
[0m15:48:27.191513 [debug] [MainThread]: 1699: static parser successfully parsed github__pull_requests.sql
[0m15:48:27.194110 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_reviewers.sql
[0m15:48:27.202853 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_reviewers.sql
[0m15:48:27.204075 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__repository_teams.sql
[0m15:48:27.212675 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__repository_teams.sql
[0m15:48:27.214006 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_label_joined.sql
[0m15:48:27.219637 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_label_joined.sql
[0m15:48:27.220850 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_assignees.sql
[0m15:48:27.227189 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_assignees.sql
[0m15:48:27.228470 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_joined.sql
[0m15:48:27.242319 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_joined.sql
[0m15:48:27.243480 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_comments.sql
[0m15:48:27.248337 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_comments.sql
[0m15:48:27.249726 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_times.sql
[0m15:48:27.267478 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_times.sql
[0m15:48:27.268738 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_open_length.sql
[0m15:48:27.276865 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_open_length.sql
[0m15:48:27.278097 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_labels.sql
[0m15:48:27.282912 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_labels.sql
[0m15:48:27.693243 [debug] [MainThread]: Test 'test.github_source.not_null_stg_github__repo_team_repository_id.7076be2503' (models/stg_github.yml) depends on a node named 'stg_github__repo_team' which is disabled
[0m15:48:27.693507 [debug] [MainThread]: Test 'test.github_source.not_null_stg_github__repo_team_team_id.000230e64c' (models/stg_github.yml) depends on a node named 'stg_github__repo_team' which is disabled
[0m15:48:27.740320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:48:27.749771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d1a40d0>]}
[0m15:48:27.773812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d0c44f0>]}
[0m15:48:27.774172 [info ] [MainThread]: Found 56 models, 43 tests, 0 snapshots, 0 analyses, 622 macros, 0 operations, 0 seed files, 20 sources, 0 exposures, 0 metrics
[0m15:48:27.774521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d5ec580>]}
[0m15:48:27.779616 [info ] [MainThread]: 
[0m15:48:27.780330 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:48:27.784373 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m15:48:27.784749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:29.000229 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m15:48:29.000838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:29.240744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d03a5b0>]}
[0m15:48:29.241505 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:48:29.241912 [info ] [MainThread]: 
[0m15:48:29.248729 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.customers
[0m15:48:29.249124 [debug] [Thread-2  ]: Began running node model.coffee_shop_zar.date_details
[0m15:48:29.249347 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m15:48:29.251253 [info ] [Thread-3  ]: 3 of 47 START view model dbt_lauren.stg_coffee_shop__order_items ............... [RUN]
[0m15:48:29.249935 [info ] [Thread-1  ]: 1 of 47 START table model dbt_lauren.customers ................................. [RUN]
[0m15:48:29.250130 [debug] [Thread-5  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m15:48:29.250317 [debug] [Thread-6  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__products
[0m15:48:29.252684 [info ] [Thread-6  ]: 6 of 47 START view model dbt_lauren.stg_coffee_shop__products .................. [RUN]
[0m15:48:29.250659 [debug] [Thread-8  ]: Began running node model.coffee_shop_zar.web_sessions
[0m15:48:29.250961 [info ] [Thread-2  ]: 2 of 47 START view model dbt_lauren.date_details ............................... [RUN]
[0m15:48:29.249646 [debug] [Thread-4  ]: Began running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m15:48:29.255530 [info ] [Thread-4  ]: 4 of 47 START view model dbt_lauren.stg_coffee_shop__orders .................... [RUN]
[0m15:48:29.253380 [info ] [Thread-8  ]: 8 of 47 START table model dbt_lauren.web_sessions .............................. [RUN]
[0m15:48:29.250518 [debug] [Thread-7  ]: Began running node model.coffee_shop_zar.stitch_visitor_events
[0m15:48:29.259292 [info ] [Thread-7  ]: 7 of 47 START view model dbt_lauren.stitch_visitor_events ...................... [RUN]
[0m15:48:29.260030 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.coffee_shop_zar.web_sessions"
[0m15:48:29.252065 [info ] [Thread-5  ]: 5 of 47 START view model dbt_lauren.stg_coffee_shop__product_prices ............ [RUN]
[0m15:48:29.256449 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__products"
[0m15:48:29.262767 [debug] [Thread-6  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__products
[0m15:48:29.263028 [debug] [Thread-6  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__products
[0m15:48:29.260245 [debug] [Thread-8  ]: Began compiling node model.coffee_shop_zar.web_sessions
[0m15:48:29.268501 [debug] [Thread-8  ]: Compiling model.coffee_shop_zar.web_sessions
[0m15:48:29.254692 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m15:48:29.261386 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stitch_visitor_events"
[0m15:48:29.261906 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m15:48:29.273816 [debug] [Thread-5  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m15:48:29.273999 [debug] [Thread-5  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m15:48:29.255181 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customers"
[0m15:48:29.278962 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.customers
[0m15:48:29.279151 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.customers
[0m15:48:29.273388 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m15:48:29.273612 [debug] [Thread-7  ]: Began compiling node model.coffee_shop_zar.stitch_visitor_events
[0m15:48:29.258687 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m15:48:29.257884 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop_zar.date_details"
[0m15:48:29.278690 [debug] [Thread-5  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m15:48:29.272782 [debug] [Thread-8  ]: Writing injected SQL for node "model.coffee_shop_zar.web_sessions"
[0m15:48:29.273134 [debug] [Thread-6  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__products"
[0m15:48:29.282719 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.customers"
[0m15:48:29.282983 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__order_items
[0m15:48:29.283203 [debug] [Thread-7  ]: Compiling model.coffee_shop_zar.stitch_visitor_events
[0m15:48:29.283435 [debug] [Thread-4  ]: Began compiling node model.coffee_shop_zar.stg_coffee_shop__orders
[0m15:48:29.283638 [debug] [Thread-2  ]: Began compiling node model.coffee_shop_zar.date_details
[0m15:48:29.284459 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:29.292541 [debug] [Thread-5  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m15:48:29.289140 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m15:48:29.291311 [debug] [Thread-7  ]: Writing injected SQL for node "model.coffee_shop_zar.stitch_visitor_events"
[0m15:48:29.291675 [debug] [Thread-6  ]: finished collecting timing info
[0m15:48:29.291844 [debug] [Thread-4  ]: Compiling model.coffee_shop_zar.stg_coffee_shop__orders
[0m15:48:29.292155 [debug] [Thread-2  ]: Compiling model.coffee_shop_zar.date_details
[0m15:48:29.292317 [debug] [Thread-1  ]: finished collecting timing info
[0m15:48:29.284795 [debug] [Thread-8  ]: finished collecting timing info
[0m15:48:29.337375 [debug] [Thread-8  ]: Began executing node model.coffee_shop_zar.web_sessions
[0m15:48:29.331072 [debug] [Thread-5  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__product_prices"
[0m15:48:29.331429 [debug] [Thread-3  ]: finished collecting timing info
[0m15:48:29.331646 [debug] [Thread-6  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__products
[0m15:48:29.334822 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m15:48:29.336863 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop_zar.date_details"
[0m15:48:29.337134 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.customers
[0m15:48:29.324171 [debug] [Thread-7  ]: finished collecting timing info
[0m15:48:29.350070 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m15:48:29.350607 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m15:48:29.350813 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m15:48:29.363437 [debug] [Thread-5  ]: On model.coffee_shop_zar.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__product_prices"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
  OPTIONS()
  as with 

    product_prices as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`product_prices`
    ),

    renamed as (
        select 
            id,
            product_id,
            price as price_usd,
            created_at as price_started_at,
            ended_at as price_ended_at
        from product_prices
    )

    select *
    from renamed;


[0m15:48:29.354751 [debug] [Thread-4  ]: finished collecting timing info
[0m15:48:29.366353 [debug] [Thread-4  ]: Began executing node model.coffee_shop_zar.stg_coffee_shop__orders
[0m15:48:29.357448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:48:29.357716 [debug] [Thread-7  ]: Began executing node model.coffee_shop_zar.stitch_visitor_events
[0m15:48:29.377204 [debug] [Thread-7  ]: Writing runtime SQL for node "model.coffee_shop_zar.stitch_visitor_events"
[0m15:48:29.354168 [debug] [Thread-6  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__products"
[0m15:48:29.355019 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:29.371111 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__orders"
[0m15:48:29.363063 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.stg_coffee_shop__order_items"
[0m15:48:29.383170 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:48:29.381918 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m15:48:29.383958 [debug] [Thread-6  ]: On model.coffee_shop_zar.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__products"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
  OPTIONS()
  as with 
    products as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`products`
    ),

    renamed as (
        select 
            id,
            name,
            category,
            created_at as product_available_on
        from products

    )

    select *
    from renamed;


[0m15:48:29.381521 [debug] [Thread-2  ]: Began executing node model.coffee_shop_zar.date_details
[0m15:48:29.383543 [debug] [Thread-3  ]: On model.coffee_shop_zar.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__order_items"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
  OPTIONS()
  as with source as (

    select * from `analytics-engineers-club`.`coffee_shop`.`order_items`

),

renamed as (

    select
        id,
        order_id,
        product_id
    from source

)

select * from renamed;


[0m15:48:29.382354 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m15:48:29.395632 [debug] [Thread-7  ]: On model.coffee_shop_zar.stitch_visitor_events: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stitch_visitor_events"} */


  create or replace view `aec-students`.`dbt_lauren`.`stitch_visitor_events`
  OPTIONS()
  as with 
  web_tracking as (
    select *,
      first_value(customer_id ignore nulls) over (partition by visitor_id order by timestamp rows between unbounded preceding and unbounded following) as _customer_id
    from `analytics-engineers-club.web_tracking.pageviews`
  ),

  id_combos as (
    select  
      customer_id,
      string_agg(visitor_id) as stitched_visitor_id
    from web_tracking
    where 
      customer_id is not null
    group by 
      customer_id

  )

 select 
  web_tracking.id,
  web_tracking.device_type,
  web_tracking.timestamp as event_at,
  web_tracking.page,
  web_tracking._customer_id as customer_id,
  ifnull(id_combos.stitched_visitor_id, web_tracking.visitor_id) as stitched_visitor_id
 from web_tracking
 left join id_combos on 
   web_tracking._customer_id = id_combos.customer_id

order by stitched_visitor_id, timestamp;


[0m15:48:29.384360 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:48:29.398317 [debug] [Thread-4  ]: On model.coffee_shop_zar.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.stg_coffee_shop__orders"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    renamed as (

        select 
            id,
            created_at as created_at,
            date(created_at) as created_on,
            extract(year from date(created_at)) as year_of,
            date_trunc(date(created_at), month) as month_of,
            date_trunc(date(created_at), week) as week_of,
            case extract(dayofweek from date(created_at)) 
                when 1 then "Sunday"
                when 2 then "Monday"
                when 3 then "Tuesday"
                when 4 then "Wednesday"
                when 5 then "Thursday"
                when 6 then "Friday"
                when 7 then "Saturday"
            end as day_of_week_name,
            customer_id,
            total as total_amount_usd,
            state,
            address,
            zip
        from orders

    )

    select *
    from renamed;


[0m15:48:29.402378 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop_zar.date_details"
[0m15:48:29.403110 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:48:29.403471 [debug] [Thread-2  ]: On model.coffee_shop_zar.date_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.date_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`date_details`
  OPTIONS()
  as with date_spine AS (
    
    select date_day
    from (
      select generate_date_array("2018-01-01", date_add(current_date, interval 20 year), interval 1 day) as dates
    ), 
    unnest(dates) as date_day

),


calculated as (

    select
      date_day,
      date_day as date_actual,
      format_date('%A', date_day) as day_name,
      extract(month from date_day) as month_actual,
      extract(year from date_day) as year_actual,
      extract(quarter from date_day) as quarter_actual,
      extract(week from date_day) as week_actual,
      date_trunc(date_day, week) as week_start_on,
      date_add(date_trunc(date_day, week), interval 6 day) as week_end_on,
      date_trunc(date_day, month) as first_day_of_month,
      last_day(date_day) as last_day_of_month,
      (extract(year from date_day) || '-Q' || extract(quarter from date_day)) as quarter_name
    from date_spine
)

select *
from calculated;


[0m15:48:30.132207 [debug] [Thread-8  ]: Writing runtime SQL for node "model.coffee_shop_zar.web_sessions"
[0m15:48:30.134294 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.customers"
[0m15:48:30.134885 [debug] [Thread-1  ]: On model.coffee_shop_zar.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customers"} */


  create or replace table `aec-students`.`dbt_lauren`.`customers`
  
  
  OPTIONS()
  as (
    


/*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club`.`coffee_shop`.`customers`
    ),

    orders as (
      select * from `analytics-engineers-club`.`coffee_shop`.`orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as total_orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            ifnull(aggregate_orders.total_orders,0) as total_orders,
            aggregate_orders.first_order_at
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at
  );
  
[0m15:48:30.137845 [debug] [Thread-8  ]: On model.coffee_shop_zar.web_sessions: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.web_sessions"} */


  create or replace table `aec-students`.`dbt_lauren`.`web_sessions`
  
  
  OPTIONS()
  as (
    


with 
  web_tracking as (
    select *,
      first_value(customer_id ignore nulls) over (partition by visitor_id order by timestamp rows between unbounded preceding and unbounded following) as _customer_id
    from `analytics-engineers-club`.`web_tracking`.`pageviews`
  ),

  id_combos as (
    select  
      customer_id,
      to_hex(md5(string_agg(visitor_id order by visitor_id))) as stitched_visitor_id
    from web_tracking
    where 
      customer_id is not null
    group by 
      customer_id

  ),

  stitched as (

    select 
      web_tracking.id,
      web_tracking.device_type,
      web_tracking.timestamp as event_at,
      web_tracking.page,
      web_tracking._customer_id as customer_id,
      ifnull(id_combos.stitched_visitor_id, web_tracking.visitor_id) as stitched_visitor_id
    from web_tracking
    left join id_combos on 
      web_tracking._customer_id = id_combos.customer_id

  ),

  add_previous_next_event as (

    select *,
      lag(event_at) over (partition by stitched_visitor_id order by event_at) as previous_event_at,
      lead(event_at) over (partition by stitched_visitor_id order by event_at) as next_event_at
    from stitched

  ),

  calculate_start_end as (

      select *,
        case 
          when timestamp_diff(event_at, previous_event_at, minute) > 30 or previous_event_at is null then true else false 
        end as is_start,
        case 
          when timestamp_diff(next_event_at, event_at, minute) > 30 or next_event_at is null then true else false 
        end as is_end,
      from add_previous_next_event

  ),

  add_session_id as (

      select *,
        to_hex(md5(
          concat(stitched_visitor_id,
          sum(case when is_start then 1 else 0 end) over (partition by stitched_visitor_id order by event_at rows between unbounded preceding and current row)
          )
        )) as session_id
      from calculate_start_end

  ),



  add_session_start_end as (

  select 
    id,
    session_id,
    min(event_at) over (partition by session_id) as session_start_at,
    max(event_at) over (partition by session_id) as session_end_at,
    event_at,
    customer_id,
    stitched_visitor_id,
    device_type,
    page
  from add_session_id

  )

  select *
  from add_session_start_end
  );
  
[0m15:48:30.616505 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:30.617117 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d1b5940>]}
[0m15:48:30.617595 [info ] [Thread-2  ]: 2 of 47 OK created view model dbt_lauren.date_details .......................... [[32mOK[0m in 1.36s]
[0m15:48:30.618181 [debug] [Thread-2  ]: Finished running node model.coffee_shop_zar.date_details
[0m15:48:30.618746 [debug] [Thread-2  ]: Began running node model.github_source.stg_github__issue_assignee_tmp
[0m15:48:30.619199 [info ] [Thread-2  ]: 9 of 47 START view model dbt_lauren.stg_github__issue_assignee_tmp ............. [RUN]
[0m15:48:30.619863 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_assignee_tmp"
[0m15:48:30.620357 [debug] [Thread-2  ]: Began compiling node model.github_source.stg_github__issue_assignee_tmp
[0m15:48:30.621065 [debug] [Thread-2  ]: Compiling model.github_source.stg_github__issue_assignee_tmp
[0m15:48:30.625826 [debug] [Thread-2  ]: Writing injected SQL for node "model.github_source.stg_github__issue_assignee_tmp"
[0m15:48:30.626542 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:30.626783 [debug] [Thread-2  ]: Began executing node model.github_source.stg_github__issue_assignee_tmp
[0m15:48:30.632360 [debug] [Thread-2  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_assignee_tmp"
[0m15:48:30.633097 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:48:30.633418 [debug] [Thread-2  ]: On model.github_source.stg_github__issue_assignee_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_assignee_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_assignee_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_assignee`;


[0m15:48:30.644050 [debug] [Thread-4  ]: finished collecting timing info
[0m15:48:30.644687 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d1b5d00>]}
[0m15:48:30.645262 [info ] [Thread-4  ]: 4 of 47 OK created view model dbt_lauren.stg_coffee_shop__orders ............... [[32mOK[0m in 1.39s]
[0m15:48:30.646630 [debug] [Thread-4  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__orders
[0m15:48:30.647050 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__issue_closed_history_tmp
[0m15:48:30.648305 [info ] [Thread-4  ]: 10 of 47 START view model dbt_lauren.stg_github__issue_closed_history_tmp ...... [RUN]
[0m15:48:30.649657 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:48:30.650004 [debug] [Thread-4  ]: Began compiling node model.github_source.stg_github__issue_closed_history_tmp
[0m15:48:30.650307 [debug] [Thread-4  ]: Compiling model.github_source.stg_github__issue_closed_history_tmp
[0m15:48:30.657369 [debug] [Thread-4  ]: Writing injected SQL for node "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:48:30.657948 [debug] [Thread-4  ]: finished collecting timing info
[0m15:48:30.658275 [debug] [Thread-4  ]: Began executing node model.github_source.stg_github__issue_closed_history_tmp
[0m15:48:30.664287 [debug] [Thread-4  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:48:30.668173 [debug] [Thread-7  ]: finished collecting timing info
[0m15:48:30.669022 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4cf433a0>]}
[0m15:48:30.669592 [info ] [Thread-7  ]: 7 of 47 OK created view model dbt_lauren.stitch_visitor_events ................. [[32mOK[0m in 1.41s]
[0m15:48:30.670867 [debug] [Thread-7  ]: Finished running node model.coffee_shop_zar.stitch_visitor_events
[0m15:48:30.671287 [debug] [Thread-7  ]: Began running node model.github_source.stg_github__issue_comment_tmp
[0m15:48:30.672524 [info ] [Thread-7  ]: 11 of 47 START view model dbt_lauren.stg_github__issue_comment_tmp ............. [RUN]
[0m15:48:30.673087 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m15:48:30.674060 [debug] [Thread-4  ]: On model.github_source.stg_github__issue_closed_history_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_closed_history_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_closed_history`;


[0m15:48:30.675638 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_comment_tmp"
[0m15:48:30.678869 [debug] [Thread-7  ]: Began compiling node model.github_source.stg_github__issue_comment_tmp
[0m15:48:30.679194 [debug] [Thread-7  ]: Compiling model.github_source.stg_github__issue_comment_tmp
[0m15:48:30.686116 [debug] [Thread-7  ]: Writing injected SQL for node "model.github_source.stg_github__issue_comment_tmp"
[0m15:48:30.686774 [debug] [Thread-7  ]: finished collecting timing info
[0m15:48:30.687107 [debug] [Thread-7  ]: Began executing node model.github_source.stg_github__issue_comment_tmp
[0m15:48:30.693088 [debug] [Thread-7  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_comment_tmp"
[0m15:48:30.698464 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m15:48:30.698710 [debug] [Thread-7  ]: On model.github_source.stg_github__issue_comment_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_comment_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_comment_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_comment`;


[0m15:48:30.712754 [debug] [Thread-6  ]: finished collecting timing info
[0m15:48:30.713810 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4cf435e0>]}
[0m15:48:30.714394 [info ] [Thread-6  ]: 6 of 47 OK created view model dbt_lauren.stg_coffee_shop__products ............. [[32mOK[0m in 1.46s]
[0m15:48:30.715150 [debug] [Thread-6  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__products
[0m15:48:30.716317 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__issue_label_tmp
[0m15:48:30.717178 [info ] [Thread-6  ]: 12 of 47 START view model dbt_lauren.stg_github__issue_label_tmp ............... [RUN]
[0m15:48:30.717874 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_label_tmp"
[0m15:48:30.718166 [debug] [Thread-6  ]: Began compiling node model.github_source.stg_github__issue_label_tmp
[0m15:48:30.719783 [debug] [Thread-6  ]: Compiling model.github_source.stg_github__issue_label_tmp
[0m15:48:30.953379 [debug] [Thread-6  ]: Writing injected SQL for node "model.github_source.stg_github__issue_label_tmp"
[0m15:48:30.957377 [debug] [Thread-6  ]: finished collecting timing info
[0m15:48:30.957779 [debug] [Thread-6  ]: Began executing node model.github_source.stg_github__issue_label_tmp
[0m15:48:30.963804 [debug] [Thread-6  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_label_tmp"
[0m15:48:30.971697 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m15:48:30.972109 [debug] [Thread-6  ]: On model.github_source.stg_github__issue_label_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_label_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_label_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_label`;


[0m15:48:31.060573 [debug] [Thread-3  ]: finished collecting timing info
[0m15:48:31.061389 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d1b5b20>]}
[0m15:48:31.062012 [info ] [Thread-3  ]: 3 of 47 OK created view model dbt_lauren.stg_coffee_shop__order_items .......... [[32mOK[0m in 1.81s]
[0m15:48:31.062764 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__order_items
[0m15:48:31.063143 [debug] [Thread-3  ]: Began running node model.github_source.stg_github__issue_merged_tmp
[0m15:48:31.063730 [info ] [Thread-3  ]: 13 of 47 START view model dbt_lauren.stg_github__issue_merged_tmp .............. [RUN]
[0m15:48:31.064707 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_merged_tmp"
[0m15:48:31.065035 [debug] [Thread-3  ]: Began compiling node model.github_source.stg_github__issue_merged_tmp
[0m15:48:31.065355 [debug] [Thread-3  ]: Compiling model.github_source.stg_github__issue_merged_tmp
[0m15:48:31.072257 [debug] [Thread-3  ]: Writing injected SQL for node "model.github_source.stg_github__issue_merged_tmp"
[0m15:48:31.075981 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:31.076643 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d1b5fa0>]}
[0m15:48:31.077217 [info ] [Thread-5  ]: 5 of 47 OK created view model dbt_lauren.stg_coffee_shop__product_prices ....... [[32mOK[0m in 1.81s]
[0m15:48:31.078584 [debug] [Thread-5  ]: Finished running node model.coffee_shop_zar.stg_coffee_shop__product_prices
[0m15:48:31.078985 [debug] [Thread-5  ]: Began running node model.github_source.stg_github__issue_tmp
[0m15:48:31.080459 [info ] [Thread-5  ]: 14 of 47 START view model dbt_lauren.stg_github__issue_tmp ..................... [RUN]
[0m15:48:31.080944 [debug] [Thread-3  ]: finished collecting timing info
[0m15:48:31.081853 [debug] [Thread-3  ]: Began executing node model.github_source.stg_github__issue_merged_tmp
[0m15:48:31.083774 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_tmp"
[0m15:48:31.089733 [debug] [Thread-5  ]: Began compiling node model.github_source.stg_github__issue_tmp
[0m15:48:31.090033 [debug] [Thread-5  ]: Compiling model.github_source.stg_github__issue_tmp
[0m15:48:31.096150 [debug] [Thread-5  ]: Writing injected SQL for node "model.github_source.stg_github__issue_tmp"
[0m15:48:31.097062 [debug] [Thread-3  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_merged_tmp"
[0m15:48:31.097813 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:48:31.098199 [debug] [Thread-3  ]: On model.github_source.stg_github__issue_merged_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_merged_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_merged_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_merged`;


[0m15:48:31.101383 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:31.101738 [debug] [Thread-5  ]: Began executing node model.github_source.stg_github__issue_tmp
[0m15:48:31.116429 [debug] [Thread-5  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_tmp"
[0m15:48:31.117120 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m15:48:31.117581 [debug] [Thread-5  ]: On model.github_source.stg_github__issue_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue`;


[0m15:48:31.143513 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_assignee_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_assignee_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_assignee`;


[0m15:48:31.143807 [debug] [Thread-2  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: f96d07f3-8099-4be6-9ee8-a24afa19587b

[0m15:48:31.144159 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:31.144514 [debug] [Thread-2  ]: Runtime Error in model stg_github__issue_assignee_tmp (models/tmp/stg_github__issue_assignee_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: f96d07f3-8099-4be6-9ee8-a24afa19587b
  
[0m15:48:31.144814 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4cd59c40>]}
[0m15:48:31.145170 [error] [Thread-2  ]: 9 of 47 ERROR creating view model dbt_lauren.stg_github__issue_assignee_tmp .... [[31mERROR[0m in 0.53s]
[0m15:48:31.152607 [debug] [Thread-2  ]: Finished running node model.github_source.stg_github__issue_assignee_tmp
[0m15:48:31.154099 [debug] [Thread-2  ]: Began running node model.github_source.stg_github__label_tmp
[0m15:48:31.154907 [info ] [Thread-2  ]: 15 of 47 START view model dbt_lauren.stg_github__label_tmp ..................... [RUN]
[0m15:48:31.159549 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github_source.stg_github__label_tmp"
[0m15:48:31.159859 [debug] [Thread-2  ]: Began compiling node model.github_source.stg_github__label_tmp
[0m15:48:31.160124 [debug] [Thread-2  ]: Compiling model.github_source.stg_github__label_tmp
[0m15:48:31.190977 [debug] [Thread-2  ]: Writing injected SQL for node "model.github_source.stg_github__label_tmp"
[0m15:48:31.191515 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:31.191869 [debug] [Thread-2  ]: Began executing node model.github_source.stg_github__label_tmp
[0m15:48:31.229615 [debug] [Thread-4  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_closed_history_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_closed_history`;


[0m15:48:31.230012 [debug] [Thread-4  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: 98d71e24-dd47-4c77-aacc-0565228a6bae

[0m15:48:31.230608 [debug] [Thread-4  ]: finished collecting timing info
[0m15:48:31.231237 [debug] [Thread-4  ]: Runtime Error in model stg_github__issue_closed_history_tmp (models/tmp/stg_github__issue_closed_history_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: 98d71e24-dd47-4c77-aacc-0565228a6bae
  
[0m15:48:31.231716 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4cd13b50>]}
[0m15:48:31.232307 [error] [Thread-4  ]: 10 of 47 ERROR creating view model dbt_lauren.stg_github__issue_closed_history_tmp  [[31mERROR[0m in 0.58s]
[0m15:48:31.233016 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__issue_closed_history_tmp
[0m15:48:31.233714 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__pull_request_review_tmp
[0m15:48:31.235852 [info ] [Thread-4  ]: 16 of 47 START view model dbt_lauren.stg_github__pull_request_review_tmp ....... [RUN]
[0m15:48:31.237410 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.github_source.stg_github__pull_request_review_tmp"
[0m15:48:31.242490 [debug] [Thread-4  ]: Began compiling node model.github_source.stg_github__pull_request_review_tmp
[0m15:48:31.242872 [debug] [Thread-4  ]: Compiling model.github_source.stg_github__pull_request_review_tmp
[0m15:48:31.241812 [debug] [Thread-2  ]: Writing runtime SQL for node "model.github_source.stg_github__label_tmp"
[0m15:48:31.251356 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:48:31.251771 [debug] [Thread-2  ]: On model.github_source.stg_github__label_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__label_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__label_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`label`;


[0m15:48:31.260417 [debug] [Thread-4  ]: Writing injected SQL for node "model.github_source.stg_github__pull_request_review_tmp"
[0m15:48:31.268090 [debug] [Thread-7  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_comment_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_comment_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_comment`;


[0m15:48:31.268663 [debug] [Thread-7  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: 319672b1-787e-43ba-a382-f4adccb8bdad

[0m15:48:31.269209 [debug] [Thread-7  ]: finished collecting timing info
[0m15:48:31.269841 [debug] [Thread-7  ]: Runtime Error in model stg_github__issue_comment_tmp (models/tmp/stg_github__issue_comment_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: 319672b1-787e-43ba-a382-f4adccb8bdad
  
[0m15:48:31.270323 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4c494d90>]}
[0m15:48:31.270882 [error] [Thread-7  ]: 11 of 47 ERROR creating view model dbt_lauren.stg_github__issue_comment_tmp .... [[31mERROR[0m in 0.59s]
[0m15:48:31.271596 [debug] [Thread-7  ]: Finished running node model.github_source.stg_github__issue_comment_tmp
[0m15:48:31.275593 [debug] [Thread-7  ]: Began running node model.github_source.stg_github__pull_request_tmp
[0m15:48:31.276553 [info ] [Thread-7  ]: 17 of 47 START view model dbt_lauren.stg_github__pull_request_tmp .............. [RUN]
[0m15:48:31.277852 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.github_source.stg_github__pull_request_tmp"
[0m15:48:31.278191 [debug] [Thread-7  ]: Began compiling node model.github_source.stg_github__pull_request_tmp
[0m15:48:31.278680 [debug] [Thread-4  ]: finished collecting timing info
[0m15:48:31.279013 [debug] [Thread-7  ]: Compiling model.github_source.stg_github__pull_request_tmp
[0m15:48:31.279439 [debug] [Thread-4  ]: Began executing node model.github_source.stg_github__pull_request_review_tmp
[0m15:48:31.298059 [debug] [Thread-7  ]: Writing injected SQL for node "model.github_source.stg_github__pull_request_tmp"
[0m15:48:31.301178 [debug] [Thread-7  ]: finished collecting timing info
[0m15:48:31.307370 [debug] [Thread-7  ]: Began executing node model.github_source.stg_github__pull_request_tmp
[0m15:48:31.300625 [debug] [Thread-4  ]: Writing runtime SQL for node "model.github_source.stg_github__pull_request_review_tmp"
[0m15:48:31.315091 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m15:48:31.316455 [debug] [Thread-4  ]: On model.github_source.stg_github__pull_request_review_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_review_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__pull_request_review_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`pull_request_review`;


[0m15:48:31.322426 [debug] [Thread-7  ]: Writing runtime SQL for node "model.github_source.stg_github__pull_request_tmp"
[0m15:48:31.323089 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m15:48:31.323468 [debug] [Thread-7  ]: On model.github_source.stg_github__pull_request_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__pull_request_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`pull_request`;


[0m15:48:31.503803 [debug] [Thread-6  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_label_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_label_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_label`;


[0m15:48:31.504088 [debug] [Thread-6  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: cdba0d0e-4148-4ea5-86dd-8f906888aec8

[0m15:48:31.504425 [debug] [Thread-6  ]: finished collecting timing info
[0m15:48:31.504838 [debug] [Thread-6  ]: Runtime Error in model stg_github__issue_label_tmp (models/tmp/stg_github__issue_label_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: cdba0d0e-4148-4ea5-86dd-8f906888aec8
  
[0m15:48:31.505141 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d21e670>]}
[0m15:48:31.505655 [error] [Thread-6  ]: 12 of 47 ERROR creating view model dbt_lauren.stg_github__issue_label_tmp ...... [[31mERROR[0m in 0.79s]
[0m15:48:31.507450 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__issue_label_tmp
[0m15:48:31.507853 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__repository_tmp
[0m15:48:31.511332 [info ] [Thread-6  ]: 18 of 47 START view model dbt_lauren.stg_github__repository_tmp ................ [RUN]
[0m15:48:31.514552 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.github_source.stg_github__repository_tmp"
[0m15:48:31.515739 [debug] [Thread-6  ]: Began compiling node model.github_source.stg_github__repository_tmp
[0m15:48:31.516051 [debug] [Thread-6  ]: Compiling model.github_source.stg_github__repository_tmp
[0m15:48:31.526534 [debug] [Thread-6  ]: Writing injected SQL for node "model.github_source.stg_github__repository_tmp"
[0m15:48:31.527061 [debug] [Thread-6  ]: finished collecting timing info
[0m15:48:31.528086 [debug] [Thread-6  ]: Began executing node model.github_source.stg_github__repository_tmp
[0m15:48:31.536720 [debug] [Thread-6  ]: Writing runtime SQL for node "model.github_source.stg_github__repository_tmp"
[0m15:48:31.537127 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m15:48:31.537402 [debug] [Thread-6  ]: On model.github_source.stg_github__repository_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__repository_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__repository_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`repository`;


[0m15:48:31.867036 [debug] [Thread-5  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue`;


[0m15:48:31.867380 [debug] [Thread-5  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: 502c2fd8-b924-48f4-ad66-24ad613b76be

[0m15:48:31.867752 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:31.868150 [debug] [Thread-5  ]: Runtime Error in model stg_github__issue_tmp (models/tmp/stg_github__issue_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: 502c2fd8-b924-48f4-ad66-24ad613b76be
  
[0m15:48:31.868453 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d759700>]}
[0m15:48:31.868842 [error] [Thread-5  ]: 14 of 47 ERROR creating view model dbt_lauren.stg_github__issue_tmp ............ [[31mERROR[0m in 0.79s]
[0m15:48:31.869369 [debug] [Thread-5  ]: Finished running node model.github_source.stg_github__issue_tmp
[0m15:48:31.869830 [debug] [Thread-5  ]: Began running node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:48:31.870431 [info ] [Thread-5  ]: 19 of 47 START view model dbt_lauren.stg_github__requested_reviewer_history_tmp  [RUN]
[0m15:48:31.871402 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:48:31.871771 [debug] [Thread-5  ]: Began compiling node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:48:31.872008 [debug] [Thread-5  ]: Compiling model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:48:31.881186 [debug] [Thread-5  ]: Writing injected SQL for node "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:48:31.881687 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:31.881917 [debug] [Thread-5  ]: Began executing node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:48:31.885445 [debug] [Thread-5  ]: Writing runtime SQL for node "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:48:31.885922 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m15:48:31.886183 [debug] [Thread-5  ]: On model.github_source.stg_github__requested_reviewer_history_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__requested_reviewer_history_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`requested_reviewer_history`;


[0m15:48:31.898983 [debug] [Thread-3  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_merged_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_merged_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`issue_merged`;


[0m15:48:31.899320 [debug] [Thread-3  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: 11aa313c-81ee-4eff-81b5-04f381a1ac74

[0m15:48:31.899868 [debug] [Thread-3  ]: finished collecting timing info
[0m15:48:31.900416 [debug] [Thread-3  ]: Runtime Error in model stg_github__issue_merged_tmp (models/tmp/stg_github__issue_merged_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: 11aa313c-81ee-4eff-81b5-04f381a1ac74
  
[0m15:48:31.900866 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d0b1070>]}
[0m15:48:31.901452 [error] [Thread-3  ]: 13 of 47 ERROR creating view model dbt_lauren.stg_github__issue_merged_tmp ..... [[31mERROR[0m in 0.84s]
[0m15:48:31.902707 [debug] [Thread-3  ]: Finished running node model.github_source.stg_github__issue_merged_tmp
[0m15:48:31.903106 [debug] [Thread-3  ]: Began running node model.github_source.stg_github__team_tmp
[0m15:48:31.904536 [info ] [Thread-3  ]: 20 of 47 START view model dbt_lauren.stg_github__team_tmp ...................... [RUN]
[0m15:48:31.905847 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github_source.stg_github__team_tmp"
[0m15:48:31.906191 [debug] [Thread-3  ]: Began compiling node model.github_source.stg_github__team_tmp
[0m15:48:31.906517 [debug] [Thread-3  ]: Compiling model.github_source.stg_github__team_tmp
[0m15:48:31.913437 [debug] [Thread-3  ]: Writing injected SQL for node "model.github_source.stg_github__team_tmp"
[0m15:48:31.914011 [debug] [Thread-3  ]: finished collecting timing info
[0m15:48:31.914373 [debug] [Thread-3  ]: Began executing node model.github_source.stg_github__team_tmp
[0m15:48:31.921962 [debug] [Thread-3  ]: Writing runtime SQL for node "model.github_source.stg_github__team_tmp"
[0m15:48:31.922569 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:48:31.922948 [debug] [Thread-3  ]: On model.github_source.stg_github__team_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__team_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__team_tmp`
  OPTIONS()
  as select * 
from `aec-students`.`analytics-engineers-club`.`team`;


[0m15:48:31.970244 [debug] [Thread-4  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_review_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__pull_request_review_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`pull_request_review`;


[0m15:48:31.970565 [debug] [Thread-4  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: 3a5d5336-dfe8-4ada-b9cb-b8243c09892d

[0m15:48:31.971041 [debug] [Thread-4  ]: finished collecting timing info
[0m15:48:31.971679 [debug] [Thread-4  ]: Runtime Error in model stg_github__pull_request_review_tmp (models/tmp/stg_github__pull_request_review_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: 3a5d5336-dfe8-4ada-b9cb-b8243c09892d
  
[0m15:48:31.973352 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4cf02ac0>]}
[0m15:48:31.972906 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__label_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__label_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`label`;


[0m15:48:31.973768 [debug] [Thread-2  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: 7196e03b-1df5-4699-bdc7-b694866a37ec

[0m15:48:31.974257 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:31.974785 [debug] [Thread-2  ]: Runtime Error in model stg_github__label_tmp (models/tmp/stg_github__label_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: 7196e03b-1df5-4699-bdc7-b694866a37ec
  
[0m15:48:31.975199 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d0eb9d0>]}
[0m15:48:31.975707 [error] [Thread-2  ]: 15 of 47 ERROR creating view model dbt_lauren.stg_github__label_tmp ............ [[31mERROR[0m in 0.82s]
[0m15:48:31.977383 [debug] [Thread-2  ]: Finished running node model.github_source.stg_github__label_tmp
[0m15:48:31.976199 [error] [Thread-4  ]: 16 of 47 ERROR creating view model dbt_lauren.stg_github__pull_request_review_tmp  [[31mERROR[0m in 0.74s]
[0m15:48:31.977791 [debug] [Thread-2  ]: Began running node model.github_source.stg_github__user_tmp
[0m15:48:31.981606 [info ] [Thread-2  ]: 21 of 47 START view model dbt_lauren.stg_github__user_tmp ...................... [RUN]
[0m15:48:31.981032 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__pull_request_review_tmp
[0m15:48:31.982786 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__issue_assignee
[0m15:48:31.983412 [info ] [Thread-4  ]: 22 of 47 SKIP relation dbt_lauren.stg_github__issue_assignee ................... [[33mSKIP[0m]
[0m15:48:31.985043 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github_source.stg_github__user_tmp"
[0m15:48:31.988365 [debug] [Thread-2  ]: Began compiling node model.github_source.stg_github__user_tmp
[0m15:48:31.989354 [debug] [Thread-2  ]: Compiling model.github_source.stg_github__user_tmp
[0m15:48:31.987851 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__issue_assignee
[0m15:48:31.994980 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__issue_closed_history
[0m15:48:31.995418 [info ] [Thread-4  ]: 23 of 47 SKIP relation dbt_lauren.stg_github__issue_closed_history ............. [[33mSKIP[0m]
[0m15:48:31.996057 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__issue_closed_history
[0m15:48:31.996402 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__issue_comment
[0m15:48:31.996819 [info ] [Thread-4  ]: 24 of 47 SKIP relation dbt_lauren.stg_github__issue_comment .................... [[33mSKIP[0m]
[0m15:48:31.997632 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__issue_comment
[0m15:48:31.999019 [debug] [Thread-6  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__repository_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__repository_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`repository`;


[0m15:48:32.004846 [debug] [Thread-6  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: b2b1e055-271b-418f-9f4c-0a597e51a193

[0m15:48:32.005386 [debug] [Thread-6  ]: finished collecting timing info
[0m15:48:32.005916 [debug] [Thread-6  ]: Runtime Error in model stg_github__repository_tmp (models/tmp/stg_github__repository_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: b2b1e055-271b-418f-9f4c-0a597e51a193
  
[0m15:48:32.006323 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4c4687f0>]}
[0m15:48:32.007256 [error] [Thread-6  ]: 18 of 47 ERROR creating view model dbt_lauren.stg_github__repository_tmp ....... [[31mERROR[0m in 0.49s]
[0m15:48:32.007897 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__repository_tmp
[0m15:48:32.008228 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__issue
[0m15:48:32.008527 [info ] [Thread-6  ]: 26 of 47 SKIP relation dbt_lauren.stg_github__issue ............................ [[33mSKIP[0m]
[0m15:48:31.999654 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__issue_label
[0m15:48:32.011755 [info ] [Thread-4  ]: 25 of 47 SKIP relation dbt_lauren.stg_github__issue_label ...................... [[33mSKIP[0m]
[0m15:48:32.012647 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__issue_label
[0m15:48:32.013008 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__issue_merged
[0m15:48:32.013325 [info ] [Thread-4  ]: 27 of 47 SKIP relation dbt_lauren.stg_github__issue_merged ..................... [[33mSKIP[0m]
[0m15:48:32.013979 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__issue_merged
[0m15:48:32.014780 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__label
[0m15:48:32.015153 [info ] [Thread-4  ]: 28 of 47 SKIP relation dbt_lauren.stg_github__label ............................ [[33mSKIP[0m]
[0m15:48:32.021669 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__label
[0m15:48:32.002689 [debug] [Thread-2  ]: Writing injected SQL for node "model.github_source.stg_github__user_tmp"
[0m15:48:32.009174 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__issue
[0m15:48:32.024713 [debug] [Thread-6  ]: Began running node model.github.int_github__issue_comments
[0m15:48:32.025323 [debug] [Thread-6  ]: Finished running node model.github.int_github__issue_comments
[0m15:48:32.024377 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:32.026126 [debug] [Thread-2  ]: Began executing node model.github_source.stg_github__user_tmp
[0m15:48:32.022722 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__pull_request_review
[0m15:48:32.032254 [info ] [Thread-4  ]: 29 of 47 SKIP relation dbt_lauren.stg_github__pull_request_review .............. [[33mSKIP[0m]
[0m15:48:32.025723 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__repository
[0m15:48:32.033301 [info ] [Thread-6  ]: 30 of 47 SKIP relation dbt_lauren.stg_github__repository ....................... [[33mSKIP[0m]
[0m15:48:32.034046 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__pull_request_review
[0m15:48:32.036362 [debug] [Thread-4  ]: Began running node model.github.int_github__issue_label_joined
[0m15:48:32.036869 [debug] [Thread-4  ]: Finished running node model.github.int_github__issue_label_joined
[0m15:48:32.036067 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__repository
[0m15:48:32.038589 [debug] [Thread-6  ]: Began running node model.github.int_github__issue_labels
[0m15:48:32.039171 [debug] [Thread-6  ]: Finished running node model.github.int_github__issue_labels
[0m15:48:32.038006 [debug] [Thread-4  ]: Began running node model.github.int_github__issue_open_length
[0m15:48:32.039790 [debug] [Thread-4  ]: Finished running node model.github.int_github__issue_open_length
[0m15:48:32.042902 [debug] [Thread-2  ]: Writing runtime SQL for node "model.github_source.stg_github__user_tmp"
[0m15:48:32.043501 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:48:32.043894 [debug] [Thread-2  ]: On model.github_source.stg_github__user_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__user_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__user_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`user`;


[0m15:48:32.057658 [debug] [Thread-7  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__pull_request_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`pull_request`;


[0m15:48:32.057985 [debug] [Thread-7  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: 73c14223-45b8-466c-8685-879251f8d92b

[0m15:48:32.058511 [debug] [Thread-7  ]: finished collecting timing info
[0m15:48:32.059065 [debug] [Thread-7  ]: Runtime Error in model stg_github__pull_request_tmp (models/tmp/stg_github__pull_request_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: 73c14223-45b8-466c-8685-879251f8d92b
  
[0m15:48:32.059764 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d12ea00>]}
[0m15:48:32.060320 [error] [Thread-7  ]: 17 of 47 ERROR creating view model dbt_lauren.stg_github__pull_request_tmp ..... [[31mERROR[0m in 0.78s]
[0m15:48:32.063425 [debug] [Thread-7  ]: Finished running node model.github_source.stg_github__pull_request_tmp
[0m15:48:32.064089 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__pull_request
[0m15:48:32.064829 [info ] [Thread-6  ]: 31 of 47 SKIP relation dbt_lauren.stg_github__pull_request ..................... [[33mSKIP[0m]
[0m15:48:32.068099 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__pull_request
[0m15:48:32.320028 [debug] [Thread-5  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__requested_reviewer_history_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`requested_reviewer_history`;


[0m15:48:32.320310 [debug] [Thread-5  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: b3752cb1-1905-4800-ab54-4428217d5d9a

[0m15:48:32.320747 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:32.321230 [debug] [Thread-5  ]: Runtime Error in model stg_github__requested_reviewer_history_tmp (models/tmp/stg_github__requested_reviewer_history_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: b3752cb1-1905-4800-ab54-4428217d5d9a
  
[0m15:48:32.321729 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4ce6ebb0>]}
[0m15:48:32.322320 [error] [Thread-5  ]: 19 of 47 ERROR creating view model dbt_lauren.stg_github__requested_reviewer_history_tmp  [[31mERROR[0m in 0.45s]
[0m15:48:32.322896 [debug] [Thread-5  ]: Finished running node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:48:32.323585 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__requested_reviewer_history
[0m15:48:32.323911 [info ] [Thread-4  ]: 32 of 47 SKIP relation dbt_lauren.stg_github__requested_reviewer_history ....... [[33mSKIP[0m]
[0m15:48:32.324573 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__requested_reviewer_history
[0m15:48:32.325119 [debug] [Thread-7  ]: Began running node model.github.int_github__pull_request_times
[0m15:48:32.325554 [debug] [Thread-7  ]: Finished running node model.github.int_github__pull_request_times
[0m15:48:32.379245 [debug] [Thread-3  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__team_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__team_tmp`
  OPTIONS()
  as select * 
from `aec-students`.`analytics-engineers-club`.`team`;


[0m15:48:32.379457 [debug] [Thread-3  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: d4f99981-03e8-407e-ab3d-bb7d9d700a0e

[0m15:48:32.379907 [debug] [Thread-3  ]: finished collecting timing info
[0m15:48:32.380312 [debug] [Thread-3  ]: Runtime Error in model stg_github__team_tmp (models/tmp/stg_github__team_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: d4f99981-03e8-407e-ab3d-bb7d9d700a0e
  
[0m15:48:32.380611 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4c436d30>]}
[0m15:48:32.380986 [error] [Thread-3  ]: 20 of 47 ERROR creating view model dbt_lauren.stg_github__team_tmp ............. [[31mERROR[0m in 0.47s]
[0m15:48:32.381488 [debug] [Thread-3  ]: Finished running node model.github_source.stg_github__team_tmp
[0m15:48:32.382053 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__team
[0m15:48:32.382274 [info ] [Thread-6  ]: 33 of 47 SKIP relation dbt_lauren.stg_github__team ............................. [[33mSKIP[0m]
[0m15:48:32.382725 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__team
[0m15:48:32.445616 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__user_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__user_tmp`
  OPTIONS()
  as select *
from `aec-students`.`analytics-engineers-club`.`user`;


[0m15:48:32.445827 [debug] [Thread-2  ]: BigQuery adapter: 404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US

Location: US
Job ID: 60659055-6c82-48a7-b100-05d128ddb1df

[0m15:48:32.446205 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:32.446594 [debug] [Thread-2  ]: Runtime Error in model stg_github__user_tmp (models/tmp/stg_github__user_tmp.sql)
  404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
  
  Location: US
  Job ID: 60659055-6c82-48a7-b100-05d128ddb1df
  
[0m15:48:32.446883 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4ce7b2e0>]}
[0m15:48:32.447252 [error] [Thread-2  ]: 21 of 47 ERROR creating view model dbt_lauren.stg_github__user_tmp ............. [[31mERROR[0m in 0.46s]
[0m15:48:32.447717 [debug] [Thread-2  ]: Finished running node model.github_source.stg_github__user_tmp
[0m15:48:32.448310 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__user
[0m15:48:32.448533 [info ] [Thread-4  ]: 34 of 47 SKIP relation dbt_lauren.stg_github__user ............................. [[33mSKIP[0m]
[0m15:48:32.449005 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__user
[0m15:48:32.449639 [debug] [Thread-3  ]: Began running node model.github.int_github__issue_assignees
[0m15:48:32.450155 [debug] [Thread-3  ]: Finished running node model.github.int_github__issue_assignees
[0m15:48:32.450506 [debug] [Thread-7  ]: Began running node model.github.int_github__pull_request_reviewers
[0m15:48:32.451407 [debug] [Thread-7  ]: Finished running node model.github.int_github__pull_request_reviewers
[0m15:48:32.451842 [debug] [Thread-2  ]: Began running node model.github.int_github__issue_joined
[0m15:48:32.452438 [debug] [Thread-2  ]: Finished running node model.github.int_github__issue_joined
[0m15:48:32.453063 [debug] [Thread-4  ]: Began running node model.github.github__issues
[0m15:48:32.453370 [info ] [Thread-4  ]: 35 of 47 SKIP relation dbt_lauren.github__issues ............................... [[33mSKIP[0m]
[0m15:48:32.455523 [debug] [Thread-4  ]: Finished running node model.github.github__issues
[0m15:48:32.455746 [debug] [Thread-6  ]: Began running node model.github.github__pull_requests
[0m15:48:32.456172 [info ] [Thread-6  ]: 36 of 47 SKIP relation dbt_lauren.github__pull_requests ........................ [[33mSKIP[0m]
[0m15:48:32.456757 [debug] [Thread-6  ]: Finished running node model.github.github__pull_requests
[0m15:48:32.457231 [debug] [Thread-7  ]: Began running node model.github.github__daily_metrics
[0m15:48:32.457482 [info ] [Thread-7  ]: 37 of 47 SKIP relation dbt_lauren.github__daily_metrics ........................ [[33mSKIP[0m]
[0m15:48:32.457938 [debug] [Thread-7  ]: Finished running node model.github.github__daily_metrics
[0m15:48:32.458718 [debug] [Thread-3  ]: Began running node model.github.github__monthly_metrics
[0m15:48:32.459019 [debug] [Thread-2  ]: Began running node model.github.github__quarterly_metrics
[0m15:48:32.459742 [info ] [Thread-2  ]: 39 of 47 SKIP relation dbt_lauren.github__quarterly_metrics .................... [[33mSKIP[0m]
[0m15:48:32.459275 [debug] [Thread-4  ]: Began running node model.github.github__weekly_metrics
[0m15:48:32.460309 [info ] [Thread-4  ]: 40 of 47 SKIP relation dbt_lauren.github__weekly_metrics ....................... [[33mSKIP[0m]
[0m15:48:32.459513 [info ] [Thread-3  ]: 38 of 47 SKIP relation dbt_lauren.github__monthly_metrics ...................... [[33mSKIP[0m]
[0m15:48:32.461370 [debug] [Thread-2  ]: Finished running node model.github.github__quarterly_metrics
[0m15:48:32.461742 [debug] [Thread-4  ]: Finished running node model.github.github__weekly_metrics
[0m15:48:32.463825 [debug] [Thread-3  ]: Finished running node model.github.github__monthly_metrics
[0m15:48:36.031335 [debug] [Thread-1  ]: finished collecting timing info
[0m15:48:36.031919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4ce27040>]}
[0m15:48:36.032364 [info ] [Thread-1  ]: 1 of 47 OK created table model dbt_lauren.customers ............................ [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 6.78s]
[0m15:48:36.032922 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.customers
[0m15:48:36.033704 [debug] [Thread-5  ]: Began running node model.coffee_shop_zar.monthly_users
[0m15:48:36.034005 [info ] [Thread-5  ]: 41 of 47 START view model dbt_lauren.monthly_users ............................. [RUN]
[0m15:48:36.034974 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.coffee_shop_zar.monthly_users"
[0m15:48:36.035320 [debug] [Thread-5  ]: Began compiling node model.coffee_shop_zar.monthly_users
[0m15:48:36.035609 [debug] [Thread-5  ]: Compiling model.coffee_shop_zar.monthly_users
[0m15:48:36.039713 [debug] [Thread-5  ]: Writing injected SQL for node "model.coffee_shop_zar.monthly_users"
[0m15:48:36.040223 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:36.040457 [debug] [Thread-5  ]: Began executing node model.coffee_shop_zar.monthly_users
[0m15:48:36.044095 [debug] [Thread-5  ]: Writing runtime SQL for node "model.coffee_shop_zar.monthly_users"
[0m15:48:36.044577 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m15:48:36.044850 [debug] [Thread-5  ]: On model.coffee_shop_zar.monthly_users: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.monthly_users"} */


  create or replace view `aec-students`.`dbt_lauren`.`monthly_users`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
from `aec-students`.`dbt_lauren`.`customers`
group by 
    signup_month;


[0m15:48:37.060516 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:37.061141 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d1b55b0>]}
[0m15:48:37.061616 [info ] [Thread-5  ]: 41 of 47 OK created view model dbt_lauren.monthly_users ........................ [[32mOK[0m in 1.03s]
[0m15:48:37.062596 [debug] [Thread-5  ]: Finished running node model.coffee_shop_zar.monthly_users
[0m15:48:46.710882 [debug] [Thread-8  ]: finished collecting timing info
[0m15:48:46.711491 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4cf418e0>]}
[0m15:48:46.711954 [info ] [Thread-8  ]: 8 of 47 OK created table model dbt_lauren.web_sessions ......................... [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 17.45s]
[0m15:48:46.713129 [debug] [Thread-8  ]: Finished running node model.coffee_shop_zar.web_sessions
[0m15:48:46.714059 [debug] [Thread-6  ]: Began running node model.coffee_shop_zar.order_details
[0m15:48:46.714699 [info ] [Thread-6  ]: 42 of 47 START view model dbt_lauren.order_details ............................. [RUN]
[0m15:48:46.714262 [debug] [Thread-2  ]: Began running node model.coffee_shop_zar.web_session_metrics
[0m15:48:46.715564 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.coffee_shop_zar.order_details"
[0m15:48:46.716188 [debug] [Thread-6  ]: Began compiling node model.coffee_shop_zar.order_details
[0m15:48:46.716390 [debug] [Thread-6  ]: Compiling model.coffee_shop_zar.order_details
[0m15:48:46.715932 [info ] [Thread-2  ]: 43 of 47 START view model dbt_lauren.web_session_metrics ....................... [RUN]
[0m15:48:46.722141 [debug] [Thread-6  ]: Writing injected SQL for node "model.coffee_shop_zar.order_details"
[0m15:48:46.722781 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop_zar.web_session_metrics"
[0m15:48:46.723432 [debug] [Thread-2  ]: Began compiling node model.coffee_shop_zar.web_session_metrics
[0m15:48:46.723771 [debug] [Thread-6  ]: finished collecting timing info
[0m15:48:46.723938 [debug] [Thread-2  ]: Compiling model.coffee_shop_zar.web_session_metrics
[0m15:48:46.724167 [debug] [Thread-6  ]: Began executing node model.coffee_shop_zar.order_details
[0m15:48:46.728928 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop_zar.web_session_metrics"
[0m15:48:46.732709 [debug] [Thread-6  ]: Writing runtime SQL for node "model.coffee_shop_zar.order_details"
[0m15:48:46.733404 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:46.733819 [debug] [Thread-2  ]: Began executing node model.coffee_shop_zar.web_session_metrics
[0m15:48:46.734110 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m15:48:46.737562 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop_zar.web_session_metrics"
[0m15:48:46.737863 [debug] [Thread-6  ]: On model.coffee_shop_zar.order_details: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.order_details"} */


  create or replace view `aec-students`.`dbt_lauren`.`order_details`
  OPTIONS()
  as with 
    orders as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__orders`
    ),


    order_items as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__order_items`
    ),


    products as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__products`
    ),
    
    product_prices as (
        select *
        from  `aec-students`.`dbt_lauren`.`stg_coffee_shop__product_prices`
    ),

    web_sessions as (
        select *
        from `aec-students`.`dbt_lauren`.`web_sessions`
    ),


    order_details as (
       
        select 
            orders.*,
            min(created_on) over (partition by orders.customer_id) as customer_first_order_on,
            order_items.product_id,
            products.name as product_name,
            products.category as product_category,
            products.product_available_on,
            product_prices.* except(id, product_id, price_started_at, price_ended_at),
            web_sessions.session_id,
            web_sessions.session_start_at,
            web_sessions.session_end_at,
            round(
                timestamp_diff(
                web_sessions.session_end_at,
                web_sessions.session_start_at,
                second
                ) / 60
                ,2
            ) as session_duration,
            round(
                timestamp_diff(
                web_sessions.event_at,
                web_sessions.session_start_at,
                second
                ) / 60,
                2
            ) as time_to_purchase,
            web_sessions.device_type
        from orders
        left join order_items on 
            orders.id = order_items.order_id
        left join products on 
            order_items.product_id = products.id
        left join product_prices on 
            order_items.product_id = product_prices.product_id and
            orders.created_at >= product_prices.price_started_at and 
            orders.created_at < product_prices.price_ended_at

        left join web_sessions on 
            orders.customer_id = web_sessions.customer_id and 
            orders.created_at = web_sessions.event_at

    )

    select 
        id,
        created_at,
        created_on,
        year_of, 
        month_of,
        week_of,
        day_of_week_name,
        customer_id,
        customer_first_order_on,
        state,
        address,
        zip,
        product_name,
        product_category,
        price_usd,
        session_id,
        session_start_at,
        session_end_at,
        session_duration,
        time_to_purchase,
        device_type
    from order_details;


[0m15:48:46.740052 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:48:46.740825 [debug] [Thread-2  ]: On model.coffee_shop_zar.web_session_metrics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.web_session_metrics"} */


  create or replace view `aec-students`.`dbt_lauren`.`web_session_metrics`
  OPTIONS()
  as with 
  session_detail as (

    select 
      session_id,
      session_end_at, session_start_at, 
      stitched_visitor_id,
      customer_id,
      device_type,
      page,
      round((timestamp_diff(session_end_at, session_start_at, second) / 60),2) as session_duration,
      case when page = "order-confirmation" then true else false end as was_purchase_made,
      date_trunc(date(session_start_at), month) as session_month,
      date(session_start_at) as session_date,
      extract(dayofweek from date(session_start_at)) as day_of_week,
      extract(hour from (session_start_at)) as hour_of_day
    from `aec-students`.`dbt_lauren`.`web_sessions`
  
  ),

  session_metrics as (

  select 
    session_id,
    stitched_visitor_id,
    customer_id,
    session_duration,
    session_month,
    session_date,
    day_of_week,
    hour_of_day,
    count(distinct device_type) as number_of_devices,
    max(was_purchase_made) as was_purchase_made,
    count(page) as pages_visited
  from session_detail
  group by 
    session_id,
    stitched_visitor_id,
    customer_id,
    session_duration,
    session_month,
    session_date,
    day_of_week,
    hour_of_day

  )

  select *
  from session_metrics;


[0m15:48:47.623018 [debug] [Thread-2  ]: finished collecting timing info
[0m15:48:47.623637 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d15b3a0>]}
[0m15:48:47.624093 [info ] [Thread-2  ]: 43 of 47 OK created view model dbt_lauren.web_session_metrics .................. [[32mOK[0m in 0.90s]
[0m15:48:47.624656 [debug] [Thread-2  ]: Finished running node model.coffee_shop_zar.web_session_metrics
[0m15:48:47.844426 [debug] [Thread-6  ]: finished collecting timing info
[0m15:48:47.844980 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d1d3940>]}
[0m15:48:48.407585 [info ] [Thread-6  ]: 42 of 47 OK created view model dbt_lauren.order_details ........................ [[32mOK[0m in 1.13s]
[0m15:48:48.408564 [debug] [Thread-6  ]: Finished running node model.coffee_shop_zar.order_details
[0m15:48:48.409646 [debug] [Thread-3  ]: Began running node model.coffee_shop_zar.customer_daily_orders
[0m15:48:48.410089 [info ] [Thread-3  ]: 44 of 47 START table model dbt_lauren.customer_daily_orders .................... [RUN]
[0m15:48:48.410638 [debug] [Thread-1  ]: Began running node model.coffee_shop_zar.ltv_cohorts
[0m15:48:48.410999 [debug] [Thread-7  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m15:48:48.411876 [info ] [Thread-7  ]: 46 of 47 START view model dbt_lauren.weekly_revenue_by_new_existing_customers .. [RUN]
[0m15:48:48.411353 [info ] [Thread-1  ]: 45 of 47 START table model dbt_lauren.ltv_cohorts .............................. [RUN]
[0m15:48:48.412443 [debug] [Thread-5  ]: Began running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m15:48:48.412969 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop_zar.customer_daily_orders"
[0m15:48:48.414297 [debug] [Thread-3  ]: Began compiling node model.coffee_shop_zar.customer_daily_orders
[0m15:48:48.413991 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m15:48:48.415562 [debug] [Thread-7  ]: Began compiling node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m15:48:48.415867 [debug] [Thread-7  ]: Compiling model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m15:48:48.413569 [info ] [Thread-5  ]: 47 of 47 START view model dbt_lauren.weekly_revenue_by_product_category ........ [RUN]
[0m15:48:48.415118 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop_zar.ltv_cohorts"
[0m15:48:48.420638 [debug] [Thread-1  ]: Began compiling node model.coffee_shop_zar.ltv_cohorts
[0m15:48:48.420864 [debug] [Thread-1  ]: Compiling model.coffee_shop_zar.ltv_cohorts
[0m15:48:48.420386 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m15:48:48.414594 [debug] [Thread-3  ]: Compiling model.coffee_shop_zar.customer_daily_orders
[0m15:48:48.419728 [debug] [Thread-7  ]: Writing injected SQL for node "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m15:48:48.425087 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m15:48:48.425423 [debug] [Thread-5  ]: Began compiling node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m15:48:48.441595 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:48:48.442224 [debug] [Thread-5  ]: Compiling model.coffee_shop_zar.weekly_revenue_by_product_category
[0m15:48:48.442622 [debug] [Thread-7  ]: finished collecting timing info
[0m15:48:48.442901 [debug] [Thread-1  ]: finished collecting timing info
[0m15:48:48.443214 [debug] [Thread-3  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */
select
                device_type as value

            from `aec-students`.`dbt_lauren`.`order_details`

            

            group by device_type
            order by count(*) desc

            

        
[0m15:48:48.446130 [debug] [Thread-5  ]: Writing injected SQL for node "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m15:48:48.446449 [debug] [Thread-7  ]: Began executing node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m15:48:48.446675 [debug] [Thread-1  ]: Began executing node model.coffee_shop_zar.ltv_cohorts
[0m15:48:48.454598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:48:48.452122 [debug] [Thread-7  ]: Writing runtime SQL for node "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"
[0m15:48:48.456397 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:48.457333 [debug] [Thread-5  ]: Began executing node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m15:48:48.460844 [debug] [Thread-5  ]: Writing runtime SQL for node "model.coffee_shop_zar.weekly_revenue_by_product_category"
[0m15:48:48.461214 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m15:48:48.461631 [debug] [Thread-7  ]: On model.coffee_shop_zar.weekly_revenue_by_new_existing_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.weekly_revenue_by_new_existing_customers"} */


  create or replace view `aec-students`.`dbt_lauren`.`weekly_revenue_by_new_existing_customers`
  OPTIONS()
  as with 
    order_details as (
        select *,
          first_value(week_of) over (partition by customer_id order by created_at rows between unbounded preceding and unbounded following)
          as first_order_week_of
        from  `aec-students`.`dbt_lauren`.`order_details`
    ),

    weekly_aggregate as (
        select 
          week_of,
          sum(case when week_of = first_order_week_of then price_usd else 0 end) as new_customer_revenue_usd,
          sum(case when week_of > first_order_week_of then price_usd else 0 end) as existing_customer_revenue_usd
        from order_details
        group by 
          week_of

    )

    select *
    from weekly_aggregate;


[0m15:48:48.462615 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m15:48:48.463000 [debug] [Thread-5  ]: On model.coffee_shop_zar.weekly_revenue_by_product_category: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.weekly_revenue_by_product_category"} */


  create or replace view `aec-students`.`dbt_lauren`.`weekly_revenue_by_product_category`
  OPTIONS()
  as with 
    order_details as (
        select *
        from  `aec-students`.`dbt_lauren`.`order_details`
    ),

    weekly_aggregate as (

        select 
          week_of,
          product_category,
          sum(price_usd) as revenue_usd
        from order_details
        group by 
          week_of,
          product_category
    )

    select *
    from weekly_aggregate;


[0m15:48:48.966873 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop_zar.ltv_cohorts"
[0m15:48:48.967434 [debug] [Thread-1  ]: On model.coffee_shop_zar.ltv_cohorts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.ltv_cohorts"} */


  create or replace table `aec-students`.`dbt_lauren`.`ltv_cohorts`
  
  
  OPTIONS()
  as (
    

with

  weekly_customer_revenue as (
    select 
      customer_id,
      week_of,
      min(week_of) over (partition by customer_id) as cohort_week,
      min(week_of) over () as reference_start_date,
      max(week_of) over () as reference_end_date,
      sum(price_usd) as revenue
    from  `aec-students`.`dbt_lauren`.`order_details`
    group by 
      customer_id,
      week_of
  ),

  date_details as (
    select *
    from  `aec-students`.`dbt_lauren`.`date_details`
    where 
      date_actual = week_start_on and 
      date_actual >= date('2020-12-27') and 
      date_actual <= date('2021-10-01')

  ),


  date_spine as (
    select 
      date_details.week_start_on,
      date_details.week_end_on,
      date_details.quarter_name,
      cohorts.customer_id,
      cohorts.cohort_week
    from date_details
    cross join (select distinct customer_id, cohort_week, reference_start_date, reference_end_date  from weekly_customer_revenue ) as cohorts
    where date_details.week_start_on >= cohorts.cohort_week and
      date_details.week_start_on >= cohorts.reference_start_date and
      date_details.week_start_on <= cohorts.reference_end_date
  ),

  cohort_details as (
    select 
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.cohort_week,
      ifnull(weekly_customer_revenue.revenue,0) as revenue, 
      row_number() over (partition by date_spine.customer_id order by date_spine.week_start_on) as week,
      sum(ifnull(weekly_customer_revenue.revenue,0)) over (partition by date_spine.customer_id order by date_spine.week_start_on rows between unbounded preceding and current row) as cumulative_revenue
    from date_spine
    left join weekly_customer_revenue on 
      date_spine.customer_id = weekly_customer_revenue.customer_id and 
      date_spine.week_start_on = weekly_customer_revenue.week_of 
  ),


  cohort_revenues as (
    select 
        week,
        cohort_week,
        count(distinct customer_id) as cohort_size,
        sum(revenue) as cohort_total_revenue,
        sum(cumulative_revenue) as cohort_total_cumulative_revenue
    from cohort_details
    group by 1,2
  ),


normalized_cohorts as (
    select
        *,
        cohort_total_revenue / cohort_size as average_revenue,
        cohort_total_cumulative_revenue / cohort_size as average_ltv
    from cohort_revenues
    
)


select *
from normalized_cohorts
order by cohort_week, week
  );
  
[0m15:48:49.464678 [debug] [Thread-7  ]: finished collecting timing info
[0m15:48:49.465298 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4c3b6b50>]}
[0m15:48:49.465737 [info ] [Thread-7  ]: 46 of 47 OK created view model dbt_lauren.weekly_revenue_by_new_existing_customers  [[32mOK[0m in 1.05s]
[0m15:48:49.466541 [debug] [Thread-7  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_new_existing_customers
[0m15:48:49.721825 [debug] [Thread-5  ]: finished collecting timing info
[0m15:48:49.722457 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4c2fdc70>]}
[0m15:48:49.722873 [info ] [Thread-5  ]: 47 of 47 OK created view model dbt_lauren.weekly_revenue_by_product_category ... [[32mOK[0m in 1.30s]
[0m15:48:49.723600 [debug] [Thread-5  ]: Finished running node model.coffee_shop_zar.weekly_revenue_by_product_category
[0m15:48:52.546398 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m15:48:52.546941 [debug] [Thread-3  ]: finished collecting timing info
[0m15:48:52.547203 [debug] [Thread-3  ]: Began executing node model.coffee_shop_zar.customer_daily_orders
[0m15:48:52.695910 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop_zar.customer_daily_orders"
[0m15:48:52.696527 [debug] [Thread-3  ]: On model.coffee_shop_zar.customer_daily_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.coffee_shop_zar.customer_daily_orders"} */


  create or replace table `aec-students`.`dbt_lauren`.`customer_daily_orders`
  
  
  OPTIONS()
  as (
    




with
  orders as (
    select *
    from `aec-students`.`dbt_lauren`.`order_details`
  ),

  daily_orders as (
    select
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip,
      count(id) as purchase_count,
      sum(price_usd) as revenue_amount,
      count(distinct session_id) as session_count,
      avg(session_duration) as average_session_duration,

      
      sum(case when device_type = 'Android' then 1 else 0 end) as android_count,
      sum(case when device_type = 'Android' then price_usd else 0 end) as android_amount,
      
      sum(case when device_type = 'iPhone' then 1 else 0 end) as iphone_count,
      sum(case when device_type = 'iPhone' then price_usd else 0 end) as iphone_amount,
      
      sum(case when device_type = 'windows' then 1 else 0 end) as windows_count,
      sum(case when device_type = 'windows' then price_usd else 0 end) as windows_amount,
      
      sum(case when device_type = 'linux' then 1 else 0 end) as linux_count,
      sum(case when device_type = 'linux' then price_usd else 0 end) as linux_amount,
      
      sum(case when device_type = 'macOS' then 1 else 0 end) as macos_count,
      sum(case when device_type = 'macOS' then price_usd else 0 end) as macos_amount,
      
    from orders
    group by 
      created_on,
      customer_id,
      customer_first_order_on,
      state,
      address,
      zip
  
  ),

  date_details as (
    select *
    from `aec-students.dbt_lauren.date_details`
    where 
      date_day >= date("2020-12-27") and
      date_day <= date("2021-10-01")
  ),


  date_spine as (
    select 
      date_details.*,
      orders.customer_id,
      orders.customer_first_order_on
    from date_details
    inner join (select distinct customer_id, customer_first_order_on from daily_orders) as orders on 
      date_details.date_actual >= orders.customer_first_order_on
  ),

  final as (
    
    select 
      date_spine.date_actual,
      date_spine.day_name,
      date_spine.month_actual,
      date_spine.year_actual,
      date_spine.quarter_actual,
      date_spine.week_actual,
      date_spine.week_start_on,
      date_spine.week_end_on,
      date_spine.first_day_of_month,
      date_spine.last_day_of_month,
      date_spine.quarter_name,
      date_spine.customer_id,
      date_spine.customer_first_order_on,
      ifnull(daily_orders.purchase_count,0) as purchase_count,
      ifnull(daily_orders.revenue_amount,0) as revenue_amount,
      ifnull(daily_orders.session_count,0) as session_count,
      ifnull(daily_orders.average_session_duration,0) as average_session_duration,

      
      ifnull( android_count, 0) as android_count,
      ifnull( android_amount, 0) as android_amount,
      
      ifnull( iphone_count, 0) as iphone_count,
      ifnull( iphone_amount, 0) as iphone_amount,
      
      ifnull( windows_count, 0) as windows_count,
      ifnull( windows_amount, 0) as windows_amount,
      
      ifnull( linux_count, 0) as linux_count,
      ifnull( linux_amount, 0) as linux_amount,
      
      ifnull( macos_count, 0) as macos_count,
      ifnull( macos_amount, 0) as macos_amount,
      
    

    from date_spine
    left join daily_orders on 
      date_spine.date_actual = daily_orders.created_on and 
      date_spine.customer_id = daily_orders.customer_id

  )

  select *
  from final
  );
  
[0m15:48:56.972986 [debug] [Thread-1  ]: finished collecting timing info
[0m15:48:56.973605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4c36ca00>]}
[0m15:48:56.974048 [info ] [Thread-1  ]: 45 of 47 OK created table model dbt_lauren.ltv_cohorts ......................... [[32mCREATE TABLE (276.0 rows, 137.4 MB processed)[0m in 8.56s]
[0m15:48:56.974924 [debug] [Thread-1  ]: Finished running node model.coffee_shop_zar.ltv_cohorts
[0m15:49:09.354217 [debug] [Thread-3  ]: finished collecting timing info
[0m15:49:09.354818 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7cae61-f225-4406-ac3f-915880796706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4c36cbe0>]}
[0m15:49:09.355265 [info ] [Thread-3  ]: 44 of 47 OK created table model dbt_lauren.customer_daily_orders ............... [[32mCREATE TABLE (35.2m rows, 466.0 MB processed)[0m in 20.94s]
[0m15:49:09.355821 [debug] [Thread-3  ]: Finished running node model.coffee_shop_zar.customer_daily_orders
[0m15:49:09.357695 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:49:09.358550 [info ] [MainThread]: 
[0m15:49:09.359035 [info ] [MainThread]: Finished running 24 view models, 23 table models in 0 hours 0 minutes and 41.58 seconds (41.58s).
[0m15:49:09.359551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:09.359869 [debug] [MainThread]: Connection 'model.coffee_shop_zar.ltv_cohorts' was properly closed.
[0m15:49:09.360074 [debug] [MainThread]: Connection 'model.coffee_shop_zar.customer_daily_orders' was properly closed.
[0m15:49:09.360263 [debug] [MainThread]: Connection 'model.coffee_shop_zar.order_details' was properly closed.
[0m15:49:09.360436 [debug] [MainThread]: Connection 'model.coffee_shop_zar.web_session_metrics' was properly closed.
[0m15:49:09.360612 [debug] [MainThread]: Connection 'model.github_source.stg_github__pull_request_review_tmp' was properly closed.
[0m15:49:09.360796 [debug] [MainThread]: Connection 'model.coffee_shop_zar.web_sessions' was properly closed.
[0m15:49:09.361083 [debug] [MainThread]: Connection 'model.coffee_shop_zar.weekly_revenue_by_new_existing_customers' was properly closed.
[0m15:49:09.361380 [debug] [MainThread]: Connection 'model.coffee_shop_zar.weekly_revenue_by_product_category' was properly closed.
[0m15:49:09.382732 [info ] [MainThread]: 
[0m15:49:09.383103 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m15:49:09.383603 [info ] [MainThread]: 
[0m15:49:09.384043 [error] [MainThread]: [33mRuntime Error in model stg_github__issue_assignee_tmp (models/tmp/stg_github__issue_assignee_tmp.sql)[0m
[0m15:49:09.384559 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.385051 [error] [MainThread]:   
[0m15:49:09.385558 [error] [MainThread]:   Location: US
[0m15:49:09.386093 [error] [MainThread]:   Job ID: f96d07f3-8099-4be6-9ee8-a24afa19587b
[0m15:49:09.386572 [error] [MainThread]:   
[0m15:49:09.387108 [info ] [MainThread]: 
[0m15:49:09.387597 [error] [MainThread]: [33mRuntime Error in model stg_github__issue_closed_history_tmp (models/tmp/stg_github__issue_closed_history_tmp.sql)[0m
[0m15:49:09.388017 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.388510 [error] [MainThread]:   
[0m15:49:09.389012 [error] [MainThread]:   Location: US
[0m15:49:09.389534 [error] [MainThread]:   Job ID: 98d71e24-dd47-4c77-aacc-0565228a6bae
[0m15:49:09.389983 [error] [MainThread]:   
[0m15:49:09.390483 [info ] [MainThread]: 
[0m15:49:09.390991 [error] [MainThread]: [33mRuntime Error in model stg_github__issue_comment_tmp (models/tmp/stg_github__issue_comment_tmp.sql)[0m
[0m15:49:09.391529 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.391970 [error] [MainThread]:   
[0m15:49:09.392457 [error] [MainThread]:   Location: US
[0m15:49:09.392940 [error] [MainThread]:   Job ID: 319672b1-787e-43ba-a382-f4adccb8bdad
[0m15:49:09.393434 [error] [MainThread]:   
[0m15:49:09.393947 [info ] [MainThread]: 
[0m15:49:09.394453 [error] [MainThread]: [33mRuntime Error in model stg_github__issue_label_tmp (models/tmp/stg_github__issue_label_tmp.sql)[0m
[0m15:49:09.395060 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.395555 [error] [MainThread]:   
[0m15:49:09.396032 [error] [MainThread]:   Location: US
[0m15:49:09.396542 [error] [MainThread]:   Job ID: cdba0d0e-4148-4ea5-86dd-8f906888aec8
[0m15:49:09.397002 [error] [MainThread]:   
[0m15:49:09.397530 [info ] [MainThread]: 
[0m15:49:09.398051 [error] [MainThread]: [33mRuntime Error in model stg_github__issue_tmp (models/tmp/stg_github__issue_tmp.sql)[0m
[0m15:49:09.398597 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.399014 [error] [MainThread]:   
[0m15:49:09.399502 [error] [MainThread]:   Location: US
[0m15:49:09.399994 [error] [MainThread]:   Job ID: 502c2fd8-b924-48f4-ad66-24ad613b76be
[0m15:49:09.400523 [error] [MainThread]:   
[0m15:49:09.401009 [info ] [MainThread]: 
[0m15:49:09.401560 [error] [MainThread]: [33mRuntime Error in model stg_github__issue_merged_tmp (models/tmp/stg_github__issue_merged_tmp.sql)[0m
[0m15:49:09.402081 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.402579 [error] [MainThread]:   
[0m15:49:09.402997 [error] [MainThread]:   Location: US
[0m15:49:09.403483 [error] [MainThread]:   Job ID: 11aa313c-81ee-4eff-81b5-04f381a1ac74
[0m15:49:09.403990 [error] [MainThread]:   
[0m15:49:09.404519 [info ] [MainThread]: 
[0m15:49:09.404966 [error] [MainThread]: [33mRuntime Error in model stg_github__label_tmp (models/tmp/stg_github__label_tmp.sql)[0m
[0m15:49:09.405602 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.406092 [error] [MainThread]:   
[0m15:49:09.406575 [error] [MainThread]:   Location: US
[0m15:49:09.407104 [error] [MainThread]:   Job ID: 7196e03b-1df5-4699-bdc7-b694866a37ec
[0m15:49:09.407606 [error] [MainThread]:   
[0m15:49:09.408031 [info ] [MainThread]: 
[0m15:49:09.408530 [error] [MainThread]: [33mRuntime Error in model stg_github__pull_request_review_tmp (models/tmp/stg_github__pull_request_review_tmp.sql)[0m
[0m15:49:09.409030 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.409565 [error] [MainThread]:   
[0m15:49:09.409989 [error] [MainThread]:   Location: US
[0m15:49:09.410471 [error] [MainThread]:   Job ID: 3a5d5336-dfe8-4ada-b9cb-b8243c09892d
[0m15:49:09.410967 [error] [MainThread]:   
[0m15:49:09.411502 [info ] [MainThread]: 
[0m15:49:09.411959 [error] [MainThread]: [33mRuntime Error in model stg_github__repository_tmp (models/tmp/stg_github__repository_tmp.sql)[0m
[0m15:49:09.412462 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.413116 [error] [MainThread]:   
[0m15:49:09.413643 [error] [MainThread]:   Location: US
[0m15:49:09.414152 [error] [MainThread]:   Job ID: b2b1e055-271b-418f-9f4c-0a597e51a193
[0m15:49:09.414655 [error] [MainThread]:   
[0m15:49:09.415168 [info ] [MainThread]: 
[0m15:49:09.415626 [error] [MainThread]: [33mRuntime Error in model stg_github__pull_request_tmp (models/tmp/stg_github__pull_request_tmp.sql)[0m
[0m15:49:09.416052 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.416540 [error] [MainThread]:   
[0m15:49:09.417037 [error] [MainThread]:   Location: US
[0m15:49:09.417573 [error] [MainThread]:   Job ID: 73c14223-45b8-466c-8685-879251f8d92b
[0m15:49:09.418007 [error] [MainThread]:   
[0m15:49:09.418514 [info ] [MainThread]: 
[0m15:49:09.419020 [error] [MainThread]: [33mRuntime Error in model stg_github__requested_reviewer_history_tmp (models/tmp/stg_github__requested_reviewer_history_tmp.sql)[0m
[0m15:49:09.419562 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.420010 [error] [MainThread]:   
[0m15:49:09.420487 [error] [MainThread]:   Location: US
[0m15:49:09.420984 [error] [MainThread]:   Job ID: b3752cb1-1905-4800-ab54-4428217d5d9a
[0m15:49:09.421527 [error] [MainThread]:   
[0m15:49:09.421957 [info ] [MainThread]: 
[0m15:49:09.422451 [error] [MainThread]: [33mRuntime Error in model stg_github__team_tmp (models/tmp/stg_github__team_tmp.sql)[0m
[0m15:49:09.422953 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.423461 [error] [MainThread]:   
[0m15:49:09.423872 [error] [MainThread]:   Location: US
[0m15:49:09.424361 [error] [MainThread]:   Job ID: d4f99981-03e8-407e-ab3d-bb7d9d700a0e
[0m15:49:09.424884 [error] [MainThread]:   
[0m15:49:09.425453 [info ] [MainThread]: 
[0m15:49:09.425959 [error] [MainThread]: [33mRuntime Error in model stg_github__user_tmp (models/tmp/stg_github__user_tmp.sql)[0m
[0m15:49:09.426468 [error] [MainThread]:   404 Not found: Dataset aec-students:analytics-engineers-club was not found in location US
[0m15:49:09.426958 [error] [MainThread]:   
[0m15:49:09.427466 [error] [MainThread]:   Location: US
[0m15:49:09.427879 [error] [MainThread]:   Job ID: 60659055-6c82-48a7-b100-05d128ddb1df
[0m15:49:09.428369 [error] [MainThread]:   
[0m15:49:09.429001 [info ] [MainThread]: 
[0m15:49:09.429504 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=13 SKIP=19 TOTAL=47
[0m15:49:09.430093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4cf542b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4d03a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4c3c3be0>]}


============================== 2022-08-15 15:51:32.894201 | 0df5a97b-1174-4fb8-83b2-c9c36568cc15 ==============================
[0m15:51:32.894231 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:51:32.895141 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['github'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:51:32.895481 [debug] [MainThread]: Tracking: tracking
[0m15:51:32.902921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59c34160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59c34a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59c344c0>]}
[0m15:51:33.001379 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:51:33.001911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0df5a97b-1174-4fb8-83b2-c9c36568cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f67a465e0>]}
[0m15:51:33.123167 [debug] [MainThread]: Parsing macros/etc.sql
[0m15:51:33.126128 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:51:33.152213 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:51:33.157911 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:51:33.160723 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:51:33.161330 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:51:33.161817 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:51:33.162438 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:51:33.163177 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:51:33.163925 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:51:33.164663 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:51:33.165127 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:51:33.166660 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:51:33.167765 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:51:33.168408 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:51:33.169749 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:51:33.170367 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:51:33.170994 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m15:51:33.173528 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m15:51:33.175215 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m15:51:33.179939 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m15:51:33.182889 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m15:51:33.198816 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m15:51:33.201734 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:51:33.202728 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:51:33.203529 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:51:33.204435 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:51:33.205920 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:51:33.208646 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:51:33.222210 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:51:33.229178 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:51:33.243394 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:51:33.247987 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:51:33.257508 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:51:33.261163 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:51:33.264018 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:51:33.265116 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:51:33.266315 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:51:33.267350 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:51:33.269180 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:51:33.275034 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:51:33.276005 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:51:33.277388 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:51:33.278887 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:51:33.280035 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:51:33.281205 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:51:33.282426 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:51:33.283361 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:51:33.285526 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:51:33.287441 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:51:33.289947 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:51:33.291146 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:51:33.292202 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:51:33.293580 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:51:33.294618 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:51:33.295797 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:51:33.296932 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:51:33.305336 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:51:33.309810 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:51:33.312244 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:51:33.316172 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:51:33.322540 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:51:33.325500 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:51:33.341116 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:51:33.345651 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:51:33.360677 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:51:33.362332 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:51:33.372518 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:51:33.373992 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:51:33.379395 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:51:33.382898 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:51:33.385267 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:51:33.390199 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:51:33.392111 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:51:33.394060 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:51:33.416459 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:51:33.423405 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:51:33.435804 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:51:33.437561 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:51:33.449104 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:51:33.466095 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:51:33.467946 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:51:33.469614 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:51:33.472112 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:51:33.475143 [debug] [MainThread]: Parsing macros/fill_staging_columns.sql
[0m15:51:33.479790 [debug] [MainThread]: Parsing macros/json_extract.sql
[0m15:51:33.482938 [debug] [MainThread]: Parsing macros/union_relations.sql
[0m15:51:33.491750 [debug] [MainThread]: Parsing macros/try_cast.sql
[0m15:51:33.496013 [debug] [MainThread]: Parsing macros/timestamp_add.sql
[0m15:51:33.499456 [debug] [MainThread]: Parsing macros/fill_pass_through_columns.sql
[0m15:51:33.501037 [debug] [MainThread]: Parsing macros/dummy_coalesce_value.sql
[0m15:51:33.504476 [debug] [MainThread]: Parsing macros/add_dbt_source_relation.sql
[0m15:51:33.505343 [debug] [MainThread]: Parsing macros/enabled_vars_one_true.sql
[0m15:51:33.506537 [debug] [MainThread]: Parsing macros/first_value.sql
[0m15:51:33.508736 [debug] [MainThread]: Parsing macros/add_pass_through_columns.sql
[0m15:51:33.510803 [debug] [MainThread]: Parsing macros/ceiling.sql
[0m15:51:33.512069 [debug] [MainThread]: Parsing macros/source_relation.sql
[0m15:51:33.514675 [debug] [MainThread]: Parsing macros/max_bool.sql
[0m15:51:33.516281 [debug] [MainThread]: Parsing macros/persist_pass_through_columns.sql
[0m15:51:33.517406 [debug] [MainThread]: Parsing macros/calculated_fields.sql
[0m15:51:33.518970 [debug] [MainThread]: Parsing macros/percentile.sql
[0m15:51:33.522807 [debug] [MainThread]: Parsing macros/remove_prefix_from_columns.sql
[0m15:51:33.524471 [debug] [MainThread]: Parsing macros/union_data.sql
[0m15:51:33.530893 [debug] [MainThread]: Parsing macros/json_parse.sql
[0m15:51:33.536551 [debug] [MainThread]: Parsing macros/empty_variable_warning.sql
[0m15:51:33.537698 [debug] [MainThread]: Parsing macros/pivot_json_extract.sql
[0m15:51:33.538907 [debug] [MainThread]: Parsing macros/snowflake_seed_data.sql
[0m15:51:33.539980 [debug] [MainThread]: Parsing macros/enabled_vars.sql
[0m15:51:33.541099 [debug] [MainThread]: Parsing macros/timestamp_diff.sql
[0m15:51:33.551284 [debug] [MainThread]: Parsing macros/collect_freshness.sql
[0m15:51:33.555107 [debug] [MainThread]: Parsing macros/string_agg.sql
[0m15:51:33.557491 [debug] [MainThread]: Parsing macros/seed_data_helper.sql
[0m15:51:33.559024 [debug] [MainThread]: Parsing macros/array_agg.sql
[0m15:51:33.560420 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m15:51:33.563290 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m15:51:33.564732 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m15:51:33.566556 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m15:51:33.568724 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m15:51:33.570792 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m15:51:33.573654 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m15:51:33.575899 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m15:51:33.577194 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m15:51:33.579055 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m15:51:33.581597 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:51:33.590195 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m15:51:33.592101 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m15:51:33.595797 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m15:51:33.598104 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m15:51:33.599736 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m15:51:33.601656 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m15:51:33.603387 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m15:51:33.605325 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m15:51:33.606402 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m15:51:33.608164 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m15:51:33.610332 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m15:51:33.616196 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m15:51:33.617618 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m15:51:33.618839 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m15:51:33.620189 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m15:51:33.621329 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m15:51:33.623249 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m15:51:33.626299 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m15:51:33.627784 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m15:51:33.629669 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m15:51:33.632024 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m15:51:33.637217 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m15:51:33.638421 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m15:51:33.644380 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m15:51:33.648027 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m15:51:33.650675 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m15:51:33.659404 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m15:51:33.661500 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m15:51:33.664989 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m15:51:33.667091 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m15:51:33.668177 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m15:51:33.677961 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m15:51:33.680715 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m15:51:33.682441 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m15:51:33.683806 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m15:51:33.685252 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m15:51:33.686843 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:51:33.688920 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:51:33.690582 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:51:33.693208 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:51:33.694512 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:51:33.695719 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:51:33.696902 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:51:33.698184 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m15:51:33.722481 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:51:33.725978 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:51:33.730256 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m15:51:33.733199 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:51:33.737364 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:51:33.739708 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:51:33.745664 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m15:51:33.747306 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:51:33.748742 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:51:33.760071 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m15:51:33.767286 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:51:33.771143 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:51:33.775289 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:51:33.776998 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:51:33.778791 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:51:33.786650 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:51:33.792344 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:51:33.795774 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:51:33.797534 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:51:33.801057 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:51:33.802830 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:51:33.809107 [debug] [MainThread]: Parsing macros/get_issue_merged_columns.sql
[0m15:51:33.810876 [debug] [MainThread]: Parsing macros/get_label_columns.sql
[0m15:51:33.812984 [debug] [MainThread]: Parsing macros/get_issue_assignee_columns.sql
[0m15:51:33.814321 [debug] [MainThread]: Parsing macros/get_issue_label_columns.sql
[0m15:51:33.815621 [debug] [MainThread]: Parsing macros/get_issue_comment_columns.sql
[0m15:51:33.817735 [debug] [MainThread]: Parsing macros/get_team_columns.sql
[0m15:51:33.820053 [debug] [MainThread]: Parsing macros/get_issue_closed_history_columns.sql
[0m15:51:33.821942 [debug] [MainThread]: Parsing macros/get_pull_request_review_columns.sql
[0m15:51:33.824257 [debug] [MainThread]: Parsing macros/get_repository_columns.sql
[0m15:51:33.827531 [debug] [MainThread]: Parsing macros/get_user_columns.sql
[0m15:51:33.829258 [debug] [MainThread]: Parsing macros/get_issue_columns.sql
[0m15:51:33.832819 [debug] [MainThread]: Parsing macros/get_pull_request_columns.sql
[0m15:51:33.836396 [debug] [MainThread]: Parsing macros/get_repo_team_columns.sql
[0m15:51:33.837950 [debug] [MainThread]: Parsing macros/get_requested_reviewer_history_columns.sql
[0m15:51:33.839835 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m15:51:33.848821 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m15:51:33.854971 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m15:51:33.859181 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m15:51:34.457625 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m15:51:34.470348 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m15:51:34.519054 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m15:51:34.521660 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m15:51:34.524033 [debug] [MainThread]: 1699: static parser successfully parsed marts/calendar/date_details.sql
[0m15:51:34.526565 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_session_metrics.sql
[0m15:51:34.528948 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/stitch_visitor_events.sql
[0m15:51:34.531451 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_analytics/web_sessions.sql
[0m15:51:34.534066 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_new_existing_customers.sql
[0m15:51:34.536673 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/customer_daily_orders.sql
[0m15:51:34.555985 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/customer_daily_orders.sql
[0m15:51:34.557208 [debug] [MainThread]: 1603: static parser failed on marts/coffee_shop/ltv_cohorts.sql
[0m15:51:34.562675 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_shop/ltv_cohorts.sql
[0m15:51:34.563967 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/customers.sql
[0m15:51:34.566479 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/monthly_users.sql
[0m15:51:34.568895 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/weekly_revenue_by_product_category.sql
[0m15:51:34.571448 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/cohorts.sql
[0m15:51:34.574051 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_shop/order_details.sql
[0m15:51:34.624391 [debug] [MainThread]: 1603: static parser failed on stg_github__issue.sql
[0m15:51:34.658855 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue.sql
[0m15:51:34.660201 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request.sql
[0m15:51:34.680075 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request.sql
[0m15:51:34.681295 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_assignee.sql
[0m15:51:34.691425 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_assignee.sql
[0m15:51:34.692879 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_closed_history.sql
[0m15:51:34.705055 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_closed_history.sql
[0m15:51:34.706269 [debug] [MainThread]: 1603: static parser failed on stg_github__label.sql
[0m15:51:34.719568 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__label.sql
[0m15:51:34.720756 [debug] [MainThread]: 1603: static parser failed on stg_github__team.sql
[0m15:51:34.734895 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__team.sql
[0m15:51:34.736060 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_comment.sql
[0m15:51:34.749786 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_comment.sql
[0m15:51:34.750984 [debug] [MainThread]: 1603: static parser failed on stg_github__requested_reviewer_history.sql
[0m15:51:34.763311 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__requested_reviewer_history.sql
[0m15:51:34.764483 [debug] [MainThread]: 1603: static parser failed on stg_github__user.sql
[0m15:51:34.774976 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__user.sql
[0m15:51:34.776168 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_merged.sql
[0m15:51:34.788000 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_merged.sql
[0m15:51:34.789414 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_label.sql
[0m15:51:34.799507 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_label.sql
[0m15:51:34.800729 [debug] [MainThread]: 1603: static parser failed on stg_github__repo_team.sql
[0m15:51:34.811592 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repo_team.sql
[0m15:51:34.812786 [debug] [MainThread]: 1603: static parser failed on stg_github__repository.sql
[0m15:51:34.830145 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repository.sql
[0m15:51:34.831330 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request_review.sql
[0m15:51:34.846181 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request_review.sql
[0m15:51:34.847341 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repository_tmp.sql
[0m15:51:34.852250 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repository_tmp.sql
[0m15:51:34.853451 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__user_tmp.sql
[0m15:51:34.859243 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__user_tmp.sql
[0m15:51:34.860383 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__label_tmp.sql
[0m15:51:34.867312 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__label_tmp.sql
[0m15:51:34.869513 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:51:34.877771 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:51:34.879722 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__team_tmp.sql
[0m15:51:34.888563 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__team_tmp.sql
[0m15:51:34.890583 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_assignee_tmp.sql
[0m15:51:34.899113 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_assignee_tmp.sql
[0m15:51:34.901028 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_comment_tmp.sql
[0m15:51:34.909993 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_comment_tmp.sql
[0m15:51:34.911526 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_tmp.sql
[0m15:51:34.917487 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_tmp.sql
[0m15:51:34.918934 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_merged_tmp.sql
[0m15:51:34.924245 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_merged_tmp.sql
[0m15:51:34.925430 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_review_tmp.sql
[0m15:51:34.930240 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_review_tmp.sql
[0m15:51:34.931484 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repo_team_tmp.sql
[0m15:51:34.936985 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repo_team_tmp.sql
[0m15:51:34.938184 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:51:34.943896 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:51:34.945068 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_label_tmp.sql
[0m15:51:34.949928 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_label_tmp.sql
[0m15:51:34.951110 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_tmp.sql
[0m15:51:34.955926 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_tmp.sql
[0m15:51:34.972206 [debug] [MainThread]: 1603: static parser failed on github__quarterly_metrics.sql
[0m15:51:34.980132 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__quarterly_metrics.sql
[0m15:51:34.981297 [debug] [MainThread]: 1603: static parser failed on github__weekly_metrics.sql
[0m15:51:34.986139 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__weekly_metrics.sql
[0m15:51:34.987288 [debug] [MainThread]: 1603: static parser failed on github__monthly_metrics.sql
[0m15:51:34.992254 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__monthly_metrics.sql
[0m15:51:34.993420 [debug] [MainThread]: 1603: static parser failed on github__issues.sql
[0m15:51:34.999618 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__issues.sql
[0m15:51:35.001502 [debug] [MainThread]: 1603: static parser failed on github__daily_metrics.sql
[0m15:51:35.015140 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__daily_metrics.sql
[0m15:51:35.017186 [debug] [MainThread]: 1699: static parser successfully parsed github__pull_requests.sql
[0m15:51:35.021694 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_reviewers.sql
[0m15:51:35.037489 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_reviewers.sql
[0m15:51:35.040241 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__repository_teams.sql
[0m15:51:35.053362 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__repository_teams.sql
[0m15:51:35.055735 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_label_joined.sql
[0m15:51:35.065622 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_label_joined.sql
[0m15:51:35.067421 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_assignees.sql
[0m15:51:35.078790 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_assignees.sql
[0m15:51:35.081031 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_joined.sql
[0m15:51:35.105235 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_joined.sql
[0m15:51:35.106604 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_comments.sql
[0m15:51:35.112696 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_comments.sql
[0m15:51:35.114055 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_times.sql
[0m15:51:35.139027 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_times.sql
[0m15:51:35.145788 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_open_length.sql
[0m15:51:35.158810 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_open_length.sql
[0m15:51:35.160999 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_labels.sql
[0m15:51:35.169642 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_labels.sql
[0m15:51:35.789642 [debug] [MainThread]: Test 'test.github_source.not_null_stg_github__repo_team_repository_id.7076be2503' (models/stg_github.yml) depends on a node named 'stg_github__repo_team' which is disabled
[0m15:51:35.789903 [debug] [MainThread]: Test 'test.github_source.not_null_stg_github__repo_team_team_id.000230e64c' (models/stg_github.yml) depends on a node named 'stg_github__repo_team' which is disabled
[0m15:51:35.835476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:51:35.844633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0df5a97b-1174-4fb8-83b2-c9c36568cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59b450d0>]}
[0m15:51:35.869562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0df5a97b-1174-4fb8-83b2-c9c36568cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f595fbc40>]}
[0m15:51:35.869909 [info ] [MainThread]: Found 56 models, 43 tests, 0 snapshots, 0 analyses, 622 macros, 0 operations, 0 seed files, 20 sources, 0 exposures, 0 metrics
[0m15:51:35.870252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df5a97b-1174-4fb8-83b2-c9c36568cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59c316d0>]}
[0m15:51:35.873936 [info ] [MainThread]: 
[0m15:51:35.874585 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:51:35.875727 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m15:51:35.876068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:36.916289 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m15:51:36.916800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:37.146766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df5a97b-1174-4fb8-83b2-c9c36568cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59aa82b0>]}
[0m15:51:37.147530 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:51:37.147935 [info ] [MainThread]: 
[0m15:51:37.153587 [debug] [Thread-1  ]: Began running node model.github.int_github__issue_assignees
[0m15:51:37.154163 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.github.int_github__issue_assignees"
[0m15:51:37.154374 [debug] [Thread-2  ]: Began running node model.github.int_github__issue_comments
[0m15:51:37.155809 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github.int_github__issue_comments"
[0m15:51:37.156005 [debug] [Thread-2  ]: Began compiling node model.github.int_github__issue_comments
[0m15:51:37.154976 [debug] [Thread-1  ]: Began compiling node model.github.int_github__issue_assignees
[0m15:51:37.156438 [debug] [Thread-1  ]: Compiling model.github.int_github__issue_assignees
[0m15:51:37.155220 [debug] [Thread-5  ]: Began running node model.github.int_github__pull_request_reviewers
[0m15:51:37.163699 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.github.int_github__pull_request_reviewers"
[0m15:51:37.163901 [debug] [Thread-5  ]: Began compiling node model.github.int_github__pull_request_reviewers
[0m15:51:37.164080 [debug] [Thread-5  ]: Compiling model.github.int_github__pull_request_reviewers
[0m15:51:37.155380 [debug] [Thread-6  ]: Began running node model.github.int_github__pull_request_times
[0m15:51:37.163272 [debug] [Thread-1  ]: Writing injected SQL for node "model.github.int_github__issue_assignees"
[0m15:51:37.154541 [debug] [Thread-3  ]: Began running node model.github.int_github__issue_label_joined
[0m15:51:37.154798 [debug] [Thread-4  ]: Began running node model.github.int_github__issue_open_length
[0m15:51:37.156230 [debug] [Thread-2  ]: Compiling model.github.int_github__issue_comments
[0m15:51:37.169818 [debug] [Thread-5  ]: Writing injected SQL for node "model.github.int_github__pull_request_reviewers"
[0m15:51:37.170272 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.github.int_github__pull_request_times"
[0m15:51:37.170916 [debug] [Thread-1  ]: finished collecting timing info
[0m15:51:37.171285 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github.int_github__issue_label_joined"
[0m15:51:37.176786 [debug] [Thread-3  ]: Began compiling node model.github.int_github__issue_label_joined
[0m15:51:37.175336 [debug] [Thread-2  ]: Writing injected SQL for node "model.github.int_github__issue_comments"
[0m15:51:37.175820 [debug] [Thread-6  ]: Began compiling node model.github.int_github__pull_request_times
[0m15:51:37.177404 [debug] [Thread-6  ]: Compiling model.github.int_github__pull_request_times
[0m15:51:37.176555 [debug] [Thread-1  ]: Finished running node model.github.int_github__issue_assignees
[0m15:51:37.176974 [debug] [Thread-3  ]: Compiling model.github.int_github__issue_label_joined
[0m15:51:37.171675 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.github.int_github__issue_open_length"
[0m15:51:37.176006 [debug] [Thread-5  ]: finished collecting timing info
[0m15:51:37.177739 [debug] [Thread-2  ]: finished collecting timing info
[0m15:51:37.190830 [debug] [Thread-6  ]: Writing injected SQL for node "model.github.int_github__pull_request_times"
[0m15:51:37.196438 [debug] [Thread-3  ]: Writing injected SQL for node "model.github.int_github__issue_label_joined"
[0m15:51:37.196700 [debug] [Thread-4  ]: Began compiling node model.github.int_github__issue_open_length
[0m15:51:37.197199 [debug] [Thread-5  ]: Finished running node model.github.int_github__pull_request_reviewers
[0m15:51:37.197710 [debug] [Thread-2  ]: Finished running node model.github.int_github__issue_comments
[0m15:51:37.198166 [debug] [Thread-6  ]: finished collecting timing info
[0m15:51:37.198553 [debug] [Thread-4  ]: Compiling model.github.int_github__issue_open_length
[0m15:51:37.198815 [debug] [Thread-3  ]: finished collecting timing info
[0m15:51:37.206092 [debug] [Thread-3  ]: Finished running node model.github.int_github__issue_label_joined
[0m15:51:37.205558 [debug] [Thread-4  ]: Writing injected SQL for node "model.github.int_github__issue_open_length"
[0m15:51:37.199553 [debug] [Thread-6  ]: Finished running node model.github.int_github__pull_request_times
[0m15:51:37.206593 [debug] [Thread-8  ]: Began running node model.github.int_github__issue_labels
[0m15:51:37.207248 [debug] [Thread-4  ]: finished collecting timing info
[0m15:51:37.207606 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.github.int_github__issue_labels"
[0m15:51:37.208083 [debug] [Thread-4  ]: Finished running node model.github.int_github__issue_open_length
[0m15:51:37.208297 [debug] [Thread-8  ]: Began compiling node model.github.int_github__issue_labels
[0m15:51:37.208678 [debug] [Thread-8  ]: Compiling model.github.int_github__issue_labels
[0m15:51:37.219961 [debug] [Thread-8  ]: Writing injected SQL for node "model.github.int_github__issue_labels"
[0m15:51:37.220300 [debug] [Thread-8  ]: finished collecting timing info
[0m15:51:37.220761 [debug] [Thread-8  ]: Finished running node model.github.int_github__issue_labels
[0m15:51:37.221298 [debug] [Thread-1  ]: Began running node model.github.int_github__issue_joined
[0m15:51:37.221850 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.github.int_github__issue_joined"
[0m15:51:37.222053 [debug] [Thread-1  ]: Began compiling node model.github.int_github__issue_joined
[0m15:51:37.222217 [debug] [Thread-1  ]: Compiling model.github.int_github__issue_joined
[0m15:51:37.251633 [debug] [Thread-1  ]: Writing injected SQL for node "model.github.int_github__issue_joined"
[0m15:51:37.252016 [debug] [Thread-1  ]: finished collecting timing info
[0m15:51:37.252495 [debug] [Thread-1  ]: Finished running node model.github.int_github__issue_joined
[0m15:51:37.253110 [debug] [Thread-2  ]: Began running node model.github.github__issues
[0m15:51:37.253697 [info ] [Thread-2  ]: 1 of 6 START table model dbt_lauren.github__issues ............................. [RUN]
[0m15:51:37.254240 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github.github__issues"
[0m15:51:37.254508 [debug] [Thread-2  ]: Began compiling node model.github.github__issues
[0m15:51:37.254684 [debug] [Thread-2  ]: Compiling model.github.github__issues
[0m15:51:37.253380 [debug] [Thread-3  ]: Began running node model.github.github__pull_requests
[0m15:51:37.266199 [debug] [Thread-2  ]: Writing injected SQL for node "model.github.github__issues"
[0m15:51:37.266519 [info ] [Thread-3  ]: 2 of 6 START table model dbt_lauren.github__pull_requests ...................... [RUN]
[0m15:51:37.267198 [debug] [Thread-2  ]: finished collecting timing info
[0m15:51:37.267587 [debug] [Thread-2  ]: Began executing node model.github.github__issues
[0m15:51:37.274183 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github.github__pull_requests"
[0m15:51:37.291275 [debug] [Thread-3  ]: Began compiling node model.github.github__pull_requests
[0m15:51:37.292061 [debug] [Thread-3  ]: Compiling model.github.github__pull_requests
[0m15:51:37.312678 [debug] [Thread-2  ]: Writing runtime SQL for node "model.github.github__issues"
[0m15:51:37.319464 [debug] [Thread-3  ]: Writing injected SQL for node "model.github.github__pull_requests"
[0m15:51:37.321037 [debug] [Thread-3  ]: finished collecting timing info
[0m15:51:37.321547 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:51:37.321740 [debug] [Thread-3  ]: Began executing node model.github.github__pull_requests
[0m15:51:37.322041 [debug] [Thread-2  ]: On model.github.github__issues: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__issues"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__issues`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__int_github__issue_label_joined as (
with issue_label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_label`

), label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__label`

), joined as (

    select 
        issue_label.issue_id,
        label.label
    from issue_label
    left join label 
        on issue_label.label_id = label.label_id

)

select *
from joined
),  __dbt__cte__int_github__issue_labels as (
with issue_label as (
    select *
    from __dbt__cte__int_github__issue_label_joined
)

select
  issue_id,
  
    string_agg(label, ', ')

 as labels
from issue_label
group by issue_id
),  __dbt__cte__int_github__issue_assignees as (
with issue_assignee as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_assignee`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  issue_assignee.issue_id,
  
    string_agg(github_user.login_name, ', ')

 as assignees
from issue_assignee
join github_user on issue_assignee.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_open_length as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_closed_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history`
), 

close_events_stacked as (
    select   
      issue_id,
      created_at as updated_at,
      false as is_closed
    from issue -- required because issue_closed_history table does not have a line item for when the issue was opened
    union all
    select
      issue_id,
      updated_at,
      is_closed
    from issue_closed_history
), 

close_events_with_timestamps as (
  select
    issue_id,
    updated_at as valid_starting,
    coalesce(lead(updated_at) over (partition by issue_id order by updated_at), 
    current_timestamp
) as valid_until,
    is_closed
  from close_events_stacked
)

select
  issue_id,
  sum(datetime_diff(
        cast(valid_until as datetime),
        cast(valid_starting as datetime),
        second
    )) /60/60/24 as days_issue_open,
  count(*) - 1 as number_of_times_reopened
from close_events_with_timestamps
  where not is_closed
group by issue_id
),  __dbt__cte__int_github__issue_comments as (
with issue_comment as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_comment`
)

select
  issue_id,
  count(*) as number_of_comments
from issue_comment
group by issue_id
),  __dbt__cte__int_github__pull_request_times as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
), 

requested_reviewer_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history`
    where not removed
), 

issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_merged as (
    select
      issue_id,
      min(merged_at) as merged_at
      from `aec-students`.`dbt_lauren`.`stg_github__issue_merged`
    group by 1
), 

first_request_time as (
    select
      pull_request.issue_id,
      pull_request.pull_request_id,
      -- Finds the first review that is by the requested reviewer and is not a dismissal
      min(case when requested_reviewer_history.requested_id = pull_request_review.user_id then
          case when lower(pull_request_review.state) in ('commented', 'approved', 'changes_requested') 
                then pull_request_review.submitted_at end 
      else null end) as time_of_first_requested_reviewer_review,
      min(requested_reviewer_history.created_at) as time_of_first_request,
      min(pull_request_review.submitted_at) as time_of_first_review_post_request
    from pull_request
    join requested_reviewer_history on requested_reviewer_history.pull_request_id = pull_request.pull_request_id
    left join pull_request_review on pull_request_review.pull_request_id = pull_request.pull_request_id
      and pull_request_review.submitted_at > requested_reviewer_history.created_at
    group by 1, 2
)

select
  first_request_time.issue_id,
  issue_merged.merged_at,
  datetime_diff(
        cast(coalesce(time_of_first_review_post_request, 
    current_timestamp
) as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_first_review,
  datetime_diff(
        cast(least(
                            coalesce(time_of_first_requested_reviewer_review, 
    current_timestamp
),
                            coalesce(issue.closed_at, 
    current_timestamp
)) as datetime),
        cast(time_of_first_request as datetime),
        second
    ) / 60/60 as hours_request_review_to_first_action,
  datetime_diff(
        cast(merged_at as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_merge
from first_request_time
join issue on first_request_time.issue_id = issue.issue_id
left join issue_merged on first_request_time.issue_id = issue_merged.issue_id
),  __dbt__cte__int_github__pull_request_reviewers as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  pull_request_review.pull_request_id,
  
    string_agg(github_user.login_name, ', ')

 as reviewers,
  count(*) as number_of_reviews
from pull_request_review
left join github_user on pull_request_review.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_joined as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_labels as (
    select *
    from __dbt__cte__int_github__issue_labels
), 

repository_teams as (
    select 
    
      repository_id,
      full_name as repository
    from `aec-students`.`dbt_lauren`.`stg_github__repository`

    
), 

issue_assignees as (
    select *
    from __dbt__cte__int_github__issue_assignees
), 

issue_open_length as (
    select *
    from __dbt__cte__int_github__issue_open_length
), 

issue_comments as (
    select *
    from __dbt__cte__int_github__issue_comments
), 

creator as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
), 

pull_request_times as (
    select *
    from __dbt__cte__int_github__pull_request_times
), 

pull_request_reviewers as (
    select *
    from __dbt__cte__int_github__pull_request_reviewers
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
)

select
  issue.*,
  case 
    when issue.is_pull_request then 'https://github.com/' || repository_teams.repository || '/pull/' || issue.issue_number
    else 'https://github.com/' || repository_teams.repository || '/issues/' || issue.issue_number
  end as url_link,
  issue_open_length.days_issue_open,
  issue_open_length.number_of_times_reopened,
  labels.labels,
  issue_comments.number_of_comments,
  repository_teams.repository,
  
  issue_assignees.assignees,
  creator.login_name as creator_login_name,
  creator.name as creator_name,
  creator.company as creator_company,
  hours_request_review_to_first_review,
  hours_request_review_to_first_action,
  hours_request_review_to_merge,
  merged_at,
  reviewers,
  number_of_reviews
from issue
left join issue_labels as labels
  on issue.issue_id = labels.issue_id
join repository_teams
  on issue.repository_id = repository_teams.repository_id
left join issue_assignees
  on issue.issue_id = issue_assignees.issue_id
left join issue_open_length
  on issue.issue_id = issue_open_length.issue_id
left join issue_comments 
  on issue.issue_id = issue_comments.issue_id
left join creator 
  on issue.user_id = creator.user_id
left join pull_request
  on issue.issue_id = pull_request.issue_id
left join pull_request_times
  on issue.issue_id = pull_request_times.issue_id
left join pull_request_reviewers
  on pull_request.pull_request_id = pull_request_reviewers.pull_request_id
),issue_joined as (
    select *
    from __dbt__cte__int_github__issue_joined  
)

select
  issue_id,
  body,
  closed_at,
  created_at,
  is_locked,
  milestone_id,
  issue_number,
  is_pull_request,
  repository_id,
  state,
  title,
  updated_at,
  user_id,
  url_link,
  days_issue_open,
  number_of_times_reopened,
  labels,
  number_of_comments,
  repository,
  
  assignees,
  creator_login_name,
  creator_name,
  creator_company
from issue_joined
where not is_pull_request
  );
  
[0m15:51:37.325802 [debug] [Thread-3  ]: Writing runtime SQL for node "model.github.github__pull_requests"
[0m15:51:37.328609 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:51:37.329103 [debug] [Thread-3  ]: On model.github.github__pull_requests: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__pull_requests"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__pull_requests`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__int_github__issue_label_joined as (
with issue_label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_label`

), label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__label`

), joined as (

    select 
        issue_label.issue_id,
        label.label
    from issue_label
    left join label 
        on issue_label.label_id = label.label_id

)

select *
from joined
),  __dbt__cte__int_github__issue_labels as (
with issue_label as (
    select *
    from __dbt__cte__int_github__issue_label_joined
)

select
  issue_id,
  
    string_agg(label, ', ')

 as labels
from issue_label
group by issue_id
),  __dbt__cte__int_github__issue_assignees as (
with issue_assignee as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_assignee`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  issue_assignee.issue_id,
  
    string_agg(github_user.login_name, ', ')

 as assignees
from issue_assignee
join github_user on issue_assignee.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_open_length as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_closed_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history`
), 

close_events_stacked as (
    select   
      issue_id,
      created_at as updated_at,
      false as is_closed
    from issue -- required because issue_closed_history table does not have a line item for when the issue was opened
    union all
    select
      issue_id,
      updated_at,
      is_closed
    from issue_closed_history
), 

close_events_with_timestamps as (
  select
    issue_id,
    updated_at as valid_starting,
    coalesce(lead(updated_at) over (partition by issue_id order by updated_at), 
    current_timestamp
) as valid_until,
    is_closed
  from close_events_stacked
)

select
  issue_id,
  sum(datetime_diff(
        cast(valid_until as datetime),
        cast(valid_starting as datetime),
        second
    )) /60/60/24 as days_issue_open,
  count(*) - 1 as number_of_times_reopened
from close_events_with_timestamps
  where not is_closed
group by issue_id
),  __dbt__cte__int_github__issue_comments as (
with issue_comment as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_comment`
)

select
  issue_id,
  count(*) as number_of_comments
from issue_comment
group by issue_id
),  __dbt__cte__int_github__pull_request_times as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
), 

requested_reviewer_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history`
    where not removed
), 

issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_merged as (
    select
      issue_id,
      min(merged_at) as merged_at
      from `aec-students`.`dbt_lauren`.`stg_github__issue_merged`
    group by 1
), 

first_request_time as (
    select
      pull_request.issue_id,
      pull_request.pull_request_id,
      -- Finds the first review that is by the requested reviewer and is not a dismissal
      min(case when requested_reviewer_history.requested_id = pull_request_review.user_id then
          case when lower(pull_request_review.state) in ('commented', 'approved', 'changes_requested') 
                then pull_request_review.submitted_at end 
      else null end) as time_of_first_requested_reviewer_review,
      min(requested_reviewer_history.created_at) as time_of_first_request,
      min(pull_request_review.submitted_at) as time_of_first_review_post_request
    from pull_request
    join requested_reviewer_history on requested_reviewer_history.pull_request_id = pull_request.pull_request_id
    left join pull_request_review on pull_request_review.pull_request_id = pull_request.pull_request_id
      and pull_request_review.submitted_at > requested_reviewer_history.created_at
    group by 1, 2
)

select
  first_request_time.issue_id,
  issue_merged.merged_at,
  datetime_diff(
        cast(coalesce(time_of_first_review_post_request, 
    current_timestamp
) as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_first_review,
  datetime_diff(
        cast(least(
                            coalesce(time_of_first_requested_reviewer_review, 
    current_timestamp
),
                            coalesce(issue.closed_at, 
    current_timestamp
)) as datetime),
        cast(time_of_first_request as datetime),
        second
    ) / 60/60 as hours_request_review_to_first_action,
  datetime_diff(
        cast(merged_at as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_merge
from first_request_time
join issue on first_request_time.issue_id = issue.issue_id
left join issue_merged on first_request_time.issue_id = issue_merged.issue_id
),  __dbt__cte__int_github__pull_request_reviewers as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  pull_request_review.pull_request_id,
  
    string_agg(github_user.login_name, ', ')

 as reviewers,
  count(*) as number_of_reviews
from pull_request_review
left join github_user on pull_request_review.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_joined as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_labels as (
    select *
    from __dbt__cte__int_github__issue_labels
), 

repository_teams as (
    select 
    
      repository_id,
      full_name as repository
    from `aec-students`.`dbt_lauren`.`stg_github__repository`

    
), 

issue_assignees as (
    select *
    from __dbt__cte__int_github__issue_assignees
), 

issue_open_length as (
    select *
    from __dbt__cte__int_github__issue_open_length
), 

issue_comments as (
    select *
    from __dbt__cte__int_github__issue_comments
), 

creator as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
), 

pull_request_times as (
    select *
    from __dbt__cte__int_github__pull_request_times
), 

pull_request_reviewers as (
    select *
    from __dbt__cte__int_github__pull_request_reviewers
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
)

select
  issue.*,
  case 
    when issue.is_pull_request then 'https://github.com/' || repository_teams.repository || '/pull/' || issue.issue_number
    else 'https://github.com/' || repository_teams.repository || '/issues/' || issue.issue_number
  end as url_link,
  issue_open_length.days_issue_open,
  issue_open_length.number_of_times_reopened,
  labels.labels,
  issue_comments.number_of_comments,
  repository_teams.repository,
  
  issue_assignees.assignees,
  creator.login_name as creator_login_name,
  creator.name as creator_name,
  creator.company as creator_company,
  hours_request_review_to_first_review,
  hours_request_review_to_first_action,
  hours_request_review_to_merge,
  merged_at,
  reviewers,
  number_of_reviews
from issue
left join issue_labels as labels
  on issue.issue_id = labels.issue_id
join repository_teams
  on issue.repository_id = repository_teams.repository_id
left join issue_assignees
  on issue.issue_id = issue_assignees.issue_id
left join issue_open_length
  on issue.issue_id = issue_open_length.issue_id
left join issue_comments 
  on issue.issue_id = issue_comments.issue_id
left join creator 
  on issue.user_id = creator.user_id
left join pull_request
  on issue.issue_id = pull_request.issue_id
left join pull_request_times
  on issue.issue_id = pull_request_times.issue_id
left join pull_request_reviewers
  on pull_request.pull_request_id = pull_request_reviewers.pull_request_id
),issue_joined as (
    select *
    from __dbt__cte__int_github__issue_joined  
)

select
  *
from issue_joined
where is_pull_request
  );
  
[0m15:51:37.822787 [debug] [Thread-3  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__pull_requests"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__pull_requests`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__int_github__issue_label_joined as (
with issue_label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_label`

), label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__label`

), joined as (

    select 
        issue_label.issue_id,
        label.label
    from issue_label
    left join label 
        on issue_label.label_id = label.label_id

)

select *
from joined
),  __dbt__cte__int_github__issue_labels as (
with issue_label as (
    select *
    from __dbt__cte__int_github__issue_label_joined
)

select
  issue_id,
  
    string_agg(label, ', ')

 as labels
from issue_label
group by issue_id
),  __dbt__cte__int_github__issue_assignees as (
with issue_assignee as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_assignee`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  issue_assignee.issue_id,
  
    string_agg(github_user.login_name, ', ')

 as assignees
from issue_assignee
join github_user on issue_assignee.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_open_length as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_closed_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history`
), 

close_events_stacked as (
    select   
      issue_id,
      created_at as updated_at,
      false as is_closed
    from issue -- required because issue_closed_history table does not have a line item for when the issue was opened
    union all
    select
      issue_id,
      updated_at,
      is_closed
    from issue_closed_history
), 

close_events_with_timestamps as (
  select
    issue_id,
    updated_at as valid_starting,
    coalesce(lead(updated_at) over (partition by issue_id order by updated_at), 
    current_timestamp
) as valid_until,
    is_closed
  from close_events_stacked
)

select
  issue_id,
  sum(datetime_diff(
        cast(valid_until as datetime),
        cast(valid_starting as datetime),
        second
    )) /60/60/24 as days_issue_open,
  count(*) - 1 as number_of_times_reopened
from close_events_with_timestamps
  where not is_closed
group by issue_id
),  __dbt__cte__int_github__issue_comments as (
with issue_comment as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_comment`
)

select
  issue_id,
  count(*) as number_of_comments
from issue_comment
group by issue_id
),  __dbt__cte__int_github__pull_request_times as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
), 

requested_reviewer_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history`
    where not removed
), 

issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_merged as (
    select
      issue_id,
      min(merged_at) as merged_at
      from `aec-students`.`dbt_lauren`.`stg_github__issue_merged`
    group by 1
), 

first_request_time as (
    select
      pull_request.issue_id,
      pull_request.pull_request_id,
      -- Finds the first review that is by the requested reviewer and is not a dismissal
      min(case when requested_reviewer_history.requested_id = pull_request_review.user_id then
          case when lower(pull_request_review.state) in ('commented', 'approved', 'changes_requested') 
                then pull_request_review.submitted_at end 
      else null end) as time_of_first_requested_reviewer_review,
      min(requested_reviewer_history.created_at) as time_of_first_request,
      min(pull_request_review.submitted_at) as time_of_first_review_post_request
    from pull_request
    join requested_reviewer_history on requested_reviewer_history.pull_request_id = pull_request.pull_request_id
    left join pull_request_review on pull_request_review.pull_request_id = pull_request.pull_request_id
      and pull_request_review.submitted_at > requested_reviewer_history.created_at
    group by 1, 2
)

select
  first_request_time.issue_id,
  issue_merged.merged_at,
  datetime_diff(
        cast(coalesce(time_of_first_review_post_request, 
    current_timestamp
) as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_first_review,
  datetime_diff(
        cast(least(
                            coalesce(time_of_first_requested_reviewer_review, 
    current_timestamp
),
                            coalesce(issue.closed_at, 
    current_timestamp
)) as datetime),
        cast(time_of_first_request as datetime),
        second
    ) / 60/60 as hours_request_review_to_first_action,
  datetime_diff(
        cast(merged_at as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_merge
from first_request_time
join issue on first_request_time.issue_id = issue.issue_id
left join issue_merged on first_request_time.issue_id = issue_merged.issue_id
),  __dbt__cte__int_github__pull_request_reviewers as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  pull_request_review.pull_request_id,
  
    string_agg(github_user.login_name, ', ')

 as reviewers,
  count(*) as number_of_reviews
from pull_request_review
left join github_user on pull_request_review.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_joined as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_labels as (
    select *
    from __dbt__cte__int_github__issue_labels
), 

repository_teams as (
    select 
    
      repository_id,
      full_name as repository
    from `aec-students`.`dbt_lauren`.`stg_github__repository`

    
), 

issue_assignees as (
    select *
    from __dbt__cte__int_github__issue_assignees
), 

issue_open_length as (
    select *
    from __dbt__cte__int_github__issue_open_length
), 

issue_comments as (
    select *
    from __dbt__cte__int_github__issue_comments
), 

creator as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
), 

pull_request_times as (
    select *
    from __dbt__cte__int_github__pull_request_times
), 

pull_request_reviewers as (
    select *
    from __dbt__cte__int_github__pull_request_reviewers
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
)

select
  issue.*,
  case 
    when issue.is_pull_request then 'https://github.com/' || repository_teams.repository || '/pull/' || issue.issue_number
    else 'https://github.com/' || repository_teams.repository || '/issues/' || issue.issue_number
  end as url_link,
  issue_open_length.days_issue_open,
  issue_open_length.number_of_times_reopened,
  labels.labels,
  issue_comments.number_of_comments,
  repository_teams.repository,
  
  issue_assignees.assignees,
  creator.login_name as creator_login_name,
  creator.name as creator_name,
  creator.company as creator_company,
  hours_request_review_to_first_review,
  hours_request_review_to_first_action,
  hours_request_review_to_merge,
  merged_at,
  reviewers,
  number_of_reviews
from issue
left join issue_labels as labels
  on issue.issue_id = labels.issue_id
join repository_teams
  on issue.repository_id = repository_teams.repository_id
left join issue_assignees
  on issue.issue_id = issue_assignees.issue_id
left join issue_open_length
  on issue.issue_id = issue_open_length.issue_id
left join issue_comments 
  on issue.issue_id = issue_comments.issue_id
left join creator 
  on issue.user_id = creator.user_id
left join pull_request
  on issue.issue_id = pull_request.issue_id
left join pull_request_times
  on issue.issue_id = pull_request_times.issue_id
left join pull_request_reviewers
  on pull_request.pull_request_id = pull_request_reviewers.pull_request_id
),issue_joined as (
    select *
    from __dbt__cte__int_github__issue_joined  
)

select
  *
from issue_joined
where is_pull_request
  );
  
[0m15:51:37.823155 [debug] [Thread-3  ]: BigQuery adapter: 404 Not found: Table aec-students:dbt_lauren.stg_github__issue was not found in location US

Location: US
Job ID: 3a4b7d01-bfb9-4fac-b531-4b544e159da5

[0m15:51:37.823556 [debug] [Thread-3  ]: finished collecting timing info
[0m15:51:37.824161 [debug] [Thread-3  ]: Runtime Error in model github__pull_requests (models/github__pull_requests.sql)
  404 Not found: Table aec-students:dbt_lauren.stg_github__issue was not found in location US
  
  Location: US
  Job ID: 3a4b7d01-bfb9-4fac-b531-4b544e159da5
  
[0m15:51:37.824528 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0df5a97b-1174-4fb8-83b2-c9c36568cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59b93c70>]}
[0m15:51:37.824968 [error] [Thread-3  ]: 2 of 6 ERROR creating table model dbt_lauren.github__pull_requests ............. [[31mERROR[0m in 0.55s]
[0m15:51:37.825873 [debug] [Thread-3  ]: Finished running node model.github.github__pull_requests
[0m15:51:37.874078 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__issues"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__issues`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__int_github__issue_label_joined as (
with issue_label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_label`

), label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__label`

), joined as (

    select 
        issue_label.issue_id,
        label.label
    from issue_label
    left join label 
        on issue_label.label_id = label.label_id

)

select *
from joined
),  __dbt__cte__int_github__issue_labels as (
with issue_label as (
    select *
    from __dbt__cte__int_github__issue_label_joined
)

select
  issue_id,
  
    string_agg(label, ', ')

 as labels
from issue_label
group by issue_id
),  __dbt__cte__int_github__issue_assignees as (
with issue_assignee as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_assignee`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  issue_assignee.issue_id,
  
    string_agg(github_user.login_name, ', ')

 as assignees
from issue_assignee
join github_user on issue_assignee.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_open_length as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_closed_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history`
), 

close_events_stacked as (
    select   
      issue_id,
      created_at as updated_at,
      false as is_closed
    from issue -- required because issue_closed_history table does not have a line item for when the issue was opened
    union all
    select
      issue_id,
      updated_at,
      is_closed
    from issue_closed_history
), 

close_events_with_timestamps as (
  select
    issue_id,
    updated_at as valid_starting,
    coalesce(lead(updated_at) over (partition by issue_id order by updated_at), 
    current_timestamp
) as valid_until,
    is_closed
  from close_events_stacked
)

select
  issue_id,
  sum(datetime_diff(
        cast(valid_until as datetime),
        cast(valid_starting as datetime),
        second
    )) /60/60/24 as days_issue_open,
  count(*) - 1 as number_of_times_reopened
from close_events_with_timestamps
  where not is_closed
group by issue_id
),  __dbt__cte__int_github__issue_comments as (
with issue_comment as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_comment`
)

select
  issue_id,
  count(*) as number_of_comments
from issue_comment
group by issue_id
),  __dbt__cte__int_github__pull_request_times as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
), 

requested_reviewer_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history`
    where not removed
), 

issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_merged as (
    select
      issue_id,
      min(merged_at) as merged_at
      from `aec-students`.`dbt_lauren`.`stg_github__issue_merged`
    group by 1
), 

first_request_time as (
    select
      pull_request.issue_id,
      pull_request.pull_request_id,
      -- Finds the first review that is by the requested reviewer and is not a dismissal
      min(case when requested_reviewer_history.requested_id = pull_request_review.user_id then
          case when lower(pull_request_review.state) in ('commented', 'approved', 'changes_requested') 
                then pull_request_review.submitted_at end 
      else null end) as time_of_first_requested_reviewer_review,
      min(requested_reviewer_history.created_at) as time_of_first_request,
      min(pull_request_review.submitted_at) as time_of_first_review_post_request
    from pull_request
    join requested_reviewer_history on requested_reviewer_history.pull_request_id = pull_request.pull_request_id
    left join pull_request_review on pull_request_review.pull_request_id = pull_request.pull_request_id
      and pull_request_review.submitted_at > requested_reviewer_history.created_at
    group by 1, 2
)

select
  first_request_time.issue_id,
  issue_merged.merged_at,
  datetime_diff(
        cast(coalesce(time_of_first_review_post_request, 
    current_timestamp
) as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_first_review,
  datetime_diff(
        cast(least(
                            coalesce(time_of_first_requested_reviewer_review, 
    current_timestamp
),
                            coalesce(issue.closed_at, 
    current_timestamp
)) as datetime),
        cast(time_of_first_request as datetime),
        second
    ) / 60/60 as hours_request_review_to_first_action,
  datetime_diff(
        cast(merged_at as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_merge
from first_request_time
join issue on first_request_time.issue_id = issue.issue_id
left join issue_merged on first_request_time.issue_id = issue_merged.issue_id
),  __dbt__cte__int_github__pull_request_reviewers as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  pull_request_review.pull_request_id,
  
    string_agg(github_user.login_name, ', ')

 as reviewers,
  count(*) as number_of_reviews
from pull_request_review
left join github_user on pull_request_review.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_joined as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_labels as (
    select *
    from __dbt__cte__int_github__issue_labels
), 

repository_teams as (
    select 
    
      repository_id,
      full_name as repository
    from `aec-students`.`dbt_lauren`.`stg_github__repository`

    
), 

issue_assignees as (
    select *
    from __dbt__cte__int_github__issue_assignees
), 

issue_open_length as (
    select *
    from __dbt__cte__int_github__issue_open_length
), 

issue_comments as (
    select *
    from __dbt__cte__int_github__issue_comments
), 

creator as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
), 

pull_request_times as (
    select *
    from __dbt__cte__int_github__pull_request_times
), 

pull_request_reviewers as (
    select *
    from __dbt__cte__int_github__pull_request_reviewers
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
)

select
  issue.*,
  case 
    when issue.is_pull_request then 'https://github.com/' || repository_teams.repository || '/pull/' || issue.issue_number
    else 'https://github.com/' || repository_teams.repository || '/issues/' || issue.issue_number
  end as url_link,
  issue_open_length.days_issue_open,
  issue_open_length.number_of_times_reopened,
  labels.labels,
  issue_comments.number_of_comments,
  repository_teams.repository,
  
  issue_assignees.assignees,
  creator.login_name as creator_login_name,
  creator.name as creator_name,
  creator.company as creator_company,
  hours_request_review_to_first_review,
  hours_request_review_to_first_action,
  hours_request_review_to_merge,
  merged_at,
  reviewers,
  number_of_reviews
from issue
left join issue_labels as labels
  on issue.issue_id = labels.issue_id
join repository_teams
  on issue.repository_id = repository_teams.repository_id
left join issue_assignees
  on issue.issue_id = issue_assignees.issue_id
left join issue_open_length
  on issue.issue_id = issue_open_length.issue_id
left join issue_comments 
  on issue.issue_id = issue_comments.issue_id
left join creator 
  on issue.user_id = creator.user_id
left join pull_request
  on issue.issue_id = pull_request.issue_id
left join pull_request_times
  on issue.issue_id = pull_request_times.issue_id
left join pull_request_reviewers
  on pull_request.pull_request_id = pull_request_reviewers.pull_request_id
),issue_joined as (
    select *
    from __dbt__cte__int_github__issue_joined  
)

select
  issue_id,
  body,
  closed_at,
  created_at,
  is_locked,
  milestone_id,
  issue_number,
  is_pull_request,
  repository_id,
  state,
  title,
  updated_at,
  user_id,
  url_link,
  days_issue_open,
  number_of_times_reopened,
  labels,
  number_of_comments,
  repository,
  
  assignees,
  creator_login_name,
  creator_name,
  creator_company
from issue_joined
where not is_pull_request
  );
  
[0m15:51:37.874328 [debug] [Thread-2  ]: BigQuery adapter: 404 Not found: Table aec-students:dbt_lauren.stg_github__issue was not found in location US

Location: US
Job ID: 6a258970-bdb0-4544-be9a-70eecf966b17

[0m15:51:37.874693 [debug] [Thread-2  ]: finished collecting timing info
[0m15:51:37.875069 [debug] [Thread-2  ]: Runtime Error in model github__issues (models/github__issues.sql)
  404 Not found: Table aec-students:dbt_lauren.stg_github__issue was not found in location US
  
  Location: US
  Job ID: 6a258970-bdb0-4544-be9a-70eecf966b17
  
[0m15:51:37.875360 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0df5a97b-1174-4fb8-83b2-c9c36568cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f59b75280>]}
[0m15:51:37.875767 [error] [Thread-2  ]: 1 of 6 ERROR creating table model dbt_lauren.github__issues .................... [[31mERROR[0m in 0.62s]
[0m15:51:37.876417 [debug] [Thread-2  ]: Finished running node model.github.github__issues
[0m15:51:37.877272 [debug] [Thread-6  ]: Began running node model.github.github__daily_metrics
[0m15:51:37.877583 [info ] [Thread-6  ]: 3 of 6 SKIP relation dbt_lauren.github__daily_metrics .......................... [[33mSKIP[0m]
[0m15:51:37.878167 [debug] [Thread-6  ]: Finished running node model.github.github__daily_metrics
[0m15:51:37.880592 [debug] [Thread-8  ]: Began running node model.github.github__monthly_metrics
[0m15:51:37.880892 [info ] [Thread-8  ]: 4 of 6 SKIP relation dbt_lauren.github__monthly_metrics ........................ [[33mSKIP[0m]
[0m15:51:37.881420 [debug] [Thread-8  ]: Finished running node model.github.github__monthly_metrics
[0m15:51:37.881776 [debug] [Thread-8  ]: Began running node model.github.github__quarterly_metrics
[0m15:51:37.881995 [info ] [Thread-8  ]: 5 of 6 SKIP relation dbt_lauren.github__quarterly_metrics ...................... [[33mSKIP[0m]
[0m15:51:37.882488 [debug] [Thread-8  ]: Finished running node model.github.github__quarterly_metrics
[0m15:51:37.882820 [debug] [Thread-8  ]: Began running node model.github.github__weekly_metrics
[0m15:51:37.883006 [info ] [Thread-8  ]: 6 of 6 SKIP relation dbt_lauren.github__weekly_metrics ......................... [[33mSKIP[0m]
[0m15:51:37.883480 [debug] [Thread-8  ]: Finished running node model.github.github__weekly_metrics
[0m15:51:37.885382 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:51:37.885879 [info ] [MainThread]: 
[0m15:51:37.886228 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m15:51:37.886731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:37.886993 [debug] [MainThread]: Connection 'model.github.int_github__issue_joined' was properly closed.
[0m15:51:37.887167 [debug] [MainThread]: Connection 'model.github.github__issues' was properly closed.
[0m15:51:37.887335 [debug] [MainThread]: Connection 'model.github.int_github__pull_request_reviewers' was properly closed.
[0m15:51:37.887499 [debug] [MainThread]: Connection 'model.github.int_github__pull_request_times' was properly closed.
[0m15:51:37.887666 [debug] [MainThread]: Connection 'model.github.github__pull_requests' was properly closed.
[0m15:51:37.887832 [debug] [MainThread]: Connection 'model.github.int_github__issue_open_length' was properly closed.
[0m15:51:37.888169 [debug] [MainThread]: Connection 'model.github.int_github__issue_labels' was properly closed.
[0m15:51:37.909481 [info ] [MainThread]: 
[0m15:51:37.909831 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:51:37.910305 [info ] [MainThread]: 
[0m15:51:37.910721 [error] [MainThread]: [33mRuntime Error in model github__pull_requests (models/github__pull_requests.sql)[0m
[0m15:51:37.911132 [error] [MainThread]:   404 Not found: Table aec-students:dbt_lauren.stg_github__issue was not found in location US
[0m15:51:37.911581 [error] [MainThread]:   
[0m15:51:37.912171 [error] [MainThread]:   Location: US
[0m15:51:37.912629 [error] [MainThread]:   Job ID: 3a4b7d01-bfb9-4fac-b531-4b544e159da5
[0m15:51:37.913076 [error] [MainThread]:   
[0m15:51:37.913550 [info ] [MainThread]: 
[0m15:51:37.914086 [error] [MainThread]: [33mRuntime Error in model github__issues (models/github__issues.sql)[0m
[0m15:51:37.914555 [error] [MainThread]:   404 Not found: Table aec-students:dbt_lauren.stg_github__issue was not found in location US
[0m15:51:37.915035 [error] [MainThread]:   
[0m15:51:37.915495 [error] [MainThread]:   Location: US
[0m15:51:37.915968 [error] [MainThread]:   Job ID: 6a258970-bdb0-4544-be9a-70eecf966b17
[0m15:51:37.916460 [error] [MainThread]:   
[0m15:51:37.916957 [info ] [MainThread]: 
[0m15:51:37.917481 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m15:51:37.918125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f593e2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f593e2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f595a2250>]}


============================== 2022-08-15 15:52:01.879469 | 4a8265d5-d3e9-40ed-9a81-f5276e561895 ==============================
[0m15:52:01.879496 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:52:01.880368 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['github_source'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:52:01.880714 [debug] [MainThread]: Tracking: tracking
[0m15:52:01.894278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dc328c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dc328f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dc328310>]}
[0m15:52:02.136764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:02.137155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:02.139316 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:52:02.151524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7ede0d0>]}
[0m15:52:02.178596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dc24dfa0>]}
[0m15:52:02.179038 [info ] [MainThread]: Found 56 models, 43 tests, 0 snapshots, 0 analyses, 622 macros, 0 operations, 0 seed files, 20 sources, 0 exposures, 0 metrics
[0m15:52:02.179424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dc241040>]}
[0m15:52:02.184662 [info ] [MainThread]: 
[0m15:52:02.185587 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:52:02.190497 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m15:52:02.190903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:03.217185 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m15:52:03.217751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:03.490205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dc328af0>]}
[0m15:52:03.490970 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:52:03.493652 [info ] [MainThread]: 
[0m15:52:03.510640 [debug] [Thread-1  ]: Began running node model.github_source.stg_github__issue_assignee_tmp
[0m15:52:03.511191 [info ] [Thread-1  ]: 1 of 26 START view model dbt_lauren.stg_github__issue_assignee_tmp ............. [RUN]
[0m15:52:03.511792 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_assignee_tmp"
[0m15:52:03.512024 [debug] [Thread-1  ]: Began compiling node model.github_source.stg_github__issue_assignee_tmp
[0m15:52:03.512239 [debug] [Thread-1  ]: Compiling model.github_source.stg_github__issue_assignee_tmp
[0m15:52:03.518340 [debug] [Thread-1  ]: Writing injected SQL for node "model.github_source.stg_github__issue_assignee_tmp"
[0m15:52:03.518591 [debug] [Thread-2  ]: Began running node model.github_source.stg_github__issue_closed_history_tmp
[0m15:52:03.518819 [debug] [Thread-3  ]: Began running node model.github_source.stg_github__issue_comment_tmp
[0m15:52:03.519011 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__issue_label_tmp
[0m15:52:03.519313 [debug] [Thread-5  ]: Began running node model.github_source.stg_github__issue_merged_tmp
[0m15:52:03.521736 [info ] [Thread-5  ]: 5 of 26 START view model dbt_lauren.stg_github__issue_merged_tmp ............... [RUN]
[0m15:52:03.522323 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_merged_tmp"
[0m15:52:03.522616 [debug] [Thread-5  ]: Began compiling node model.github_source.stg_github__issue_merged_tmp
[0m15:52:03.522891 [debug] [Thread-5  ]: Compiling model.github_source.stg_github__issue_merged_tmp
[0m15:52:03.520063 [debug] [Thread-8  ]: Began running node model.github_source.stg_github__pull_request_review_tmp
[0m15:52:03.521109 [info ] [Thread-3  ]: 3 of 26 START view model dbt_lauren.stg_github__issue_comment_tmp .............. [RUN]
[0m15:52:03.528643 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_comment_tmp"
[0m15:52:03.528885 [debug] [Thread-3  ]: Began compiling node model.github_source.stg_github__issue_comment_tmp
[0m15:52:03.519799 [debug] [Thread-7  ]: Began running node model.github_source.stg_github__label_tmp
[0m15:52:03.529364 [info ] [Thread-7  ]: 7 of 26 START view model dbt_lauren.stg_github__label_tmp ...................... [RUN]
[0m15:52:03.529906 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.github_source.stg_github__label_tmp"
[0m15:52:03.527642 [debug] [Thread-5  ]: Writing injected SQL for node "model.github_source.stg_github__issue_merged_tmp"
[0m15:52:03.527997 [info ] [Thread-8  ]: 8 of 26 START view model dbt_lauren.stg_github__pull_request_review_tmp ........ [RUN]
[0m15:52:03.529060 [debug] [Thread-3  ]: Compiling model.github_source.stg_github__issue_comment_tmp
[0m15:52:03.521442 [info ] [Thread-4  ]: 4 of 26 START view model dbt_lauren.stg_github__issue_label_tmp ................ [RUN]
[0m15:52:03.520868 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:03.530133 [debug] [Thread-7  ]: Began compiling node model.github_source.stg_github__label_tmp
[0m15:52:03.542953 [debug] [Thread-7  ]: Compiling model.github_source.stg_github__label_tmp
[0m15:52:03.520505 [info ] [Thread-2  ]: 2 of 26 START view model dbt_lauren.stg_github__issue_closed_history_tmp ....... [RUN]
[0m15:52:03.531463 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.github_source.stg_github__pull_request_review_tmp"
[0m15:52:03.547299 [debug] [Thread-8  ]: Began compiling node model.github_source.stg_github__pull_request_review_tmp
[0m15:52:03.540775 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:03.542400 [debug] [Thread-3  ]: Writing injected SQL for node "model.github_source.stg_github__issue_comment_tmp"
[0m15:52:03.542718 [debug] [Thread-1  ]: Began executing node model.github_source.stg_github__issue_assignee_tmp
[0m15:52:03.519561 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__issue_tmp
[0m15:52:03.546782 [debug] [Thread-7  ]: Writing injected SQL for node "model.github_source.stg_github__label_tmp"
[0m15:52:03.534536 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_label_tmp"
[0m15:52:03.547791 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:52:03.547973 [debug] [Thread-8  ]: Compiling model.github_source.stg_github__pull_request_review_tmp
[0m15:52:03.548239 [debug] [Thread-5  ]: Began executing node model.github_source.stg_github__issue_merged_tmp
[0m15:52:03.592257 [debug] [Thread-5  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_merged_tmp"
[0m15:52:03.575158 [info ] [Thread-6  ]: 6 of 26 START view model dbt_lauren.stg_github__issue_tmp ...................... [RUN]
[0m15:52:03.582734 [debug] [Thread-1  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_assignee_tmp"
[0m15:52:03.583200 [debug] [Thread-4  ]: Began compiling node model.github_source.stg_github__issue_label_tmp
[0m15:52:03.583608 [debug] [Thread-2  ]: Began compiling node model.github_source.stg_github__issue_closed_history_tmp
[0m15:52:03.594466 [debug] [Thread-2  ]: Compiling model.github_source.stg_github__issue_closed_history_tmp
[0m15:52:03.587731 [debug] [Thread-8  ]: Writing injected SQL for node "model.github_source.stg_github__pull_request_review_tmp"
[0m15:52:03.548629 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:03.603524 [debug] [Thread-3  ]: Began executing node model.github_source.stg_github__issue_comment_tmp
[0m15:52:03.593716 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_tmp"
[0m15:52:03.594221 [debug] [Thread-4  ]: Compiling model.github_source.stg_github__issue_label_tmp
[0m15:52:03.583782 [debug] [Thread-7  ]: finished collecting timing info
[0m15:52:03.602009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:52:03.602873 [debug] [Thread-2  ]: Writing injected SQL for node "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:52:03.593346 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m15:52:03.607460 [debug] [Thread-3  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_comment_tmp"
[0m15:52:03.607655 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:03.607876 [debug] [Thread-6  ]: Began compiling node model.github_source.stg_github__issue_tmp
[0m15:52:03.611665 [debug] [Thread-4  ]: Writing injected SQL for node "model.github_source.stg_github__issue_label_tmp"
[0m15:52:03.611934 [debug] [Thread-7  ]: Began executing node model.github_source.stg_github__label_tmp
[0m15:52:03.612238 [debug] [Thread-1  ]: On model.github_source.stg_github__issue_assignee_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_assignee_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_assignee_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_assignee`;


[0m15:52:03.612646 [debug] [Thread-5  ]: On model.github_source.stg_github__issue_merged_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_merged_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_merged_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_merged`;


[0m15:52:03.612969 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:03.621349 [debug] [Thread-2  ]: Began executing node model.github_source.stg_github__issue_closed_history_tmp
[0m15:52:03.613414 [debug] [Thread-8  ]: Began executing node model.github_source.stg_github__pull_request_review_tmp
[0m15:52:03.613801 [debug] [Thread-6  ]: Compiling model.github_source.stg_github__issue_tmp
[0m15:52:03.617540 [debug] [Thread-7  ]: Writing runtime SQL for node "model.github_source.stg_github__label_tmp"
[0m15:52:03.613594 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:52:03.625813 [debug] [Thread-2  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:52:03.626028 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:03.696300 [debug] [Thread-4  ]: Began executing node model.github_source.stg_github__issue_label_tmp
[0m15:52:03.694962 [debug] [Thread-6  ]: Writing injected SQL for node "model.github_source.stg_github__issue_tmp"
[0m15:52:03.695598 [debug] [Thread-3  ]: On model.github_source.stg_github__issue_comment_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_comment_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_comment_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_comment`;


[0m15:52:03.690190 [debug] [Thread-8  ]: Writing runtime SQL for node "model.github_source.stg_github__pull_request_review_tmp"
[0m15:52:03.703143 [debug] [Thread-4  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_label_tmp"
[0m15:52:03.703368 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:52:03.709209 [debug] [Thread-2  ]: On model.github_source.stg_github__issue_closed_history_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_closed_history_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_closed_history`;


[0m15:52:03.708045 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m15:52:03.708651 [debug] [Thread-6  ]: finished collecting timing info
[0m15:52:03.703686 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m15:52:03.711726 [debug] [Thread-8  ]: On model.github_source.stg_github__pull_request_review_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_review_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__pull_request_review_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`pull_request_review`;


[0m15:52:03.713189 [debug] [Thread-7  ]: On model.github_source.stg_github__label_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__label_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__label_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`label`;


[0m15:52:03.712837 [debug] [Thread-6  ]: Began executing node model.github_source.stg_github__issue_tmp
[0m15:52:03.724905 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:52:03.725327 [debug] [Thread-4  ]: On model.github_source.stg_github__issue_label_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_label_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_label_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_label`;


[0m15:52:03.729036 [debug] [Thread-6  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_tmp"
[0m15:52:03.733040 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m15:52:03.733463 [debug] [Thread-6  ]: On model.github_source.stg_github__issue_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__issue_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue`;


[0m15:52:05.054781 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:05.057369 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:05.058090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7e6daf0>]}
[0m15:52:05.060395 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:05.060853 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7c76bb0>]}
[0m15:52:05.061805 [info ] [Thread-1  ]: 1 of 26 OK created view model dbt_lauren.stg_github__issue_assignee_tmp ........ [[32mOK[0m in 1.55s]
[0m15:52:05.062549 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7c769d0>]}
[0m15:52:05.064720 [debug] [Thread-6  ]: finished collecting timing info
[0m15:52:05.065141 [info ] [Thread-3  ]: 3 of 26 OK created view model dbt_lauren.stg_github__issue_comment_tmp ......... [[32mOK[0m in 1.53s]
[0m15:52:05.065739 [debug] [Thread-1  ]: Finished running node model.github_source.stg_github__issue_assignee_tmp
[0m15:52:05.074679 [debug] [Thread-1  ]: Began running node model.github_source.stg_github__pull_request_tmp
[0m15:52:05.076547 [info ] [Thread-1  ]: 9 of 26 START view model dbt_lauren.stg_github__pull_request_tmp ............... [RUN]
[0m15:52:05.074054 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7c76670>]}
[0m15:52:05.073085 [debug] [Thread-7  ]: finished collecting timing info
[0m15:52:05.079229 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7c76490>]}
[0m15:52:05.073572 [info ] [Thread-4  ]: 4 of 26 OK created view model dbt_lauren.stg_github__issue_label_tmp ........... [[32mOK[0m in 1.53s]
[0m15:52:05.077673 [info ] [Thread-6  ]: 6 of 26 OK created view model dbt_lauren.stg_github__issue_tmp ................. [[32mOK[0m in 1.48s]
[0m15:52:05.078329 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.github_source.stg_github__pull_request_tmp"
[0m15:52:05.079753 [info ] [Thread-7  ]: 7 of 26 OK created view model dbt_lauren.stg_github__label_tmp ................. [[32mOK[0m in 1.55s]
[0m15:52:05.076172 [debug] [Thread-3  ]: Finished running node model.github_source.stg_github__issue_comment_tmp
[0m15:52:05.080421 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__issue_label_tmp
[0m15:52:05.081188 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__issue_tmp
[0m15:52:05.087423 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__team_tmp
[0m15:52:05.085347 [debug] [Thread-7  ]: Finished running node model.github_source.stg_github__label_tmp
[0m15:52:05.085672 [debug] [Thread-3  ]: Began running node model.github_source.stg_github__repository_tmp
[0m15:52:05.086194 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:52:05.083945 [debug] [Thread-1  ]: Began compiling node model.github_source.stg_github__pull_request_tmp
[0m15:52:05.089484 [debug] [Thread-1  ]: Compiling model.github_source.stg_github__pull_request_tmp
[0m15:52:05.088408 [debug] [Thread-7  ]: Began running node model.github_source.stg_github__user_tmp
[0m15:52:05.088898 [info ] [Thread-3  ]: 10 of 26 START view model dbt_lauren.stg_github__repository_tmp ................ [RUN]
[0m15:52:05.089214 [info ] [Thread-4  ]: 11 of 26 START view model dbt_lauren.stg_github__requested_reviewer_history_tmp  [RUN]
[0m15:52:05.093697 [debug] [Thread-1  ]: Writing injected SQL for node "model.github_source.stg_github__pull_request_tmp"
[0m15:52:05.088062 [info ] [Thread-6  ]: 12 of 26 START view model dbt_lauren.stg_github__team_tmp ...................... [RUN]
[0m15:52:05.094090 [info ] [Thread-7  ]: 13 of 26 START view model dbt_lauren.stg_github__user_tmp ...................... [RUN]
[0m15:52:05.094912 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github_source.stg_github__repository_tmp"
[0m15:52:05.095970 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:52:05.096950 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.github_source.stg_github__team_tmp"
[0m15:52:05.101570 [debug] [Thread-6  ]: Began compiling node model.github_source.stg_github__team_tmp
[0m15:52:05.102056 [debug] [Thread-6  ]: Compiling model.github_source.stg_github__team_tmp
[0m15:52:05.101145 [debug] [Thread-4  ]: Began compiling node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:52:05.099833 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.github_source.stg_github__user_tmp"
[0m15:52:05.101865 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:05.100096 [debug] [Thread-3  ]: Began compiling node model.github_source.stg_github__repository_tmp
[0m15:52:05.107341 [debug] [Thread-3  ]: Compiling model.github_source.stg_github__repository_tmp
[0m15:52:05.106535 [debug] [Thread-4  ]: Compiling model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:52:05.106819 [debug] [Thread-7  ]: Began compiling node model.github_source.stg_github__user_tmp
[0m15:52:05.107063 [debug] [Thread-1  ]: Began executing node model.github_source.stg_github__pull_request_tmp
[0m15:52:05.106262 [debug] [Thread-6  ]: Writing injected SQL for node "model.github_source.stg_github__team_tmp"
[0m15:52:05.111745 [debug] [Thread-3  ]: Writing injected SQL for node "model.github_source.stg_github__repository_tmp"
[0m15:52:05.118010 [debug] [Thread-4  ]: Writing injected SQL for node "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:52:05.118401 [debug] [Thread-7  ]: Compiling model.github_source.stg_github__user_tmp
[0m15:52:05.123943 [debug] [Thread-1  ]: Writing runtime SQL for node "model.github_source.stg_github__pull_request_tmp"
[0m15:52:05.124965 [debug] [Thread-6  ]: finished collecting timing info
[0m15:52:05.127153 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:05.131658 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:05.136528 [debug] [Thread-7  ]: Writing injected SQL for node "model.github_source.stg_github__user_tmp"
[0m15:52:05.137110 [debug] [Thread-6  ]: Began executing node model.github_source.stg_github__team_tmp
[0m15:52:05.141433 [debug] [Thread-6  ]: Writing runtime SQL for node "model.github_source.stg_github__team_tmp"
[0m15:52:05.137579 [debug] [Thread-3  ]: Began executing node model.github_source.stg_github__repository_tmp
[0m15:52:05.145141 [debug] [Thread-3  ]: Writing runtime SQL for node "model.github_source.stg_github__repository_tmp"
[0m15:52:05.137326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:52:05.137843 [debug] [Thread-4  ]: Began executing node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:52:05.148717 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m15:52:05.154072 [debug] [Thread-6  ]: On model.github_source.stg_github__team_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__team_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__team_tmp`
  OPTIONS()
  as select * 
from `analytics-engineers-club`.`github`.`team`;


[0m15:52:05.149747 [debug] [Thread-1  ]: On model.github_source.stg_github__pull_request_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__pull_request_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`pull_request`;


[0m15:52:05.149934 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:52:05.153783 [debug] [Thread-4  ]: Writing runtime SQL for node "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:52:05.149422 [debug] [Thread-7  ]: finished collecting timing info
[0m15:52:05.158476 [debug] [Thread-7  ]: Began executing node model.github_source.stg_github__user_tmp
[0m15:52:05.157940 [debug] [Thread-3  ]: On model.github_source.stg_github__repository_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__repository_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__repository_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`repository`;


[0m15:52:05.163364 [debug] [Thread-7  ]: Writing runtime SQL for node "model.github_source.stg_github__user_tmp"
[0m15:52:05.163866 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m15:52:05.167770 [debug] [Thread-4  ]: On model.github_source.stg_github__requested_reviewer_history_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__requested_reviewer_history_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`requested_reviewer_history`;


[0m15:52:05.170721 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m15:52:05.171533 [debug] [Thread-7  ]: On model.github_source.stg_github__user_tmp: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__user_tmp"} */


  create or replace view `aec-students`.`dbt_lauren`.`stg_github__user_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`user`;


[0m15:52:05.256464 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:05.257462 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7e38dc0>]}
[0m15:52:05.258103 [info ] [Thread-5  ]: 5 of 26 OK created view model dbt_lauren.stg_github__issue_merged_tmp .......... [[32mOK[0m in 1.74s]
[0m15:52:05.260696 [debug] [Thread-5  ]: Finished running node model.github_source.stg_github__issue_merged_tmp
[0m15:52:05.261134 [debug] [Thread-5  ]: Began running node model.github_source.stg_github__issue_assignee
[0m15:52:05.262954 [info ] [Thread-5  ]: 14 of 26 START table model dbt_lauren.stg_github__issue_assignee ............... [RUN]
[0m15:52:05.268647 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:05.271478 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dc3db9d0>]}
[0m15:52:05.276294 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:05.279571 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7dbad60>]}
[0m15:52:05.280127 [info ] [Thread-2  ]: 2 of 26 OK created view model dbt_lauren.stg_github__issue_closed_history_tmp .. [[32mOK[0m in 1.73s]
[0m15:52:05.277453 [info ] [Thread-8  ]: 8 of 26 OK created view model dbt_lauren.stg_github__pull_request_review_tmp ... [[32mOK[0m in 1.74s]
[0m15:52:05.281638 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_assignee"
[0m15:52:05.282834 [debug] [Thread-5  ]: Began compiling node model.github_source.stg_github__issue_assignee
[0m15:52:05.283074 [debug] [Thread-5  ]: Compiling model.github_source.stg_github__issue_assignee
[0m15:52:05.282256 [debug] [Thread-2  ]: Finished running node model.github_source.stg_github__issue_closed_history_tmp
[0m15:52:05.282657 [debug] [Thread-8  ]: Finished running node model.github_source.stg_github__pull_request_review_tmp
[0m15:52:05.289646 [debug] [Thread-8  ]: Began running node model.github_source.stg_github__issue_label
[0m15:52:05.290266 [info ] [Thread-8  ]: 16 of 26 START table model dbt_lauren.stg_github__issue_label .................. [RUN]
[0m15:52:05.288534 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m15:52:05.288978 [debug] [Thread-2  ]: Began running node model.github_source.stg_github__issue_comment
[0m15:52:05.297590 [info ] [Thread-2  ]: 15 of 26 START table model dbt_lauren.stg_github__issue_comment ................ [RUN]
[0m15:52:05.291182 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_label"
[0m15:52:05.299018 [debug] [Thread-8  ]: Began compiling node model.github_source.stg_github__issue_label
[0m15:52:05.299335 [debug] [Thread-8  ]: Compiling model.github_source.stg_github__issue_label
[0m15:52:05.298622 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_comment"
[0m15:52:05.305687 [debug] [Thread-2  ]: Began compiling node model.github_source.stg_github__issue_comment
[0m15:52:05.306044 [debug] [Thread-2  ]: Compiling model.github_source.stg_github__issue_comment
[0m15:52:05.332371 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m15:52:05.333697 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:52:06.045687 [debug] [Thread-5  ]: Writing injected SQL for node "model.github_source.stg_github__issue_assignee"
[0m15:52:06.047725 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:06.048726 [debug] [Thread-5  ]: Began executing node model.github_source.stg_github__issue_assignee
[0m15:52:06.049209 [debug] [Thread-2  ]: Writing injected SQL for node "model.github_source.stg_github__issue_comment"
[0m15:52:06.082085 [debug] [Thread-5  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_assignee"
[0m15:52:06.084127 [debug] [Thread-5  ]: On model.github_source.stg_github__issue_assignee: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_assignee"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__issue_assignee`
  
  
  OPTIONS()
  as (
    with issue_assignee as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_assignee_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue_assignee

), fields as (

    select 
      issue_id,
      user_id
    from macro
)

select *
from fields
  );
  
[0m15:52:06.084564 [debug] [Thread-8  ]: Writing injected SQL for node "model.github_source.stg_github__issue_label"
[0m15:52:06.084904 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:06.086958 [debug] [Thread-2  ]: Began executing node model.github_source.stg_github__issue_comment
[0m15:52:06.087260 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:06.090664 [debug] [Thread-2  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_comment"
[0m15:52:06.090932 [debug] [Thread-8  ]: Began executing node model.github_source.stg_github__issue_label
[0m15:52:06.094727 [debug] [Thread-8  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_label"
[0m15:52:06.094962 [debug] [Thread-2  ]: On model.github_source.stg_github__issue_comment: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_comment"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__issue_comment`
  
  
  OPTIONS()
  as (
    with issue_comment as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_comment_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue_comment

), fields as (

    select 
      id as issue_comment_id,
      issue_id,
      user_id

    from macro
)

select *
from fields
  );
  
[0m15:52:06.096530 [debug] [Thread-8  ]: On model.github_source.stg_github__issue_label: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_label"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__issue_label`
  
  
  OPTIONS()
  as (
    with issue_label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_label_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    label_id
    
 as 
    
    label_id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    




    from issue_label

), fields as (

    select 
      issue_id,
      label_id
    from macro
)

select *
from fields
  );
  
[0m15:52:06.484735 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:06.485422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7dc0370>]}
[0m15:52:06.485863 [info ] [Thread-1  ]: 9 of 26 OK created view model dbt_lauren.stg_github__pull_request_tmp .......... [[32mOK[0m in 1.41s]
[0m15:52:06.486417 [debug] [Thread-1  ]: Finished running node model.github_source.stg_github__pull_request_tmp
[0m15:52:06.486781 [debug] [Thread-1  ]: Began running node model.github_source.stg_github__issue
[0m15:52:06.487330 [info ] [Thread-1  ]: 17 of 26 START table model dbt_lauren.stg_github__issue ........................ [RUN]
[0m15:52:06.488278 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue"
[0m15:52:06.488925 [debug] [Thread-1  ]: Began compiling node model.github_source.stg_github__issue
[0m15:52:06.489229 [debug] [Thread-1  ]: Compiling model.github_source.stg_github__issue
[0m15:52:06.495046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:52:06.545164 [debug] [Thread-7  ]: finished collecting timing info
[0m15:52:06.545891 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7c4de80>]}
[0m15:52:06.546497 [info ] [Thread-7  ]: 13 of 26 OK created view model dbt_lauren.stg_github__user_tmp ................. [[32mOK[0m in 1.45s]
[0m15:52:06.547250 [debug] [Thread-7  ]: Finished running node model.github_source.stg_github__user_tmp
[0m15:52:06.547644 [debug] [Thread-7  ]: Began running node model.github_source.stg_github__label
[0m15:52:06.548852 [info ] [Thread-7  ]: 18 of 26 START table model dbt_lauren.stg_github__label ........................ [RUN]
[0m15:52:06.553022 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.github_source.stg_github__label"
[0m15:52:06.553416 [debug] [Thread-7  ]: Began compiling node model.github_source.stg_github__label
[0m15:52:06.553752 [debug] [Thread-7  ]: Compiling model.github_source.stg_github__label
[0m15:52:06.563066 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m15:52:06.738215 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:06.738787 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7edee50>]}
[0m15:52:06.739210 [info ] [Thread-4  ]: 11 of 26 OK created view model dbt_lauren.stg_github__requested_reviewer_history_tmp  [[32mOK[0m in 1.64s]
[0m15:52:06.739742 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:52:06.740252 [debug] [Thread-4  ]: Began running node model.github_source.stg_github__issue_merged
[0m15:52:06.740771 [info ] [Thread-4  ]: 19 of 26 START table model dbt_lauren.stg_github__issue_merged ................. [RUN]
[0m15:52:06.742041 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_merged"
[0m15:52:06.748021 [debug] [Thread-4  ]: Began compiling node model.github_source.stg_github__issue_merged
[0m15:52:06.748416 [debug] [Thread-4  ]: Compiling model.github_source.stg_github__issue_merged
[0m15:52:06.759836 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m15:52:06.762851 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:06.764830 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7e3ba00>]}
[0m15:52:06.765803 [info ] [Thread-3  ]: 10 of 26 OK created view model dbt_lauren.stg_github__repository_tmp ........... [[32mOK[0m in 1.67s]
[0m15:52:06.767737 [debug] [Thread-3  ]: Finished running node model.github_source.stg_github__repository_tmp
[0m15:52:06.769044 [debug] [Thread-3  ]: Began running node model.github_source.stg_github__issue_closed_history
[0m15:52:06.769751 [info ] [Thread-3  ]: 20 of 26 START table model dbt_lauren.stg_github__issue_closed_history ......... [RUN]
[0m15:52:06.770673 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github_source.stg_github__issue_closed_history"
[0m15:52:06.770886 [debug] [Thread-3  ]: Began compiling node model.github_source.stg_github__issue_closed_history
[0m15:52:06.771082 [debug] [Thread-3  ]: Compiling model.github_source.stg_github__issue_closed_history
[0m15:52:06.776324 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:52:06.790433 [debug] [Thread-1  ]: Writing injected SQL for node "model.github_source.stg_github__issue"
[0m15:52:06.791075 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:06.791435 [debug] [Thread-1  ]: Began executing node model.github_source.stg_github__issue
[0m15:52:06.797481 [debug] [Thread-1  ]: Writing runtime SQL for node "model.github_source.stg_github__issue"
[0m15:52:06.798142 [debug] [Thread-1  ]: On model.github_source.stg_github__issue: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__issue`
  
  
  OPTIONS()
  as (
    with issue as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    closed_at
    
 as 
    
    closed_at
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    locked
    
 as 
    
    locked
    
, 
    
    
    milestone_id
    
 as 
    
    milestone_id
    
, 
    
    
    number
    
 as 
    
    number
    
, 
    
    
    pull_request
    
 as 
    
    pull_request
    
, 
    
    
    repository_id
    
 as 
    
    repository_id
    
, 
    
    
    state
    
 as 
    
    state
    
, 
    
    
    title
    
 as 
    
    title
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue 

), fields as (

    select 
      id as issue_id,
      body,
      cast(closed_at as 
    timestamp
) as closed_at,
      cast(created_at as 
    timestamp
) as created_at,
      locked as is_locked,
      milestone_id,
      number as issue_number,
      pull_request as is_pull_request,
      repository_id,
      state,
      title,
      cast(updated_at as 
    timestamp
) as updated_at,
      user_id
      
    from macro
)

select *
from fields
  );
  
[0m15:52:06.807267 [debug] [Thread-6  ]: finished collecting timing info
[0m15:52:06.807958 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7e3b790>]}
[0m15:52:06.808579 [info ] [Thread-6  ]: 12 of 26 OK created view model dbt_lauren.stg_github__team_tmp ................. [[32mOK[0m in 1.71s]
[0m15:52:06.809853 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__team_tmp
[0m15:52:06.810344 [debug] [Thread-6  ]: Began running node model.github_source.stg_github__pull_request_review
[0m15:52:06.823782 [info ] [Thread-6  ]: 21 of 26 START table model dbt_lauren.stg_github__pull_request_review .......... [RUN]
[0m15:52:06.825088 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.github_source.stg_github__pull_request_review"
[0m15:52:06.825415 [debug] [Thread-6  ]: Began compiling node model.github_source.stg_github__pull_request_review
[0m15:52:06.825752 [debug] [Thread-6  ]: Compiling model.github_source.stg_github__pull_request_review
[0m15:52:06.834823 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m15:52:06.844046 [debug] [Thread-7  ]: Writing injected SQL for node "model.github_source.stg_github__label"
[0m15:52:06.844642 [debug] [Thread-7  ]: finished collecting timing info
[0m15:52:06.845117 [debug] [Thread-7  ]: Began executing node model.github_source.stg_github__label
[0m15:52:06.851253 [debug] [Thread-7  ]: Writing runtime SQL for node "model.github_source.stg_github__label"
[0m15:52:06.853249 [debug] [Thread-7  ]: On model.github_source.stg_github__label: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__label"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__label`
  
  
  OPTIONS()
  as (
    with issue_label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__label_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    color
    
 as 
    
    color
    
, 
    
    
    description
    
 as 
    
    description
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    is_default
    
 as 
    
    is_default
    
, 
    
    
    name
    
 as 
    
    name
    
, 
    
    
    url
    
 as 
    
    url
    




    from issue_label

), fields as (

    select 
        id as label_id,
        _fivetran_synced,	
        color,
        description,
        is_default,
        name as label,
        url
    from macro
)

select *
from fields
  );
  
[0m15:52:07.134115 [debug] [Thread-3  ]: Writing injected SQL for node "model.github_source.stg_github__issue_closed_history"
[0m15:52:07.134542 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:07.134765 [debug] [Thread-3  ]: Began executing node model.github_source.stg_github__issue_closed_history
[0m15:52:07.138479 [debug] [Thread-3  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_closed_history"
[0m15:52:07.138897 [debug] [Thread-3  ]: On model.github_source.stg_github__issue_closed_history: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_closed_history"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history`
  
  
  OPTIONS()
  as (
    with issue_closed_history as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    closed
    
 as 
    
    closed
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    




    from issue_closed_history

), fields as (

    select 
      issue_id,
      cast(updated_at as 
    timestamp
) as updated_at,
      closed as is_closed

    from macro
)

select *
from fields
  );
  
[0m15:52:07.179499 [debug] [Thread-4  ]: Writing injected SQL for node "model.github_source.stg_github__issue_merged"
[0m15:52:07.183134 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:07.183876 [debug] [Thread-4  ]: Began executing node model.github_source.stg_github__issue_merged
[0m15:52:07.188557 [debug] [Thread-4  ]: Writing runtime SQL for node "model.github_source.stg_github__issue_merged"
[0m15:52:07.191402 [debug] [Thread-6  ]: Writing injected SQL for node "model.github_source.stg_github__pull_request_review"
[0m15:52:07.191670 [debug] [Thread-4  ]: On model.github_source.stg_github__issue_merged: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_merged"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__issue_merged`
  
  
  OPTIONS()
  as (
    with issue_merged as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_merged_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    merged_at
    
 as 
    
    merged_at
    




    from issue_merged

), fields as (

    select 
      issue_id,
      cast(merged_at as 
    timestamp
) as merged_at

    from macro
)

select *
from fields
  );
  
[0m15:52:07.192156 [debug] [Thread-6  ]: finished collecting timing info
[0m15:52:07.193929 [debug] [Thread-6  ]: Began executing node model.github_source.stg_github__pull_request_review
[0m15:52:07.198334 [debug] [Thread-6  ]: Writing runtime SQL for node "model.github_source.stg_github__pull_request_review"
[0m15:52:07.198811 [debug] [Thread-6  ]: On model.github_source.stg_github__pull_request_review: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_review"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
  
  
  OPTIONS()
  as (
    with pull_request_review as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    pull_request_id
    
 as 
    
    pull_request_id
    
, 
    
    
    state
    
 as 
    
    state
    
, 
    
    
    submitted_at
    
 as 
    
    submitted_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from pull_request_review

), fields as (

    select 
      id as pull_request_review_id,
      pull_request_id,
      cast(submitted_at as 
    timestamp
) as submitted_at,
      state,
      user_id

    from macro
)

select *
from fields
  );
  
[0m15:52:08.221983 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:08.222621 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d4354e80>]}
[0m15:52:08.223051 [info ] [Thread-8  ]: 16 of 26 OK created table model dbt_lauren.stg_github__issue_label ............. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 2.93s]
[0m15:52:08.223986 [debug] [Thread-8  ]: Finished running node model.github_source.stg_github__issue_label
[0m15:52:08.224282 [debug] [Thread-8  ]: Began running node model.github_source.stg_github__pull_request
[0m15:52:08.224665 [info ] [Thread-8  ]: 22 of 26 START table model dbt_lauren.stg_github__pull_request ................. [RUN]
[0m15:52:08.225561 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.github_source.stg_github__pull_request"
[0m15:52:08.226223 [debug] [Thread-8  ]: Began compiling node model.github_source.stg_github__pull_request
[0m15:52:08.226457 [debug] [Thread-8  ]: Compiling model.github_source.stg_github__pull_request
[0m15:52:08.231619 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m15:52:08.243620 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:08.244316 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7d66040>]}
[0m15:52:08.244905 [info ] [Thread-2  ]: 15 of 26 OK created table model dbt_lauren.stg_github__issue_comment ........... [[32mCREATE TABLE (12.0 rows, 288.0 Bytes processed)[0m in 2.95s]
[0m15:52:08.246812 [debug] [Thread-2  ]: Finished running node model.github_source.stg_github__issue_comment
[0m15:52:08.247287 [debug] [Thread-2  ]: Began running node model.github_source.stg_github__user
[0m15:52:08.247828 [info ] [Thread-2  ]: 23 of 26 START table model dbt_lauren.stg_github__user ......................... [RUN]
[0m15:52:08.249033 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github_source.stg_github__user"
[0m15:52:08.249466 [debug] [Thread-2  ]: Began compiling node model.github_source.stg_github__user
[0m15:52:08.249781 [debug] [Thread-2  ]: Compiling model.github_source.stg_github__user
[0m15:52:08.258152 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:52:08.328084 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:08.328946 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7e270a0>]}
[0m15:52:08.329633 [info ] [Thread-5  ]: 14 of 26 OK created table model dbt_lauren.stg_github__issue_assignee .......... [[32mCREATE TABLE (2.0 rows, 32.0 Bytes processed)[0m in 3.05s]
[0m15:52:08.331007 [debug] [Thread-5  ]: Finished running node model.github_source.stg_github__issue_assignee
[0m15:52:08.331446 [debug] [Thread-5  ]: Began running node model.github_source.stg_github__requested_reviewer_history
[0m15:52:08.332770 [info ] [Thread-5  ]: 24 of 26 START table model dbt_lauren.stg_github__requested_reviewer_history ... [RUN]
[0m15:52:08.335938 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.github_source.stg_github__requested_reviewer_history"
[0m15:52:08.336403 [debug] [Thread-5  ]: Began compiling node model.github_source.stg_github__requested_reviewer_history
[0m15:52:08.336754 [debug] [Thread-5  ]: Compiling model.github_source.stg_github__requested_reviewer_history
[0m15:52:08.350100 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m15:52:08.771962 [debug] [Thread-8  ]: Writing injected SQL for node "model.github_source.stg_github__pull_request"
[0m15:52:08.772375 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:08.772600 [debug] [Thread-8  ]: Began executing node model.github_source.stg_github__pull_request
[0m15:52:08.777929 [debug] [Thread-8  ]: Writing runtime SQL for node "model.github_source.stg_github__pull_request"
[0m15:52:08.778350 [debug] [Thread-8  ]: On model.github_source.stg_github__pull_request: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__pull_request`
  
  
  OPTIONS()
  as (
    with pull_request as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    base_label
    
 as 
    
    base_label
    
, 
    
    
    base_ref
    
 as 
    
    base_ref
    
, 
    
    
    base_repo_id
    
 as 
    
    base_repo_id
    
, 
    
    
    base_sha
    
 as 
    
    base_sha
    
, 
    
    
    base_user_id
    
 as 
    
    base_user_id
    
, 
    
    
    head_label
    
 as 
    
    head_label
    
, 
    
    
    head_ref
    
 as 
    
    head_ref
    
, 
    
    
    head_repo_id
    
 as 
    
    head_repo_id
    
, 
    
    
    head_sha
    
 as 
    
    head_sha
    
, 
    
    
    head_user_id
    
 as 
    
    head_user_id
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    merge_commit_sha
    
 as 
    
    merge_commit_sha
    




    from pull_request

), fields as (

    select 
      id as pull_request_id,
      issue_id,
      head_repo_id,
      head_user_id

    from macro
)

select *
from fields
  );
  
[0m15:52:08.868189 [debug] [Thread-5  ]: Writing injected SQL for node "model.github_source.stg_github__requested_reviewer_history"
[0m15:52:08.869040 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:08.870360 [debug] [Thread-5  ]: Began executing node model.github_source.stg_github__requested_reviewer_history
[0m15:52:08.874215 [debug] [Thread-5  ]: Writing runtime SQL for node "model.github_source.stg_github__requested_reviewer_history"
[0m15:52:08.875670 [debug] [Thread-5  ]: On model.github_source.stg_github__requested_reviewer_history: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__requested_reviewer_history"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history`
  
  
  OPTIONS()
  as (
    with requested_reviewer_history as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    pull_request_id
    
 as 
    
    pull_request_id
    
, 
    
    
    removed
    
 as 
    
    removed
    
, 
    
    
    requested_id
    
 as 
    
    requested_id
    




    from requested_reviewer_history

), fields as (

    select 
      pull_request_id,
      cast(created_at as 
    timestamp
) as created_at,
      requested_id,
      removed

    from macro
)

select *
from fields
  );
  
[0m15:52:08.879414 [debug] [Thread-2  ]: Writing injected SQL for node "model.github_source.stg_github__user"
[0m15:52:08.879847 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:08.880091 [debug] [Thread-2  ]: Began executing node model.github_source.stg_github__user
[0m15:52:08.883575 [debug] [Thread-2  ]: Writing runtime SQL for node "model.github_source.stg_github__user"
[0m15:52:08.884042 [debug] [Thread-2  ]: On model.github_source.stg_github__user: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__user"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__user`
  
  
  OPTIONS()
  as (
    with github_user as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    company
    
 as 
    
    company
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    login
    
 as 
    
    login
    
, 
    
    
    name
    
 as 
    
    name
    



        
        
    from github_user

), fields as (

    select
      id as user_id,
      login as login_name,
      name,
      company

    from macro
)

select *
from fields
  );
  
[0m15:52:08.925034 [debug] [Thread-7  ]: finished collecting timing info
[0m15:52:08.925534 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d4207dc0>]}
[0m15:52:08.925960 [info ] [Thread-7  ]: 18 of 26 OK created table model dbt_lauren.stg_github__label ................... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 2.37s]
[0m15:52:08.926662 [debug] [Thread-7  ]: Finished running node model.github_source.stg_github__label
[0m15:52:08.926949 [debug] [Thread-7  ]: Began running node model.github_source.stg_github__repository
[0m15:52:08.927309 [info ] [Thread-7  ]: 25 of 26 START table model dbt_lauren.stg_github__repository ................... [RUN]
[0m15:52:08.928095 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.github_source.stg_github__repository"
[0m15:52:08.929220 [debug] [Thread-7  ]: Began compiling node model.github_source.stg_github__repository
[0m15:52:08.929448 [debug] [Thread-7  ]: Compiling model.github_source.stg_github__repository
[0m15:52:08.933636 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m15:52:09.116133 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:09.116721 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d422ce50>]}
[0m15:52:09.117157 [info ] [Thread-3  ]: 20 of 26 OK created table model dbt_lauren.stg_github__issue_closed_history .... [[32mCREATE TABLE (70.0 rows, 1.2 KB processed)[0m in 2.35s]
[0m15:52:09.117967 [debug] [Thread-3  ]: Finished running node model.github_source.stg_github__issue_closed_history
[0m15:52:09.118281 [debug] [Thread-3  ]: Began running node model.github_source.stg_github__team
[0m15:52:09.118672 [info ] [Thread-3  ]: 26 of 26 START table model dbt_lauren.stg_github__team ......................... [RUN]
[0m15:52:09.119890 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github_source.stg_github__team"
[0m15:52:09.120174 [debug] [Thread-3  ]: Began compiling node model.github_source.stg_github__team
[0m15:52:09.120416 [debug] [Thread-3  ]: Compiling model.github_source.stg_github__team
[0m15:52:09.127281 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:52:09.195152 [debug] [Thread-7  ]: Writing injected SQL for node "model.github_source.stg_github__repository"
[0m15:52:09.195763 [debug] [Thread-7  ]: finished collecting timing info
[0m15:52:09.196108 [debug] [Thread-7  ]: Began executing node model.github_source.stg_github__repository
[0m15:52:09.203342 [debug] [Thread-7  ]: Writing runtime SQL for node "model.github_source.stg_github__repository"
[0m15:52:09.203965 [debug] [Thread-7  ]: On model.github_source.stg_github__repository: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__repository"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__repository`
  
  
  OPTIONS()
  as (
    with repository as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__repository_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    archived
    
 as 
    
    archived
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    default_branch
    
 as 
    
    default_branch
    
, 
    
    
    description
    
 as 
    
    description
    
, 
    
    
    fork
    
 as 
    
    fork
    
, 
    
    
    full_name
    
 as 
    
    full_name
    
, 
    
    
    homepage
    
 as 
    
    homepage
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    language
    
 as 
    
    language
    
, 
    
    
    name
    
 as 
    
    name
    
, 
    
    
    owner_id
    
 as 
    
    owner_id
    
, 
    
    
    private
    
 as 
    
    private
    




    from repository

), fields as (

    select 
      id as repository_id,
      full_name,
      private as is_private

    from macro
)

select *
from fields
  );
  
[0m15:52:09.235293 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:09.236010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d436a970>]}
[0m15:52:09.236586 [info ] [Thread-1  ]: 17 of 26 OK created table model dbt_lauren.stg_github__issue ................... [[32mCREATE TABLE (79.0 rows, 15.3 KB processed)[0m in 2.75s]
[0m15:52:09.237888 [debug] [Thread-1  ]: Finished running node model.github_source.stg_github__issue
[0m15:52:09.374815 [debug] [Thread-3  ]: Writing injected SQL for node "model.github_source.stg_github__team"
[0m15:52:09.375355 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:09.375689 [debug] [Thread-3  ]: Began executing node model.github_source.stg_github__team
[0m15:52:09.380771 [debug] [Thread-3  ]: Writing runtime SQL for node "model.github_source.stg_github__team"
[0m15:52:09.381260 [debug] [Thread-3  ]: On model.github_source.stg_github__team: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github_source.stg_github__team"} */


  create or replace table `aec-students`.`dbt_lauren`.`stg_github__team`
  
  
  OPTIONS()
  as (
    with base as (

    select * 
    from `aec-students`.`dbt_lauren`.`stg_github__team_tmp`

),

fields as (

    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    description
    
 as 
    
    description
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    name
    
 as 
    
    name
    
, 
    
    
    org_id
    
 as 
    
    org_id
    
, 
    
    
    parent_id
    
 as 
    
    parent_id
    
, 
    
    
    privacy
    
 as 
    
    privacy
    
, 
    
    
    slug
    
 as 
    
    slug
    



        
    from base
    
), final as (
    
    select 
        id as team_id,
        description,
        name,
        parent_id,
        privacy,
        slug
    from fields
)

select * 
from final
  );
  
[0m15:52:09.491664 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:09.492198 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d41dbe80>]}
[0m15:52:09.492614 [info ] [Thread-4  ]: 19 of 26 OK created table model dbt_lauren.stg_github__issue_merged ............ [[32mCREATE TABLE (69.0 rows, 1.1 KB processed)[0m in 2.75s]
[0m15:52:09.493372 [debug] [Thread-4  ]: Finished running node model.github_source.stg_github__issue_merged
[0m15:52:09.640938 [debug] [Thread-6  ]: finished collecting timing info
[0m15:52:09.641544 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d42c3640>]}
[0m15:52:09.641983 [info ] [Thread-6  ]: 21 of 26 OK created table model dbt_lauren.stg_github__pull_request_review ..... [[32mCREATE TABLE (48.0 rows, 2.0 KB processed)[0m in 2.82s]
[0m15:52:09.642749 [debug] [Thread-6  ]: Finished running node model.github_source.stg_github__pull_request_review
[0m15:52:10.932046 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:10.932649 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d40d2ee0>]}
[0m15:52:10.933099 [info ] [Thread-2  ]: 23 of 26 OK created table model dbt_lauren.stg_github__user .................... [[32mCREATE TABLE (13.0 rows, 438.0 Bytes processed)[0m in 2.68s]
[0m15:52:10.933682 [debug] [Thread-2  ]: Finished running node model.github_source.stg_github__user
[0m15:52:11.114668 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:11.115304 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d43922b0>]}
[0m15:52:11.115755 [info ] [Thread-8  ]: 22 of 26 OK created table model dbt_lauren.stg_github__pull_request ............ [[32mCREATE TABLE (79.0 rows, 2.5 KB processed)[0m in 2.89s]
[0m15:52:11.116485 [debug] [Thread-8  ]: Finished running node model.github_source.stg_github__pull_request
[0m15:52:11.216210 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:11.216752 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7dc03a0>]}
[0m15:52:11.217159 [info ] [Thread-5  ]: 24 of 26 OK created table model dbt_lauren.stg_github__requested_reviewer_history  [[32mCREATE TABLE (26.0 rows, 650.0 Bytes processed)[0m in 2.88s]
[0m15:52:11.217927 [debug] [Thread-5  ]: Finished running node model.github_source.stg_github__requested_reviewer_history
[0m15:52:11.453383 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:11.453941 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7c43d60>]}
[0m15:52:11.815504 [debug] [Thread-7  ]: finished collecting timing info
[0m15:52:11.816108 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a8265d5-d3e9-40ed-9a81-f5276e561895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7d8a430>]}
[0m15:52:11.935817 [info ] [Thread-3  ]: 26 of 26 OK created table model dbt_lauren.stg_github__team .................... [[32mCREATE TABLE (2.0 rows, 94.0 Bytes processed)[0m in 2.33s]
[0m15:52:11.936407 [info ] [Thread-7  ]: 25 of 26 OK created table model dbt_lauren.stg_github__repository .............. [[32mCREATE TABLE (16.0 rows, 792.0 Bytes processed)[0m in 2.89s]
[0m15:52:11.937535 [debug] [Thread-3  ]: Finished running node model.github_source.stg_github__team
[0m15:52:11.938471 [debug] [Thread-7  ]: Finished running node model.github_source.stg_github__repository
[0m15:52:11.941064 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:52:11.941773 [info ] [MainThread]: 
[0m15:52:11.942114 [info ] [MainThread]: Finished running 13 view models, 13 table models in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m15:52:11.942568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:11.942826 [debug] [MainThread]: Connection 'model.github_source.stg_github__issue' was properly closed.
[0m15:52:11.942987 [debug] [MainThread]: Connection 'model.github_source.stg_github__requested_reviewer_history' was properly closed.
[0m15:52:11.943128 [debug] [MainThread]: Connection 'model.github_source.stg_github__team' was properly closed.
[0m15:52:11.943268 [debug] [MainThread]: Connection 'model.github_source.stg_github__repository' was properly closed.
[0m15:52:11.943406 [debug] [MainThread]: Connection 'model.github_source.stg_github__pull_request' was properly closed.
[0m15:52:11.943545 [debug] [MainThread]: Connection 'model.github_source.stg_github__issue_merged' was properly closed.
[0m15:52:11.943692 [debug] [MainThread]: Connection 'model.github_source.stg_github__user' was properly closed.
[0m15:52:11.943926 [debug] [MainThread]: Connection 'model.github_source.stg_github__pull_request_review' was properly closed.
[0m15:52:11.983673 [info ] [MainThread]: 
[0m15:52:11.984688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:11.986638 [info ] [MainThread]: 
[0m15:52:11.988342 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m15:52:11.990202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d7c56fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d42a42b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d4241c70>]}


============================== 2022-08-15 15:52:17.524376 | 3c4785ac-c80e-4947-b589-f4286f194e69 ==============================
[0m15:52:17.524401 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:52:17.525360 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['github'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:52:17.525699 [debug] [MainThread]: Tracking: tracking
[0m15:52:17.536127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb815d2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb815d2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb815d24c0>]}
[0m15:52:17.677681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:17.678217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:17.681341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.marts.customers

[0m15:52:17.692145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb811adfd0>]}
[0m15:52:17.718172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb814f7d00>]}
[0m15:52:17.718557 [info ] [MainThread]: Found 56 models, 43 tests, 0 snapshots, 0 analyses, 622 macros, 0 operations, 0 seed files, 20 sources, 0 exposures, 0 metrics
[0m15:52:17.718955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb814f7c70>]}
[0m15:52:17.723496 [info ] [MainThread]: 
[0m15:52:17.724202 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:52:17.725597 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m15:52:17.726199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:18.933177 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m15:52:18.933889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:19.124838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb815a5b50>]}
[0m15:52:19.125723 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:52:19.126158 [info ] [MainThread]: 
[0m15:52:19.132740 [debug] [Thread-1  ]: Began running node model.github.int_github__issue_assignees
[0m15:52:19.132962 [debug] [Thread-2  ]: Began running node model.github.int_github__issue_comments
[0m15:52:19.134644 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github.int_github__issue_comments"
[0m15:52:19.134856 [debug] [Thread-2  ]: Began compiling node model.github.int_github__issue_comments
[0m15:52:19.135092 [debug] [Thread-2  ]: Compiling model.github.int_github__issue_comments
[0m15:52:19.133813 [debug] [Thread-6  ]: Began running node model.github.int_github__pull_request_times
[0m15:52:19.134226 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.github.int_github__issue_assignees"
[0m15:52:19.133386 [debug] [Thread-4  ]: Began running node model.github.int_github__issue_open_length
[0m15:52:19.141530 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.github.int_github__issue_open_length"
[0m15:52:19.133597 [debug] [Thread-5  ]: Began running node model.github.int_github__pull_request_reviewers
[0m15:52:19.142121 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.github.int_github__pull_request_reviewers"
[0m15:52:19.140859 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.github.int_github__pull_request_times"
[0m15:52:19.141110 [debug] [Thread-1  ]: Began compiling node model.github.int_github__issue_assignees
[0m15:52:19.141728 [debug] [Thread-4  ]: Began compiling node model.github.int_github__issue_open_length
[0m15:52:19.142970 [debug] [Thread-4  ]: Compiling model.github.int_github__issue_open_length
[0m15:52:19.142312 [debug] [Thread-5  ]: Began compiling node model.github.int_github__pull_request_reviewers
[0m15:52:19.153097 [debug] [Thread-5  ]: Compiling model.github.int_github__pull_request_reviewers
[0m15:52:19.142544 [debug] [Thread-6  ]: Began compiling node model.github.int_github__pull_request_times
[0m15:52:19.142757 [debug] [Thread-1  ]: Compiling model.github.int_github__issue_assignees
[0m15:52:19.133158 [debug] [Thread-3  ]: Began running node model.github.int_github__issue_label_joined
[0m15:52:19.140422 [debug] [Thread-2  ]: Writing injected SQL for node "model.github.int_github__issue_comments"
[0m15:52:19.157493 [debug] [Thread-4  ]: Writing injected SQL for node "model.github.int_github__issue_open_length"
[0m15:52:19.167021 [debug] [Thread-5  ]: Writing injected SQL for node "model.github.int_github__pull_request_reviewers"
[0m15:52:19.167286 [debug] [Thread-6  ]: Compiling model.github.int_github__pull_request_times
[0m15:52:19.172456 [debug] [Thread-1  ]: Writing injected SQL for node "model.github.int_github__issue_assignees"
[0m15:52:19.172912 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github.int_github__issue_label_joined"
[0m15:52:19.186423 [debug] [Thread-3  ]: Began compiling node model.github.int_github__issue_label_joined
[0m15:52:19.173777 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:19.185720 [debug] [Thread-6  ]: Writing injected SQL for node "model.github.int_github__pull_request_times"
[0m15:52:19.187968 [debug] [Thread-6  ]: finished collecting timing info
[0m15:52:19.186674 [debug] [Thread-3  ]: Compiling model.github.int_github__issue_label_joined
[0m15:52:19.173605 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:19.193566 [debug] [Thread-2  ]: Finished running node model.github.int_github__issue_comments
[0m15:52:19.187388 [debug] [Thread-4  ]: Finished running node model.github.int_github__issue_open_length
[0m15:52:19.185895 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:19.194364 [debug] [Thread-5  ]: Finished running node model.github.int_github__pull_request_reviewers
[0m15:52:19.193011 [debug] [Thread-3  ]: Writing injected SQL for node "model.github.int_github__issue_label_joined"
[0m15:52:19.186901 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:19.195303 [debug] [Thread-1  ]: Finished running node model.github.int_github__issue_assignees
[0m15:52:19.188411 [debug] [Thread-6  ]: Finished running node model.github.int_github__pull_request_times
[0m15:52:19.195588 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:19.196362 [debug] [Thread-3  ]: Finished running node model.github.int_github__issue_label_joined
[0m15:52:19.197078 [debug] [Thread-8  ]: Began running node model.github.int_github__issue_labels
[0m15:52:19.197488 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.github.int_github__issue_labels"
[0m15:52:19.197679 [debug] [Thread-8  ]: Began compiling node model.github.int_github__issue_labels
[0m15:52:19.197842 [debug] [Thread-8  ]: Compiling model.github.int_github__issue_labels
[0m15:52:19.212564 [debug] [Thread-8  ]: Writing injected SQL for node "model.github.int_github__issue_labels"
[0m15:52:19.212981 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:19.213506 [debug] [Thread-8  ]: Finished running node model.github.int_github__issue_labels
[0m15:52:19.214175 [debug] [Thread-2  ]: Began running node model.github.int_github__issue_joined
[0m15:52:19.214549 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github.int_github__issue_joined"
[0m15:52:19.214741 [debug] [Thread-2  ]: Began compiling node model.github.int_github__issue_joined
[0m15:52:19.214918 [debug] [Thread-2  ]: Compiling model.github.int_github__issue_joined
[0m15:52:19.247592 [debug] [Thread-2  ]: Writing injected SQL for node "model.github.int_github__issue_joined"
[0m15:52:19.247997 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:19.248472 [debug] [Thread-2  ]: Finished running node model.github.int_github__issue_joined
[0m15:52:19.249156 [debug] [Thread-5  ]: Began running node model.github.github__issues
[0m15:52:19.249356 [debug] [Thread-1  ]: Began running node model.github.github__pull_requests
[0m15:52:19.249700 [info ] [Thread-5  ]: 1 of 6 START table model dbt_lauren.github__issues ............................. [RUN]
[0m15:52:19.250031 [info ] [Thread-1  ]: 2 of 6 START table model dbt_lauren.github__pull_requests ...................... [RUN]
[0m15:52:19.250924 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.github.github__issues"
[0m15:52:19.251370 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.github.github__pull_requests"
[0m15:52:19.252064 [debug] [Thread-1  ]: Began compiling node model.github.github__pull_requests
[0m15:52:19.252399 [debug] [Thread-1  ]: Compiling model.github.github__pull_requests
[0m15:52:19.251597 [debug] [Thread-5  ]: Began compiling node model.github.github__issues
[0m15:52:19.258968 [debug] [Thread-1  ]: Writing injected SQL for node "model.github.github__pull_requests"
[0m15:52:19.259213 [debug] [Thread-5  ]: Compiling model.github.github__issues
[0m15:52:19.269314 [debug] [Thread-5  ]: Writing injected SQL for node "model.github.github__issues"
[0m15:52:19.269636 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:19.270916 [debug] [Thread-1  ]: Began executing node model.github.github__pull_requests
[0m15:52:19.271142 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:19.291896 [debug] [Thread-5  ]: Began executing node model.github.github__issues
[0m15:52:19.384530 [debug] [Thread-5  ]: Writing runtime SQL for node "model.github.github__issues"
[0m15:52:19.384867 [debug] [Thread-1  ]: Writing runtime SQL for node "model.github.github__pull_requests"
[0m15:52:19.385775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:52:19.386192 [debug] [Thread-1  ]: On model.github.github__pull_requests: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__pull_requests"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__pull_requests`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__int_github__issue_label_joined as (
with issue_label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_label`

), label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__label`

), joined as (

    select 
        issue_label.issue_id,
        label.label
    from issue_label
    left join label 
        on issue_label.label_id = label.label_id

)

select *
from joined
),  __dbt__cte__int_github__issue_labels as (
with issue_label as (
    select *
    from __dbt__cte__int_github__issue_label_joined
)

select
  issue_id,
  
    string_agg(label, ', ')

 as labels
from issue_label
group by issue_id
),  __dbt__cte__int_github__issue_assignees as (
with issue_assignee as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_assignee`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  issue_assignee.issue_id,
  
    string_agg(github_user.login_name, ', ')

 as assignees
from issue_assignee
join github_user on issue_assignee.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_open_length as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_closed_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history`
), 

close_events_stacked as (
    select   
      issue_id,
      created_at as updated_at,
      false as is_closed
    from issue -- required because issue_closed_history table does not have a line item for when the issue was opened
    union all
    select
      issue_id,
      updated_at,
      is_closed
    from issue_closed_history
), 

close_events_with_timestamps as (
  select
    issue_id,
    updated_at as valid_starting,
    coalesce(lead(updated_at) over (partition by issue_id order by updated_at), 
    current_timestamp
) as valid_until,
    is_closed
  from close_events_stacked
)

select
  issue_id,
  sum(datetime_diff(
        cast(valid_until as datetime),
        cast(valid_starting as datetime),
        second
    )) /60/60/24 as days_issue_open,
  count(*) - 1 as number_of_times_reopened
from close_events_with_timestamps
  where not is_closed
group by issue_id
),  __dbt__cte__int_github__issue_comments as (
with issue_comment as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_comment`
)

select
  issue_id,
  count(*) as number_of_comments
from issue_comment
group by issue_id
),  __dbt__cte__int_github__pull_request_times as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
), 

requested_reviewer_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history`
    where not removed
), 

issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_merged as (
    select
      issue_id,
      min(merged_at) as merged_at
      from `aec-students`.`dbt_lauren`.`stg_github__issue_merged`
    group by 1
), 

first_request_time as (
    select
      pull_request.issue_id,
      pull_request.pull_request_id,
      -- Finds the first review that is by the requested reviewer and is not a dismissal
      min(case when requested_reviewer_history.requested_id = pull_request_review.user_id then
          case when lower(pull_request_review.state) in ('commented', 'approved', 'changes_requested') 
                then pull_request_review.submitted_at end 
      else null end) as time_of_first_requested_reviewer_review,
      min(requested_reviewer_history.created_at) as time_of_first_request,
      min(pull_request_review.submitted_at) as time_of_first_review_post_request
    from pull_request
    join requested_reviewer_history on requested_reviewer_history.pull_request_id = pull_request.pull_request_id
    left join pull_request_review on pull_request_review.pull_request_id = pull_request.pull_request_id
      and pull_request_review.submitted_at > requested_reviewer_history.created_at
    group by 1, 2
)

select
  first_request_time.issue_id,
  issue_merged.merged_at,
  datetime_diff(
        cast(coalesce(time_of_first_review_post_request, 
    current_timestamp
) as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_first_review,
  datetime_diff(
        cast(least(
                            coalesce(time_of_first_requested_reviewer_review, 
    current_timestamp
),
                            coalesce(issue.closed_at, 
    current_timestamp
)) as datetime),
        cast(time_of_first_request as datetime),
        second
    ) / 60/60 as hours_request_review_to_first_action,
  datetime_diff(
        cast(merged_at as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_merge
from first_request_time
join issue on first_request_time.issue_id = issue.issue_id
left join issue_merged on first_request_time.issue_id = issue_merged.issue_id
),  __dbt__cte__int_github__pull_request_reviewers as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  pull_request_review.pull_request_id,
  
    string_agg(github_user.login_name, ', ')

 as reviewers,
  count(*) as number_of_reviews
from pull_request_review
left join github_user on pull_request_review.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_joined as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_labels as (
    select *
    from __dbt__cte__int_github__issue_labels
), 

repository_teams as (
    select 
    
      repository_id,
      full_name as repository
    from `aec-students`.`dbt_lauren`.`stg_github__repository`

    
), 

issue_assignees as (
    select *
    from __dbt__cte__int_github__issue_assignees
), 

issue_open_length as (
    select *
    from __dbt__cte__int_github__issue_open_length
), 

issue_comments as (
    select *
    from __dbt__cte__int_github__issue_comments
), 

creator as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
), 

pull_request_times as (
    select *
    from __dbt__cte__int_github__pull_request_times
), 

pull_request_reviewers as (
    select *
    from __dbt__cte__int_github__pull_request_reviewers
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
)

select
  issue.*,
  case 
    when issue.is_pull_request then 'https://github.com/' || repository_teams.repository || '/pull/' || issue.issue_number
    else 'https://github.com/' || repository_teams.repository || '/issues/' || issue.issue_number
  end as url_link,
  issue_open_length.days_issue_open,
  issue_open_length.number_of_times_reopened,
  labels.labels,
  issue_comments.number_of_comments,
  repository_teams.repository,
  
  issue_assignees.assignees,
  creator.login_name as creator_login_name,
  creator.name as creator_name,
  creator.company as creator_company,
  hours_request_review_to_first_review,
  hours_request_review_to_first_action,
  hours_request_review_to_merge,
  merged_at,
  reviewers,
  number_of_reviews
from issue
left join issue_labels as labels
  on issue.issue_id = labels.issue_id
join repository_teams
  on issue.repository_id = repository_teams.repository_id
left join issue_assignees
  on issue.issue_id = issue_assignees.issue_id
left join issue_open_length
  on issue.issue_id = issue_open_length.issue_id
left join issue_comments 
  on issue.issue_id = issue_comments.issue_id
left join creator 
  on issue.user_id = creator.user_id
left join pull_request
  on issue.issue_id = pull_request.issue_id
left join pull_request_times
  on issue.issue_id = pull_request_times.issue_id
left join pull_request_reviewers
  on pull_request.pull_request_id = pull_request_reviewers.pull_request_id
),issue_joined as (
    select *
    from __dbt__cte__int_github__issue_joined  
)

select
  *
from issue_joined
where is_pull_request
  );
  
[0m15:52:19.387112 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m15:52:19.389877 [debug] [Thread-5  ]: On model.github.github__issues: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__issues"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__issues`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__int_github__issue_label_joined as (
with issue_label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_label`

), label as (

    select *
    from `aec-students`.`dbt_lauren`.`stg_github__label`

), joined as (

    select 
        issue_label.issue_id,
        label.label
    from issue_label
    left join label 
        on issue_label.label_id = label.label_id

)

select *
from joined
),  __dbt__cte__int_github__issue_labels as (
with issue_label as (
    select *
    from __dbt__cte__int_github__issue_label_joined
)

select
  issue_id,
  
    string_agg(label, ', ')

 as labels
from issue_label
group by issue_id
),  __dbt__cte__int_github__issue_assignees as (
with issue_assignee as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_assignee`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  issue_assignee.issue_id,
  
    string_agg(github_user.login_name, ', ')

 as assignees
from issue_assignee
join github_user on issue_assignee.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_open_length as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_closed_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_closed_history`
), 

close_events_stacked as (
    select   
      issue_id,
      created_at as updated_at,
      false as is_closed
    from issue -- required because issue_closed_history table does not have a line item for when the issue was opened
    union all
    select
      issue_id,
      updated_at,
      is_closed
    from issue_closed_history
), 

close_events_with_timestamps as (
  select
    issue_id,
    updated_at as valid_starting,
    coalesce(lead(updated_at) over (partition by issue_id order by updated_at), 
    current_timestamp
) as valid_until,
    is_closed
  from close_events_stacked
)

select
  issue_id,
  sum(datetime_diff(
        cast(valid_until as datetime),
        cast(valid_starting as datetime),
        second
    )) /60/60/24 as days_issue_open,
  count(*) - 1 as number_of_times_reopened
from close_events_with_timestamps
  where not is_closed
group by issue_id
),  __dbt__cte__int_github__issue_comments as (
with issue_comment as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue_comment`
)

select
  issue_id,
  count(*) as number_of_comments
from issue_comment
group by issue_id
),  __dbt__cte__int_github__pull_request_times as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
), 

requested_reviewer_history as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__requested_reviewer_history`
    where not removed
), 

issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_merged as (
    select
      issue_id,
      min(merged_at) as merged_at
      from `aec-students`.`dbt_lauren`.`stg_github__issue_merged`
    group by 1
), 

first_request_time as (
    select
      pull_request.issue_id,
      pull_request.pull_request_id,
      -- Finds the first review that is by the requested reviewer and is not a dismissal
      min(case when requested_reviewer_history.requested_id = pull_request_review.user_id then
          case when lower(pull_request_review.state) in ('commented', 'approved', 'changes_requested') 
                then pull_request_review.submitted_at end 
      else null end) as time_of_first_requested_reviewer_review,
      min(requested_reviewer_history.created_at) as time_of_first_request,
      min(pull_request_review.submitted_at) as time_of_first_review_post_request
    from pull_request
    join requested_reviewer_history on requested_reviewer_history.pull_request_id = pull_request.pull_request_id
    left join pull_request_review on pull_request_review.pull_request_id = pull_request.pull_request_id
      and pull_request_review.submitted_at > requested_reviewer_history.created_at
    group by 1, 2
)

select
  first_request_time.issue_id,
  issue_merged.merged_at,
  datetime_diff(
        cast(coalesce(time_of_first_review_post_request, 
    current_timestamp
) as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_first_review,
  datetime_diff(
        cast(least(
                            coalesce(time_of_first_requested_reviewer_review, 
    current_timestamp
),
                            coalesce(issue.closed_at, 
    current_timestamp
)) as datetime),
        cast(time_of_first_request as datetime),
        second
    ) / 60/60 as hours_request_review_to_first_action,
  datetime_diff(
        cast(merged_at as datetime),
        cast(time_of_first_request as datetime),
        second
    )/ 60/60 as hours_request_review_to_merge
from first_request_time
join issue on first_request_time.issue_id = issue.issue_id
left join issue_merged on first_request_time.issue_id = issue_merged.issue_id
),  __dbt__cte__int_github__pull_request_reviewers as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request_review`
), 

github_user as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
)

select
  pull_request_review.pull_request_id,
  
    string_agg(github_user.login_name, ', ')

 as reviewers,
  count(*) as number_of_reviews
from pull_request_review
left join github_user on pull_request_review.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_joined as (
with issue as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__issue`
), 

issue_labels as (
    select *
    from __dbt__cte__int_github__issue_labels
), 

repository_teams as (
    select 
    
      repository_id,
      full_name as repository
    from `aec-students`.`dbt_lauren`.`stg_github__repository`

    
), 

issue_assignees as (
    select *
    from __dbt__cte__int_github__issue_assignees
), 

issue_open_length as (
    select *
    from __dbt__cte__int_github__issue_open_length
), 

issue_comments as (
    select *
    from __dbt__cte__int_github__issue_comments
), 

creator as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__user`
), 

pull_request_times as (
    select *
    from __dbt__cte__int_github__pull_request_times
), 

pull_request_reviewers as (
    select *
    from __dbt__cte__int_github__pull_request_reviewers
), 

pull_request as (
    select *
    from `aec-students`.`dbt_lauren`.`stg_github__pull_request`
)

select
  issue.*,
  case 
    when issue.is_pull_request then 'https://github.com/' || repository_teams.repository || '/pull/' || issue.issue_number
    else 'https://github.com/' || repository_teams.repository || '/issues/' || issue.issue_number
  end as url_link,
  issue_open_length.days_issue_open,
  issue_open_length.number_of_times_reopened,
  labels.labels,
  issue_comments.number_of_comments,
  repository_teams.repository,
  
  issue_assignees.assignees,
  creator.login_name as creator_login_name,
  creator.name as creator_name,
  creator.company as creator_company,
  hours_request_review_to_first_review,
  hours_request_review_to_first_action,
  hours_request_review_to_merge,
  merged_at,
  reviewers,
  number_of_reviews
from issue
left join issue_labels as labels
  on issue.issue_id = labels.issue_id
join repository_teams
  on issue.repository_id = repository_teams.repository_id
left join issue_assignees
  on issue.issue_id = issue_assignees.issue_id
left join issue_open_length
  on issue.issue_id = issue_open_length.issue_id
left join issue_comments 
  on issue.issue_id = issue_comments.issue_id
left join creator 
  on issue.user_id = creator.user_id
left join pull_request
  on issue.issue_id = pull_request.issue_id
left join pull_request_times
  on issue.issue_id = pull_request_times.issue_id
left join pull_request_reviewers
  on pull_request.pull_request_id = pull_request_reviewers.pull_request_id
),issue_joined as (
    select *
    from __dbt__cte__int_github__issue_joined  
)

select
  issue_id,
  body,
  closed_at,
  created_at,
  is_locked,
  milestone_id,
  issue_number,
  is_pull_request,
  repository_id,
  state,
  title,
  updated_at,
  user_id,
  url_link,
  days_issue_open,
  number_of_times_reopened,
  labels,
  number_of_comments,
  repository,
  
  assignees,
  creator_login_name,
  creator_name,
  creator_company
from issue_joined
where not is_pull_request
  );
  
[0m15:52:22.706480 [debug] [Thread-1  ]: finished collecting timing info
[0m15:52:22.707312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8110c370>]}
[0m15:52:22.707973 [info ] [Thread-1  ]: 2 of 6 OK created table model dbt_lauren.github__pull_requests ................. [[32mCREATE TABLE (79.0 rows, 22.4 KB processed)[0m in 3.46s]
[0m15:52:22.712633 [debug] [Thread-1  ]: Finished running node model.github.github__pull_requests
[0m15:52:22.931640 [debug] [Thread-5  ]: finished collecting timing info
[0m15:52:22.932235 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb81107550>]}
[0m15:52:22.932676 [info ] [Thread-5  ]: 1 of 6 OK created table model dbt_lauren.github__issues ........................ [[32mCREATE TABLE (0.0 rows, 21.1 KB processed)[0m in 3.68s]
[0m15:52:22.933541 [debug] [Thread-5  ]: Finished running node model.github.github__issues
[0m15:52:22.934342 [debug] [Thread-3  ]: Began running node model.github.github__daily_metrics
[0m15:52:22.934677 [info ] [Thread-3  ]: 3 of 6 START table model dbt_lauren.github__daily_metrics ...................... [RUN]
[0m15:52:22.935222 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.github.github__daily_metrics"
[0m15:52:22.935395 [debug] [Thread-3  ]: Began compiling node model.github.github__daily_metrics
[0m15:52:22.935554 [debug] [Thread-3  ]: Compiling model.github.github__daily_metrics
[0m15:52:22.946598 [debug] [Thread-3  ]: Writing injected SQL for node "model.github.github__daily_metrics"
[0m15:52:22.947030 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:22.947266 [debug] [Thread-3  ]: Began executing node model.github.github__daily_metrics
[0m15:52:22.950836 [debug] [Thread-3  ]: Writing runtime SQL for node "model.github.github__daily_metrics"
[0m15:52:22.951326 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:52:22.951608 [debug] [Thread-3  ]: On model.github.github__daily_metrics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__daily_metrics"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__daily_metrics`
  
  
  OPTIONS()
  as (
    with github_issues as (
    select *
    from `aec-students`.`dbt_lauren`.`github__issues`
), 

pull_requests as (
    select *
    from `aec-students`.`dbt_lauren`.`github__pull_requests`
), 

issues_opened_per_day as (
   select 
      timestamp_trunc(
        cast(created_at as timestamp),
        day
    ) as day, 
      count(*) as number_issues_opened,
      sum(days_issue_open) as sum_days_issue_open,
      max(days_issue_open) as longest_days_issue_open
    from github_issues
    group by 1
), 

issues_closed_per_day as (
   select 
      timestamp_trunc(
        cast(closed_at as timestamp),
        day
    ) as day, 
      count(*) as number_issues_closed
    from github_issues
    where closed_at is not null
    group by 1
), 

prs_opened_per_day as (
   select 
      timestamp_trunc(
        cast(created_at as timestamp),
        day
    ) as day, 
      count(*) as number_prs_opened,
      sum(days_issue_open) as sum_days_pr_open,
      max(days_issue_open) as longest_days_pr_open
    from pull_requests
    group by 1
), 

prs_merged_per_day as (
   select 
      timestamp_trunc(
        cast(merged_at as timestamp),
        day
    ) as day, 
      count(*) as number_prs_merged
    from pull_requests
    where merged_at is not null
    group by 1
), 

prs_closed_without_merge_per_day as (
   select 
      timestamp_trunc(
        cast(closed_at as timestamp),
        day
    ) as day, 
      count(*) as number_prs_closed_without_merge
    from pull_requests
    where closed_at is not null
      and merged_at is null
    group by 1
), 

issues_per_day as (
    select 
      coalesce(issues_opened_per_day.day, 
        issues_closed_per_day.day
      ) as day,
      number_issues_opened,
      number_issues_closed,      
      sum_days_issue_open,
      longest_days_issue_open
    from issues_opened_per_day
    full outer join issues_closed_per_day on issues_opened_per_day.day = issues_closed_per_day.day
), 

prs_per_day as (
    select 
      coalesce(prs_opened_per_day.day, 
        prs_merged_per_day.day,
        prs_closed_without_merge_per_day.day
      ) as day,
      number_prs_opened,
      number_prs_merged,
      number_prs_closed_without_merge,
      sum_days_pr_open,
      longest_days_pr_open
    from prs_opened_per_day
    full outer join prs_merged_per_day on prs_opened_per_day.day = prs_merged_per_day.day
    full outer join prs_closed_without_merge_per_day on coalesce(prs_opened_per_day.day, prs_merged_per_day.day) = prs_closed_without_merge_per_day.day
)

select 
  coalesce(issues_per_day.day, prs_per_day.day) as day,
  coalesce(number_issues_opened, 0) as number_issues_opened,
  coalesce(number_issues_closed, 0) as number_issues_closed,
  sum_days_issue_open,
  longest_days_issue_open,
  coalesce(number_prs_opened, 0) as number_prs_opened,
  coalesce(number_prs_merged, 0) as number_prs_merged,
  coalesce(number_prs_closed_without_merge, 0) as number_prs_closed_without_merge,
  sum_days_pr_open,
  longest_days_pr_open
from issues_per_day 
full outer join prs_per_day on issues_per_day.day = prs_per_day.day
order by day desc
  );
  
[0m15:52:26.028219 [debug] [Thread-3  ]: finished collecting timing info
[0m15:52:26.028883 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8105dcd0>]}
[0m15:52:26.029368 [info ] [Thread-3  ]: 3 of 6 OK created table model dbt_lauren.github__daily_metrics ................. [[32mCREATE TABLE (40.0 rows, 1.9 KB processed)[0m in 3.09s]
[0m15:52:26.030216 [debug] [Thread-3  ]: Finished running node model.github.github__daily_metrics
[0m15:52:26.031070 [debug] [Thread-8  ]: Began running node model.github.github__monthly_metrics
[0m15:52:26.031271 [debug] [Thread-4  ]: Began running node model.github.github__quarterly_metrics
[0m15:52:26.031655 [info ] [Thread-8  ]: 4 of 6 START table model dbt_lauren.github__monthly_metrics .................... [RUN]
[0m15:52:26.033543 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.github.github__monthly_metrics"
[0m15:52:26.032881 [info ] [Thread-4  ]: 5 of 6 START table model dbt_lauren.github__quarterly_metrics .................. [RUN]
[0m15:52:26.034384 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.github.github__quarterly_metrics"
[0m15:52:26.032550 [debug] [Thread-2  ]: Began running node model.github.github__weekly_metrics
[0m15:52:26.035229 [info ] [Thread-2  ]: 6 of 6 START table model dbt_lauren.github__weekly_metrics ..................... [RUN]
[0m15:52:26.035876 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.github.github__weekly_metrics"
[0m15:52:26.036088 [debug] [Thread-2  ]: Began compiling node model.github.github__weekly_metrics
[0m15:52:26.036257 [debug] [Thread-2  ]: Compiling model.github.github__weekly_metrics
[0m15:52:26.034684 [debug] [Thread-4  ]: Began compiling node model.github.github__quarterly_metrics
[0m15:52:26.042796 [debug] [Thread-4  ]: Compiling model.github.github__quarterly_metrics
[0m15:52:26.042538 [debug] [Thread-2  ]: Writing injected SQL for node "model.github.github__weekly_metrics"
[0m15:52:26.046632 [debug] [Thread-4  ]: Writing injected SQL for node "model.github.github__quarterly_metrics"
[0m15:52:26.033798 [debug] [Thread-8  ]: Began compiling node model.github.github__monthly_metrics
[0m15:52:26.047374 [debug] [Thread-8  ]: Compiling model.github.github__monthly_metrics
[0m15:52:26.047552 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:26.051360 [debug] [Thread-8  ]: Writing injected SQL for node "model.github.github__monthly_metrics"
[0m15:52:26.052199 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:26.051848 [debug] [Thread-2  ]: Began executing node model.github.github__weekly_metrics
[0m15:52:26.052391 [debug] [Thread-8  ]: Began executing node model.github.github__monthly_metrics
[0m15:52:26.059204 [debug] [Thread-8  ]: Writing runtime SQL for node "model.github.github__monthly_metrics"
[0m15:52:26.055749 [debug] [Thread-2  ]: Writing runtime SQL for node "model.github.github__weekly_metrics"
[0m15:52:26.051562 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:26.059866 [debug] [Thread-4  ]: Began executing node model.github.github__quarterly_metrics
[0m15:52:26.060117 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m15:52:26.064392 [debug] [Thread-4  ]: Writing runtime SQL for node "model.github.github__quarterly_metrics"
[0m15:52:26.065347 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m15:52:26.064944 [debug] [Thread-8  ]: On model.github.github__monthly_metrics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__monthly_metrics"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__monthly_metrics`
  
  
  OPTIONS()
  as (
    with daily_metrics as (
    select *
    from `aec-students`.`dbt_lauren`.`github__daily_metrics`
)

select 
  timestamp_trunc(
        cast(day as timestamp),
        month
    ) as month, 
  sum(number_issues_opened) as number_issues_opened,
  sum(number_issues_closed) as number_issues_closed,
  sum(sum_days_issue_open) / sum(number_issues_opened) as avg_days_issue_open,
  max(longest_days_issue_open) as longest_days_issue_open,
  sum(number_prs_opened) as number_prs_opened,
  sum(number_prs_merged) as number_prs_merged,
  sum(number_prs_closed_without_merge) as number_prs_closed_without_merge,
  sum(sum_days_pr_open) / sum(number_prs_opened) as avg_days_pr_open,
  max(longest_days_pr_open) as longest_days_pr_open
from daily_metrics 
group by 1
order by 1 desc
  );
  
[0m15:52:26.065583 [debug] [Thread-4  ]: On model.github.github__quarterly_metrics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__quarterly_metrics"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__quarterly_metrics`
  
  
  OPTIONS()
  as (
    with daily_metrics as (
    select *
    from `aec-students`.`dbt_lauren`.`github__daily_metrics`
)

select 
  timestamp_trunc(
        cast(day as timestamp),
        quarter
    ) as quarter, 
  sum(number_issues_opened) as number_issues_opened,
  sum(number_issues_closed) as number_issues_closed,
  sum(sum_days_issue_open) / sum(number_issues_opened) as avg_days_issue_open,
  max(longest_days_issue_open) as longest_days_issue_open,
  sum(number_prs_opened) as number_prs_opened,
  sum(number_prs_merged) as number_prs_merged,
  sum(number_prs_closed_without_merge) as number_prs_closed_without_merge,
  sum(sum_days_pr_open) / sum(number_prs_opened) as avg_days_pr_open,
  max(longest_days_pr_open) as longest_days_pr_open

from daily_metrics 
group by 1
order by 1 desc
  );
  
[0m15:52:26.064740 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:52:26.070831 [debug] [Thread-2  ]: On model.github.github__weekly_metrics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop_zar", "target_name": "dev", "node_id": "model.github.github__weekly_metrics"} */


  create or replace table `aec-students`.`dbt_lauren`.`github__weekly_metrics`
  
  
  OPTIONS()
  as (
    with daily_metrics as (
    select *
    from `aec-students`.`dbt_lauren`.`github__daily_metrics`
)

select 
  timestamp_trunc(
        cast(day as timestamp),
        week
    ) as week, 
  sum(number_issues_opened) as number_issues_opened,
  sum(number_issues_closed) as number_issues_closed,
  sum(sum_days_issue_open) / sum(number_issues_opened) as avg_days_issue_open,
  max(longest_days_issue_open) as longest_days_issue_open,
  sum(number_prs_opened) as number_prs_opened,
  sum(number_prs_merged) as number_prs_merged,
  sum(number_prs_closed_without_merge) as number_prs_closed_without_merge,
  sum(sum_days_pr_open) / sum(number_prs_opened) as avg_days_pr_open,
  max(longest_days_pr_open) as longest_days_pr_open
from daily_metrics 
group by 1
order by 1 desc
  );
  
[0m15:52:28.432378 [debug] [Thread-4  ]: finished collecting timing info
[0m15:52:28.433042 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb810d75e0>]}
[0m15:52:28.433548 [info ] [Thread-4  ]: 5 of 6 OK created table model dbt_lauren.github__quarterly_metrics ............. [[32mCREATE TABLE (2.0 rows, 2.4 KB processed)[0m in 2.40s]
[0m15:52:28.434183 [debug] [Thread-4  ]: Finished running node model.github.github__quarterly_metrics
[0m15:52:28.623143 [debug] [Thread-8  ]: finished collecting timing info
[0m15:52:28.623753 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb81079ac0>]}
[0m15:52:28.624201 [info ] [Thread-8  ]: 4 of 6 OK created table model dbt_lauren.github__monthly_metrics ............... [[32mCREATE TABLE (5.0 rows, 2.4 KB processed)[0m in 2.59s]
[0m15:52:28.624823 [debug] [Thread-8  ]: Finished running node model.github.github__monthly_metrics
[0m15:52:28.640192 [debug] [Thread-2  ]: finished collecting timing info
[0m15:52:28.640651 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4785ac-c80e-4947-b589-f4286f194e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb810ccd00>]}
[0m15:52:28.641025 [info ] [Thread-2  ]: 6 of 6 OK created table model dbt_lauren.github__weekly_metrics ................ [[32mCREATE TABLE (14.0 rows, 2.4 KB processed)[0m in 2.60s]
[0m15:52:28.641609 [debug] [Thread-2  ]: Finished running node model.github.github__weekly_metrics
[0m15:52:28.643312 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:52:28.643764 [info ] [MainThread]: 
[0m15:52:28.644107 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 10.92 seconds (10.92s).
[0m15:52:28.644569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:28.644825 [debug] [MainThread]: Connection 'model.github.github__weekly_metrics' was properly closed.
[0m15:52:28.645008 [debug] [MainThread]: Connection 'model.github.github__pull_requests' was properly closed.
[0m15:52:28.645166 [debug] [MainThread]: Connection 'model.github.int_github__pull_request_times' was properly closed.
[0m15:52:28.645371 [debug] [MainThread]: Connection 'model.github.github__quarterly_metrics' was properly closed.
[0m15:52:28.646436 [debug] [MainThread]: Connection 'model.github.github__issues' was properly closed.
[0m15:52:28.646680 [debug] [MainThread]: Connection 'model.github.github__daily_metrics' was properly closed.
[0m15:52:28.646906 [debug] [MainThread]: Connection 'model.github.github__monthly_metrics' was properly closed.
[0m15:52:28.669934 [info ] [MainThread]: 
[0m15:52:28.670439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:28.670991 [info ] [MainThread]: 
[0m15:52:28.671451 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:52:28.672047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb815d2ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb80f45d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb815e5730>]}
