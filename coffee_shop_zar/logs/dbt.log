

============================== 2022-08-06 06:21:03.426126 | 77adfea5-a9bf-4c9d-9cb8-aa99acc7acab ==============================
[0m06:21:03.426155 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:21:03.426628 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m06:21:03.426905 [debug] [MainThread]: Tracking: tracking
[0m06:21:03.430804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed3b413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed3b412e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed3b413d0>]}
[0m06:21:03.432329 [debug] [MainThread]: Executing "git --help"
[0m06:21:03.435960 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:21:03.436389 [debug] [MainThread]: STDERR: "b''"
[0m06:21:03.436974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed3b41190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed3b411c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed3b41100>]}


============================== 2022-08-06 06:24:16.566111 | 10875d0b-0858-4313-b00a-0c120d41efc6 ==============================
[0m06:24:16.566122 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:24:16.566660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m06:24:16.566974 [debug] [MainThread]: Tracking: tracking
[0m06:24:16.571351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60965412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60965414c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60965413d0>]}
[0m06:24:16.850536 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m06:24:16.851051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '10875d0b-0858-4313-b00a-0c120d41efc6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6097bab6a0>]}
[0m06:24:16.851819 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m06:24:16.852308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '10875d0b-0858-4313-b00a-0c120d41efc6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60949ca400>]}
[0m06:24:16.866896 [debug] [MainThread]: Executing "git --help"
[0m06:24:16.871695 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:24:16.872152 [debug] [MainThread]: STDERR: "b''"
[0m06:24:16.884545 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m06:24:16.885559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:24:17.538602 [debug] [MainThread]: On debug: select 1 as id
[0m06:24:18.593911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609872e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60949c9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60949c9a60>]}
[0m06:24:19.135452 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-06 06:25:35.029942 | c0176b9b-36d7-4237-9a98-f839de8c83f5 ==============================
[0m06:25:35.029970 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:25:35.030744 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:25:35.031060 [debug] [MainThread]: Tracking: tracking
[0m06:25:35.035960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5385332c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5385332d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53853328e0>]}
[0m06:25:35.055050 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m06:25:35.055659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0176b9b-36d7-4237-9a98-f839de8c83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538530d4c0>]}
[0m06:25:35.081012 [debug] [MainThread]: Parsing macros/etc.sql
[0m06:25:35.085647 [debug] [MainThread]: Parsing macros/adapters.sql
[0m06:25:35.113152 [debug] [MainThread]: Parsing macros/catalog.sql
[0m06:25:35.118788 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m06:25:35.121482 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m06:25:35.122035 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m06:25:35.122484 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m06:25:35.123066 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m06:25:35.123776 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m06:25:35.124411 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m06:25:35.125138 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m06:25:35.125694 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m06:25:35.127081 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m06:25:35.128135 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m06:25:35.128762 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m06:25:35.130094 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m06:25:35.130737 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m06:25:35.131379 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m06:25:35.134139 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m06:25:35.135828 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m06:25:35.141197 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m06:25:35.144117 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m06:25:35.160228 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m06:25:35.163091 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m06:25:35.164045 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m06:25:35.164846 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m06:25:35.165738 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m06:25:35.167169 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m06:25:35.170339 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m06:25:35.184051 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m06:25:35.191136 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m06:25:35.205423 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m06:25:35.209902 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m06:25:35.219358 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m06:25:35.222298 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m06:25:35.224495 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m06:25:35.225547 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m06:25:35.226719 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m06:25:35.227726 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m06:25:35.229039 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m06:25:35.234752 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m06:25:35.235695 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m06:25:35.237016 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m06:25:35.238373 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m06:25:35.239553 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m06:25:35.240745 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m06:25:35.241915 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m06:25:35.242795 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m06:25:35.244941 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m06:25:35.246941 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m06:25:35.249429 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m06:25:35.250628 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m06:25:35.251647 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m06:25:35.253027 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m06:25:35.254490 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m06:25:35.255673 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m06:25:35.256818 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m06:25:35.265220 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m06:25:35.269625 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m06:25:35.272068 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m06:25:35.275921 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m06:25:35.281724 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m06:25:35.284578 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m06:25:35.300740 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m06:25:35.305313 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m06:25:35.320549 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m06:25:35.322131 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m06:25:35.331636 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m06:25:35.333046 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m06:25:35.338394 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m06:25:35.341911 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m06:25:35.344277 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m06:25:35.348852 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m06:25:35.350667 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m06:25:35.352525 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m06:25:35.370701 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m06:25:35.377689 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m06:25:35.390299 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m06:25:35.392016 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m06:25:35.403685 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m06:25:35.420227 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m06:25:35.421850 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m06:25:35.423487 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m06:25:35.426003 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m06:25:35.687441 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m06:25:35.733312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0176b9b-36d7-4237-9a98-f839de8c83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5385232a60>]}
[0m06:25:35.739036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0176b9b-36d7-4237-9a98-f839de8c83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538525da90>]}
[0m06:25:35.739388 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:25:35.739725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0176b9b-36d7-4237-9a98-f839de8c83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5384dc6970>]}
[0m06:25:35.741145 [info ] [MainThread]: 
[0m06:25:35.742030 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m06:25:35.743148 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m06:25:35.743503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:25:36.804173 [debug] [ThreadPool]: Acquiring new bigquery connection "create_aec-students_dbt_lauren"
[0m06:25:36.804760 [debug] [ThreadPool]: Acquiring new bigquery connection "create_aec-students_dbt_lauren"
[0m06:25:36.805133 [debug] [ThreadPool]: BigQuery adapter: Creating schema "aec-students.dbt_lauren".
[0m06:25:36.805371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:37.344167 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m06:25:37.344535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:37.600025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0176b9b-36d7-4237-9a98-f839de8c83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538521fbb0>]}
[0m06:25:37.600804 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m06:25:37.601213 [info ] [MainThread]: 
[0m06:25:37.607383 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
[0m06:25:37.607751 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.customers ................................... [RUN]
[0m06:25:37.608508 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
[0m06:25:37.608766 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
[0m06:25:37.609114 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
[0m06:25:37.612871 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
[0m06:25:37.613361 [debug] [Thread-1  ]: finished collecting timing info
[0m06:25:37.613645 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
[0m06:25:37.646138 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
[0m06:25:37.646682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:37.646959 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_lauren`.`customers`
  OPTIONS()
  as /*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club.coffee_shop.customers`
    ),

    orders as (
      select * from `analytics-engineers-club.coffee_shop.orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            aggregate_orders.* except(customer_id)
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at;


[0m06:25:38.593771 [debug] [Thread-1  ]: finished collecting timing info
[0m06:25:38.594334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0176b9b-36d7-4237-9a98-f839de8c83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53844b1f70>]}
[0m06:25:38.594751 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.customers .............................. [[32mOK[0m in 0.99s]
[0m06:25:38.595298 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
[0m06:25:38.596882 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m06:25:38.597434 [info ] [MainThread]: 
[0m06:25:38.597783 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m06:25:38.598254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:25:38.598527 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m06:25:38.605510 [info ] [MainThread]: 
[0m06:25:38.606022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:25:38.606558 [info ] [MainThread]: 
[0m06:25:38.607044 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:25:38.607608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5385209d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5385209520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53852112b0>]}


============================== 2022-08-06 06:27:18.402751 | 91238ffe-0da7-44a4-ad75-de610a2efab9 ==============================
[0m06:27:18.402785 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:27:18.403684 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:27:18.404041 [debug] [MainThread]: Tracking: tracking
[0m06:27:18.409572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e989b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e989d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e989340>]}
[0m06:27:18.467992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:27:18.468901 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m06:27:18.493037 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m06:27:18.525177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91238ffe-0da7-44a4-ad75-de610a2efab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e82f0d0>]}
[0m06:27:18.532000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91238ffe-0da7-44a4-ad75-de610a2efab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e846f10>]}
[0m06:27:18.532411 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:27:18.532806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91238ffe-0da7-44a4-ad75-de610a2efab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e834310>]}
[0m06:27:18.534215 [info ] [MainThread]: 
[0m06:27:18.535130 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m06:27:18.536321 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m06:27:18.536690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:27:19.642781 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m06:27:19.643420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:27:19.947626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91238ffe-0da7-44a4-ad75-de610a2efab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e972f70>]}
[0m06:27:19.948554 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m06:27:19.949026 [info ] [MainThread]: 
[0m06:27:19.955719 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
[0m06:27:19.956185 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.customers ................................... [RUN]
[0m06:27:19.956950 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
[0m06:27:19.957274 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
[0m06:27:19.957563 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
[0m06:27:19.960841 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
[0m06:27:19.961370 [debug] [Thread-1  ]: finished collecting timing info
[0m06:27:19.961678 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
[0m06:27:20.000166 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
[0m06:27:20.000832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:27:20.001260 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_lauren`.`customers`
  OPTIONS()
  as /*
For each customer, we want to know how many orders they have placed, and when they placed their first order.
*/

with 
    customers as (
      select * from `analytics-engineers-club.coffee_shop.customers`
    ),

    orders as (
      select * from `analytics-engineers-club.coffee_shop.orders`
    ),

    aggregate_orders as (
      select customer_id,
            count(distinct id) as orders,
            array_agg(created_at order by created_at asc limit 1)[safe_offset(0)] as first_order_at
      from orders
      group by customer_id
    ),

    final as (

      select customers.*,
            ifnull(aggregate_orders.orders,0) as orders,
            aggregate_orders.first_order_at
      from customers 
      left join aggregate_orders on 
        customers.id = aggregate_orders.customer_id

    )

    select *
    from final
    order by first_order_at;


[0m06:27:20.812841 [debug] [Thread-1  ]: finished collecting timing info
[0m06:27:20.813455 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91238ffe-0da7-44a4-ad75-de610a2efab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6c306b50>]}
[0m06:27:20.813894 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.customers .............................. [[32mOK[0m in 0.86s]
[0m06:27:20.814460 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
[0m06:27:20.816281 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m06:27:20.817029 [info ] [MainThread]: 
[0m06:27:20.817790 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m06:27:20.818524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:27:20.818839 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m06:27:20.819120 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m06:27:20.827527 [info ] [MainThread]: 
[0m06:27:20.827920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:27:20.828457 [info ] [MainThread]: 
[0m06:27:20.829010 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:27:20.830133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d71b58bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e972880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6e81b490>]}


============================== 2022-08-06 17:50:40.033618 | 455e4677-93d8-43ac-bc53-46ef41ba039c ==============================
[0m17:50:40.033633 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:50:40.034722 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_name': 'coffee_shop', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m17:50:40.037376 [debug] [MainThread]: Tracking: tracking
[0m17:50:40.042972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c94f8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c9481250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c9481790>]}
[0m17:50:40.044047 [info ] [MainThread]: Setting up your profile.
[0m17:50:51.772182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c9538f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c94d5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c94d5160>]}


============================== 2022-08-06 17:52:12.633836 | 668c85e0-e8e2-4bf9-bdcb-731f2125e67c ==============================
[0m17:52:12.633851 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:52:12.634479 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m17:52:12.635008 [debug] [MainThread]: Tracking: tracking
[0m17:52:12.639238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff277eb9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff277e41310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff277e41790>]}
[0m17:52:13.496140 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:52:13.496634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '668c85e0-e8e2-4bf9-bdcb-731f2125e67c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2794b7a90>]}
[0m17:52:13.497358 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m17:52:13.497729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '668c85e0-e8e2-4bf9-bdcb-731f2125e67c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff276271880>]}
[0m17:52:13.512137 [debug] [MainThread]: Executing "git --help"
[0m17:52:13.517383 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:52:13.517894 [debug] [MainThread]: STDERR: "b''"
[0m17:52:13.530887 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m17:52:13.532058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:15.794401 [debug] [MainThread]: On debug: select 1 as id
[0m17:52:16.748249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff276271bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2762719d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff276271b80>]}
[0m17:52:17.187780 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-06 17:55:29.705031 | 0702985f-af08-47ef-996f-182e9df418c0 ==============================
[0m17:55:29.705058 [info ] [MainThread]: Running with dbt=1.2.0
[0m17:55:29.706731 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['monthly_users'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:55:29.707148 [debug] [MainThread]: Tracking: tracking
[0m17:55:29.713480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4663f6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4663f6be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4663f68e0>]}
[0m17:55:29.779736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:55:29.780114 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/monthly_users.sql
[0m17:55:29.792992 [debug] [MainThread]: 1699: static parser successfully parsed monthly_users.sql
[0m17:55:29.814722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0702985f-af08-47ef-996f-182e9df418c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff466271af0>]}
[0m17:55:29.822300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0702985f-af08-47ef-996f-182e9df418c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff466346df0>]}
[0m17:55:29.822634 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 285 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:55:29.822981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0702985f-af08-47ef-996f-182e9df418c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff466346ee0>]}
[0m17:55:29.824424 [info ] [MainThread]: 
[0m17:55:29.825210 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:55:29.826957 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students"
[0m17:55:29.827451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:30.949821 [debug] [ThreadPool]: Acquiring new bigquery connection "list_aec-students_dbt_lauren"
[0m17:55:30.950485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:31.200940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0702985f-af08-47ef-996f-182e9df418c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff466346850>]}
[0m17:55:31.201666 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:55:31.202074 [info ] [MainThread]: 
[0m17:55:31.219373 [debug] [Thread-1  ]: Began running node model.coffee_shop.monthly_users
[0m17:55:31.219737 [info ] [Thread-1  ]: 1 of 1 START view model dbt_lauren.monthly_users ............................... [RUN]
[0m17:55:31.220346 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_users"
[0m17:55:31.220561 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.monthly_users
[0m17:55:31.220779 [debug] [Thread-1  ]: Compiling model.coffee_shop.monthly_users
[0m17:55:31.224964 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.monthly_users"
[0m17:55:31.225375 [debug] [Thread-1  ]: finished collecting timing info
[0m17:55:31.225697 [debug] [Thread-1  ]: Began executing node model.coffee_shop.monthly_users
[0m17:55:31.276885 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.monthly_users"
[0m17:55:31.277440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:55:31.277827 [debug] [Thread-1  ]: On model.coffee_shop.monthly_users: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_users"} */


  create or replace view `aec-students`.`dbt_lauren`.`monthly_users`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
from `aec-students`.`dbt_lauren`.`customers`
group by 
    signup_month;


[0m17:55:32.150977 [debug] [Thread-1  ]: finished collecting timing info
[0m17:55:32.151525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0702985f-af08-47ef-996f-182e9df418c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff465de7d90>]}
[0m17:55:32.151964 [info ] [Thread-1  ]: 1 of 1 OK created view model dbt_lauren.monthly_users .......................... [[32mOK[0m in 0.93s]
[0m17:55:32.152844 [debug] [Thread-1  ]: Finished running node model.coffee_shop.monthly_users
[0m17:55:32.154287 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:55:32.154696 [info ] [MainThread]: 
[0m17:55:32.155025 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m17:55:32.155448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:32.155685 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_users' was properly closed.
[0m17:55:32.165147 [info ] [MainThread]: 
[0m17:55:32.165492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:32.166017 [info ] [MainThread]: 
[0m17:55:32.166528 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:32.167525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff465df14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4663f6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4663d0c10>]}
